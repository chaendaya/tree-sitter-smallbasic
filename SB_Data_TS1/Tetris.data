1 ID . ID = Expr
  1,1: GraphicsWindow
  1,15: .
  1,16: KeyDown
  1,24: =
  1,26: HandleKey

188 . ID = Expr
  1,15: .
  1,16: KeyDown
  1,24: =
  1,26: HandleKey

259 ID = Expr
  1,16: KeyDown
  1,24: =
  1,26: HandleKey

214 = Expr
  1,24: =
  1,26: HandleKey

75 ID
  1,26: HandleKey

2 ID . ID = Expr
  2,1: GraphicsWindow
  2,15: .
  2,16: BackgroundColor
  2,32: =
  2,34: GraphicsWindow.GetColorFromRGB( 253, 252, 251 )

188 . ID = Expr
  2,15: .
  2,16: BackgroundColor
  2,32: =
  2,34: GraphicsWindow.GetColorFromRGB( 253, 252, 251 )

259 ID = Expr
  2,16: BackgroundColor
  2,32: =
  2,34: GraphicsWindow.GetColorFromRGB( 253, 252, 251 )

214 = Expr
  2,32: =
  2,34: GraphicsWindow.GetColorFromRGB( 253, 252, 251 )

75 ID . ID ( Exprs )
  2,34: GraphicsWindow
  2,48: .
  2,49: GetColorFromRGB
  2,64: (
  2,66: 253, 252, 251
  2,80: )

2 . ID ( Exprs )
  2,48: .
  2,49: GetColorFromRGB
  2,64: (
  2,66: 253, 252, 251
  2,80: )

247 ID ( Exprs )
  2,49: GetColorFromRGB
  2,64: (
  2,66: 253, 252, 251
  2,80: )

6 ( Exprs )
  2,64: (
  2,66: 253, 252, 251
  2,80: )

21 NUM
  2,66: 253

217 , MoreThanOneExpr
  2,69: ,
  2,71: 252, 251

54 NUM
  2,71: 252

217 , MoreThanOneExpr
  2,74: ,
  2,76: 251

54 NUM
  2,76: 251

250 )
  2,80: )

20 Stmt_token1 Expr CRStmtCRs Stmt_token2
  4,1: While
  4,7: "True"
  4,13: 
  BOXES = 4      ' number of boxes per piece
  BWIDTH = 25    ' box width in pixels
  XOFFSET = 40   ' Screen X offset in pixels of where the board starts
  YOFFSET = 40   ' Screen Y offset in pixels of where the board starts
  CWIDTH = 10    ' Canvas Width, in number of boxes
  CHEIGHT = 20   ' Canvas Height, in number of boxes.
  STARTDELAY = 800
  ENDDELAY = 175
  PREVIEW_xpos = 13
  PREVIEW_ypos = 2

  GraphicsWindow.Clear()
  GraphicsWindow.Title = "Small Basic Tetris"
  GraphicsWindow.Height = 580
  GraphicsWindow.Width = 700
  GraphicsWindow.Show()

  SetupTemplates()
  SetupCanvas()
  MainLoop()

  GraphicsWindow.ShowMessage( "Game Over", "Small Basic Tetris" )

  27,1: EndWhile

77 STR
  4,7: "True"

43 CR_token2
  4,13: 


126 ID = Expr
  5,3: BOXES
  5,9: =
  5,11: 4

184 = Expr
  5,9: =
  5,11: 4

70 NUM
  5,11: 4

205 Comment CR
  5,18: ' number of boxes per piece
  5,45: 


43 CR_token2
  5,45: 


126 ID = Expr
  6,3: BWIDTH
  6,10: =
  6,12: 25

184 = Expr
  6,10: =
  6,12: 25

70 NUM
  6,12: 25

205 Comment CR
  6,18: ' box width in pixels
  6,39: 


43 CR_token2
  6,39: 


126 ID = Expr
  7,3: XOFFSET
  7,11: =
  7,13: 40

184 = Expr
  7,11: =
  7,13: 40

70 NUM
  7,13: 40

205 Comment CR
  7,18: ' Screen X offset in pixels of where the board starts
  7,71: 


43 CR_token2
  7,71: 


126 ID = Expr
  8,3: YOFFSET
  8,11: =
  8,13: 40

184 = Expr
  8,11: =
  8,13: 40

70 NUM
  8,13: 40

205 Comment CR
  8,18: ' Screen Y offset in pixels of where the board starts
  8,71: 


43 CR_token2
  8,71: 


126 ID = Expr
  9,3: CWIDTH
  9,10: =
  9,12: 10

184 = Expr
  9,10: =
  9,12: 10

70 NUM
  9,12: 10

205 Comment CR
  9,18: ' Canvas Width, in number of boxes
  9,52: 


43 CR_token2
  9,52: 


126 ID = Expr
  10,3: CHEIGHT
  10,11: =
  10,13: 20

184 = Expr
  10,11: =
  10,13: 20

70 NUM
  10,13: 20

205 Comment CR
  10,18: ' Canvas Height, in number of boxes.
  10,54: 


43 CR_token2
  10,54: 


126 ID = Expr
  11,3: STARTDELAY
  11,14: =
  11,16: 800

184 = Expr
  11,14: =
  11,16: 800

70 NUM
  11,16: 800

43 CR_token2
  11,19: 


126 ID = Expr
  12,3: ENDDELAY
  12,12: =
  12,14: 175

184 = Expr
  12,12: =
  12,14: 175

70 NUM
  12,14: 175

43 CR_token2
  12,17: 


126 ID = Expr
  13,3: PREVIEW_xpos
  13,16: =
  13,18: 13

184 = Expr
  13,16: =
  13,18: 13

70 NUM
  13,18: 13

43 CR_token2
  13,20: 


126 ID = Expr
  14,3: PREVIEW_ypos
  14,16: =
  14,18: 2

184 = Expr
  14,16: =
  14,18: 2

70 NUM
  14,18: 2

43 CR_token2
  14,19: 



126 ID . ID ( )
  16,3: GraphicsWindow
  16,17: .
  16,18: Clear
  16,23: (
  16,24: )

184 . ID ( )
  16,17: .
  16,18: Clear
  16,23: (
  16,24: )

255 ID ( )
  16,18: Clear
  16,23: (
  16,24: )

221 ( )
  16,23: (
  16,24: )

27 )
  16,24: )

208 CR_token2
  16,25: 


126 ID . ID = Expr
  17,3: GraphicsWindow
  17,17: .
  17,18: Title
  17,24: =
  17,26: "Small Basic Tetris"

184 . ID = Expr
  17,17: .
  17,18: Title
  17,24: =
  17,26: "Small Basic Tetris"

255 ID = Expr
  17,18: Title
  17,24: =
  17,26: "Small Basic Tetris"

221 = Expr
  17,24: =
  17,26: "Small Basic Tetris"

57 STR
  17,26: "Small Basic Tetris"

43 CR_token2
  17,46: 


126 ID . ID = Expr
  18,3: GraphicsWindow
  18,17: .
  18,18: Height
  18,25: =
  18,27: 580

184 . ID = Expr
  18,17: .
  18,18: Height
  18,25: =
  18,27: 580

255 ID = Expr
  18,18: Height
  18,25: =
  18,27: 580

221 = Expr
  18,25: =
  18,27: 580

57 NUM
  18,27: 580

43 CR_token2
  18,30: 


126 ID . ID = Expr
  19,3: GraphicsWindow
  19,17: .
  19,18: Width
  19,24: =
  19,26: 700

184 . ID = Expr
  19,17: .
  19,18: Width
  19,24: =
  19,26: 700

255 ID = Expr
  19,18: Width
  19,24: =
  19,26: 700

221 = Expr
  19,24: =
  19,26: 700

57 NUM
  19,26: 700

43 CR_token2
  19,29: 


126 ID . ID ( )
  20,3: GraphicsWindow
  20,17: .
  20,18: Show
  20,22: (
  20,23: )

184 . ID ( )
  20,17: .
  20,18: Show
  20,22: (
  20,23: )

255 ID ( )
  20,18: Show
  20,22: (
  20,23: )

221 ( )
  20,22: (
  20,23: )

27 )
  20,23: )

208 CR_token2
  20,24: 



126 ID ( )
  22,3: SetupTemplates
  22,17: (
  22,18: )

184 ( )
  22,17: (
  22,18: )

261 )
  22,18: )

215 CR_token2
  22,19: 


126 ID ( )
  23,3: SetupCanvas
  23,14: (
  23,15: )

184 ( )
  23,14: (
  23,15: )

261 )
  23,15: )

215 CR_token2
  23,16: 


126 ID ( )
  24,3: MainLoop
  24,11: (
  24,12: )

184 ( )
  24,11: (
  24,12: )

261 )
  24,12: )

215 CR_token2
  24,13: 



126 ID . ID ( Exprs )
  26,3: GraphicsWindow
  26,17: .
  26,18: ShowMessage
  26,29: (
  26,31: "Game Over", "Small Basic Tetris"
  26,65: )

184 . ID ( Exprs )
  26,17: .
  26,18: ShowMessage
  26,29: (
  26,31: "Game Over", "Small Basic Tetris"
  26,65: )

255 ID ( Exprs )
  26,18: ShowMessage
  26,29: (
  26,31: "Game Over", "Small Basic Tetris"
  26,65: )

221 ( Exprs )
  26,29: (
  26,31: "Game Over", "Small Basic Tetris"
  26,65: )

27 STR
  26,31: "Game Over"

217 , MoreThanOneExpr
  26,42: ,
  26,44: "Small Basic Tetris"

54 STR
  26,44: "Small Basic Tetris"

238 )
  26,65: )

210 CR_token2
  26,66: 


179 Stmt_token2
  27,1: EndWhile

146 Stmt_token7 ID CRStmtCRs Stmt_token8
  29,1: Sub
  29,5: MainLoop
  29,13: 
  template = Text.Append("template", Math.GetRandomNumber(7))

  CreatePiece() ' in: template ret: h
  nextPiece = h

  end = 0
  sessionDelay = STARTDELAY
  While end = 0
    If sessionDelay > ENDDELAY Then
      sessionDelay = sessionDelay - 1
    EndIf

    delay = sessionDelay
    thisPiece = nextPiece
    template = Text.Append("template", Math.GetRandomNumber(7))

    CreatePiece() ' in: template ret: h
    nextPiece = h
    DrawPreviewPiece()

    h = thisPiece

    ypos = 0
    done = 0
    xpos = 3 ' always drop from column 3
    CheckStop() ' in: ypos, xpos, h ret: done
    If done = 1 Then
      ypos = ypos - 1
      MovePiece()  'in: ypos, xpos, h
      end = 1
    EndIf

    yposdelta = 0
    While done = 0 Or yposdelta > 0
      MovePiece()  'in: ypos, xpos, h

      ' Delay, but break if the delay get set to 0 if the piece gets dropped
      delayIndex = delay
      While delayIndex > 0 And delay > 0
        Program.Delay(10)
        delayIndex = delayIndex - 10
      EndWhile

      If yposdelta > 0 Then
        yposdelta = yposdelta - 1  ' used to create freespin, when the piece is rotated
      Else
        ypos = ypos + 1            ' otherwise, move the piece down.
      EndIf

      ' Check if the piece should stop.
      CheckStop() ' in: ypos, xpos, h ret: done 
    EndWhile
  EndWhile

  83,1: EndSub

244 ID CRStmtCRs Stmt_token8
  29,5: MainLoop
  29,13: 
  template = Text.Append("template", Math.GetRandomNumber(7))

  CreatePiece() ' in: template ret: h
  nextPiece = h

  end = 0
  sessionDelay = STARTDELAY
  While end = 0
    If sessionDelay > ENDDELAY Then
      sessionDelay = sessionDelay - 1
    EndIf

    delay = sessionDelay
    thisPiece = nextPiece
    template = Text.Append("template", Math.GetRandomNumber(7))

    CreatePiece() ' in: template ret: h
    nextPiece = h
    DrawPreviewPiece()

    h = thisPiece

    ypos = 0
    done = 0
    xpos = 3 ' always drop from column 3
    CheckStop() ' in: ypos, xpos, h ret: done
    If done = 1 Then
      ypos = ypos - 1
      MovePiece()  'in: ypos, xpos, h
      end = 1
    EndIf

    yposdelta = 0
    While done = 0 Or yposdelta > 0
      MovePiece()  'in: ypos, xpos, h

      ' Delay, but break if the delay get set to 0 if the piece gets dropped
      delayIndex = delay
      While delayIndex > 0 And delay > 0
        Program.Delay(10)
        delayIndex = delayIndex - 10
      EndWhile

      If yposdelta > 0 Then
        yposdelta = yposdelta - 1  ' used to create freespin, when the piece is rotated
      Else
        ypos = ypos + 1            ' otherwise, move the piece down.
      EndIf

      ' Check if the piece should stop.
      CheckStop() ' in: ypos, xpos, h ret: done 
    EndWhile
  EndWhile

  83,1: EndSub

199 CR_token2
  29,13: 


160 ID = Expr
  30,3: template
  30,12: =
  30,14: Text.Append("template", Math.GetRandomNumber(7))

184 = Expr
  30,12: =
  30,14: Text.Append("template", Math.GetRandomNumber(7))

70 ID . ID ( Exprs )
  30,14: Text
  30,18: .
  30,19: Append
  30,25: (
  30,26: "template", Math.GetRandomNumber(7)
  30,61: )

5 . ID ( Exprs )
  30,18: .
  30,19: Append
  30,25: (
  30,26: "template", Math.GetRandomNumber(7)
  30,61: )

260 ID ( Exprs )
  30,19: Append
  30,25: (
  30,26: "template", Math.GetRandomNumber(7)
  30,61: )

24 ( Exprs )
  30,25: (
  30,26: "template", Math.GetRandomNumber(7)
  30,61: )

26 STR
  30,26: "template"

217 , MoreThanOneExpr
  30,36: ,
  30,38: Math.GetRandomNumber(7)

54 ID . ID ( Exprs )
  30,38: Math
  30,42: .
  30,43: GetRandomNumber
  30,58: (
  30,59: 7
  30,60: )

4 . ID ( Exprs )
  30,42: .
  30,43: GetRandomNumber
  30,58: (
  30,59: 7
  30,60: )

248 ID ( Exprs )
  30,43: GetRandomNumber
  30,58: (
  30,59: 7
  30,60: )

23 ( Exprs )
  30,58: (
  30,59: 7
  30,60: )

22 NUM
  30,59: 7

239 )
  30,60: )

249 )
  30,61: )

49 CR_token2
  30,62: 



160 ID ( )
  32,3: CreatePiece
  32,14: (
  32,15: )

184 ( )
  32,14: (
  32,15: )

261 )
  32,15: )

206 Comment CR
  32,17: ' in: template ret: h
  32,38: 


215 CR_token2
  32,38: 


160 ID = Expr
  33,3: nextPiece
  33,13: =
  33,15: h

184 = Expr
  33,13: =
  33,15: h

70 ID
  33,15: h

5 CR_token2
  33,16: 



160 ID = Expr
  35,3: end
  35,7: =
  35,9: 0

184 = Expr
  35,7: =
  35,9: 0

70 NUM
  35,9: 0

43 CR_token2
  35,10: 


160 ID = Expr
  36,3: sessionDelay
  36,16: =
  36,18: STARTDELAY

184 = Expr
  36,16: =
  36,18: STARTDELAY

70 ID
  36,18: STARTDELAY

5 CR_token2
  36,28: 


160 Stmt_token1 Expr CRStmtCRs Stmt_token2
  37,3: While
  37,9: end = 0
  37,16: 
    If sessionDelay > ENDDELAY Then
      sessionDelay = sessionDelay - 1
    EndIf

    delay = sessionDelay
    thisPiece = nextPiece
    template = Text.Append("template", Math.GetRandomNumber(7))

    CreatePiece() ' in: template ret: h
    nextPiece = h
    DrawPreviewPiece()

    h = thisPiece

    ypos = 0
    done = 0
    xpos = 3 ' always drop from column 3
    CheckStop() ' in: ypos, xpos, h ret: done
    If done = 1 Then
      ypos = ypos - 1
      MovePiece()  'in: ypos, xpos, h
      end = 1
    EndIf

    yposdelta = 0
    While done = 0 Or yposdelta > 0
      MovePiece()  'in: ypos, xpos, h

      ' Delay, but break if the delay get set to 0 if the piece gets dropped
      delayIndex = delay
      While delayIndex > 0 And delay > 0
        Program.Delay(10)
        delayIndex = delayIndex - 10
      EndWhile

      If yposdelta > 0 Then
        yposdelta = yposdelta - 1  ' used to create freespin, when the piece is rotated
      Else
        ypos = ypos + 1            ' otherwise, move the piece down.
      EndIf

      ' Check if the piece should stop.
      CheckStop() ' in: ypos, xpos, h ret: done 
    EndWhile

  82,3: EndWhile

79 ID
  37,9: end

135 = CompExpr
  37,13: =
  37,15: 0

123 NUM
  37,15: 0

43 CR_token2
  37,16: 


126 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  38,5: If
  38,8: sessionDelay > ENDDELAY
  38,32: Then
  38,36: 
      sessionDelay = sessionDelay - 1

  40,5: EndIf

86 ID
  38,8: sessionDelay

91 > AdditiveExpr
  38,21: >
  38,23: ENDDELAY

131 ID
  38,23: ENDDELAY

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  38,32: Then
  38,36: 
      sessionDelay = sessionDelay - 1

  40,5: EndIf

124 CR_token2
  38,36: 


109 ID = Expr
  39,7: sessionDelay
  39,20: =
  39,22: sessionDelay - 1

184 = Expr
  39,20: =
  39,22: sessionDelay - 1

70 ID
  39,22: sessionDelay

59 - MultiplicativeExpr
  39,35: -
  39,37: 1

144 NUM
  39,37: 1

43 CR_token2
  39,38: 


109 OptionalElse_token1
  40,5: EndIf

218 CR_token2
  40,10: 



126 ID = Expr
  42,5: delay
  42,11: =
  42,13: sessionDelay

184 = Expr
  42,11: =
  42,13: sessionDelay

70 ID
  42,13: sessionDelay

5 CR_token2
  42,25: 


126 ID = Expr
  43,5: thisPiece
  43,15: =
  43,17: nextPiece

184 = Expr
  43,15: =
  43,17: nextPiece

70 ID
  43,17: nextPiece

5 CR_token2
  43,26: 


126 ID = Expr
  44,5: template
  44,14: =
  44,16: Text.Append("template", Math.GetRandomNumber(7))

184 = Expr
  44,14: =
  44,16: Text.Append("template", Math.GetRandomNumber(7))

70 ID . ID ( Exprs )
  44,16: Text
  44,20: .
  44,21: Append
  44,27: (
  44,28: "template", Math.GetRandomNumber(7)
  44,63: )

5 . ID ( Exprs )
  44,20: .
  44,21: Append
  44,27: (
  44,28: "template", Math.GetRandomNumber(7)
  44,63: )

260 ID ( Exprs )
  44,21: Append
  44,27: (
  44,28: "template", Math.GetRandomNumber(7)
  44,63: )

24 ( Exprs )
  44,27: (
  44,28: "template", Math.GetRandomNumber(7)
  44,63: )

26 STR
  44,28: "template"

217 , MoreThanOneExpr
  44,38: ,
  44,40: Math.GetRandomNumber(7)

54 ID . ID ( Exprs )
  44,40: Math
  44,44: .
  44,45: GetRandomNumber
  44,60: (
  44,61: 7
  44,62: )

4 . ID ( Exprs )
  44,44: .
  44,45: GetRandomNumber
  44,60: (
  44,61: 7
  44,62: )

248 ID ( Exprs )
  44,45: GetRandomNumber
  44,60: (
  44,61: 7
  44,62: )

23 ( Exprs )
  44,60: (
  44,61: 7
  44,62: )

22 NUM
  44,61: 7

239 )
  44,62: )

249 )
  44,63: )

49 CR_token2
  44,64: 



126 ID ( )
  46,5: CreatePiece
  46,16: (
  46,17: )

184 ( )
  46,16: (
  46,17: )

261 )
  46,17: )

205 Comment CR
  46,19: ' in: template ret: h
  46,40: 


215 CR_token2
  46,40: 


126 ID = Expr
  47,5: nextPiece
  47,15: =
  47,17: h

184 = Expr
  47,15: =
  47,17: h

70 ID
  47,17: h

5 CR_token2
  47,18: 


126 ID ( )
  48,5: DrawPreviewPiece
  48,21: (
  48,22: )

184 ( )
  48,21: (
  48,22: )

261 )
  48,22: )

215 CR_token2
  48,23: 



126 ID = Expr
  50,5: h
  50,7: =
  50,9: thisPiece

184 = Expr
  50,7: =
  50,9: thisPiece

70 ID
  50,9: thisPiece

5 CR_token2
  50,18: 



126 ID = Expr
  52,5: ypos
  52,10: =
  52,12: 0

184 = Expr
  52,10: =
  52,12: 0

70 NUM
  52,12: 0

43 CR_token2
  52,13: 


126 ID = Expr
  53,5: done
  53,10: =
  53,12: 0

184 = Expr
  53,10: =
  53,12: 0

70 NUM
  53,12: 0

43 CR_token2
  53,13: 


126 ID = Expr
  54,5: xpos
  54,10: =
  54,12: 3

184 = Expr
  54,10: =
  54,12: 3

70 NUM
  54,12: 3

205 Comment CR
  54,14: ' always drop from column 3
  54,41: 


43 CR_token2
  54,41: 


126 ID ( )
  55,5: CheckStop
  55,14: (
  55,15: )

184 ( )
  55,14: (
  55,15: )

261 )
  55,15: )

205 Comment CR
  55,17: ' in: ypos, xpos, h ret: done
  55,46: 


215 CR_token2
  55,46: 


126 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  56,5: If
  56,8: done = 1
  56,17: Then
  56,21: 
      ypos = ypos - 1
      MovePiece()  'in: ypos, xpos, h
      end = 1

  60,5: EndIf

86 ID
  56,8: done

128 = CompExpr
  56,13: =
  56,15: 1

117 NUM
  56,15: 1

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  56,17: Then
  56,21: 
      ypos = ypos - 1
      MovePiece()  'in: ypos, xpos, h
      end = 1

  60,5: EndIf

124 CR_token2
  56,21: 


109 ID = Expr
  57,7: ypos
  57,12: =
  57,14: ypos - 1

184 = Expr
  57,12: =
  57,14: ypos - 1

70 ID
  57,14: ypos

59 - MultiplicativeExpr
  57,19: -
  57,21: 1

144 NUM
  57,21: 1

43 CR_token2
  57,22: 


109 ID ( )
  58,7: MovePiece
  58,16: (
  58,17: )

184 ( )
  58,16: (
  58,17: )

261 )
  58,17: )

207 Comment CR
  58,20: 'in: ypos, xpos, h
  58,38: 


215 CR_token2
  58,38: 


109 ID = Expr
  59,7: end
  59,11: =
  59,13: 1

184 = Expr
  59,11: =
  59,13: 1

70 NUM
  59,13: 1

43 CR_token2
  59,14: 


109 OptionalElse_token1
  60,5: EndIf

218 CR_token2
  60,10: 



126 ID = Expr
  62,5: yposdelta
  62,15: =
  62,17: 0

184 = Expr
  62,15: =
  62,17: 0

70 NUM
  62,17: 0

43 CR_token2
  62,18: 


126 Stmt_token1 Expr Stmt_repeat1 Stmt_token2
  63,5: While
  63,11: done = 0 Or yposdelta > 0
  63,36: 
      MovePiece()  'in: ypos, xpos, h

      ' Delay, but break if the delay get set to 0 if the piece gets dropped
      delayIndex = delay
      While delayIndex > 0 And delay > 0
        Program.Delay(10)
        delayIndex = delayIndex - 10
      EndWhile

      If yposdelta > 0 Then
        yposdelta = yposdelta - 1  ' used to create freespin, when the piece is rotated
      Else
        ypos = ypos + 1            ' otherwise, move the piece down.
      EndIf

      ' Check if the piece should stop.
      CheckStop() ' in: ypos, xpos, h ret: done 

  81,5: EndWhile

79 ID
  63,11: done

135 = CompExpr
  63,16: =
  63,18: 0

123 NUM
  63,18: 0

181 OrExpr_token1 AndExpr
  63,20: Or
  63,23: yposdelta > 0

99 ID
  63,23: yposdelta

90 > AdditiveExpr
  63,33: >
  63,35: 0

129 NUM
  63,35: 0

43 CR_token2
  63,36: 


126 ID ( )
  64,7: MovePiece
  64,16: (
  64,17: )

184 ( )
  64,16: (
  64,17: )

261 )
  64,17: )

205 Comment CR
  64,20: 'in: ypos, xpos, h
  64,38: 



215 CR_token2
  64,38: 



187 Comment CRStmtCRs
  66,7: ' Delay, but break if the delay get set to 0 if the piece gets dropped
  66,77: 
      delayIndex = delay
      While delayIndex > 0 And delay > 0
        Program.Delay(10)
        delayIndex = delayIndex - 10
      EndWhile

      If yposdelta > 0 Then
        yposdelta = yposdelta - 1  ' used to create freespin, when the piece is rotated
      Else
        ypos = ypos + 1            ' otherwise, move the piece down.
      EndIf



126 CR_token2
  66,77: 


126 ID = Expr
  67,7: delayIndex
  67,18: =
  67,20: delay

184 = Expr
  67,18: =
  67,20: delay

70 ID
  67,20: delay

5 CR_token2
  67,25: 


126 Stmt_token1 Expr CRStmtCRs Stmt_token2
  68,7: While
  68,13: delayIndex > 0 And delay > 0
  68,41: 
        Program.Delay(10)
        delayIndex = delayIndex - 10

  71,7: EndWhile

79 ID
  68,13: delayIndex

90 > AdditiveExpr
  68,24: >
  68,26: 0

129 NUM
  68,26: 0

169 AndExpr_token1 EqNeqExpr
  68,28: And
  68,32: delay > 0

104 ID
  68,32: delay

90 > AdditiveExpr
  68,38: >
  68,40: 0

129 NUM
  68,40: 0

43 CR_token2
  68,41: 


126 ID . ID ( Exprs )
  69,9: Program
  69,16: .
  69,17: Delay
  69,22: (
  69,23: 10
  69,25: )

184 . ID ( Exprs )
  69,16: .
  69,17: Delay
  69,22: (
  69,23: 10
  69,25: )

255 ID ( Exprs )
  69,17: Delay
  69,22: (
  69,23: 10
  69,25: )

221 ( Exprs )
  69,22: (
  69,23: 10
  69,25: )

27 NUM
  69,23: 10

238 )
  69,25: )

210 CR_token2
  69,26: 


126 ID = Expr
  70,9: delayIndex
  70,20: =
  70,22: delayIndex - 10

184 = Expr
  70,20: =
  70,22: delayIndex - 10

70 ID
  70,22: delayIndex

59 - MultiplicativeExpr
  70,33: -
  70,35: 10

144 NUM
  70,35: 10

43 CR_token2
  70,37: 


187 Stmt_token2
  71,7: EndWhile

222 CR_token2
  71,15: 



126 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  73,7: If
  73,10: yposdelta > 0
  73,24: Then
  73,28: 
        yposdelta = yposdelta - 1  ' used to create freespin, when the piece is rotated

  75,7: Else
        ypos = ypos + 1            ' otherwise, move the piece down.
      EndIf

86 ID
  73,10: yposdelta

91 > AdditiveExpr
  73,20: >
  73,22: 0

131 NUM
  73,22: 0

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  73,24: Then
  73,28: 
        yposdelta = yposdelta - 1  ' used to create freespin, when the piece is rotated

  75,7: Else
        ypos = ypos + 1            ' otherwise, move the piece down.
      EndIf

124 CR_token2
  73,28: 


109 ID = Expr
  74,9: yposdelta
  74,19: =
  74,21: yposdelta - 1

184 = Expr
  74,19: =
  74,21: yposdelta - 1

70 ID
  74,21: yposdelta

59 - MultiplicativeExpr
  74,31: -
  74,33: 1

144 NUM
  74,33: 1

207 Comment CR
  74,36: ' used to create freespin, when the piece is rotated
  74,88: 


43 CR_token2
  74,88: 


109 OptionalElse_token2 CRStmtCRs OptionalElse_token1
  75,7: Else
  75,11: 
        ypos = ypos + 1            ' otherwise, move the piece down.

  77,7: EndIf

201 CR_token2
  75,11: 


163 ID = Expr
  76,9: ypos
  76,14: =
  76,16: ypos + 1

184 = Expr
  76,14: =
  76,16: ypos + 1

70 ID
  76,16: ypos

59 + MultiplicativeExpr
  76,21: +
  76,23: 1

144 NUM
  76,23: 1

202 Comment CR
  76,36: ' otherwise, move the piece down.
  76,69: 


43 CR_token2
  76,69: 


237 OptionalElse_token1
  77,7: EndIf

209 CR_token2
  77,12: 



126 Comment CRStmtCRs
  79,7: ' Check if the piece should stop.
  79,40: 
      CheckStop() ' in: ypos, xpos, h ret: done 


126 CR_token2
  79,40: 


126 ID ( )
  80,7: CheckStop
  80,16: (
  80,17: )

184 ( )
  80,16: (
  80,17: )

261 )
  80,17: )

205 Comment CR
  80,19: ' in: ypos, xpos, h ret: done 
  80,49: 


215 CR_token2
  80,49: 


187 Stmt_token2
  81,5: EndWhile

222 CR_token2
  81,13: 


187 Stmt_token2
  82,3: EndWhile

222 CR_token2
  82,11: 


257 Stmt_token8
  83,1: EndSub

146 Stmt_token7 ID CRStmtCRs Stmt_token8
  85,1: Sub
  85,5: HandleKey
  85,14: 
  ' Stop game
  If GraphicsWindow.LastKey = "Escape" Then
    Program.End()
  EndIf

  ' Move piece left
  If GraphicsWindow.LastKey = "Left" Then
    moveDirection = -1
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
    If invalidMove = 0 Then
      xpos = xpos + moveDirection
    EndIf
    MovePiece()  'in: ypos, xpos, h
  EndIf

  ' Move piece right
  If GraphicsWindow.LastKey = "Right" Then
    moveDirection = 1
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
    If invalidMove = 0 Then
      xpos = xpos + moveDirection
    EndIf
    MovePiece()  'in: ypos, xpos, h
  EndIf

  ' Move piece down
  If GraphicsWindow.LastKey = "Down" or GraphicsWindow.LastKey = "Space" Then
    delay = 0
  EndIf

  ' Rotate piece
  If GraphicsWindow.LastKey = "Up" Then
    basetemplate = Array.GetValue(h, -1)  ' Array.GetValue(h, -1) = the template name
    template = "temptemplate"
    rotation = "CW"
    CopyPiece()  'in basetemplate, template, rotation

    Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
    moveDirection = 0
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0

    ' See if it can be moved so that it will rotate.
    xposbk = xpos
    yposdelta = 0
    While yposdelta = 0 And Math.Abs(xposbk - xpos) < 3 ' move up to 3 times only
      ' if the rotation move worked, copy the temp to "rotatedtemplate" and use that from now on
      If invalidMove = 0 Then
        basetemplate = template
        template = "rotatedtemplate"
        Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
        rotation = "COPY"
        CopyPiece()  'in basetemplate, template, rotation
        yposdelta = 1 ' Don't move down if we rotate
        MovePiece()  'in: ypos, xpos, h
      ElseIf invalidMove = 2 Then
        ' Don't support shifting piece when hitting another piece to the right or left.
        xpos = 99 ' exit the loop
      Else
        ' if the rotated piece can't be placed, move it left or right and try again.
        xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
      EndIf
    EndWhile

    If invalidMove <> 0 Then
      xpos = xposbk
      Array.SetValue(h, -1, basetemplate) ' Array.GetValue(h, -1) = the template name
      template = ""
    EndIf
  EndIf

  156,1: EndSub

244 ID CRStmtCRs Stmt_token8
  85,5: HandleKey
  85,14: 
  ' Stop game
  If GraphicsWindow.LastKey = "Escape" Then
    Program.End()
  EndIf

  ' Move piece left
  If GraphicsWindow.LastKey = "Left" Then
    moveDirection = -1
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
    If invalidMove = 0 Then
      xpos = xpos + moveDirection
    EndIf
    MovePiece()  'in: ypos, xpos, h
  EndIf

  ' Move piece right
  If GraphicsWindow.LastKey = "Right" Then
    moveDirection = 1
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
    If invalidMove = 0 Then
      xpos = xpos + moveDirection
    EndIf
    MovePiece()  'in: ypos, xpos, h
  EndIf

  ' Move piece down
  If GraphicsWindow.LastKey = "Down" or GraphicsWindow.LastKey = "Space" Then
    delay = 0
  EndIf

  ' Rotate piece
  If GraphicsWindow.LastKey = "Up" Then
    basetemplate = Array.GetValue(h, -1)  ' Array.GetValue(h, -1) = the template name
    template = "temptemplate"
    rotation = "CW"
    CopyPiece()  'in basetemplate, template, rotation

    Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
    moveDirection = 0
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0

    ' See if it can be moved so that it will rotate.
    xposbk = xpos
    yposdelta = 0
    While yposdelta = 0 And Math.Abs(xposbk - xpos) < 3 ' move up to 3 times only
      ' if the rotation move worked, copy the temp to "rotatedtemplate" and use that from now on
      If invalidMove = 0 Then
        basetemplate = template
        template = "rotatedtemplate"
        Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
        rotation = "COPY"
        CopyPiece()  'in basetemplate, template, rotation
        yposdelta = 1 ' Don't move down if we rotate
        MovePiece()  'in: ypos, xpos, h
      ElseIf invalidMove = 2 Then
        ' Don't support shifting piece when hitting another piece to the right or left.
        xpos = 99 ' exit the loop
      Else
        ' if the rotated piece can't be placed, move it left or right and try again.
        xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
      EndIf
    EndWhile

    If invalidMove <> 0 Then
      xpos = xposbk
      Array.SetValue(h, -1, basetemplate) ' Array.GetValue(h, -1) = the template name
      template = ""
    EndIf
  EndIf

  156,1: EndSub

199 CR_token2
  85,14: 


105 Comment CRStmtCRs_repeat1
  86,3: ' Stop game
  87,3: If GraphicsWindow.LastKey = "Escape" Then
    Program.End()
  EndIf

  ' Move piece left
  If GraphicsWindow.LastKey = "Left" Then
    moveDirection = -1
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
    If invalidMove = 0 Then
      xpos = xpos + moveDirection
    EndIf
    MovePiece()  'in: ypos, xpos, h
  EndIf

  ' Move piece right
  If GraphicsWindow.LastKey = "Right" Then
    moveDirection = 1
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
    If invalidMove = 0 Then
      xpos = xpos + moveDirection
    EndIf
    MovePiece()  'in: ypos, xpos, h
  EndIf

  ' Move piece down
  If GraphicsWindow.LastKey = "Down" or GraphicsWindow.LastKey = "Space" Then
    delay = 0
  EndIf

  ' Rotate piece
  If GraphicsWindow.LastKey = "Up" Then
    basetemplate = Array.GetValue(h, -1)  ' Array.GetValue(h, -1) = the template name
    template = "temptemplate"
    rotation = "CW"
    CopyPiece()  'in basetemplate, template, rotation

    Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
    moveDirection = 0
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0

    ' See if it can be moved so that it will rotate.
    xposbk = xpos
    yposdelta = 0
    While yposdelta = 0 And Math.Abs(xposbk - xpos) < 3 ' move up to 3 times only
      ' if the rotation move worked, copy the temp to "rotatedtemplate" and use that from now on
      If invalidMove = 0 Then
        basetemplate = template
        template = "rotatedtemplate"
        Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
        rotation = "COPY"
        CopyPiece()  'in basetemplate, template, rotation
        yposdelta = 1 ' Don't move down if we rotate
        MovePiece()  'in: ypos, xpos, h
      ElseIf invalidMove = 2 Then
        ' Don't support shifting piece when hitting another piece to the right or left.
        xpos = 99 ' exit the loop
      Else
        ' if the rotated piece can't be placed, move it left or right and try again.
        xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
      EndIf
    EndWhile

    If invalidMove <> 0 Then
      xpos = xposbk
      Array.SetValue(h, -1, basetemplate) ' Array.GetValue(h, -1) = the template name
      template = ""
    EndIf
  EndIf


160 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  87,3: If
  87,6: GraphicsWindow.LastKey = "Escape"
  87,40: Then
  87,44: 
    Program.End()

  89,3: EndIf

86 ID . ID
  87,6: GraphicsWindow
  87,20: .
  87,21: LastKey

4 . ID
  87,20: .
  87,21: LastKey

248 ID
  87,21: LastKey

128 = CompExpr
  87,29: =
  87,31: "Escape"

117 STR
  87,31: "Escape"

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  87,40: Then
  87,44: 
    Program.End()

  89,3: EndIf

124 CR_token2
  87,44: 


109 ID . ID ( )
  88,5: Program
  88,12: .
  88,13: End
  88,16: (
  88,17: )

184 . ID ( )
  88,12: .
  88,13: End
  88,16: (
  88,17: )

255 ID ( )
  88,13: End
  88,16: (
  88,17: )

221 ( )
  88,16: (
  88,17: )

27 )
  88,17: )

208 CR_token2
  88,18: 


109 OptionalElse_token1
  89,3: EndIf

218 CR_token2
  89,8: 



106 Comment TheRest
  91,3: ' Move piece left
  92,3: If GraphicsWindow.LastKey = "Left" Then
    moveDirection = -1
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
    If invalidMove = 0 Then
      xpos = xpos + moveDirection
    EndIf
    MovePiece()  'in: ypos, xpos, h
  EndIf



160 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  92,3: If
  92,6: GraphicsWindow.LastKey = "Left"
  92,38: Then
  92,42: 
    moveDirection = -1
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
    If invalidMove = 0 Then
      xpos = xpos + moveDirection
    EndIf
    MovePiece()  'in: ypos, xpos, h

  99,3: EndIf

86 ID . ID
  92,6: GraphicsWindow
  92,20: .
  92,21: LastKey

4 . ID
  92,20: .
  92,21: LastKey

248 ID
  92,21: LastKey

128 = CompExpr
  92,29: =
  92,31: "Left"

117 STR
  92,31: "Left"

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  92,38: Then
  92,42: 
    moveDirection = -1
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
    If invalidMove = 0 Then
      xpos = xpos + moveDirection
    EndIf
    MovePiece()  'in: ypos, xpos, h

  99,3: EndIf

124 CR_token2
  92,42: 


109 ID = Expr
  93,5: moveDirection
  93,19: =
  93,21: -1

184 = Expr
  93,19: =
  93,21: -1

70 - Primary
  93,21: -
  93,22: 1

193 NUM
  93,22: 1

43 CR_token2
  93,23: 


109 ID ( )
  94,5: ValidateMove
  94,17: (
  94,18: )

184 ( )
  94,17: (
  94,18: )

261 )
  94,18: )

207 Comment CR
  94,21: ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
  94,119: 


215 CR_token2
  94,119: 


109 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  95,5: If
  95,8: invalidMove = 0
  95,24: Then
  95,28: 
      xpos = xpos + moveDirection

  97,5: EndIf

86 ID
  95,8: invalidMove

128 = CompExpr
  95,20: =
  95,22: 0

117 NUM
  95,22: 0

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  95,24: Then
  95,28: 
      xpos = xpos + moveDirection

  97,5: EndIf

124 CR_token2
  95,28: 


109 ID = Expr
  96,7: xpos
  96,12: =
  96,14: xpos + moveDirection

184 = Expr
  96,12: =
  96,14: xpos + moveDirection

70 ID
  96,14: xpos

59 + MultiplicativeExpr
  96,19: +
  96,21: moveDirection

144 ID
  96,21: moveDirection

5 CR_token2
  96,34: 


109 OptionalElse_token1
  97,5: EndIf

218 CR_token2
  97,10: 


109 ID ( )
  98,5: MovePiece
  98,14: (
  98,15: )

184 ( )
  98,14: (
  98,15: )

261 )
  98,15: )

207 Comment CR
  98,18: 'in: ypos, xpos, h
  98,36: 


215 CR_token2
  98,36: 


109 OptionalElse_token1
  99,3: EndIf

218 CR_token2
  99,8: 



160 Comment CRStmtCRs_repeat1
  101,3: ' Move piece right
  102,3: If GraphicsWindow.LastKey = "Right" Then
    moveDirection = 1
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
    If invalidMove = 0 Then
      xpos = xpos + moveDirection
    EndIf
    MovePiece()  'in: ypos, xpos, h
  EndIf

  ' Move piece down
  If GraphicsWindow.LastKey = "Down" or GraphicsWindow.LastKey = "Space" Then
    delay = 0
  EndIf



160 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  102,3: If
  102,6: GraphicsWindow.LastKey = "Right"
  102,39: Then
  102,43: 
    moveDirection = 1
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
    If invalidMove = 0 Then
      xpos = xpos + moveDirection
    EndIf
    MovePiece()  'in: ypos, xpos, h

  109,3: EndIf

86 ID . ID
  102,6: GraphicsWindow
  102,20: .
  102,21: LastKey

4 . ID
  102,20: .
  102,21: LastKey

248 ID
  102,21: LastKey

128 = CompExpr
  102,29: =
  102,31: "Right"

117 STR
  102,31: "Right"

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  102,39: Then
  102,43: 
    moveDirection = 1
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
    If invalidMove = 0 Then
      xpos = xpos + moveDirection
    EndIf
    MovePiece()  'in: ypos, xpos, h

  109,3: EndIf

124 CR_token2
  102,43: 


109 ID = Expr
  103,5: moveDirection
  103,19: =
  103,21: 1

184 = Expr
  103,19: =
  103,21: 1

70 NUM
  103,21: 1

43 CR_token2
  103,22: 


109 ID ( )
  104,5: ValidateMove
  104,17: (
  104,18: )

184 ( )
  104,17: (
  104,18: )

261 )
  104,18: )

207 Comment CR
  104,21: ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
  104,119: 


215 CR_token2
  104,119: 


109 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  105,5: If
  105,8: invalidMove = 0
  105,24: Then
  105,28: 
      xpos = xpos + moveDirection

  107,5: EndIf

86 ID
  105,8: invalidMove

128 = CompExpr
  105,20: =
  105,22: 0

117 NUM
  105,22: 0

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  105,24: Then
  105,28: 
      xpos = xpos + moveDirection

  107,5: EndIf

124 CR_token2
  105,28: 


109 ID = Expr
  106,7: xpos
  106,12: =
  106,14: xpos + moveDirection

184 = Expr
  106,12: =
  106,14: xpos + moveDirection

70 ID
  106,14: xpos

59 + MultiplicativeExpr
  106,19: +
  106,21: moveDirection

144 ID
  106,21: moveDirection

5 CR_token2
  106,34: 


109 OptionalElse_token1
  107,5: EndIf

218 CR_token2
  107,10: 


109 ID ( )
  108,5: MovePiece
  108,14: (
  108,15: )

184 ( )
  108,14: (
  108,15: )

261 )
  108,15: )

207 Comment CR
  108,18: 'in: ypos, xpos, h
  108,36: 


215 CR_token2
  108,36: 


109 OptionalElse_token1
  109,3: EndIf

218 CR_token2
  109,8: 



107 Comment TheRest
  111,3: ' Move piece down
  112,3: If GraphicsWindow.LastKey = "Down" or GraphicsWindow.LastKey = "Space" Then
    delay = 0
  EndIf



160 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  112,3: If
  112,6: GraphicsWindow.LastKey = "Down" or GraphicsWindow.LastKey = "Space"
  112,74: Then
  112,78: 
    delay = 0

  114,3: EndIf

86 ID . ID
  112,6: GraphicsWindow
  112,20: .
  112,21: LastKey

4 . ID
  112,20: .
  112,21: LastKey

248 ID
  112,21: LastKey

128 = CompExpr
  112,29: =
  112,31: "Down"

117 STR
  112,31: "Down"

183 OrExpr_token1 AndExpr
  112,38: or
  112,41: GraphicsWindow.LastKey = "Space"

100 ID . ID
  112,41: GraphicsWindow
  112,55: .
  112,56: LastKey

4 . ID
  112,55: .
  112,56: LastKey

248 ID
  112,56: LastKey

128 = CompExpr
  112,64: =
  112,66: "Space"

117 STR
  112,66: "Space"

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  112,74: Then
  112,78: 
    delay = 0

  114,3: EndIf

124 CR_token2
  112,78: 


109 ID = Expr
  113,5: delay
  113,11: =
  113,13: 0

184 = Expr
  113,11: =
  113,13: 0

70 NUM
  113,13: 0

43 CR_token2
  113,14: 


109 OptionalElse_token1
  114,3: EndIf

218 CR_token2
  114,8: 



160 Comment TheRest
  116,3: ' Rotate piece
  117,3: If GraphicsWindow.LastKey = "Up" Then
    basetemplate = Array.GetValue(h, -1)  ' Array.GetValue(h, -1) = the template name
    template = "temptemplate"
    rotation = "CW"
    CopyPiece()  'in basetemplate, template, rotation

    Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
    moveDirection = 0
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0

    ' See if it can be moved so that it will rotate.
    xposbk = xpos
    yposdelta = 0
    While yposdelta = 0 And Math.Abs(xposbk - xpos) < 3 ' move up to 3 times only
      ' if the rotation move worked, copy the temp to "rotatedtemplate" and use that from now on
      If invalidMove = 0 Then
        basetemplate = template
        template = "rotatedtemplate"
        Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
        rotation = "COPY"
        CopyPiece()  'in basetemplate, template, rotation
        yposdelta = 1 ' Don't move down if we rotate
        MovePiece()  'in: ypos, xpos, h
      ElseIf invalidMove = 2 Then
        ' Don't support shifting piece when hitting another piece to the right or left.
        xpos = 99 ' exit the loop
      Else
        ' if the rotated piece can't be placed, move it left or right and try again.
        xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
      EndIf
    EndWhile

    If invalidMove <> 0 Then
      xpos = xposbk
      Array.SetValue(h, -1, basetemplate) ' Array.GetValue(h, -1) = the template name
      template = ""
    EndIf
  EndIf


160 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  117,3: If
  117,6: GraphicsWindow.LastKey = "Up"
  117,36: Then
  117,40: 
    basetemplate = Array.GetValue(h, -1)  ' Array.GetValue(h, -1) = the template name
    template = "temptemplate"
    rotation = "CW"
    CopyPiece()  'in basetemplate, template, rotation

    Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
    moveDirection = 0
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0

    ' See if it can be moved so that it will rotate.
    xposbk = xpos
    yposdelta = 0
    While yposdelta = 0 And Math.Abs(xposbk - xpos) < 3 ' move up to 3 times only
      ' if the rotation move worked, copy the temp to "rotatedtemplate" and use that from now on
      If invalidMove = 0 Then
        basetemplate = template
        template = "rotatedtemplate"
        Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
        rotation = "COPY"
        CopyPiece()  'in basetemplate, template, rotation
        yposdelta = 1 ' Don't move down if we rotate
        MovePiece()  'in: ypos, xpos, h
      ElseIf invalidMove = 2 Then
        ' Don't support shifting piece when hitting another piece to the right or left.
        xpos = 99 ' exit the loop
      Else
        ' if the rotated piece can't be placed, move it left or right and try again.
        xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
      EndIf
    EndWhile

    If invalidMove <> 0 Then
      xpos = xposbk
      Array.SetValue(h, -1, basetemplate) ' Array.GetValue(h, -1) = the template name
      template = ""
    EndIf

  155,3: EndIf

86 ID . ID
  117,6: GraphicsWindow
  117,20: .
  117,21: LastKey

4 . ID
  117,20: .
  117,21: LastKey

248 ID
  117,21: LastKey

128 = CompExpr
  117,29: =
  117,31: "Up"

117 STR
  117,31: "Up"

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  117,36: Then
  117,40: 
    basetemplate = Array.GetValue(h, -1)  ' Array.GetValue(h, -1) = the template name
    template = "temptemplate"
    rotation = "CW"
    CopyPiece()  'in basetemplate, template, rotation

    Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
    moveDirection = 0
    ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0

    ' See if it can be moved so that it will rotate.
    xposbk = xpos
    yposdelta = 0
    While yposdelta = 0 And Math.Abs(xposbk - xpos) < 3 ' move up to 3 times only
      ' if the rotation move worked, copy the temp to "rotatedtemplate" and use that from now on
      If invalidMove = 0 Then
        basetemplate = template
        template = "rotatedtemplate"
        Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
        rotation = "COPY"
        CopyPiece()  'in basetemplate, template, rotation
        yposdelta = 1 ' Don't move down if we rotate
        MovePiece()  'in: ypos, xpos, h
      ElseIf invalidMove = 2 Then
        ' Don't support shifting piece when hitting another piece to the right or left.
        xpos = 99 ' exit the loop
      Else
        ' if the rotated piece can't be placed, move it left or right and try again.
        xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
      EndIf
    EndWhile

    If invalidMove <> 0 Then
      xpos = xposbk
      Array.SetValue(h, -1, basetemplate) ' Array.GetValue(h, -1) = the template name
      template = ""
    EndIf

  155,3: EndIf

124 CR_token2
  117,40: 


109 ID = Expr
  118,5: basetemplate
  118,18: =
  118,20: Array.GetValue(h, -1)

184 = Expr
  118,18: =
  118,20: Array.GetValue(h, -1)

70 ID . ID ( Exprs )
  118,20: Array
  118,25: .
  118,26: GetValue
  118,34: (
  118,35: h, -1
  118,40: )

5 . ID ( Exprs )
  118,25: .
  118,26: GetValue
  118,34: (
  118,35: h, -1
  118,40: )

260 ID ( Exprs )
  118,26: GetValue
  118,34: (
  118,35: h, -1
  118,40: )

24 ( Exprs )
  118,34: (
  118,35: h, -1
  118,40: )

26 ID
  118,35: h

217 , MoreThanOneExpr
  118,36: ,
  118,38: -1

54 - Primary
  118,38: -
  118,39: 1

197 NUM
  118,39: 1

249 )
  118,40: )

207 Comment CR
  118,43: ' Array.GetValue(h, -1) = the template name
  118,86: 


49 CR_token2
  118,86: 


109 ID = Expr
  119,5: template
  119,14: =
  119,16: "temptemplate"

184 = Expr
  119,14: =
  119,16: "temptemplate"

70 STR
  119,16: "temptemplate"

43 CR_token2
  119,30: 


109 ID = Expr
  120,5: rotation
  120,14: =
  120,16: "CW"

184 = Expr
  120,14: =
  120,16: "CW"

70 STR
  120,16: "CW"

43 CR_token2
  120,20: 


109 ID ( )
  121,5: CopyPiece
  121,14: (
  121,15: )

184 ( )
  121,14: (
  121,15: )

261 )
  121,15: )

207 Comment CR
  121,18: 'in basetemplate, template, rotation
  121,54: 



215 CR_token2
  121,54: 



109 ID . ID ( Exprs )
  123,5: Array
  123,10: .
  123,11: SetValue
  123,19: (
  123,20: h, -1, template
  123,35: )

184 . ID ( Exprs )
  123,10: .
  123,11: SetValue
  123,19: (
  123,20: h, -1, template
  123,35: )

255 ID ( Exprs )
  123,11: SetValue
  123,19: (
  123,20: h, -1, template
  123,35: )

221 ( Exprs )
  123,19: (
  123,20: h, -1, template
  123,35: )

27 ID
  123,20: h

217 , MoreThanOneExpr
  123,21: ,
  123,23: -1, template

54 - Primary
  123,23: -
  123,24: 1

197 NUM
  123,24: 1

217 , MoreThanOneExpr
  123,25: ,
  123,27: template

54 ID
  123,27: template

238 )
  123,35: )

207 Comment CR
  123,37: ' Array.GetValue(h, -1) = the template name
  123,80: 


210 CR_token2
  123,80: 


109 ID = Expr
  124,5: moveDirection
  124,19: =
  124,21: 0

184 = Expr
  124,19: =
  124,21: 0

70 NUM
  124,21: 0

43 CR_token2
  124,22: 


109 ID ( )
  125,5: ValidateMove
  125,17: (
  125,18: )

184 ( )
  125,17: (
  125,18: )

261 )
  125,18: )

207 Comment CR
  125,21: ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
  125,119: 



215 CR_token2
  125,119: 



122 Comment CRStmtCRs
  127,5: ' See if it can be moved so that it will rotate.
  127,53: 
    xposbk = xpos
    yposdelta = 0
    While yposdelta = 0 And Math.Abs(xposbk - xpos) < 3 ' move up to 3 times only
      ' if the rotation move worked, copy the temp to "rotatedtemplate" and use that from now on
      If invalidMove = 0 Then
        basetemplate = template
        template = "rotatedtemplate"
        Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
        rotation = "COPY"
        CopyPiece()  'in basetemplate, template, rotation
        yposdelta = 1 ' Don't move down if we rotate
        MovePiece()  'in: ypos, xpos, h
      ElseIf invalidMove = 2 Then
        ' Don't support shifting piece when hitting another piece to the right or left.
        xpos = 99 ' exit the loop
      Else
        ' if the rotated piece can't be placed, move it left or right and try again.
        xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
      EndIf
    EndWhile

    If invalidMove <> 0 Then
      xpos = xposbk
      Array.SetValue(h, -1, basetemplate) ' Array.GetValue(h, -1) = the template name
      template = ""
    EndIf


109 CR_token2
  127,53: 


109 ID = Expr
  128,5: xposbk
  128,12: =
  128,14: xpos

184 = Expr
  128,12: =
  128,14: xpos

70 ID
  128,14: xpos

5 CR_token2
  128,18: 


109 ID = Expr
  129,5: yposdelta
  129,15: =
  129,17: 0

184 = Expr
  129,15: =
  129,17: 0

70 NUM
  129,17: 0

43 CR_token2
  129,18: 


109 Stmt_token1 Expr Comment Stmt_repeat1 Stmt_token2
  130,5: While
  130,11: yposdelta = 0 And Math.Abs(xposbk - xpos) < 3
  130,57: ' move up to 3 times only
  130,82: 
      ' if the rotation move worked, copy the temp to "rotatedtemplate" and use that from now on
      If invalidMove = 0 Then
        basetemplate = template
        template = "rotatedtemplate"
        Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
        rotation = "COPY"
        CopyPiece()  'in basetemplate, template, rotation
        yposdelta = 1 ' Don't move down if we rotate
        MovePiece()  'in: ypos, xpos, h
      ElseIf invalidMove = 2 Then
        ' Don't support shifting piece when hitting another piece to the right or left.
        xpos = 99 ' exit the loop
      Else
        ' if the rotated piece can't be placed, move it left or right and try again.
        xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
      EndIf

  148,5: EndWhile

79 ID
  130,11: yposdelta

135 = CompExpr
  130,21: =
  130,23: 0

123 NUM
  130,23: 0

169 AndExpr_token1 EqNeqExpr
  130,25: And
  130,29: Math.Abs(xposbk - xpos) < 3

104 ID . ID ( Exprs )
  130,29: Math
  130,33: .
  130,34: Abs
  130,37: (
  130,38: xposbk - xpos
  130,51: )

5 . ID ( Exprs )
  130,33: .
  130,34: Abs
  130,37: (
  130,38: xposbk - xpos
  130,51: )

260 ID ( Exprs )
  130,34: Abs
  130,37: (
  130,38: xposbk - xpos
  130,51: )

24 ( Exprs )
  130,37: (
  130,38: xposbk - xpos
  130,51: )

26 ID
  130,38: xposbk

65 - MultiplicativeExpr
  130,45: -
  130,47: xpos

141 ID
  130,47: xpos

249 )
  130,51: )

90 < AdditiveExpr
  130,53: <
  130,55: 3

129 NUM
  130,55: 3

186 Comment Stmt_repeat1 Stmt_token2
  130,57: ' move up to 3 times only
  130,82: 
      ' if the rotation move worked, copy the temp to "rotatedtemplate" and use that from now on
      If invalidMove = 0 Then
        basetemplate = template
        template = "rotatedtemplate"
        Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
        rotation = "COPY"
        CopyPiece()  'in basetemplate, template, rotation
        yposdelta = 1 ' Don't move down if we rotate
        MovePiece()  'in: ypos, xpos, h
      ElseIf invalidMove = 2 Then
        ' Don't support shifting piece when hitting another piece to the right or left.
        xpos = 99 ' exit the loop
      Else
        ' if the rotated piece can't be placed, move it left or right and try again.
        xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
      EndIf

  148,5: EndWhile

43 CR_token2
  130,82: 


187 Comment CRStmtCRs
  131,7: ' if the rotation move worked, copy the temp to "rotatedtemplate" and use that from now on
  131,97: 
      If invalidMove = 0 Then
        basetemplate = template
        template = "rotatedtemplate"
        Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
        rotation = "COPY"
        CopyPiece()  'in basetemplate, template, rotation
        yposdelta = 1 ' Don't move down if we rotate
        MovePiece()  'in: ypos, xpos, h
      ElseIf invalidMove = 2 Then
        ' Don't support shifting piece when hitting another piece to the right or left.
        xpos = 99 ' exit the loop
      Else
        ' if the rotated piece can't be placed, move it left or right and try again.
        xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
      EndIf


126 CR_token2
  131,97: 


126 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  132,7: If
  132,10: invalidMove = 0
  132,26: Then
  132,30: 
        basetemplate = template
        template = "rotatedtemplate"
        Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
        rotation = "COPY"
        CopyPiece()  'in basetemplate, template, rotation
        yposdelta = 1 ' Don't move down if we rotate
        MovePiece()  'in: ypos, xpos, h

  140,7: ElseIf invalidMove = 2 Then
        ' Don't support shifting piece when hitting another piece to the right or left.
        xpos = 99 ' exit the loop
      Else
        ' if the rotated piece can't be placed, move it left or right and try again.
        xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
      EndIf

86 ID
  132,10: invalidMove

128 = CompExpr
  132,22: =
  132,24: 0

117 NUM
  132,24: 0

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  132,26: Then
  132,30: 
        basetemplate = template
        template = "rotatedtemplate"
        Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name
        rotation = "COPY"
        CopyPiece()  'in basetemplate, template, rotation
        yposdelta = 1 ' Don't move down if we rotate
        MovePiece()  'in: ypos, xpos, h

  140,7: ElseIf invalidMove = 2 Then
        ' Don't support shifting piece when hitting another piece to the right or left.
        xpos = 99 ' exit the loop
      Else
        ' if the rotated piece can't be placed, move it left or right and try again.
        xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
      EndIf

124 CR_token2
  132,30: 


109 ID = Expr
  133,9: basetemplate
  133,22: =
  133,24: template

184 = Expr
  133,22: =
  133,24: template

70 ID
  133,24: template

5 CR_token2
  133,32: 


109 ID = Expr
  134,9: template
  134,18: =
  134,20: "rotatedtemplate"

184 = Expr
  134,18: =
  134,20: "rotatedtemplate"

70 STR
  134,20: "rotatedtemplate"

43 CR_token2
  134,37: 


109 ID . ID ( Exprs )
  135,9: Array
  135,14: .
  135,15: SetValue
  135,23: (
  135,24: h, -1, template
  135,39: )

184 . ID ( Exprs )
  135,14: .
  135,15: SetValue
  135,23: (
  135,24: h, -1, template
  135,39: )

255 ID ( Exprs )
  135,15: SetValue
  135,23: (
  135,24: h, -1, template
  135,39: )

221 ( Exprs )
  135,23: (
  135,24: h, -1, template
  135,39: )

27 ID
  135,24: h

217 , MoreThanOneExpr
  135,25: ,
  135,27: -1, template

54 - Primary
  135,27: -
  135,28: 1

197 NUM
  135,28: 1

217 , MoreThanOneExpr
  135,29: ,
  135,31: template

54 ID
  135,31: template

238 )
  135,39: )

207 Comment CR
  135,41: ' Array.GetValue(h, -1) = the template name
  135,84: 


210 CR_token2
  135,84: 


109 ID = Expr
  136,9: rotation
  136,18: =
  136,20: "COPY"

184 = Expr
  136,18: =
  136,20: "COPY"

70 STR
  136,20: "COPY"

43 CR_token2
  136,26: 


109 ID ( )
  137,9: CopyPiece
  137,18: (
  137,19: )

184 ( )
  137,18: (
  137,19: )

261 )
  137,19: )

207 Comment CR
  137,22: 'in basetemplate, template, rotation
  137,58: 


215 CR_token2
  137,58: 


109 ID = Expr
  138,9: yposdelta
  138,19: =
  138,21: 1

184 = Expr
  138,19: =
  138,21: 1

70 NUM
  138,21: 1

207 Comment CR
  138,23: ' Don't move down if we rotate
  138,53: 


43 CR_token2
  138,53: 


109 ID ( )
  139,9: MovePiece
  139,18: (
  139,19: )

184 ( )
  139,18: (
  139,19: )

261 )
  139,19: )

207 Comment CR
  139,22: 'in: ypos, xpos, h
  139,40: 


215 CR_token2
  139,40: 


109 MoreThanZeroElseIf_token1 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  140,7: ElseIf
  140,14: invalidMove = 2
  140,30: Then
  140,34: 
        ' Don't support shifting piece when hitting another piece to the right or left.
        xpos = 99 ' exit the loop

  143,7: Else
        ' if the rotated piece can't be placed, move it left or right and try again.
        xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
      EndIf

82 ID
  140,14: invalidMove

128 = CompExpr
  140,26: =
  140,28: 2

117 NUM
  140,28: 2

236 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  140,30: Then
  140,34: 
        ' Don't support shifting piece when hitting another piece to the right or left.
        xpos = 99 ' exit the loop

  143,7: Else
        ' if the rotated piece can't be placed, move it left or right and try again.
        xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
      EndIf

118 CR_token2
  140,34: 


115 Comment CRStmtCRs
  141,9: ' Don't support shifting piece when hitting another piece to the right or left.
  141,88: 
        xpos = 99 ' exit the loop


109 CR_token2
  141,88: 


109 ID = Expr
  142,9: xpos
  142,14: =
  142,16: 99

184 = Expr
  142,14: =
  142,16: 99

70 NUM
  142,16: 99

207 Comment CR
  142,19: ' exit the loop
  142,34: 


43 CR_token2
  142,34: 


109 OptionalElse_token2 CRStmtCRs OptionalElse_token1
  143,7: Else
  143,11: 
        ' if the rotated piece can't be placed, move it left or right and try again.
        xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0

  147,7: EndIf

201 CR_token2
  143,11: 


113 Comment CRStmtCRs_repeat1
  144,9: ' if the rotated piece can't be placed, move it left or right and try again.
  145,9: xpos = xpos - invalidMove
        ValidateMove()  ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0


163 ID = Expr
  145,9: xpos
  145,14: =
  145,16: xpos - invalidMove

184 = Expr
  145,14: =
  145,16: xpos - invalidMove

70 ID
  145,16: xpos

59 - MultiplicativeExpr
  145,21: -
  145,23: invalidMove

144 ID
  145,23: invalidMove

5 CR_token2
  145,34: 


163 ID ( )
  146,9: ValidateMove
  146,21: (
  146,22: )

184 ( )
  146,21: (
  146,22: )

261 )
  146,22: )

202 Comment CR
  146,25: ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
  146,123: 


215 CR_token2
  146,123: 


237 OptionalElse_token1
  147,7: EndIf

209 CR_token2
  147,12: 


187 Stmt_token2
  148,5: EndWhile

222 CR_token2
  148,13: 



109 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  150,5: If
  150,8: invalidMove <> 0
  150,25: Then
  150,29: 
      xpos = xposbk
      Array.SetValue(h, -1, basetemplate) ' Array.GetValue(h, -1) = the template name
      template = ""

  154,5: EndIf

86 ID
  150,8: invalidMove

128 <> CompExpr
  150,20: <>
  150,23: 0

117 NUM
  150,23: 0

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  150,25: Then
  150,29: 
      xpos = xposbk
      Array.SetValue(h, -1, basetemplate) ' Array.GetValue(h, -1) = the template name
      template = ""

  154,5: EndIf

124 CR_token2
  150,29: 


109 ID = Expr
  151,7: xpos
  151,12: =
  151,14: xposbk

184 = Expr
  151,12: =
  151,14: xposbk

70 ID
  151,14: xposbk

5 CR_token2
  151,20: 


109 ID . ID ( Exprs )
  152,7: Array
  152,12: .
  152,13: SetValue
  152,21: (
  152,22: h, -1, basetemplate
  152,41: )

184 . ID ( Exprs )
  152,12: .
  152,13: SetValue
  152,21: (
  152,22: h, -1, basetemplate
  152,41: )

255 ID ( Exprs )
  152,13: SetValue
  152,21: (
  152,22: h, -1, basetemplate
  152,41: )

221 ( Exprs )
  152,21: (
  152,22: h, -1, basetemplate
  152,41: )

27 ID
  152,22: h

217 , MoreThanOneExpr
  152,23: ,
  152,25: -1, basetemplate

54 - Primary
  152,25: -
  152,26: 1

197 NUM
  152,26: 1

217 , MoreThanOneExpr
  152,27: ,
  152,29: basetemplate

54 ID
  152,29: basetemplate

238 )
  152,41: )

207 Comment CR
  152,43: ' Array.GetValue(h, -1) = the template name
  152,86: 


210 CR_token2
  152,86: 


109 ID = Expr
  153,7: template
  153,16: =
  153,18: ""

184 = Expr
  153,16: =
  153,18: ""

70 STR
  153,18: ""

43 CR_token2
  153,20: 


109 OptionalElse_token1
  154,5: EndIf

218 CR_token2
  154,10: 


109 OptionalElse_token1
  155,3: EndIf

218 CR_token2
  155,8: 


257 Stmt_token8
  156,1: EndSub

146 Stmt_token7 ID CRStmtCRs Stmt_token8
  159,1: Sub
  159,5: DrawPreviewPiece
  159,21: 
  xpos = PREVIEW_xpos
  ypos = PREVIEW_ypos
  h = nextPiece

  XOFFSETBK = XOFFSET
  YOFFSETBK = YOFFSET
  XOFFSET = XOFFSET + Array.GetValue(Array.GetValue(h, -1), "pviewx") ' Array.GetValue(h, -1) = the template name
  YOFFSET = YOFFSET + Array.GetValue(Array.GetValue(h, -1), "pviewy") ' Array.GetValue(h, -1) = the template name
  MovePiece()  'in: ypos, xpos, h

  XOFFSET = XOFFSETBK
  YOFFSET = YOFFSETBK

  172,1: EndSub

244 ID CRStmtCRs Stmt_token8
  159,5: DrawPreviewPiece
  159,21: 
  xpos = PREVIEW_xpos
  ypos = PREVIEW_ypos
  h = nextPiece

  XOFFSETBK = XOFFSET
  YOFFSETBK = YOFFSET
  XOFFSET = XOFFSET + Array.GetValue(Array.GetValue(h, -1), "pviewx") ' Array.GetValue(h, -1) = the template name
  YOFFSET = YOFFSET + Array.GetValue(Array.GetValue(h, -1), "pviewy") ' Array.GetValue(h, -1) = the template name
  MovePiece()  'in: ypos, xpos, h

  XOFFSET = XOFFSETBK
  YOFFSET = YOFFSETBK

  172,1: EndSub

199 CR_token2
  159,21: 


160 ID = Expr
  160,3: xpos
  160,8: =
  160,10: PREVIEW_xpos

184 = Expr
  160,8: =
  160,10: PREVIEW_xpos

70 ID
  160,10: PREVIEW_xpos

5 CR_token2
  160,22: 


160 ID = Expr
  161,3: ypos
  161,8: =
  161,10: PREVIEW_ypos

184 = Expr
  161,8: =
  161,10: PREVIEW_ypos

70 ID
  161,10: PREVIEW_ypos

5 CR_token2
  161,22: 


160 ID = Expr
  162,3: h
  162,5: =
  162,7: nextPiece

184 = Expr
  162,5: =
  162,7: nextPiece

70 ID
  162,7: nextPiece

5 CR_token2
  162,16: 



160 ID = Expr
  164,3: XOFFSETBK
  164,13: =
  164,15: XOFFSET

184 = Expr
  164,13: =
  164,15: XOFFSET

70 ID
  164,15: XOFFSET

5 CR_token2
  164,22: 


160 ID = Expr
  165,3: YOFFSETBK
  165,13: =
  165,15: YOFFSET

184 = Expr
  165,13: =
  165,15: YOFFSET

70 ID
  165,15: YOFFSET

5 CR_token2
  165,22: 


160 ID = Expr
  166,3: XOFFSET
  166,11: =
  166,13: XOFFSET + Array.GetValue(Array.GetValue(h, -1), "pviewx")

184 = Expr
  166,11: =
  166,13: XOFFSET + Array.GetValue(Array.GetValue(h, -1), "pviewx")

70 ID
  166,13: XOFFSET

59 + MultiplicativeExpr
  166,21: +
  166,23: Array.GetValue(Array.GetValue(h, -1), "pviewx")

144 ID . ID ( Exprs )
  166,23: Array
  166,28: .
  166,29: GetValue
  166,37: (
  166,38: Array.GetValue(h, -1), "pviewx"
  166,69: )

5 . ID ( Exprs )
  166,28: .
  166,29: GetValue
  166,37: (
  166,38: Array.GetValue(h, -1), "pviewx"
  166,69: )

260 ID ( Exprs )
  166,29: GetValue
  166,37: (
  166,38: Array.GetValue(h, -1), "pviewx"
  166,69: )

24 ( Exprs )
  166,37: (
  166,38: Array.GetValue(h, -1), "pviewx"
  166,69: )

26 ID . ID ( Exprs )
  166,38: Array
  166,43: .
  166,44: GetValue
  166,52: (
  166,53: h, -1
  166,58: )

4 . ID ( Exprs )
  166,43: .
  166,44: GetValue
  166,52: (
  166,53: h, -1
  166,58: )

248 ID ( Exprs )
  166,44: GetValue
  166,52: (
  166,53: h, -1
  166,58: )

23 ( Exprs )
  166,52: (
  166,53: h, -1
  166,58: )

22 ID
  166,53: h

217 , MoreThanOneExpr
  166,54: ,
  166,56: -1

54 - Primary
  166,56: -
  166,57: 1

197 NUM
  166,57: 1

239 )
  166,58: )

217 , MoreThanOneExpr
  166,59: ,
  166,61: "pviewx"

54 STR
  166,61: "pviewx"

249 )
  166,69: )

206 Comment CR
  166,71: ' Array.GetValue(h, -1) = the template name
  166,114: 


49 CR_token2
  166,114: 


160 ID = Expr
  167,3: YOFFSET
  167,11: =
  167,13: YOFFSET + Array.GetValue(Array.GetValue(h, -1), "pviewy")

184 = Expr
  167,11: =
  167,13: YOFFSET + Array.GetValue(Array.GetValue(h, -1), "pviewy")

70 ID
  167,13: YOFFSET

59 + MultiplicativeExpr
  167,21: +
  167,23: Array.GetValue(Array.GetValue(h, -1), "pviewy")

144 ID . ID ( Exprs )
  167,23: Array
  167,28: .
  167,29: GetValue
  167,37: (
  167,38: Array.GetValue(h, -1), "pviewy"
  167,69: )

5 . ID ( Exprs )
  167,28: .
  167,29: GetValue
  167,37: (
  167,38: Array.GetValue(h, -1), "pviewy"
  167,69: )

260 ID ( Exprs )
  167,29: GetValue
  167,37: (
  167,38: Array.GetValue(h, -1), "pviewy"
  167,69: )

24 ( Exprs )
  167,37: (
  167,38: Array.GetValue(h, -1), "pviewy"
  167,69: )

26 ID . ID ( Exprs )
  167,38: Array
  167,43: .
  167,44: GetValue
  167,52: (
  167,53: h, -1
  167,58: )

4 . ID ( Exprs )
  167,43: .
  167,44: GetValue
  167,52: (
  167,53: h, -1
  167,58: )

248 ID ( Exprs )
  167,44: GetValue
  167,52: (
  167,53: h, -1
  167,58: )

23 ( Exprs )
  167,52: (
  167,53: h, -1
  167,58: )

22 ID
  167,53: h

217 , MoreThanOneExpr
  167,54: ,
  167,56: -1

54 - Primary
  167,56: -
  167,57: 1

197 NUM
  167,57: 1

239 )
  167,58: )

217 , MoreThanOneExpr
  167,59: ,
  167,61: "pviewy"

54 STR
  167,61: "pviewy"

249 )
  167,69: )

206 Comment CR
  167,71: ' Array.GetValue(h, -1) = the template name
  167,114: 


49 CR_token2
  167,114: 


160 ID ( )
  168,3: MovePiece
  168,12: (
  168,13: )

184 ( )
  168,12: (
  168,13: )

261 )
  168,13: )

206 Comment CR
  168,16: 'in: ypos, xpos, h
  168,34: 



215 CR_token2
  168,34: 



160 ID = Expr
  170,3: XOFFSET
  170,11: =
  170,13: XOFFSETBK

184 = Expr
  170,11: =
  170,13: XOFFSETBK

70 ID
  170,13: XOFFSETBK

5 CR_token2
  170,22: 


160 ID = Expr
  171,3: YOFFSET
  171,11: =
  171,13: YOFFSETBK

184 = Expr
  171,11: =
  171,13: YOFFSETBK

70 ID
  171,13: YOFFSETBK

5 CR_token2
  171,22: 


257 Stmt_token8
  172,1: EndSub

146 Comment Start_repeat1
  174,1: ' creates template that's a rotated basetemplate
  175,1: Sub CopyPiece  'in basetemplate, template, rotation 
  L = Array.GetValue(basetemplate, "dim")

  If rotation = "CW" Then
    For i = 0 to BOXES - 1 ' x' = y y' = L - 1 - x
      v = Array.GetValue(basetemplate, i)

      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (Math.Remainder(v, 10))
      y = (L - 1 - Math.Floor(v/10))
      Array.SetValue(template, i, x * 10 + y)
    EndFor
  ' Count-Cockwise is not currently used
  ElseIf rotation = "CCW" Then
    For i = 0 to BOXES - 1 ' x' = L - 1 - y y' = x
      v = Array.GetValue(basetemplate, i)
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (L - 1 - Math.Remainder(v, 10))
      y = Math.Floor(v/10)
      Array.SetValue(template, i, x * 10 + y)
    EndFor
  ElseIf rotation = "COPY" Then
    For i = 0 to BOXES - 1
      Array.SetValue(template, i, Array.GetValue(basetemplate, i))
    EndFor
  Else
    GraphicsWindow.ShowMessage("invalid parameter", "Error")
    Program.End()
  EndIf

  ' Copy the remain properties from basetemplate to template.
  Array.SetValue(template, "color", Array.GetValue(basetemplate, "color"))
  Array.SetValue(template, "dim", Array.GetValue(basetemplate, "dim"))
  Array.SetValue(template, "pviewx", Array.GetValue(basetemplate, "pviewx"))
  Array.SetValue(template, "pviewy", Array.GetValue(basetemplate, "pviewy"))
EndSub

Sub CreatePiece ' in: template ret: h
  ' Create a new handle, representing an arrayName, that will represent the piece
  hcount = hcount + 1
  h = Text.Append("piece", hcount)

  Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name

  GraphicsWindow.PenWidth = 1
  GraphicsWindow.PenColor = "Black"
  GraphicsWindow.BrushColor = Array.GetValue(template, "color")

  For i = 0 to BOXES - 1
    s = Shapes.AddRectangle(BWIDTH, BWIDTH)
    Shapes.Move(s, -BWIDTH, -BWIDTH) ' move off screen
    Array.SetValue(h, i, s)
  EndFor
EndSub

Sub MovePiece 'in: ypos, xpos, h. ypos/xpos is 0-19, representing the top/left box coordinate of the piece on the canvas. h returned by CreatePiece
  For i = 0 to BOXES - 1
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    ' Array.GetValue(h, i) = box for piece h.
    ' xpos/ypos = are topleft of shape. x/y is the box offset within the shape.
    Shapes.Move(Array.GetValue(h, i), XOFFSET + xpos * BWIDTH + x * BWIDTH, YOFFSET + ypos * BWIDTH + y * BWIDTH)
  EndFor
EndSub

Sub ValidateMove ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
  i = 0
  invalidMove = 0
  While i < BOXES
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name

    'x/y is the box offset within the shape.
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    If (x + xpos + moveDirection) < 0 Then
      invalidMove = -1
      i = BOXES ' force getting out of the loop
    EndIf

    If (x + xpos + moveDirection) >= CWIDTH Then
      invalidMove = 1
      i = BOXES ' force getting out of the loop
    EndIf

    If Array.GetValue("c", (x + xpos + moveDirection) + (y + ypos) * CWIDTH) <> "." Then
      invalidMove = 2
      i = BOXES ' force getting out of the loop
    EndIf

    i = i + 1
  EndWhile
EndSub


Sub CheckStop ' in: ypos, xpos, h ret: done
  done = 0
  i = 0
  While i < BOXES
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name

    'x/y is the box offset within the shape.
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    If y + ypos > CHEIGHT Or Array.GetValue("c", (x + xpos) + (y + ypos) * CWIDTH) <> "." Then
      done = 1
      i = BOXES ' force getting out of the loop
    EndIf

    i = i + 1
  EndWhile

  ' If we need to stop the piece, move the box handles to the canvas
  If done = 1 Then
    For i = 0 to BOXES - 1
      v = Array.GetValue(Array.GetValue(h, -1), i) ' Array.GetValue(h, -1) = the template name
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10) 
      Array.SetValue("c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i))
    EndFor

    ' 1 points for every piece successfully dropped
    score = score + 1
    PrintScore()

    ' Delete clared lines
    DeleteLines()
  EndIf
EndSub


Sub DeleteLines
  linesCleared = 0

  ' Iterate over each row, starting from the bottom
  For y = CHEIGHT - 1 to 0 Step -1

    ' Check to see if the whole row is filled
    x = CWIDTH
    While x = CWIDTH
      x = 0
      While x < CWIDTH
        piece = Array.GetValue("c", x + y * CWIDTH)
        If piece = "." then
          x = CWIDTH
        EndIf
        x = x + 1
      EndWhile

      ' if non of them were empty (i.e "."), then remove the line.
      If x = CWIDTH Then

        ' Delete the line
        For x1 = 0 to CWIDTH - 1
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))
        EndFor
        linesCleared = linesCleared + 1

        ' Move everything else down one.
        For y1 = y To 1 Step -1
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor
        EndFor
      EndIf
    EndWhile
  EndFor

  If linesCleared > 0 Then
    score = score + 100 * Math.Round(linesCleared * 2.15 - 1)
    PrintScore()
  EndIf
EndSub

Sub SetupCanvas
' GraphicsWindow.DrawResizedImage( Flickr.GetRandomPicture( "bricks" ), 0, 0, GraphicsWindow.Width, GraphicsWindow.Height)


  GraphicsWindow.BrushColor = GraphicsWindow.BackgroundColor
  GraphicsWindow.FillRectangle(XOFFSET, YOFFSET, CWIDTH*BWIDTH, CHEIGHT*BWIDTH)

  Program.Delay(200)
  GraphicsWindow.PenWidth = 1
  GraphicsWindow.PenColor = "Pink"
  For x = 0 To CWIDTH-1
    For y = 0 To CHEIGHT-1
      Array.SetValue("c", x + y * CWIDTH, ".") ' "." indicates spot is free
      GraphicsWindow.DrawRectangle(XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH)
    EndFor
  EndFor

  GraphicsWindow.PenWidth = 4
  GraphicsWindow.PenColor = "Black"
  GraphicsWindow.DrawLine(XOFFSET, YOFFSET, XOFFSET, YOFFSET + CHEIGHT*BWIDTH)
  GraphicsWindow.DrawLine(XOFFSET + CWIDTH*BWIDTH, YOFFSET, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH)
  GraphicsWindow.DrawLine(XOFFSET, YOFFSET + CHEIGHT*BWIDTH, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH)

  GraphicsWindow.PenColor = "Lime"
  GraphicsWindow.DrawLine(XOFFSET - 4, YOFFSET, XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 6)
  GraphicsWindow.DrawLine(XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 6)
  GraphicsWindow.DrawLine(XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 4, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 4)

  GraphicsWindow.PenColor = "Black"
  GraphicsWindow.BrushColor = "Pink"
  x = XOFFSET + PREVIEW_xpos * BWIDTH - BWIDTH
  y = YOFFSET + PREVIEW_ypos * BWIDTH - BWIDTH
  GraphicsWindow.FillRectangle(x, y, BWIDTH * 5, BWIDTH * 6)
  GraphicsWindow.DrawRectangle(x, y, BWIDTH * 5, BWIDTH * 6)

  GraphicsWindow.FillRectangle(x - 20, y + 190, 310, 170)
  GraphicsWindow.DrawRectangle(x - 20, y + 190, 310, 170)

  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.FontItalic = "False"
  GraphicsWindow.FontName = "Comic Sans MS"
  GraphicsWindow.FontSize = 16
  GraphicsWindow.DrawText(x, y + 200, "Game control keys:")
  GraphicsWindow.DrawText(x + 25, y + 220, "Left Arrow = Move piece left")
  GraphicsWindow.DrawText(x + 25, y + 240, "Right Arrow = Move piece right")
  GraphicsWindow.DrawText(x + 25, y + 260, "Up Arrow = Rotate piece")
  GraphicsWindow.DrawText(x + 25, y + 280, "Down Arrow = Drop piece")
  GraphicsWindow.DrawText(x, y + 320, "Press to stop game")

  Program.Delay(200) ' without this delay, the above text will use the fontsize of the score 

  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.FontName = "Georgia"
  GraphicsWindow.FontItalic = "True"
  GraphicsWindow.FontSize = 36
  GraphicsWindow.DrawText(x - 20, y + 400, "Small Basic Tetris")
  Program.Delay(200) ' without this delay, the above text will use the fontsize of the score 
  GraphicsWindow.FontSize = 16
  GraphicsWindow.DrawText(x - 20, y + 440, "ver.0.1")

  Program.Delay(200) ' without this delay, the above text will use the fontsize of the score 
  score = 0
  PrintScore()
EndSub


Sub PrintScore
  GraphicsWindow.PenWidth = 4
  GraphicsWindow.BrushColor = "Pink"
  GraphicsWindow.FillRectangle(500, 65, 153, 50)
  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.DrawRectangle(500, 65, 153, 50)
  GraphicsWindow.FontItalic = "False"
  GraphicsWindow.FontSize = 32
  GraphicsWindow.FontName = "Impact"
  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.DrawText(505, 70, Text.Append(Text.GetSubText( "00000000", 0, 8 - Text.GetLength( score ) ), score))
EndSub

146 Stmt_token7 ID Comment CRStmtCRs Stmt_token8
  175,1: Sub
  175,5: CopyPiece
  175,16: 'in basetemplate, template, rotation 
  175,53: 
  L = Array.GetValue(basetemplate, "dim")

  If rotation = "CW" Then
    For i = 0 to BOXES - 1 ' x' = y y' = L - 1 - x
      v = Array.GetValue(basetemplate, i)

      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (Math.Remainder(v, 10))
      y = (L - 1 - Math.Floor(v/10))
      Array.SetValue(template, i, x * 10 + y)
    EndFor
  ' Count-Cockwise is not currently used
  ElseIf rotation = "CCW" Then
    For i = 0 to BOXES - 1 ' x' = L - 1 - y y' = x
      v = Array.GetValue(basetemplate, i)
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (L - 1 - Math.Remainder(v, 10))
      y = Math.Floor(v/10)
      Array.SetValue(template, i, x * 10 + y)
    EndFor
  ElseIf rotation = "COPY" Then
    For i = 0 to BOXES - 1
      Array.SetValue(template, i, Array.GetValue(basetemplate, i))
    EndFor
  Else
    GraphicsWindow.ShowMessage("invalid parameter", "Error")
    Program.End()
  EndIf

  ' Copy the remain properties from basetemplate to template.
  Array.SetValue(template, "color", Array.GetValue(basetemplate, "color"))
  Array.SetValue(template, "dim", Array.GetValue(basetemplate, "dim"))
  Array.SetValue(template, "pviewx", Array.GetValue(basetemplate, "pviewx"))
  Array.SetValue(template, "pviewy", Array.GetValue(basetemplate, "pviewy"))

  216,1: EndSub

244 ID Comment CRStmtCRs Stmt_token8
  175,5: CopyPiece
  175,16: 'in basetemplate, template, rotation 
  175,53: 
  L = Array.GetValue(basetemplate, "dim")

  If rotation = "CW" Then
    For i = 0 to BOXES - 1 ' x' = y y' = L - 1 - x
      v = Array.GetValue(basetemplate, i)

      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (Math.Remainder(v, 10))
      y = (L - 1 - Math.Floor(v/10))
      Array.SetValue(template, i, x * 10 + y)
    EndFor
  ' Count-Cockwise is not currently used
  ElseIf rotation = "CCW" Then
    For i = 0 to BOXES - 1 ' x' = L - 1 - y y' = x
      v = Array.GetValue(basetemplate, i)
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (L - 1 - Math.Remainder(v, 10))
      y = Math.Floor(v/10)
      Array.SetValue(template, i, x * 10 + y)
    EndFor
  ElseIf rotation = "COPY" Then
    For i = 0 to BOXES - 1
      Array.SetValue(template, i, Array.GetValue(basetemplate, i))
    EndFor
  Else
    GraphicsWindow.ShowMessage("invalid parameter", "Error")
    Program.End()
  EndIf

  ' Copy the remain properties from basetemplate to template.
  Array.SetValue(template, "color", Array.GetValue(basetemplate, "color"))
  Array.SetValue(template, "dim", Array.GetValue(basetemplate, "dim"))
  Array.SetValue(template, "pviewx", Array.GetValue(basetemplate, "pviewx"))
  Array.SetValue(template, "pviewy", Array.GetValue(basetemplate, "pviewy"))

  216,1: EndSub

199 Comment CRStmtCRs Stmt_token8
  175,16: 'in basetemplate, template, rotation 
  175,53: 
  L = Array.GetValue(basetemplate, "dim")

  If rotation = "CW" Then
    For i = 0 to BOXES - 1 ' x' = y y' = L - 1 - x
      v = Array.GetValue(basetemplate, i)

      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (Math.Remainder(v, 10))
      y = (L - 1 - Math.Floor(v/10))
      Array.SetValue(template, i, x * 10 + y)
    EndFor
  ' Count-Cockwise is not currently used
  ElseIf rotation = "CCW" Then
    For i = 0 to BOXES - 1 ' x' = L - 1 - y y' = x
      v = Array.GetValue(basetemplate, i)
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (L - 1 - Math.Remainder(v, 10))
      y = Math.Floor(v/10)
      Array.SetValue(template, i, x * 10 + y)
    EndFor
  ElseIf rotation = "COPY" Then
    For i = 0 to BOXES - 1
      Array.SetValue(template, i, Array.GetValue(basetemplate, i))
    EndFor
  Else
    GraphicsWindow.ShowMessage("invalid parameter", "Error")
    Program.End()
  EndIf

  ' Copy the remain properties from basetemplate to template.
  Array.SetValue(template, "color", Array.GetValue(basetemplate, "color"))
  Array.SetValue(template, "dim", Array.GetValue(basetemplate, "dim"))
  Array.SetValue(template, "pviewx", Array.GetValue(basetemplate, "pviewx"))
  Array.SetValue(template, "pviewy", Array.GetValue(basetemplate, "pviewy"))

  216,1: EndSub

199 CR_token2
  175,53: 


160 ID = Expr
  176,3: L
  176,5: =
  176,7: Array.GetValue(basetemplate, "dim")

184 = Expr
  176,5: =
  176,7: Array.GetValue(basetemplate, "dim")

70 ID . ID ( Exprs )
  176,7: Array
  176,12: .
  176,13: GetValue
  176,21: (
  176,22: basetemplate, "dim"
  176,41: )

5 . ID ( Exprs )
  176,12: .
  176,13: GetValue
  176,21: (
  176,22: basetemplate, "dim"
  176,41: )

260 ID ( Exprs )
  176,13: GetValue
  176,21: (
  176,22: basetemplate, "dim"
  176,41: )

24 ( Exprs )
  176,21: (
  176,22: basetemplate, "dim"
  176,41: )

26 ID
  176,22: basetemplate

217 , MoreThanOneExpr
  176,34: ,
  176,36: "dim"

54 STR
  176,36: "dim"

249 )
  176,41: )

49 CR_token2
  176,42: 



160 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  178,3: If
  178,6: rotation = "CW"
  178,22: Then
  178,26: 
    For i = 0 to BOXES - 1 ' x' = y y' = L - 1 - x
      v = Array.GetValue(basetemplate, i)

      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (Math.Remainder(v, 10))
      y = (L - 1 - Math.Floor(v/10))
      Array.SetValue(template, i, x * 10 + y)
    EndFor
  ' Count-Cockwise is not currently used

  191,3: ElseIf rotation = "CCW" Then
    For i = 0 to BOXES - 1 ' x' = L - 1 - y y' = x
      v = Array.GetValue(basetemplate, i)
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (L - 1 - Math.Remainder(v, 10))
      y = Math.Floor(v/10)
      Array.SetValue(template, i, x * 10 + y)
    EndFor
  ElseIf rotation = "COPY" Then
    For i = 0 to BOXES - 1
      Array.SetValue(template, i, Array.GetValue(basetemplate, i))
    EndFor
  Else
    GraphicsWindow.ShowMessage("invalid parameter", "Error")
    Program.End()
  EndIf

86 ID
  178,6: rotation

128 = CompExpr
  178,15: =
  178,17: "CW"

117 STR
  178,17: "CW"

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  178,22: Then
  178,26: 
    For i = 0 to BOXES - 1 ' x' = y y' = L - 1 - x
      v = Array.GetValue(basetemplate, i)

      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (Math.Remainder(v, 10))
      y = (L - 1 - Math.Floor(v/10))
      Array.SetValue(template, i, x * 10 + y)
    EndFor
  ' Count-Cockwise is not currently used

  191,3: ElseIf rotation = "CCW" Then
    For i = 0 to BOXES - 1 ' x' = L - 1 - y y' = x
      v = Array.GetValue(basetemplate, i)
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (L - 1 - Math.Remainder(v, 10))
      y = Math.Floor(v/10)
      Array.SetValue(template, i, x * 10 + y)
    EndFor
  ElseIf rotation = "COPY" Then
    For i = 0 to BOXES - 1
      Array.SetValue(template, i, Array.GetValue(basetemplate, i))
    EndFor
  Else
    GraphicsWindow.ShowMessage("invalid parameter", "Error")
    Program.End()
  EndIf

124 CR_token2
  178,26: 


109 Stmt_token4 ID = Expr Stmt_token5 Expr Comment Stmt_repeat1 Stmt_token6
  179,5: For
  179,9: i
  179,11: =
  179,13: 0
  179,15: to
  179,18: BOXES - 1
  179,28: ' x' = y y' = L - 1 - x
  179,51: 
      v = Array.GetValue(basetemplate, i)

      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (Math.Remainder(v, 10))
      y = (L - 1 - Math.Floor(v/10))
      Array.SetValue(template, i, x * 10 + y)

  189,5: EndFor

267 ID = Expr Stmt_token5 Expr Comment Stmt_repeat1 Stmt_token6
  179,9: i
  179,11: =
  179,13: 0
  179,15: to
  179,18: BOXES - 1
  179,28: ' x' = y y' = L - 1 - x
  179,51: 
      v = Array.GetValue(basetemplate, i)

      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (Math.Remainder(v, 10))
      y = (L - 1 - Math.Floor(v/10))
      Array.SetValue(template, i, x * 10 + y)

  189,5: EndFor

266 = Expr Stmt_token5 Expr Comment Stmt_repeat1 Stmt_token6
  179,11: =
  179,13: 0
  179,15: to
  179,18: BOXES - 1
  179,28: ' x' = y y' = L - 1 - x
  179,51: 
      v = Array.GetValue(basetemplate, i)

      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (Math.Remainder(v, 10))
      y = (L - 1 - Math.Floor(v/10))
      Array.SetValue(template, i, x * 10 + y)

  189,5: EndFor

56 NUM
  179,13: 0

264 Stmt_token5 Expr Comment Stmt_repeat1 Stmt_token6
  179,15: to
  179,18: BOXES - 1
  179,28: ' x' = y y' = L - 1 - x
  179,51: 
      v = Array.GetValue(basetemplate, i)

      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (Math.Remainder(v, 10))
      y = (L - 1 - Math.Floor(v/10))
      Array.SetValue(template, i, x * 10 + y)

  189,5: EndFor

83 ID
  179,18: BOXES

59 - MultiplicativeExpr
  179,24: -
  179,26: 1

144 NUM
  179,26: 1

145 Comment Stmt_repeat1 Stmt_token6
  179,28: ' x' = y y' = L - 1 - x
  179,51: 
      v = Array.GetValue(basetemplate, i)

      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (Math.Remainder(v, 10))
      y = (L - 1 - Math.Floor(v/10))
      Array.SetValue(template, i, x * 10 + y)

  189,5: EndFor

43 CR_token2
  179,51: 


137 ID = Expr
  180,7: v
  180,9: =
  180,11: Array.GetValue(basetemplate, i)

184 = Expr
  180,9: =
  180,11: Array.GetValue(basetemplate, i)

70 ID . ID ( Exprs )
  180,11: Array
  180,16: .
  180,17: GetValue
  180,25: (
  180,26: basetemplate, i
  180,41: )

5 . ID ( Exprs )
  180,16: .
  180,17: GetValue
  180,25: (
  180,26: basetemplate, i
  180,41: )

260 ID ( Exprs )
  180,17: GetValue
  180,25: (
  180,26: basetemplate, i
  180,41: )

24 ( Exprs )
  180,25: (
  180,26: basetemplate, i
  180,41: )

26 ID
  180,26: basetemplate

217 , MoreThanOneExpr
  180,38: ,
  180,40: i

54 ID
  180,40: i

249 )
  180,41: )

49 CR_token2
  180,42: 



177 Comment CRStmtCRs
  182,7: 'x = Math.Floor(v/10)
  182,28: 


137 CR_token2
  182,28: 


137 Comment CRStmtCRs
  183,7: 'y = Math.Remainder(v, 10)
  183,33: 



137 CR_token2
  183,33: 



137 Comment CRStmtCRs
  185,7: ' new x and y
  185,20: 
      x = (Math.Remainder(v, 10))
      y = (L - 1 - Math.Floor(v/10))
      Array.SetValue(template, i, x * 10 + y)


137 CR_token2
  185,20: 


137 ID = Expr
  186,7: x
  186,9: =
  186,11: (Math.Remainder(v, 10))

184 = Expr
  186,9: =
  186,11: (Math.Remainder(v, 10))

70 ( Expr )
  186,11: (
  186,12: Math.Remainder(v, 10)
  186,33: )

64 ID . ID ( Exprs )
  186,12: Math
  186,16: .
  186,17: Remainder
  186,26: (
  186,27: v, 10
  186,32: )

4 . ID ( Exprs )
  186,16: .
  186,17: Remainder
  186,26: (
  186,27: v, 10
  186,32: )

248 ID ( Exprs )
  186,17: Remainder
  186,26: (
  186,27: v, 10
  186,32: )

23 ( Exprs )
  186,26: (
  186,27: v, 10
  186,32: )

22 ID
  186,27: v

217 , MoreThanOneExpr
  186,28: ,
  186,30: 10

54 NUM
  186,30: 10

239 )
  186,32: )

235 )
  186,33: )

37 CR_token2
  186,34: 


137 ID = Expr
  187,7: y
  187,9: =
  187,11: (L - 1 - Math.Floor(v/10))

184 = Expr
  187,9: =
  187,11: (L - 1 - Math.Floor(v/10))

70 ( Expr )
  187,11: (
  187,12: L - 1 - Math.Floor(v/10)
  187,36: )

64 ID
  187,12: L

65 - MultiplicativeExpr
  187,14: -
  187,16: 1

141 NUM
  187,16: 1

65 - MultiplicativeExpr
  187,18: -
  187,20: Math.Floor(v/10)

141 ID . ID ( Exprs )
  187,20: Math
  187,24: .
  187,25: Floor
  187,30: (
  187,31: v/10
  187,35: )

4 . ID ( Exprs )
  187,24: .
  187,25: Floor
  187,30: (
  187,31: v/10
  187,35: )

248 ID ( Exprs )
  187,25: Floor
  187,30: (
  187,31: v/10
  187,35: )

23 ( Exprs )
  187,30: (
  187,31: v/10
  187,35: )

22 ID
  187,31: v

50 / UnaryExpr
  187,32: /
  187,33: 10

156 NUM
  187,33: 10

239 )
  187,35: )

235 )
  187,36: )

37 CR_token2
  187,37: 


137 ID . ID ( Exprs )
  188,7: Array
  188,12: .
  188,13: SetValue
  188,21: (
  188,22: template, i, x * 10 + y
  188,45: )

184 . ID ( Exprs )
  188,12: .
  188,13: SetValue
  188,21: (
  188,22: template, i, x * 10 + y
  188,45: )

255 ID ( Exprs )
  188,13: SetValue
  188,21: (
  188,22: template, i, x * 10 + y
  188,45: )

221 ( Exprs )
  188,21: (
  188,22: template, i, x * 10 + y
  188,45: )

27 ID
  188,22: template

217 , MoreThanOneExpr
  188,30: ,
  188,32: i, x * 10 + y

54 ID
  188,32: i

217 , MoreThanOneExpr
  188,33: ,
  188,35: x * 10 + y

54 ID
  188,35: x

50 * UnaryExpr
  188,37: *
  188,39: 10

156 NUM
  188,39: 10

65 + MultiplicativeExpr
  188,42: +
  188,44: y

141 ID
  188,44: y

238 )
  188,45: )

210 CR_token2
  188,46: 


177 Stmt_token6
  189,5: EndFor

216 CR_token2
  189,11: 


122 Comment CRStmtCRs
  190,3: ' Count-Cockwise is not currently used
  190,41: 


109 CR_token2
  190,41: 


109 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  191,3: ElseIf
  191,10: rotation = "CCW"
  191,27: Then
  191,31: 
    For i = 0 to BOXES - 1 ' x' = L - 1 - y y' = x
      v = Array.GetValue(basetemplate, i)
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (L - 1 - Math.Remainder(v, 10))
      y = Math.Floor(v/10)
      Array.SetValue(template, i, x * 10 + y)
    EndFor

  202,3: ElseIf rotation = "COPY" Then
    For i = 0 to BOXES - 1
      Array.SetValue(template, i, Array.GetValue(basetemplate, i))
    EndFor
  Else
    GraphicsWindow.ShowMessage("invalid parameter", "Error")
    Program.End()
  EndIf

82 ID
  191,10: rotation

128 = CompExpr
  191,19: =
  191,21: "CCW"

117 STR
  191,21: "CCW"

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  191,27: Then
  191,31: 
    For i = 0 to BOXES - 1 ' x' = L - 1 - y y' = x
      v = Array.GetValue(basetemplate, i)
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (L - 1 - Math.Remainder(v, 10))
      y = Math.Floor(v/10)
      Array.SetValue(template, i, x * 10 + y)
    EndFor

  202,3: ElseIf rotation = "COPY" Then
    For i = 0 to BOXES - 1
      Array.SetValue(template, i, Array.GetValue(basetemplate, i))
    EndFor
  Else
    GraphicsWindow.ShowMessage("invalid parameter", "Error")
    Program.End()
  EndIf

118 CR_token2
  191,31: 


109 Stmt_token4 ID = Expr Stmt_token5 Expr Comment Stmt_repeat1 Stmt_token6
  192,5: For
  192,9: i
  192,11: =
  192,13: 0
  192,15: to
  192,18: BOXES - 1
  192,28: ' x' = L - 1 - y y' = x
  192,51: 
      v = Array.GetValue(basetemplate, i)
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (L - 1 - Math.Remainder(v, 10))
      y = Math.Floor(v/10)
      Array.SetValue(template, i, x * 10 + y)

  201,5: EndFor

267 ID = Expr Stmt_token5 Expr Comment Stmt_repeat1 Stmt_token6
  192,9: i
  192,11: =
  192,13: 0
  192,15: to
  192,18: BOXES - 1
  192,28: ' x' = L - 1 - y y' = x
  192,51: 
      v = Array.GetValue(basetemplate, i)
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (L - 1 - Math.Remainder(v, 10))
      y = Math.Floor(v/10)
      Array.SetValue(template, i, x * 10 + y)

  201,5: EndFor

266 = Expr Stmt_token5 Expr Comment Stmt_repeat1 Stmt_token6
  192,11: =
  192,13: 0
  192,15: to
  192,18: BOXES - 1
  192,28: ' x' = L - 1 - y y' = x
  192,51: 
      v = Array.GetValue(basetemplate, i)
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (L - 1 - Math.Remainder(v, 10))
      y = Math.Floor(v/10)
      Array.SetValue(template, i, x * 10 + y)

  201,5: EndFor

56 NUM
  192,13: 0

264 Stmt_token5 Expr Comment Stmt_repeat1 Stmt_token6
  192,15: to
  192,18: BOXES - 1
  192,28: ' x' = L - 1 - y y' = x
  192,51: 
      v = Array.GetValue(basetemplate, i)
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (L - 1 - Math.Remainder(v, 10))
      y = Math.Floor(v/10)
      Array.SetValue(template, i, x * 10 + y)

  201,5: EndFor

83 ID
  192,18: BOXES

59 - MultiplicativeExpr
  192,24: -
  192,26: 1

144 NUM
  192,26: 1

145 Comment Stmt_repeat1 Stmt_token6
  192,28: ' x' = L - 1 - y y' = x
  192,51: 
      v = Array.GetValue(basetemplate, i)
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10)

      ' new x and y
      x = (L - 1 - Math.Remainder(v, 10))
      y = Math.Floor(v/10)
      Array.SetValue(template, i, x * 10 + y)

  201,5: EndFor

43 CR_token2
  192,51: 


137 ID = Expr
  193,7: v
  193,9: =
  193,11: Array.GetValue(basetemplate, i)

184 = Expr
  193,9: =
  193,11: Array.GetValue(basetemplate, i)

70 ID . ID ( Exprs )
  193,11: Array
  193,16: .
  193,17: GetValue
  193,25: (
  193,26: basetemplate, i
  193,41: )

5 . ID ( Exprs )
  193,16: .
  193,17: GetValue
  193,25: (
  193,26: basetemplate, i
  193,41: )

260 ID ( Exprs )
  193,17: GetValue
  193,25: (
  193,26: basetemplate, i
  193,41: )

24 ( Exprs )
  193,25: (
  193,26: basetemplate, i
  193,41: )

26 ID
  193,26: basetemplate

217 , MoreThanOneExpr
  193,38: ,
  193,40: i

54 ID
  193,40: i

249 )
  193,41: )

49 CR_token2
  193,42: 


177 Comment CRStmtCRs
  194,7: 'x = Math.Floor(v/10)
  194,28: 


137 CR_token2
  194,28: 


137 Comment CRStmtCRs
  195,7: 'y = Math.Remainder(v, 10)
  195,33: 



137 CR_token2
  195,33: 



137 Comment CRStmtCRs
  197,7: ' new x and y
  197,20: 
      x = (L - 1 - Math.Remainder(v, 10))
      y = Math.Floor(v/10)
      Array.SetValue(template, i, x * 10 + y)


137 CR_token2
  197,20: 


137 ID = Expr
  198,7: x
  198,9: =
  198,11: (L - 1 - Math.Remainder(v, 10))

184 = Expr
  198,9: =
  198,11: (L - 1 - Math.Remainder(v, 10))

70 ( Expr )
  198,11: (
  198,12: L - 1 - Math.Remainder(v, 10)
  198,41: )

64 ID
  198,12: L

65 - MultiplicativeExpr
  198,14: -
  198,16: 1

141 NUM
  198,16: 1

65 - MultiplicativeExpr
  198,18: -
  198,20: Math.Remainder(v, 10)

141 ID . ID ( Exprs )
  198,20: Math
  198,24: .
  198,25: Remainder
  198,34: (
  198,35: v, 10
  198,40: )

4 . ID ( Exprs )
  198,24: .
  198,25: Remainder
  198,34: (
  198,35: v, 10
  198,40: )

248 ID ( Exprs )
  198,25: Remainder
  198,34: (
  198,35: v, 10
  198,40: )

23 ( Exprs )
  198,34: (
  198,35: v, 10
  198,40: )

22 ID
  198,35: v

217 , MoreThanOneExpr
  198,36: ,
  198,38: 10

54 NUM
  198,38: 10

239 )
  198,40: )

235 )
  198,41: )

37 CR_token2
  198,42: 


137 ID = Expr
  199,7: y
  199,9: =
  199,11: Math.Floor(v/10)

184 = Expr
  199,9: =
  199,11: Math.Floor(v/10)

70 ID . ID ( Exprs )
  199,11: Math
  199,15: .
  199,16: Floor
  199,21: (
  199,22: v/10
  199,26: )

5 . ID ( Exprs )
  199,15: .
  199,16: Floor
  199,21: (
  199,22: v/10
  199,26: )

260 ID ( Exprs )
  199,16: Floor
  199,21: (
  199,22: v/10
  199,26: )

24 ( Exprs )
  199,21: (
  199,22: v/10
  199,26: )

26 ID
  199,22: v

50 / UnaryExpr
  199,23: /
  199,24: 10

156 NUM
  199,24: 10

249 )
  199,26: )

49 CR_token2
  199,27: 


137 ID . ID ( Exprs )
  200,7: Array
  200,12: .
  200,13: SetValue
  200,21: (
  200,22: template, i, x * 10 + y
  200,45: )

184 . ID ( Exprs )
  200,12: .
  200,13: SetValue
  200,21: (
  200,22: template, i, x * 10 + y
  200,45: )

255 ID ( Exprs )
  200,13: SetValue
  200,21: (
  200,22: template, i, x * 10 + y
  200,45: )

221 ( Exprs )
  200,21: (
  200,22: template, i, x * 10 + y
  200,45: )

27 ID
  200,22: template

217 , MoreThanOneExpr
  200,30: ,
  200,32: i, x * 10 + y

54 ID
  200,32: i

217 , MoreThanOneExpr
  200,33: ,
  200,35: x * 10 + y

54 ID
  200,35: x

50 * UnaryExpr
  200,37: *
  200,39: 10

156 NUM
  200,39: 10

65 + MultiplicativeExpr
  200,42: +
  200,44: y

141 ID
  200,44: y

238 )
  200,45: )

210 CR_token2
  200,46: 


177 Stmt_token6
  201,5: EndFor

216 CR_token2
  201,11: 


109 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  202,3: ElseIf
  202,10: rotation = "COPY"
  202,28: Then
  202,32: 
    For i = 0 to BOXES - 1
      Array.SetValue(template, i, Array.GetValue(basetemplate, i))
    EndFor

  206,3: Else
    GraphicsWindow.ShowMessage("invalid parameter", "Error")
    Program.End()
  EndIf

82 ID
  202,10: rotation

128 = CompExpr
  202,19: =
  202,21: "COPY"

117 STR
  202,21: "COPY"

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  202,28: Then
  202,32: 
    For i = 0 to BOXES - 1
      Array.SetValue(template, i, Array.GetValue(basetemplate, i))
    EndFor

  206,3: Else
    GraphicsWindow.ShowMessage("invalid parameter", "Error")
    Program.End()
  EndIf

118 CR_token2
  202,32: 


109 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  203,5: For
  203,9: i
  203,11: =
  203,13: 0
  203,15: to
  203,18: BOXES - 1
  203,27: 
      Array.SetValue(template, i, Array.GetValue(basetemplate, i))

  205,5: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  203,9: i
  203,11: =
  203,13: 0
  203,15: to
  203,18: BOXES - 1
  203,27: 
      Array.SetValue(template, i, Array.GetValue(basetemplate, i))

  205,5: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  203,11: =
  203,13: 0
  203,15: to
  203,18: BOXES - 1
  203,27: 
      Array.SetValue(template, i, Array.GetValue(basetemplate, i))

  205,5: EndFor

56 NUM
  203,13: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  203,15: to
  203,18: BOXES - 1
  203,27: 
      Array.SetValue(template, i, Array.GetValue(basetemplate, i))

  205,5: EndFor

83 ID
  203,18: BOXES

59 - MultiplicativeExpr
  203,24: -
  203,26: 1

144 NUM
  203,26: 1

43 CR_token2
  203,27: 


137 ID . ID ( Exprs )
  204,7: Array
  204,12: .
  204,13: SetValue
  204,21: (
  204,22: template, i, Array.GetValue(basetemplate, i)
  204,66: )

184 . ID ( Exprs )
  204,12: .
  204,13: SetValue
  204,21: (
  204,22: template, i, Array.GetValue(basetemplate, i)
  204,66: )

255 ID ( Exprs )
  204,13: SetValue
  204,21: (
  204,22: template, i, Array.GetValue(basetemplate, i)
  204,66: )

221 ( Exprs )
  204,21: (
  204,22: template, i, Array.GetValue(basetemplate, i)
  204,66: )

27 ID
  204,22: template

217 , MoreThanOneExpr
  204,30: ,
  204,32: i, Array.GetValue(basetemplate, i)

54 ID
  204,32: i

217 , MoreThanOneExpr
  204,33: ,
  204,35: Array.GetValue(basetemplate, i)

54 ID . ID ( Exprs )
  204,35: Array
  204,40: .
  204,41: GetValue
  204,49: (
  204,50: basetemplate, i
  204,65: )

4 . ID ( Exprs )
  204,40: .
  204,41: GetValue
  204,49: (
  204,50: basetemplate, i
  204,65: )

248 ID ( Exprs )
  204,41: GetValue
  204,49: (
  204,50: basetemplate, i
  204,65: )

23 ( Exprs )
  204,49: (
  204,50: basetemplate, i
  204,65: )

22 ID
  204,50: basetemplate

217 , MoreThanOneExpr
  204,62: ,
  204,64: i

54 ID
  204,64: i

239 )
  204,65: )

238 )
  204,66: )

210 CR_token2
  204,67: 


177 Stmt_token6
  205,5: EndFor

216 CR_token2
  205,11: 


109 OptionalElse_token2 CRStmtCRs OptionalElse_token1
  206,3: Else
  206,7: 
    GraphicsWindow.ShowMessage("invalid parameter", "Error")
    Program.End()

  209,3: EndIf

201 CR_token2
  206,7: 


163 ID . ID ( Exprs )
  207,5: GraphicsWindow
  207,19: .
  207,20: ShowMessage
  207,31: (
  207,32: "invalid parameter", "Error"
  207,60: )

184 . ID ( Exprs )
  207,19: .
  207,20: ShowMessage
  207,31: (
  207,32: "invalid parameter", "Error"
  207,60: )

255 ID ( Exprs )
  207,20: ShowMessage
  207,31: (
  207,32: "invalid parameter", "Error"
  207,60: )

221 ( Exprs )
  207,31: (
  207,32: "invalid parameter", "Error"
  207,60: )

27 STR
  207,32: "invalid parameter"

217 , MoreThanOneExpr
  207,51: ,
  207,53: "Error"

54 STR
  207,53: "Error"

238 )
  207,60: )

210 CR_token2
  207,61: 


163 ID . ID ( )
  208,5: Program
  208,12: .
  208,13: End
  208,16: (
  208,17: )

184 . ID ( )
  208,12: .
  208,13: End
  208,16: (
  208,17: )

255 ID ( )
  208,13: End
  208,16: (
  208,17: )

221 ( )
  208,16: (
  208,17: )

27 )
  208,17: )

208 CR_token2
  208,18: 


237 OptionalElse_token1
  209,3: EndIf

209 CR_token2
  209,8: 



160 Comment TheRest
  211,3: ' Copy the remain properties from basetemplate to template.
  212,3: Array.SetValue(template, "color", Array.GetValue(basetemplate, "color"))


160 ID . ID ( Exprs )
  212,3: Array
  212,8: .
  212,9: SetValue
  212,17: (
  212,18: template, "color", Array.GetValue(basetemplate, "color")
  212,74: )

184 . ID ( Exprs )
  212,8: .
  212,9: SetValue
  212,17: (
  212,18: template, "color", Array.GetValue(basetemplate, "color")
  212,74: )

255 ID ( Exprs )
  212,9: SetValue
  212,17: (
  212,18: template, "color", Array.GetValue(basetemplate, "color")
  212,74: )

221 ( Exprs )
  212,17: (
  212,18: template, "color", Array.GetValue(basetemplate, "color")
  212,74: )

27 ID
  212,18: template

217 , MoreThanOneExpr
  212,26: ,
  212,28: "color", Array.GetValue(basetemplate, "color")

54 STR
  212,28: "color"

217 , MoreThanOneExpr
  212,35: ,
  212,37: Array.GetValue(basetemplate, "color")

54 ID . ID ( Exprs )
  212,37: Array
  212,42: .
  212,43: GetValue
  212,51: (
  212,52: basetemplate, "color"
  212,73: )

4 . ID ( Exprs )
  212,42: .
  212,43: GetValue
  212,51: (
  212,52: basetemplate, "color"
  212,73: )

248 ID ( Exprs )
  212,43: GetValue
  212,51: (
  212,52: basetemplate, "color"
  212,73: )

23 ( Exprs )
  212,51: (
  212,52: basetemplate, "color"
  212,73: )

22 ID
  212,52: basetemplate

217 , MoreThanOneExpr
  212,64: ,
  212,66: "color"

54 STR
  212,66: "color"

239 )
  212,73: )

238 )
  212,74: )

210 CR_token2
  212,75: 


160 ID . ID ( Exprs )
  213,3: Array
  213,8: .
  213,9: SetValue
  213,17: (
  213,18: template, "dim", Array.GetValue(basetemplate, "dim")
  213,70: )

184 . ID ( Exprs )
  213,8: .
  213,9: SetValue
  213,17: (
  213,18: template, "dim", Array.GetValue(basetemplate, "dim")
  213,70: )

255 ID ( Exprs )
  213,9: SetValue
  213,17: (
  213,18: template, "dim", Array.GetValue(basetemplate, "dim")
  213,70: )

221 ( Exprs )
  213,17: (
  213,18: template, "dim", Array.GetValue(basetemplate, "dim")
  213,70: )

27 ID
  213,18: template

217 , MoreThanOneExpr
  213,26: ,
  213,28: "dim", Array.GetValue(basetemplate, "dim")

54 STR
  213,28: "dim"

217 , MoreThanOneExpr
  213,33: ,
  213,35: Array.GetValue(basetemplate, "dim")

54 ID . ID ( Exprs )
  213,35: Array
  213,40: .
  213,41: GetValue
  213,49: (
  213,50: basetemplate, "dim"
  213,69: )

4 . ID ( Exprs )
  213,40: .
  213,41: GetValue
  213,49: (
  213,50: basetemplate, "dim"
  213,69: )

248 ID ( Exprs )
  213,41: GetValue
  213,49: (
  213,50: basetemplate, "dim"
  213,69: )

23 ( Exprs )
  213,49: (
  213,50: basetemplate, "dim"
  213,69: )

22 ID
  213,50: basetemplate

217 , MoreThanOneExpr
  213,62: ,
  213,64: "dim"

54 STR
  213,64: "dim"

239 )
  213,69: )

238 )
  213,70: )

210 CR_token2
  213,71: 


160 ID . ID ( Exprs )
  214,3: Array
  214,8: .
  214,9: SetValue
  214,17: (
  214,18: template, "pviewx", Array.GetValue(basetemplate, "pviewx")
  214,76: )

184 . ID ( Exprs )
  214,8: .
  214,9: SetValue
  214,17: (
  214,18: template, "pviewx", Array.GetValue(basetemplate, "pviewx")
  214,76: )

255 ID ( Exprs )
  214,9: SetValue
  214,17: (
  214,18: template, "pviewx", Array.GetValue(basetemplate, "pviewx")
  214,76: )

221 ( Exprs )
  214,17: (
  214,18: template, "pviewx", Array.GetValue(basetemplate, "pviewx")
  214,76: )

27 ID
  214,18: template

217 , MoreThanOneExpr
  214,26: ,
  214,28: "pviewx", Array.GetValue(basetemplate, "pviewx")

54 STR
  214,28: "pviewx"

217 , MoreThanOneExpr
  214,36: ,
  214,38: Array.GetValue(basetemplate, "pviewx")

54 ID . ID ( Exprs )
  214,38: Array
  214,43: .
  214,44: GetValue
  214,52: (
  214,53: basetemplate, "pviewx"
  214,75: )

4 . ID ( Exprs )
  214,43: .
  214,44: GetValue
  214,52: (
  214,53: basetemplate, "pviewx"
  214,75: )

248 ID ( Exprs )
  214,44: GetValue
  214,52: (
  214,53: basetemplate, "pviewx"
  214,75: )

23 ( Exprs )
  214,52: (
  214,53: basetemplate, "pviewx"
  214,75: )

22 ID
  214,53: basetemplate

217 , MoreThanOneExpr
  214,65: ,
  214,67: "pviewx"

54 STR
  214,67: "pviewx"

239 )
  214,75: )

238 )
  214,76: )

210 CR_token2
  214,77: 


160 ID . ID ( Exprs )
  215,3: Array
  215,8: .
  215,9: SetValue
  215,17: (
  215,18: template, "pviewy", Array.GetValue(basetemplate, "pviewy")
  215,76: )

184 . ID ( Exprs )
  215,8: .
  215,9: SetValue
  215,17: (
  215,18: template, "pviewy", Array.GetValue(basetemplate, "pviewy")
  215,76: )

255 ID ( Exprs )
  215,9: SetValue
  215,17: (
  215,18: template, "pviewy", Array.GetValue(basetemplate, "pviewy")
  215,76: )

221 ( Exprs )
  215,17: (
  215,18: template, "pviewy", Array.GetValue(basetemplate, "pviewy")
  215,76: )

27 ID
  215,18: template

217 , MoreThanOneExpr
  215,26: ,
  215,28: "pviewy", Array.GetValue(basetemplate, "pviewy")

54 STR
  215,28: "pviewy"

217 , MoreThanOneExpr
  215,36: ,
  215,38: Array.GetValue(basetemplate, "pviewy")

54 ID . ID ( Exprs )
  215,38: Array
  215,43: .
  215,44: GetValue
  215,52: (
  215,53: basetemplate, "pviewy"
  215,75: )

4 . ID ( Exprs )
  215,43: .
  215,44: GetValue
  215,52: (
  215,53: basetemplate, "pviewy"
  215,75: )

248 ID ( Exprs )
  215,44: GetValue
  215,52: (
  215,53: basetemplate, "pviewy"
  215,75: )

23 ( Exprs )
  215,52: (
  215,53: basetemplate, "pviewy"
  215,75: )

22 ID
  215,53: basetemplate

217 , MoreThanOneExpr
  215,65: ,
  215,67: "pviewy"

54 STR
  215,67: "pviewy"

239 )
  215,75: )

238 )
  215,76: )

210 CR_token2
  215,77: 


257 Stmt_token8
  216,1: EndSub

146 Stmt_token7 ID Comment CRStmtCRs Stmt_token8
  218,1: Sub
  218,5: CreatePiece
  218,17: ' in: template ret: h
  218,38: 
  ' Create a new handle, representing an arrayName, that will represent the piece
  hcount = hcount + 1
  h = Text.Append("piece", hcount)

  Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name

  GraphicsWindow.PenWidth = 1
  GraphicsWindow.PenColor = "Black"
  GraphicsWindow.BrushColor = Array.GetValue(template, "color")

  For i = 0 to BOXES - 1
    s = Shapes.AddRectangle(BWIDTH, BWIDTH)
    Shapes.Move(s, -BWIDTH, -BWIDTH) ' move off screen
    Array.SetValue(h, i, s)
  EndFor

  234,1: EndSub

244 ID Comment CRStmtCRs Stmt_token8
  218,5: CreatePiece
  218,17: ' in: template ret: h
  218,38: 
  ' Create a new handle, representing an arrayName, that will represent the piece
  hcount = hcount + 1
  h = Text.Append("piece", hcount)

  Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name

  GraphicsWindow.PenWidth = 1
  GraphicsWindow.PenColor = "Black"
  GraphicsWindow.BrushColor = Array.GetValue(template, "color")

  For i = 0 to BOXES - 1
    s = Shapes.AddRectangle(BWIDTH, BWIDTH)
    Shapes.Move(s, -BWIDTH, -BWIDTH) ' move off screen
    Array.SetValue(h, i, s)
  EndFor

  234,1: EndSub

199 Comment CRStmtCRs Stmt_token8
  218,17: ' in: template ret: h
  218,38: 
  ' Create a new handle, representing an arrayName, that will represent the piece
  hcount = hcount + 1
  h = Text.Append("piece", hcount)

  Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name

  GraphicsWindow.PenWidth = 1
  GraphicsWindow.PenColor = "Black"
  GraphicsWindow.BrushColor = Array.GetValue(template, "color")

  For i = 0 to BOXES - 1
    s = Shapes.AddRectangle(BWIDTH, BWIDTH)
    Shapes.Move(s, -BWIDTH, -BWIDTH) ' move off screen
    Array.SetValue(h, i, s)
  EndFor

  234,1: EndSub

199 CR_token2
  218,38: 


105 Comment CRStmtCRs_repeat1
  219,3: ' Create a new handle, representing an arrayName, that will represent the piece
  220,3: hcount = hcount + 1
  h = Text.Append("piece", hcount)

  Array.SetValue(h, -1, template) ' Array.GetValue(h, -1) = the template name

  GraphicsWindow.PenWidth = 1
  GraphicsWindow.PenColor = "Black"
  GraphicsWindow.BrushColor = Array.GetValue(template, "color")

  For i = 0 to BOXES - 1
    s = Shapes.AddRectangle(BWIDTH, BWIDTH)
    Shapes.Move(s, -BWIDTH, -BWIDTH) ' move off screen
    Array.SetValue(h, i, s)
  EndFor


160 ID = Expr
  220,3: hcount
  220,10: =
  220,12: hcount + 1

184 = Expr
  220,10: =
  220,12: hcount + 1

70 ID
  220,12: hcount

59 + MultiplicativeExpr
  220,19: +
  220,21: 1

144 NUM
  220,21: 1

43 CR_token2
  220,22: 


160 ID = Expr
  221,3: h
  221,5: =
  221,7: Text.Append("piece", hcount)

184 = Expr
  221,5: =
  221,7: Text.Append("piece", hcount)

70 ID . ID ( Exprs )
  221,7: Text
  221,11: .
  221,12: Append
  221,18: (
  221,19: "piece", hcount
  221,34: )

5 . ID ( Exprs )
  221,11: .
  221,12: Append
  221,18: (
  221,19: "piece", hcount
  221,34: )

260 ID ( Exprs )
  221,12: Append
  221,18: (
  221,19: "piece", hcount
  221,34: )

24 ( Exprs )
  221,18: (
  221,19: "piece", hcount
  221,34: )

26 STR
  221,19: "piece"

217 , MoreThanOneExpr
  221,26: ,
  221,28: hcount

54 ID
  221,28: hcount

249 )
  221,34: )

49 CR_token2
  221,35: 



160 ID . ID ( Exprs )
  223,3: Array
  223,8: .
  223,9: SetValue
  223,17: (
  223,18: h, -1, template
  223,33: )

184 . ID ( Exprs )
  223,8: .
  223,9: SetValue
  223,17: (
  223,18: h, -1, template
  223,33: )

255 ID ( Exprs )
  223,9: SetValue
  223,17: (
  223,18: h, -1, template
  223,33: )

221 ( Exprs )
  223,17: (
  223,18: h, -1, template
  223,33: )

27 ID
  223,18: h

217 , MoreThanOneExpr
  223,19: ,
  223,21: -1, template

54 - Primary
  223,21: -
  223,22: 1

197 NUM
  223,22: 1

217 , MoreThanOneExpr
  223,23: ,
  223,25: template

54 ID
  223,25: template

238 )
  223,33: )

206 Comment CR
  223,35: ' Array.GetValue(h, -1) = the template name
  223,78: 



210 CR_token2
  223,78: 



160 ID . ID = Expr
  225,3: GraphicsWindow
  225,17: .
  225,18: PenWidth
  225,27: =
  225,29: 1

184 . ID = Expr
  225,17: .
  225,18: PenWidth
  225,27: =
  225,29: 1

255 ID = Expr
  225,18: PenWidth
  225,27: =
  225,29: 1

221 = Expr
  225,27: =
  225,29: 1

57 NUM
  225,29: 1

43 CR_token2
  225,30: 


160 ID . ID = Expr
  226,3: GraphicsWindow
  226,17: .
  226,18: PenColor
  226,27: =
  226,29: "Black"

184 . ID = Expr
  226,17: .
  226,18: PenColor
  226,27: =
  226,29: "Black"

255 ID = Expr
  226,18: PenColor
  226,27: =
  226,29: "Black"

221 = Expr
  226,27: =
  226,29: "Black"

57 STR
  226,29: "Black"

43 CR_token2
  226,36: 


160 ID . ID = Expr
  227,3: GraphicsWindow
  227,17: .
  227,18: BrushColor
  227,29: =
  227,31: Array.GetValue(template, "color")

184 . ID = Expr
  227,17: .
  227,18: BrushColor
  227,29: =
  227,31: Array.GetValue(template, "color")

255 ID = Expr
  227,18: BrushColor
  227,29: =
  227,31: Array.GetValue(template, "color")

221 = Expr
  227,29: =
  227,31: Array.GetValue(template, "color")

57 ID . ID ( Exprs )
  227,31: Array
  227,36: .
  227,37: GetValue
  227,45: (
  227,46: template, "color"
  227,63: )

5 . ID ( Exprs )
  227,36: .
  227,37: GetValue
  227,45: (
  227,46: template, "color"
  227,63: )

260 ID ( Exprs )
  227,37: GetValue
  227,45: (
  227,46: template, "color"
  227,63: )

24 ( Exprs )
  227,45: (
  227,46: template, "color"
  227,63: )

26 ID
  227,46: template

217 , MoreThanOneExpr
  227,54: ,
  227,56: "color"

54 STR
  227,56: "color"

249 )
  227,63: )

49 CR_token2
  227,64: 



160 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  229,3: For
  229,7: i
  229,9: =
  229,11: 0
  229,13: to
  229,16: BOXES - 1
  229,25: 
    s = Shapes.AddRectangle(BWIDTH, BWIDTH)
    Shapes.Move(s, -BWIDTH, -BWIDTH) ' move off screen
    Array.SetValue(h, i, s)

  233,3: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  229,7: i
  229,9: =
  229,11: 0
  229,13: to
  229,16: BOXES - 1
  229,25: 
    s = Shapes.AddRectangle(BWIDTH, BWIDTH)
    Shapes.Move(s, -BWIDTH, -BWIDTH) ' move off screen
    Array.SetValue(h, i, s)

  233,3: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  229,9: =
  229,11: 0
  229,13: to
  229,16: BOXES - 1
  229,25: 
    s = Shapes.AddRectangle(BWIDTH, BWIDTH)
    Shapes.Move(s, -BWIDTH, -BWIDTH) ' move off screen
    Array.SetValue(h, i, s)

  233,3: EndFor

56 NUM
  229,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  229,13: to
  229,16: BOXES - 1
  229,25: 
    s = Shapes.AddRectangle(BWIDTH, BWIDTH)
    Shapes.Move(s, -BWIDTH, -BWIDTH) ' move off screen
    Array.SetValue(h, i, s)

  233,3: EndFor

83 ID
  229,16: BOXES

59 - MultiplicativeExpr
  229,22: -
  229,24: 1

144 NUM
  229,24: 1

43 CR_token2
  229,25: 


137 ID = Expr
  230,5: s
  230,7: =
  230,9: Shapes.AddRectangle(BWIDTH, BWIDTH)

184 = Expr
  230,7: =
  230,9: Shapes.AddRectangle(BWIDTH, BWIDTH)

70 ID . ID ( Exprs )
  230,9: Shapes
  230,15: .
  230,16: AddRectangle
  230,28: (
  230,29: BWIDTH, BWIDTH
  230,43: )

5 . ID ( Exprs )
  230,15: .
  230,16: AddRectangle
  230,28: (
  230,29: BWIDTH, BWIDTH
  230,43: )

260 ID ( Exprs )
  230,16: AddRectangle
  230,28: (
  230,29: BWIDTH, BWIDTH
  230,43: )

24 ( Exprs )
  230,28: (
  230,29: BWIDTH, BWIDTH
  230,43: )

26 ID
  230,29: BWIDTH

217 , MoreThanOneExpr
  230,35: ,
  230,37: BWIDTH

54 ID
  230,37: BWIDTH

249 )
  230,43: )

49 CR_token2
  230,44: 


137 ID . ID ( Exprs )
  231,5: Shapes
  231,11: .
  231,12: Move
  231,16: (
  231,17: s, -BWIDTH, -BWIDTH
  231,36: )

184 . ID ( Exprs )
  231,11: .
  231,12: Move
  231,16: (
  231,17: s, -BWIDTH, -BWIDTH
  231,36: )

255 ID ( Exprs )
  231,12: Move
  231,16: (
  231,17: s, -BWIDTH, -BWIDTH
  231,36: )

221 ( Exprs )
  231,16: (
  231,17: s, -BWIDTH, -BWIDTH
  231,36: )

27 ID
  231,17: s

217 , MoreThanOneExpr
  231,18: ,
  231,20: -BWIDTH, -BWIDTH

54 - Primary
  231,20: -
  231,21: BWIDTH

197 ID
  231,21: BWIDTH

217 , MoreThanOneExpr
  231,27: ,
  231,29: -BWIDTH

54 - Primary
  231,29: -
  231,30: BWIDTH

197 ID
  231,30: BWIDTH

238 )
  231,36: )

203 Comment CR
  231,38: ' move off screen
  231,55: 


210 CR_token2
  231,55: 


137 ID . ID ( Exprs )
  232,5: Array
  232,10: .
  232,11: SetValue
  232,19: (
  232,20: h, i, s
  232,27: )

184 . ID ( Exprs )
  232,10: .
  232,11: SetValue
  232,19: (
  232,20: h, i, s
  232,27: )

255 ID ( Exprs )
  232,11: SetValue
  232,19: (
  232,20: h, i, s
  232,27: )

221 ( Exprs )
  232,19: (
  232,20: h, i, s
  232,27: )

27 ID
  232,20: h

217 , MoreThanOneExpr
  232,21: ,
  232,23: i, s

54 ID
  232,23: i

217 , MoreThanOneExpr
  232,24: ,
  232,26: s

54 ID
  232,26: s

238 )
  232,27: )

210 CR_token2
  232,28: 


177 Stmt_token6
  233,3: EndFor

216 CR_token2
  233,9: 


257 Stmt_token8
  234,1: EndSub

146 Stmt_token7 ID Comment CRStmtCRs Stmt_token8
  236,1: Sub
  236,5: MovePiece
  236,15: 'in: ypos, xpos, h. ypos/xpos is 0-19, representing the top/left box coordinate of the piece on the canvas. h returned by CreatePiece
  236,148: 
  For i = 0 to BOXES - 1
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    ' Array.GetValue(h, i) = box for piece h.
    ' xpos/ypos = are topleft of shape. x/y is the box offset within the shape.
    Shapes.Move(Array.GetValue(h, i), XOFFSET + xpos * BWIDTH + x * BWIDTH, YOFFSET + ypos * BWIDTH + y * BWIDTH)
  EndFor

  246,1: EndSub

244 ID Comment CRStmtCRs Stmt_token8
  236,5: MovePiece
  236,15: 'in: ypos, xpos, h. ypos/xpos is 0-19, representing the top/left box coordinate of the piece on the canvas. h returned by CreatePiece
  236,148: 
  For i = 0 to BOXES - 1
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    ' Array.GetValue(h, i) = box for piece h.
    ' xpos/ypos = are topleft of shape. x/y is the box offset within the shape.
    Shapes.Move(Array.GetValue(h, i), XOFFSET + xpos * BWIDTH + x * BWIDTH, YOFFSET + ypos * BWIDTH + y * BWIDTH)
  EndFor

  246,1: EndSub

199 Comment CRStmtCRs Stmt_token8
  236,15: 'in: ypos, xpos, h. ypos/xpos is 0-19, representing the top/left box coordinate of the piece on the canvas. h returned by CreatePiece
  236,148: 
  For i = 0 to BOXES - 1
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    ' Array.GetValue(h, i) = box for piece h.
    ' xpos/ypos = are topleft of shape. x/y is the box offset within the shape.
    Shapes.Move(Array.GetValue(h, i), XOFFSET + xpos * BWIDTH + x * BWIDTH, YOFFSET + ypos * BWIDTH + y * BWIDTH)
  EndFor

  246,1: EndSub

199 CR_token2
  236,148: 


160 Stmt_token4 ID = Expr Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  237,3: For
  237,7: i
  237,9: =
  237,11: 0
  237,13: to
  237,16: BOXES - 1
  237,25: 
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    ' Array.GetValue(h, i) = box for piece h.
    ' xpos/ypos = are topleft of shape. x/y is the box offset within the shape.
    Shapes.Move(Array.GetValue(h, i), XOFFSET + xpos * BWIDTH + x * BWIDTH, YOFFSET + ypos * BWIDTH + y * BWIDTH)

  245,3: EndFor

267 ID = Expr Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  237,7: i
  237,9: =
  237,11: 0
  237,13: to
  237,16: BOXES - 1
  237,25: 
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    ' Array.GetValue(h, i) = box for piece h.
    ' xpos/ypos = are topleft of shape. x/y is the box offset within the shape.
    Shapes.Move(Array.GetValue(h, i), XOFFSET + xpos * BWIDTH + x * BWIDTH, YOFFSET + ypos * BWIDTH + y * BWIDTH)

  245,3: EndFor

266 = Expr Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  237,9: =
  237,11: 0
  237,13: to
  237,16: BOXES - 1
  237,25: 
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    ' Array.GetValue(h, i) = box for piece h.
    ' xpos/ypos = are topleft of shape. x/y is the box offset within the shape.
    Shapes.Move(Array.GetValue(h, i), XOFFSET + xpos * BWIDTH + x * BWIDTH, YOFFSET + ypos * BWIDTH + y * BWIDTH)

  245,3: EndFor

56 NUM
  237,11: 0

264 Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  237,13: to
  237,16: BOXES - 1
  237,25: 
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    ' Array.GetValue(h, i) = box for piece h.
    ' xpos/ypos = are topleft of shape. x/y is the box offset within the shape.
    Shapes.Move(Array.GetValue(h, i), XOFFSET + xpos * BWIDTH + x * BWIDTH, YOFFSET + ypos * BWIDTH + y * BWIDTH)

  245,3: EndFor

83 ID
  237,16: BOXES

59 - MultiplicativeExpr
  237,22: -
  237,24: 1

144 NUM
  237,24: 1

43 CR_token2
  237,25: 


137 ID = Expr
  238,5: v
  238,7: =
  238,9: Array.GetValue(Array.GetValue(h, -1), i)

184 = Expr
  238,7: =
  238,9: Array.GetValue(Array.GetValue(h, -1), i)

70 ID . ID ( Exprs )
  238,9: Array
  238,14: .
  238,15: GetValue
  238,23: (
  238,24: Array.GetValue(h, -1), i
  238,48: )

5 . ID ( Exprs )
  238,14: .
  238,15: GetValue
  238,23: (
  238,24: Array.GetValue(h, -1), i
  238,48: )

260 ID ( Exprs )
  238,15: GetValue
  238,23: (
  238,24: Array.GetValue(h, -1), i
  238,48: )

24 ( Exprs )
  238,23: (
  238,24: Array.GetValue(h, -1), i
  238,48: )

26 ID . ID ( Exprs )
  238,24: Array
  238,29: .
  238,30: GetValue
  238,38: (
  238,39: h, -1
  238,44: )

4 . ID ( Exprs )
  238,29: .
  238,30: GetValue
  238,38: (
  238,39: h, -1
  238,44: )

248 ID ( Exprs )
  238,30: GetValue
  238,38: (
  238,39: h, -1
  238,44: )

23 ( Exprs )
  238,38: (
  238,39: h, -1
  238,44: )

22 ID
  238,39: h

217 , MoreThanOneExpr
  238,40: ,
  238,42: -1

54 - Primary
  238,42: -
  238,43: 1

197 NUM
  238,43: 1

239 )
  238,44: )

217 , MoreThanOneExpr
  238,45: ,
  238,47: i

54 ID
  238,47: i

249 )
  238,48: )

203 Comment CR
  238,51: ' Array.GetValue(h, -1) = the template name
  238,94: 


49 CR_token2
  238,94: 


137 ID = Expr
  239,5: x
  239,7: =
  239,9: Math.Floor(v/10)

184 = Expr
  239,7: =
  239,9: Math.Floor(v/10)

70 ID . ID ( Exprs )
  239,9: Math
  239,13: .
  239,14: Floor
  239,19: (
  239,20: v/10
  239,24: )

5 . ID ( Exprs )
  239,13: .
  239,14: Floor
  239,19: (
  239,20: v/10
  239,24: )

260 ID ( Exprs )
  239,14: Floor
  239,19: (
  239,20: v/10
  239,24: )

24 ( Exprs )
  239,19: (
  239,20: v/10
  239,24: )

26 ID
  239,20: v

50 / UnaryExpr
  239,21: /
  239,22: 10

156 NUM
  239,22: 10

249 )
  239,24: )

49 CR_token2
  239,25: 


137 ID = Expr
  240,5: y
  240,7: =
  240,9: Math.Remainder(v, 10)

184 = Expr
  240,7: =
  240,9: Math.Remainder(v, 10)

70 ID . ID ( Exprs )
  240,9: Math
  240,13: .
  240,14: Remainder
  240,23: (
  240,24: v, 10
  240,29: )

5 . ID ( Exprs )
  240,13: .
  240,14: Remainder
  240,23: (
  240,24: v, 10
  240,29: )

260 ID ( Exprs )
  240,14: Remainder
  240,23: (
  240,24: v, 10
  240,29: )

24 ( Exprs )
  240,23: (
  240,24: v, 10
  240,29: )

26 ID
  240,24: v

217 , MoreThanOneExpr
  240,25: ,
  240,27: 10

54 NUM
  240,27: 10

249 )
  240,29: )

49 CR_token2
  240,30: 



177 Comment CRStmtCRs
  242,5: ' Array.GetValue(h, i) = box for piece h.
  242,46: 


137 CR_token2
  242,46: 


137 Comment CRStmtCRs
  243,5: ' xpos/ypos = are topleft of shape. x/y is the box offset within the shape.
  243,80: 
    Shapes.Move(Array.GetValue(h, i), XOFFSET + xpos * BWIDTH + x * BWIDTH, YOFFSET + ypos * BWIDTH + y * BWIDTH)


137 CR_token2
  243,80: 


137 ID . ID ( Exprs )
  244,5: Shapes
  244,11: .
  244,12: Move
  244,16: (
  244,17: Array.GetValue(h, i), XOFFSET + xpos * BWIDTH + x * BWIDTH, YOFFSET + ypos * BWIDTH + y * BWIDTH
  244,113: )

184 . ID ( Exprs )
  244,11: .
  244,12: Move
  244,16: (
  244,17: Array.GetValue(h, i), XOFFSET + xpos * BWIDTH + x * BWIDTH, YOFFSET + ypos * BWIDTH + y * BWIDTH
  244,113: )

255 ID ( Exprs )
  244,12: Move
  244,16: (
  244,17: Array.GetValue(h, i), XOFFSET + xpos * BWIDTH + x * BWIDTH, YOFFSET + ypos * BWIDTH + y * BWIDTH
  244,113: )

221 ( Exprs )
  244,16: (
  244,17: Array.GetValue(h, i), XOFFSET + xpos * BWIDTH + x * BWIDTH, YOFFSET + ypos * BWIDTH + y * BWIDTH
  244,113: )

27 ID . ID ( Exprs )
  244,17: Array
  244,22: .
  244,23: GetValue
  244,31: (
  244,32: h, i
  244,36: )

4 . ID ( Exprs )
  244,22: .
  244,23: GetValue
  244,31: (
  244,32: h, i
  244,36: )

248 ID ( Exprs )
  244,23: GetValue
  244,31: (
  244,32: h, i
  244,36: )

23 ( Exprs )
  244,31: (
  244,32: h, i
  244,36: )

22 ID
  244,32: h

217 , MoreThanOneExpr
  244,33: ,
  244,35: i

54 ID
  244,35: i

239 )
  244,36: )

217 , MoreThanOneExpr
  244,37: ,
  244,39: XOFFSET + xpos * BWIDTH + x * BWIDTH, YOFFSET + ypos * BWIDTH + y * BWIDTH

54 ID
  244,39: XOFFSET

65 + MultiplicativeExpr
  244,47: +
  244,49: xpos * BWIDTH

141 ID
  244,49: xpos

30 * UnaryExpr
  244,54: *
  244,56: BWIDTH

156 ID
  244,56: BWIDTH

65 + MultiplicativeExpr
  244,63: +
  244,65: x * BWIDTH

141 ID
  244,65: x

30 * UnaryExpr
  244,67: *
  244,69: BWIDTH

156 ID
  244,69: BWIDTH

217 , MoreThanOneExpr
  244,75: ,
  244,77: YOFFSET + ypos * BWIDTH + y * BWIDTH

54 ID
  244,77: YOFFSET

65 + MultiplicativeExpr
  244,85: +
  244,87: ypos * BWIDTH

141 ID
  244,87: ypos

30 * UnaryExpr
  244,92: *
  244,94: BWIDTH

156 ID
  244,94: BWIDTH

65 + MultiplicativeExpr
  244,101: +
  244,103: y * BWIDTH

141 ID
  244,103: y

30 * UnaryExpr
  244,105: *
  244,107: BWIDTH

156 ID
  244,107: BWIDTH

238 )
  244,113: )

210 CR_token2
  244,114: 


177 Stmt_token6
  245,3: EndFor

216 CR_token2
  245,9: 


257 Stmt_token8
  246,1: EndSub

146 Stmt_token7 ID Comment CRStmtCRs Stmt_token8
  248,1: Sub
  248,5: ValidateMove
  248,18: ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
  248,116: 
  i = 0
  invalidMove = 0
  While i < BOXES
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name

    'x/y is the box offset within the shape.
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    If (x + xpos + moveDirection) < 0 Then
      invalidMove = -1
      i = BOXES ' force getting out of the loop
    EndIf

    If (x + xpos + moveDirection) >= CWIDTH Then
      invalidMove = 1
      i = BOXES ' force getting out of the loop
    EndIf

    If Array.GetValue("c", (x + xpos + moveDirection) + (y + ypos) * CWIDTH) <> "." Then
      invalidMove = 2
      i = BOXES ' force getting out of the loop
    EndIf

    i = i + 1
  EndWhile

  275,1: EndSub

244 ID Comment CRStmtCRs Stmt_token8
  248,5: ValidateMove
  248,18: ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
  248,116: 
  i = 0
  invalidMove = 0
  While i < BOXES
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name

    'x/y is the box offset within the shape.
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    If (x + xpos + moveDirection) < 0 Then
      invalidMove = -1
      i = BOXES ' force getting out of the loop
    EndIf

    If (x + xpos + moveDirection) >= CWIDTH Then
      invalidMove = 1
      i = BOXES ' force getting out of the loop
    EndIf

    If Array.GetValue("c", (x + xpos + moveDirection) + (y + ypos) * CWIDTH) <> "." Then
      invalidMove = 2
      i = BOXES ' force getting out of the loop
    EndIf

    i = i + 1
  EndWhile

  275,1: EndSub

199 Comment CRStmtCRs Stmt_token8
  248,18: ' in: ypos, xpos, h, moveDirection ret: invalidMove = 1 or -1 or 2 if move is invalid, otherwise 0
  248,116: 
  i = 0
  invalidMove = 0
  While i < BOXES
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name

    'x/y is the box offset within the shape.
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    If (x + xpos + moveDirection) < 0 Then
      invalidMove = -1
      i = BOXES ' force getting out of the loop
    EndIf

    If (x + xpos + moveDirection) >= CWIDTH Then
      invalidMove = 1
      i = BOXES ' force getting out of the loop
    EndIf

    If Array.GetValue("c", (x + xpos + moveDirection) + (y + ypos) * CWIDTH) <> "." Then
      invalidMove = 2
      i = BOXES ' force getting out of the loop
    EndIf

    i = i + 1
  EndWhile

  275,1: EndSub

199 CR_token2
  248,116: 


160 ID = Expr
  249,3: i
  249,5: =
  249,7: 0

184 = Expr
  249,5: =
  249,7: 0

70 NUM
  249,7: 0

43 CR_token2
  249,8: 


160 ID = Expr
  250,3: invalidMove
  250,15: =
  250,17: 0

184 = Expr
  250,15: =
  250,17: 0

70 NUM
  250,17: 0

43 CR_token2
  250,18: 


160 Stmt_token1 Expr Stmt_repeat1 Stmt_token2
  251,3: While
  251,9: i < BOXES
  251,18: 
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name

    'x/y is the box offset within the shape.
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    If (x + xpos + moveDirection) < 0 Then
      invalidMove = -1
      i = BOXES ' force getting out of the loop
    EndIf

    If (x + xpos + moveDirection) >= CWIDTH Then
      invalidMove = 1
      i = BOXES ' force getting out of the loop
    EndIf

    If Array.GetValue("c", (x + xpos + moveDirection) + (y + ypos) * CWIDTH) <> "." Then
      invalidMove = 2
      i = BOXES ' force getting out of the loop
    EndIf

    i = i + 1

  274,3: EndWhile

79 ID
  251,9: i

90 < AdditiveExpr
  251,11: <
  251,13: BOXES

129 ID
  251,13: BOXES

5 CR_token2
  251,18: 


126 ID = Expr
  252,5: v
  252,7: =
  252,9: Array.GetValue(Array.GetValue(h, -1), i)

184 = Expr
  252,7: =
  252,9: Array.GetValue(Array.GetValue(h, -1), i)

70 ID . ID ( Exprs )
  252,9: Array
  252,14: .
  252,15: GetValue
  252,23: (
  252,24: Array.GetValue(h, -1), i
  252,48: )

5 . ID ( Exprs )
  252,14: .
  252,15: GetValue
  252,23: (
  252,24: Array.GetValue(h, -1), i
  252,48: )

260 ID ( Exprs )
  252,15: GetValue
  252,23: (
  252,24: Array.GetValue(h, -1), i
  252,48: )

24 ( Exprs )
  252,23: (
  252,24: Array.GetValue(h, -1), i
  252,48: )

26 ID . ID ( Exprs )
  252,24: Array
  252,29: .
  252,30: GetValue
  252,38: (
  252,39: h, -1
  252,44: )

4 . ID ( Exprs )
  252,29: .
  252,30: GetValue
  252,38: (
  252,39: h, -1
  252,44: )

248 ID ( Exprs )
  252,30: GetValue
  252,38: (
  252,39: h, -1
  252,44: )

23 ( Exprs )
  252,38: (
  252,39: h, -1
  252,44: )

22 ID
  252,39: h

217 , MoreThanOneExpr
  252,40: ,
  252,42: -1

54 - Primary
  252,42: -
  252,43: 1

197 NUM
  252,43: 1

239 )
  252,44: )

217 , MoreThanOneExpr
  252,45: ,
  252,47: i

54 ID
  252,47: i

249 )
  252,48: )

205 Comment CR
  252,51: ' Array.GetValue(h, -1) = the template name
  252,94: 



49 CR_token2
  252,94: 



187 Comment CRStmtCRs
  254,5: 'x/y is the box offset within the shape.
  254,45: 
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    If (x + xpos + moveDirection) < 0 Then
      invalidMove = -1
      i = BOXES ' force getting out of the loop
    EndIf

    If (x + xpos + moveDirection) >= CWIDTH Then
      invalidMove = 1
      i = BOXES ' force getting out of the loop
    EndIf

    If Array.GetValue("c", (x + xpos + moveDirection) + (y + ypos) * CWIDTH) <> "." Then
      invalidMove = 2
      i = BOXES ' force getting out of the loop
    EndIf

    i = i + 1


126 CR_token2
  254,45: 


126 ID = Expr
  255,5: x
  255,7: =
  255,9: Math.Floor(v/10)

184 = Expr
  255,7: =
  255,9: Math.Floor(v/10)

70 ID . ID ( Exprs )
  255,9: Math
  255,13: .
  255,14: Floor
  255,19: (
  255,20: v/10
  255,24: )

5 . ID ( Exprs )
  255,13: .
  255,14: Floor
  255,19: (
  255,20: v/10
  255,24: )

260 ID ( Exprs )
  255,14: Floor
  255,19: (
  255,20: v/10
  255,24: )

24 ( Exprs )
  255,19: (
  255,20: v/10
  255,24: )

26 ID
  255,20: v

50 / UnaryExpr
  255,21: /
  255,22: 10

156 NUM
  255,22: 10

249 )
  255,24: )

49 CR_token2
  255,25: 


126 ID = Expr
  256,5: y
  256,7: =
  256,9: Math.Remainder(v, 10)

184 = Expr
  256,7: =
  256,9: Math.Remainder(v, 10)

70 ID . ID ( Exprs )
  256,9: Math
  256,13: .
  256,14: Remainder
  256,23: (
  256,24: v, 10
  256,29: )

5 . ID ( Exprs )
  256,13: .
  256,14: Remainder
  256,23: (
  256,24: v, 10
  256,29: )

260 ID ( Exprs )
  256,14: Remainder
  256,23: (
  256,24: v, 10
  256,29: )

24 ( Exprs )
  256,23: (
  256,24: v, 10
  256,29: )

26 ID
  256,24: v

217 , MoreThanOneExpr
  256,25: ,
  256,27: 10

54 NUM
  256,27: 10

249 )
  256,29: )

49 CR_token2
  256,30: 



126 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  258,5: If
  258,8: (x + xpos + moveDirection) < 0
  258,39: Then
  258,43: 
      invalidMove = -1
      i = BOXES ' force getting out of the loop

  261,5: EndIf

86 ( Expr )
  258,8: (
  258,9: x + xpos + moveDirection
  258,33: )

80 ID
  258,9: x

65 + MultiplicativeExpr
  258,11: +
  258,13: xpos

141 ID
  258,13: xpos

65 + MultiplicativeExpr
  258,18: +
  258,20: moveDirection

141 ID
  258,20: moveDirection

265 )
  258,33: )

91 < AdditiveExpr
  258,35: <
  258,37: 0

131 NUM
  258,37: 0

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  258,39: Then
  258,43: 
      invalidMove = -1
      i = BOXES ' force getting out of the loop

  261,5: EndIf

124 CR_token2
  258,43: 


109 ID = Expr
  259,7: invalidMove
  259,19: =
  259,21: -1

184 = Expr
  259,19: =
  259,21: -1

70 - Primary
  259,21: -
  259,22: 1

193 NUM
  259,22: 1

43 CR_token2
  259,23: 


109 ID = Expr
  260,7: i
  260,9: =
  260,11: BOXES

184 = Expr
  260,9: =
  260,11: BOXES

70 ID
  260,11: BOXES

207 Comment CR
  260,17: ' force getting out of the loop
  260,48: 


5 CR_token2
  260,48: 


109 OptionalElse_token1
  261,5: EndIf

218 CR_token2
  261,10: 



126 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  263,5: If
  263,8: (x + xpos + moveDirection) >= CWIDTH
  263,45: Then
  263,49: 
      invalidMove = 1
      i = BOXES ' force getting out of the loop

  266,5: EndIf

86 ( Expr )
  263,8: (
  263,9: x + xpos + moveDirection
  263,33: )

80 ID
  263,9: x

65 + MultiplicativeExpr
  263,11: +
  263,13: xpos

141 ID
  263,13: xpos

65 + MultiplicativeExpr
  263,18: +
  263,20: moveDirection

141 ID
  263,20: moveDirection

265 )
  263,33: )

91 >= AdditiveExpr
  263,35: >=
  263,38: CWIDTH

131 ID
  263,38: CWIDTH

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  263,45: Then
  263,49: 
      invalidMove = 1
      i = BOXES ' force getting out of the loop

  266,5: EndIf

124 CR_token2
  263,49: 


109 ID = Expr
  264,7: invalidMove
  264,19: =
  264,21: 1

184 = Expr
  264,19: =
  264,21: 1

70 NUM
  264,21: 1

43 CR_token2
  264,22: 


109 ID = Expr
  265,7: i
  265,9: =
  265,11: BOXES

184 = Expr
  265,9: =
  265,11: BOXES

70 ID
  265,11: BOXES

207 Comment CR
  265,17: ' force getting out of the loop
  265,48: 


5 CR_token2
  265,48: 


109 OptionalElse_token1
  266,5: EndIf

218 CR_token2
  266,10: 



126 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  268,5: If
  268,8: Array.GetValue("c", (x + xpos + moveDirection) + (y + ypos) * CWIDTH) <> "."
  268,85: Then
  268,89: 
      invalidMove = 2
      i = BOXES ' force getting out of the loop

  271,5: EndIf

86 ID . ID ( Exprs )
  268,8: Array
  268,13: .
  268,14: GetValue
  268,22: (
  268,23: "c", (x + xpos + moveDirection) + (y + ypos) * CWIDTH
  268,76: )

4 . ID ( Exprs )
  268,13: .
  268,14: GetValue
  268,22: (
  268,23: "c", (x + xpos + moveDirection) + (y + ypos) * CWIDTH
  268,76: )

248 ID ( Exprs )
  268,14: GetValue
  268,22: (
  268,23: "c", (x + xpos + moveDirection) + (y + ypos) * CWIDTH
  268,76: )

23 ( Exprs )
  268,22: (
  268,23: "c", (x + xpos + moveDirection) + (y + ypos) * CWIDTH
  268,76: )

22 STR
  268,23: "c"

217 , MoreThanOneExpr
  268,26: ,
  268,28: (x + xpos + moveDirection) + (y + ypos) * CWIDTH

54 ( Expr )
  268,28: (
  268,29: x + xpos + moveDirection
  268,53: )

80 ID
  268,29: x

65 + MultiplicativeExpr
  268,31: +
  268,33: xpos

141 ID
  268,33: xpos

65 + MultiplicativeExpr
  268,38: +
  268,40: moveDirection

141 ID
  268,40: moveDirection

265 )
  268,53: )

65 + MultiplicativeExpr
  268,55: +
  268,57: (y + ypos) * CWIDTH

141 ( Expr )
  268,57: (
  268,58: y + ypos
  268,66: )

80 ID
  268,58: y

65 + MultiplicativeExpr
  268,60: +
  268,62: ypos

141 ID
  268,62: ypos

265 )
  268,66: )

30 * UnaryExpr
  268,68: *
  268,70: CWIDTH

156 ID
  268,70: CWIDTH

239 )
  268,76: )

128 <> CompExpr
  268,78: <>
  268,81: "."

117 STR
  268,81: "."

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  268,85: Then
  268,89: 
      invalidMove = 2
      i = BOXES ' force getting out of the loop

  271,5: EndIf

124 CR_token2
  268,89: 


109 ID = Expr
  269,7: invalidMove
  269,19: =
  269,21: 2

184 = Expr
  269,19: =
  269,21: 2

70 NUM
  269,21: 2

43 CR_token2
  269,22: 


109 ID = Expr
  270,7: i
  270,9: =
  270,11: BOXES

184 = Expr
  270,9: =
  270,11: BOXES

70 ID
  270,11: BOXES

207 Comment CR
  270,17: ' force getting out of the loop
  270,48: 


5 CR_token2
  270,48: 


109 OptionalElse_token1
  271,5: EndIf

218 CR_token2
  271,10: 



126 ID = Expr
  273,5: i
  273,7: =
  273,9: i + 1

184 = Expr
  273,7: =
  273,9: i + 1

70 ID
  273,9: i

59 + MultiplicativeExpr
  273,11: +
  273,13: 1

144 NUM
  273,13: 1

43 CR_token2
  273,14: 


187 Stmt_token2
  274,3: EndWhile

222 CR_token2
  274,11: 


257 Stmt_token8
  275,1: EndSub

146 Stmt_token7 ID Comment CRStmtCRs Stmt_token8
  278,1: Sub
  278,5: CheckStop
  278,15: ' in: ypos, xpos, h ret: done
  278,44: 
  done = 0
  i = 0
  While i < BOXES
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name

    'x/y is the box offset within the shape.
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    If y + ypos > CHEIGHT Or Array.GetValue("c", (x + xpos) + (y + ypos) * CWIDTH) <> "." Then
      done = 1
      i = BOXES ' force getting out of the loop
    EndIf

    i = i + 1
  EndWhile

  ' If we need to stop the piece, move the box handles to the canvas
  If done = 1 Then
    For i = 0 to BOXES - 1
      v = Array.GetValue(Array.GetValue(h, -1), i) ' Array.GetValue(h, -1) = the template name
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10) 
      Array.SetValue("c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i))
    EndFor

    ' 1 points for every piece successfully dropped
    score = score + 1
    PrintScore()

    ' Delete clared lines
    DeleteLines()
  EndIf

  312,1: EndSub

244 ID Comment CRStmtCRs Stmt_token8
  278,5: CheckStop
  278,15: ' in: ypos, xpos, h ret: done
  278,44: 
  done = 0
  i = 0
  While i < BOXES
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name

    'x/y is the box offset within the shape.
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    If y + ypos > CHEIGHT Or Array.GetValue("c", (x + xpos) + (y + ypos) * CWIDTH) <> "." Then
      done = 1
      i = BOXES ' force getting out of the loop
    EndIf

    i = i + 1
  EndWhile

  ' If we need to stop the piece, move the box handles to the canvas
  If done = 1 Then
    For i = 0 to BOXES - 1
      v = Array.GetValue(Array.GetValue(h, -1), i) ' Array.GetValue(h, -1) = the template name
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10) 
      Array.SetValue("c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i))
    EndFor

    ' 1 points for every piece successfully dropped
    score = score + 1
    PrintScore()

    ' Delete clared lines
    DeleteLines()
  EndIf

  312,1: EndSub

199 Comment CRStmtCRs Stmt_token8
  278,15: ' in: ypos, xpos, h ret: done
  278,44: 
  done = 0
  i = 0
  While i < BOXES
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name

    'x/y is the box offset within the shape.
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    If y + ypos > CHEIGHT Or Array.GetValue("c", (x + xpos) + (y + ypos) * CWIDTH) <> "." Then
      done = 1
      i = BOXES ' force getting out of the loop
    EndIf

    i = i + 1
  EndWhile

  ' If we need to stop the piece, move the box handles to the canvas
  If done = 1 Then
    For i = 0 to BOXES - 1
      v = Array.GetValue(Array.GetValue(h, -1), i) ' Array.GetValue(h, -1) = the template name
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10) 
      Array.SetValue("c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i))
    EndFor

    ' 1 points for every piece successfully dropped
    score = score + 1
    PrintScore()

    ' Delete clared lines
    DeleteLines()
  EndIf

  312,1: EndSub

199 CR_token2
  278,44: 


160 ID = Expr
  279,3: done
  279,8: =
  279,10: 0

184 = Expr
  279,8: =
  279,10: 0

70 NUM
  279,10: 0

43 CR_token2
  279,11: 


160 ID = Expr
  280,3: i
  280,5: =
  280,7: 0

184 = Expr
  280,5: =
  280,7: 0

70 NUM
  280,7: 0

43 CR_token2
  280,8: 


160 Stmt_token1 Expr Stmt_repeat1 Stmt_token2
  281,3: While
  281,9: i < BOXES
  281,18: 
    v = Array.GetValue(Array.GetValue(h, -1), i)  ' Array.GetValue(h, -1) = the template name

    'x/y is the box offset within the shape.
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    If y + ypos > CHEIGHT Or Array.GetValue("c", (x + xpos) + (y + ypos) * CWIDTH) <> "." Then
      done = 1
      i = BOXES ' force getting out of the loop
    EndIf

    i = i + 1

  294,3: EndWhile

79 ID
  281,9: i

90 < AdditiveExpr
  281,11: <
  281,13: BOXES

129 ID
  281,13: BOXES

5 CR_token2
  281,18: 


126 ID = Expr
  282,5: v
  282,7: =
  282,9: Array.GetValue(Array.GetValue(h, -1), i)

184 = Expr
  282,7: =
  282,9: Array.GetValue(Array.GetValue(h, -1), i)

70 ID . ID ( Exprs )
  282,9: Array
  282,14: .
  282,15: GetValue
  282,23: (
  282,24: Array.GetValue(h, -1), i
  282,48: )

5 . ID ( Exprs )
  282,14: .
  282,15: GetValue
  282,23: (
  282,24: Array.GetValue(h, -1), i
  282,48: )

260 ID ( Exprs )
  282,15: GetValue
  282,23: (
  282,24: Array.GetValue(h, -1), i
  282,48: )

24 ( Exprs )
  282,23: (
  282,24: Array.GetValue(h, -1), i
  282,48: )

26 ID . ID ( Exprs )
  282,24: Array
  282,29: .
  282,30: GetValue
  282,38: (
  282,39: h, -1
  282,44: )

4 . ID ( Exprs )
  282,29: .
  282,30: GetValue
  282,38: (
  282,39: h, -1
  282,44: )

248 ID ( Exprs )
  282,30: GetValue
  282,38: (
  282,39: h, -1
  282,44: )

23 ( Exprs )
  282,38: (
  282,39: h, -1
  282,44: )

22 ID
  282,39: h

217 , MoreThanOneExpr
  282,40: ,
  282,42: -1

54 - Primary
  282,42: -
  282,43: 1

197 NUM
  282,43: 1

239 )
  282,44: )

217 , MoreThanOneExpr
  282,45: ,
  282,47: i

54 ID
  282,47: i

249 )
  282,48: )

205 Comment CR
  282,51: ' Array.GetValue(h, -1) = the template name
  282,94: 



49 CR_token2
  282,94: 



187 Comment CRStmtCRs
  284,5: 'x/y is the box offset within the shape.
  284,45: 
    x = Math.Floor(v/10)
    y = Math.Remainder(v, 10)

    If y + ypos > CHEIGHT Or Array.GetValue("c", (x + xpos) + (y + ypos) * CWIDTH) <> "." Then
      done = 1
      i = BOXES ' force getting out of the loop
    EndIf

    i = i + 1


126 CR_token2
  284,45: 


126 ID = Expr
  285,5: x
  285,7: =
  285,9: Math.Floor(v/10)

184 = Expr
  285,7: =
  285,9: Math.Floor(v/10)

70 ID . ID ( Exprs )
  285,9: Math
  285,13: .
  285,14: Floor
  285,19: (
  285,20: v/10
  285,24: )

5 . ID ( Exprs )
  285,13: .
  285,14: Floor
  285,19: (
  285,20: v/10
  285,24: )

260 ID ( Exprs )
  285,14: Floor
  285,19: (
  285,20: v/10
  285,24: )

24 ( Exprs )
  285,19: (
  285,20: v/10
  285,24: )

26 ID
  285,20: v

50 / UnaryExpr
  285,21: /
  285,22: 10

156 NUM
  285,22: 10

249 )
  285,24: )

49 CR_token2
  285,25: 


126 ID = Expr
  286,5: y
  286,7: =
  286,9: Math.Remainder(v, 10)

184 = Expr
  286,7: =
  286,9: Math.Remainder(v, 10)

70 ID . ID ( Exprs )
  286,9: Math
  286,13: .
  286,14: Remainder
  286,23: (
  286,24: v, 10
  286,29: )

5 . ID ( Exprs )
  286,13: .
  286,14: Remainder
  286,23: (
  286,24: v, 10
  286,29: )

260 ID ( Exprs )
  286,14: Remainder
  286,23: (
  286,24: v, 10
  286,29: )

24 ( Exprs )
  286,23: (
  286,24: v, 10
  286,29: )

26 ID
  286,24: v

217 , MoreThanOneExpr
  286,25: ,
  286,27: 10

54 NUM
  286,27: 10

249 )
  286,29: )

49 CR_token2
  286,30: 



126 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  288,5: If
  288,8: y + ypos > CHEIGHT Or Array.GetValue("c", (x + xpos) + (y + ypos) * CWIDTH) <> "."
  288,91: Then
  288,95: 
      done = 1
      i = BOXES ' force getting out of the loop

  291,5: EndIf

86 ID
  288,8: y

65 + MultiplicativeExpr
  288,10: +
  288,12: ypos

141 ID
  288,12: ypos

91 > AdditiveExpr
  288,17: >
  288,19: CHEIGHT

131 ID
  288,19: CHEIGHT

183 OrExpr_token1 AndExpr
  288,27: Or
  288,30: Array.GetValue("c", (x + xpos) + (y + ypos) * CWIDTH) <> "."

100 ID . ID ( Exprs )
  288,30: Array
  288,35: .
  288,36: GetValue
  288,44: (
  288,45: "c", (x + xpos) + (y + ypos) * CWIDTH
  288,82: )

4 . ID ( Exprs )
  288,35: .
  288,36: GetValue
  288,44: (
  288,45: "c", (x + xpos) + (y + ypos) * CWIDTH
  288,82: )

248 ID ( Exprs )
  288,36: GetValue
  288,44: (
  288,45: "c", (x + xpos) + (y + ypos) * CWIDTH
  288,82: )

23 ( Exprs )
  288,44: (
  288,45: "c", (x + xpos) + (y + ypos) * CWIDTH
  288,82: )

22 STR
  288,45: "c"

217 , MoreThanOneExpr
  288,48: ,
  288,50: (x + xpos) + (y + ypos) * CWIDTH

54 ( Expr )
  288,50: (
  288,51: x + xpos
  288,59: )

80 ID
  288,51: x

65 + MultiplicativeExpr
  288,53: +
  288,55: xpos

141 ID
  288,55: xpos

265 )
  288,59: )

65 + MultiplicativeExpr
  288,61: +
  288,63: (y + ypos) * CWIDTH

141 ( Expr )
  288,63: (
  288,64: y + ypos
  288,72: )

80 ID
  288,64: y

65 + MultiplicativeExpr
  288,66: +
  288,68: ypos

141 ID
  288,68: ypos

265 )
  288,72: )

30 * UnaryExpr
  288,74: *
  288,76: CWIDTH

156 ID
  288,76: CWIDTH

239 )
  288,82: )

128 <> CompExpr
  288,84: <>
  288,87: "."

117 STR
  288,87: "."

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  288,91: Then
  288,95: 
      done = 1
      i = BOXES ' force getting out of the loop

  291,5: EndIf

124 CR_token2
  288,95: 


109 ID = Expr
  289,7: done
  289,12: =
  289,14: 1

184 = Expr
  289,12: =
  289,14: 1

70 NUM
  289,14: 1

43 CR_token2
  289,15: 


109 ID = Expr
  290,7: i
  290,9: =
  290,11: BOXES

184 = Expr
  290,9: =
  290,11: BOXES

70 ID
  290,11: BOXES

207 Comment CR
  290,17: ' force getting out of the loop
  290,48: 


5 CR_token2
  290,48: 


109 OptionalElse_token1
  291,5: EndIf

218 CR_token2
  291,10: 



126 ID = Expr
  293,5: i
  293,7: =
  293,9: i + 1

184 = Expr
  293,7: =
  293,9: i + 1

70 ID
  293,9: i

59 + MultiplicativeExpr
  293,11: +
  293,13: 1

144 NUM
  293,13: 1

43 CR_token2
  293,14: 


187 Stmt_token2
  294,3: EndWhile

222 CR_token2
  294,11: 



160 Comment TheRest
  296,3: ' If we need to stop the piece, move the box handles to the canvas
  297,3: If done = 1 Then
    For i = 0 to BOXES - 1
      v = Array.GetValue(Array.GetValue(h, -1), i) ' Array.GetValue(h, -1) = the template name
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10) 
      Array.SetValue("c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i))
    EndFor

    ' 1 points for every piece successfully dropped
    score = score + 1
    PrintScore()

    ' Delete clared lines
    DeleteLines()
  EndIf


160 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  297,3: If
  297,6: done = 1
  297,15: Then
  297,19: 
    For i = 0 to BOXES - 1
      v = Array.GetValue(Array.GetValue(h, -1), i) ' Array.GetValue(h, -1) = the template name
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10) 
      Array.SetValue("c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i))
    EndFor

    ' 1 points for every piece successfully dropped
    score = score + 1
    PrintScore()

    ' Delete clared lines
    DeleteLines()

  311,3: EndIf

86 ID
  297,6: done

128 = CompExpr
  297,11: =
  297,13: 1

117 NUM
  297,13: 1

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  297,15: Then
  297,19: 
    For i = 0 to BOXES - 1
      v = Array.GetValue(Array.GetValue(h, -1), i) ' Array.GetValue(h, -1) = the template name
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10) 
      Array.SetValue("c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i))
    EndFor

    ' 1 points for every piece successfully dropped
    score = score + 1
    PrintScore()

    ' Delete clared lines
    DeleteLines()

  311,3: EndIf

124 CR_token2
  297,19: 


109 Stmt_token4 ID = Expr Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  298,5: For
  298,9: i
  298,11: =
  298,13: 0
  298,15: to
  298,18: BOXES - 1
  298,27: 
      v = Array.GetValue(Array.GetValue(h, -1), i) ' Array.GetValue(h, -1) = the template name
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10) 
      Array.SetValue("c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i))

  303,5: EndFor

267 ID = Expr Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  298,9: i
  298,11: =
  298,13: 0
  298,15: to
  298,18: BOXES - 1
  298,27: 
      v = Array.GetValue(Array.GetValue(h, -1), i) ' Array.GetValue(h, -1) = the template name
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10) 
      Array.SetValue("c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i))

  303,5: EndFor

266 = Expr Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  298,11: =
  298,13: 0
  298,15: to
  298,18: BOXES - 1
  298,27: 
      v = Array.GetValue(Array.GetValue(h, -1), i) ' Array.GetValue(h, -1) = the template name
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10) 
      Array.SetValue("c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i))

  303,5: EndFor

56 NUM
  298,13: 0

264 Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  298,15: to
  298,18: BOXES - 1
  298,27: 
      v = Array.GetValue(Array.GetValue(h, -1), i) ' Array.GetValue(h, -1) = the template name
      'x = Math.Floor(v/10)
      'y = Math.Remainder(v, 10) 
      Array.SetValue("c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i))

  303,5: EndFor

83 ID
  298,18: BOXES

59 - MultiplicativeExpr
  298,24: -
  298,26: 1

144 NUM
  298,26: 1

43 CR_token2
  298,27: 


137 ID = Expr
  299,7: v
  299,9: =
  299,11: Array.GetValue(Array.GetValue(h, -1), i)

184 = Expr
  299,9: =
  299,11: Array.GetValue(Array.GetValue(h, -1), i)

70 ID . ID ( Exprs )
  299,11: Array
  299,16: .
  299,17: GetValue
  299,25: (
  299,26: Array.GetValue(h, -1), i
  299,50: )

5 . ID ( Exprs )
  299,16: .
  299,17: GetValue
  299,25: (
  299,26: Array.GetValue(h, -1), i
  299,50: )

260 ID ( Exprs )
  299,17: GetValue
  299,25: (
  299,26: Array.GetValue(h, -1), i
  299,50: )

24 ( Exprs )
  299,25: (
  299,26: Array.GetValue(h, -1), i
  299,50: )

26 ID . ID ( Exprs )
  299,26: Array
  299,31: .
  299,32: GetValue
  299,40: (
  299,41: h, -1
  299,46: )

4 . ID ( Exprs )
  299,31: .
  299,32: GetValue
  299,40: (
  299,41: h, -1
  299,46: )

248 ID ( Exprs )
  299,32: GetValue
  299,40: (
  299,41: h, -1
  299,46: )

23 ( Exprs )
  299,40: (
  299,41: h, -1
  299,46: )

22 ID
  299,41: h

217 , MoreThanOneExpr
  299,42: ,
  299,44: -1

54 - Primary
  299,44: -
  299,45: 1

197 NUM
  299,45: 1

239 )
  299,46: )

217 , MoreThanOneExpr
  299,47: ,
  299,49: i

54 ID
  299,49: i

249 )
  299,50: )

203 Comment CR
  299,52: ' Array.GetValue(h, -1) = the template name
  299,95: 


49 CR_token2
  299,95: 


177 Comment CRStmtCRs
  300,7: 'x = Math.Floor(v/10)
  300,28: 


137 CR_token2
  300,28: 


137 Comment CRStmtCRs
  301,7: 'y = Math.Remainder(v, 10) 
  301,34: 
      Array.SetValue("c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i))


137 CR_token2
  301,34: 


137 ID . ID ( Exprs )
  302,7: Array
  302,12: .
  302,13: SetValue
  302,21: (
  302,22: "c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i)
  302,120: )

184 . ID ( Exprs )
  302,12: .
  302,13: SetValue
  302,21: (
  302,22: "c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i)
  302,120: )

255 ID ( Exprs )
  302,13: SetValue
  302,21: (
  302,22: "c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i)
  302,120: )

221 ( Exprs )
  302,21: (
  302,22: "c", (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i)
  302,120: )

27 STR
  302,22: "c"

217 , MoreThanOneExpr
  302,25: ,
  302,27: (Math.Floor(v/10) + xpos) + (Math.Remainder(v, 10) + ypos - 1) * CWIDTH, Array.GetValue(h, i)

54 ( Expr )
  302,27: (
  302,28: Math.Floor(v/10) + xpos
  302,51: )

80 ID . ID ( Exprs )
  302,28: Math
  302,32: .
  302,33: Floor
  302,38: (
  302,39: v/10
  302,43: )

4 . ID ( Exprs )
  302,32: .
  302,33: Floor
  302,38: (
  302,39: v/10
  302,43: )

248 ID ( Exprs )
  302,33: Floor
  302,38: (
  302,39: v/10
  302,43: )

23 ( Exprs )
  302,38: (
  302,39: v/10
  302,43: )

22 ID
  302,39: v

50 / UnaryExpr
  302,40: /
  302,41: 10

156 NUM
  302,41: 10

239 )
  302,43: )

65 + MultiplicativeExpr
  302,45: +
  302,47: xpos

141 ID
  302,47: xpos

265 )
  302,51: )

65 + MultiplicativeExpr
  302,53: +
  302,55: (Math.Remainder(v, 10) + ypos - 1) * CWIDTH

141 ( Expr )
  302,55: (
  302,56: Math.Remainder(v, 10) + ypos - 1
  302,88: )

80 ID . ID ( Exprs )
  302,56: Math
  302,60: .
  302,61: Remainder
  302,70: (
  302,71: v, 10
  302,76: )

4 . ID ( Exprs )
  302,60: .
  302,61: Remainder
  302,70: (
  302,71: v, 10
  302,76: )

248 ID ( Exprs )
  302,61: Remainder
  302,70: (
  302,71: v, 10
  302,76: )

23 ( Exprs )
  302,70: (
  302,71: v, 10
  302,76: )

22 ID
  302,71: v

217 , MoreThanOneExpr
  302,72: ,
  302,74: 10

54 NUM
  302,74: 10

239 )
  302,76: )

65 + MultiplicativeExpr
  302,78: +
  302,80: ypos

141 ID
  302,80: ypos

65 - MultiplicativeExpr
  302,85: -
  302,87: 1

141 NUM
  302,87: 1

265 )
  302,88: )

30 * UnaryExpr
  302,90: *
  302,92: CWIDTH

156 ID
  302,92: CWIDTH

217 , MoreThanOneExpr
  302,98: ,
  302,100: Array.GetValue(h, i)

54 ID . ID ( Exprs )
  302,100: Array
  302,105: .
  302,106: GetValue
  302,114: (
  302,115: h, i
  302,119: )

4 . ID ( Exprs )
  302,105: .
  302,106: GetValue
  302,114: (
  302,115: h, i
  302,119: )

248 ID ( Exprs )
  302,106: GetValue
  302,114: (
  302,115: h, i
  302,119: )

23 ( Exprs )
  302,114: (
  302,115: h, i
  302,119: )

22 ID
  302,115: h

217 , MoreThanOneExpr
  302,116: ,
  302,118: i

54 ID
  302,118: i

239 )
  302,119: )

238 )
  302,120: )

210 CR_token2
  302,121: 


177 Stmt_token6
  303,5: EndFor

216 CR_token2
  303,11: 



122 Comment CRStmtCRs
  305,5: ' 1 points for every piece successfully dropped
  305,52: 
    score = score + 1
    PrintScore()



109 CR_token2
  305,52: 


109 ID = Expr
  306,5: score
  306,11: =
  306,13: score + 1

184 = Expr
  306,11: =
  306,13: score + 1

70 ID
  306,13: score

59 + MultiplicativeExpr
  306,19: +
  306,21: 1

144 NUM
  306,21: 1

43 CR_token2
  306,22: 


109 ID ( )
  307,5: PrintScore
  307,15: (
  307,16: )

184 ( )
  307,15: (
  307,16: )

261 )
  307,16: )

215 CR_token2
  307,17: 



109 Comment CRStmtCRs
  309,5: ' Delete clared lines
  309,26: 
    DeleteLines()


109 CR_token2
  309,26: 


109 ID ( )
  310,5: DeleteLines
  310,16: (
  310,17: )

184 ( )
  310,16: (
  310,17: )

261 )
  310,17: )

215 CR_token2
  310,18: 


109 OptionalElse_token1
  311,3: EndIf

218 CR_token2
  311,8: 


257 Stmt_token8
  312,1: EndSub

146 Stmt_token7 ID CRStmtCRs Stmt_token8
  315,1: Sub
  315,5: DeleteLines
  315,16: 
  linesCleared = 0

  ' Iterate over each row, starting from the bottom
  For y = CHEIGHT - 1 to 0 Step -1

    ' Check to see if the whole row is filled
    x = CWIDTH
    While x = CWIDTH
      x = 0
      While x < CWIDTH
        piece = Array.GetValue("c", x + y * CWIDTH)
        If piece = "." then
          x = CWIDTH
        EndIf
        x = x + 1
      EndWhile

      ' if non of them were empty (i.e "."), then remove the line.
      If x = CWIDTH Then

        ' Delete the line
        For x1 = 0 to CWIDTH - 1
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))
        EndFor
        linesCleared = linesCleared + 1

        ' Move everything else down one.
        For y1 = y To 1 Step -1
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor
        EndFor
      EndIf
    EndWhile
  EndFor

  If linesCleared > 0 Then
    score = score + 100 * Math.Round(linesCleared * 2.15 - 1)
    PrintScore()
  EndIf

  358,1: EndSub

244 ID CRStmtCRs Stmt_token8
  315,5: DeleteLines
  315,16: 
  linesCleared = 0

  ' Iterate over each row, starting from the bottom
  For y = CHEIGHT - 1 to 0 Step -1

    ' Check to see if the whole row is filled
    x = CWIDTH
    While x = CWIDTH
      x = 0
      While x < CWIDTH
        piece = Array.GetValue("c", x + y * CWIDTH)
        If piece = "." then
          x = CWIDTH
        EndIf
        x = x + 1
      EndWhile

      ' if non of them were empty (i.e "."), then remove the line.
      If x = CWIDTH Then

        ' Delete the line
        For x1 = 0 to CWIDTH - 1
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))
        EndFor
        linesCleared = linesCleared + 1

        ' Move everything else down one.
        For y1 = y To 1 Step -1
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor
        EndFor
      EndIf
    EndWhile
  EndFor

  If linesCleared > 0 Then
    score = score + 100 * Math.Round(linesCleared * 2.15 - 1)
    PrintScore()
  EndIf

  358,1: EndSub

199 CR_token2
  315,16: 


160 ID = Expr
  316,3: linesCleared
  316,16: =
  316,18: 0

184 = Expr
  316,16: =
  316,18: 0

70 NUM
  316,18: 0

43 CR_token2
  316,19: 



106 Comment TheRest
  318,3: ' Iterate over each row, starting from the bottom
  319,3: For y = CHEIGHT - 1 to 0 Step -1

    ' Check to see if the whole row is filled
    x = CWIDTH
    While x = CWIDTH
      x = 0
      While x < CWIDTH
        piece = Array.GetValue("c", x + y * CWIDTH)
        If piece = "." then
          x = CWIDTH
        EndIf
        x = x + 1
      EndWhile

      ' if non of them were empty (i.e "."), then remove the line.
      If x = CWIDTH Then

        ' Delete the line
        For x1 = 0 to CWIDTH - 1
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))
        EndFor
        linesCleared = linesCleared + 1

        ' Move everything else down one.
        For y1 = y To 1 Step -1
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor
        EndFor
      EndIf
    EndWhile
  EndFor



160 Stmt_token4 ID = Expr Stmt_token5 Expr OptStep Stmt_repeat1 Stmt_token6
  319,3: For
  319,7: y
  319,9: =
  319,11: CHEIGHT - 1
  319,23: to
  319,26: 0
  319,28: Step -1
  319,35: 

    ' Check to see if the whole row is filled
    x = CWIDTH
    While x = CWIDTH
      x = 0
      While x < CWIDTH
        piece = Array.GetValue("c", x + y * CWIDTH)
        If piece = "." then
          x = CWIDTH
        EndIf
        x = x + 1
      EndWhile

      ' if non of them were empty (i.e "."), then remove the line.
      If x = CWIDTH Then

        ' Delete the line
        For x1 = 0 to CWIDTH - 1
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))
        EndFor
        linesCleared = linesCleared + 1

        ' Move everything else down one.
        For y1 = y To 1 Step -1
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor
        EndFor
      EndIf
    EndWhile

  352,3: EndFor

267 ID = Expr Stmt_token5 Expr OptStep Stmt_repeat1 Stmt_token6
  319,7: y
  319,9: =
  319,11: CHEIGHT - 1
  319,23: to
  319,26: 0
  319,28: Step -1
  319,35: 

    ' Check to see if the whole row is filled
    x = CWIDTH
    While x = CWIDTH
      x = 0
      While x < CWIDTH
        piece = Array.GetValue("c", x + y * CWIDTH)
        If piece = "." then
          x = CWIDTH
        EndIf
        x = x + 1
      EndWhile

      ' if non of them were empty (i.e "."), then remove the line.
      If x = CWIDTH Then

        ' Delete the line
        For x1 = 0 to CWIDTH - 1
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))
        EndFor
        linesCleared = linesCleared + 1

        ' Move everything else down one.
        For y1 = y To 1 Step -1
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor
        EndFor
      EndIf
    EndWhile

  352,3: EndFor

266 = Expr Stmt_token5 Expr OptStep Stmt_repeat1 Stmt_token6
  319,9: =
  319,11: CHEIGHT - 1
  319,23: to
  319,26: 0
  319,28: Step -1
  319,35: 

    ' Check to see if the whole row is filled
    x = CWIDTH
    While x = CWIDTH
      x = 0
      While x < CWIDTH
        piece = Array.GetValue("c", x + y * CWIDTH)
        If piece = "." then
          x = CWIDTH
        EndIf
        x = x + 1
      EndWhile

      ' if non of them were empty (i.e "."), then remove the line.
      If x = CWIDTH Then

        ' Delete the line
        For x1 = 0 to CWIDTH - 1
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))
        EndFor
        linesCleared = linesCleared + 1

        ' Move everything else down one.
        For y1 = y To 1 Step -1
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor
        EndFor
      EndIf
    EndWhile

  352,3: EndFor

56 ID
  319,11: CHEIGHT

65 - MultiplicativeExpr
  319,19: -
  319,21: 1

141 NUM
  319,21: 1

264 Stmt_token5 Expr OptStep Stmt_repeat1 Stmt_token6
  319,23: to
  319,26: 0
  319,28: Step -1
  319,35: 

    ' Check to see if the whole row is filled
    x = CWIDTH
    While x = CWIDTH
      x = 0
      While x < CWIDTH
        piece = Array.GetValue("c", x + y * CWIDTH)
        If piece = "." then
          x = CWIDTH
        EndIf
        x = x + 1
      EndWhile

      ' if non of them were empty (i.e "."), then remove the line.
      If x = CWIDTH Then

        ' Delete the line
        For x1 = 0 to CWIDTH - 1
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))
        EndFor
        linesCleared = linesCleared + 1

        ' Move everything else down one.
        For y1 = y To 1 Step -1
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor
        EndFor
      EndIf
    EndWhile

  352,3: EndFor

83 NUM
  319,26: 0

43 OptStep_token1 Expr
  319,28: Step
  319,33: -1

62 - Primary
  319,33: -
  319,34: 1

193 NUM
  319,34: 1

43 CR_token2
  319,35: 



190 Comment CRStmtCRs
  321,5: ' Check to see if the whole row is filled
  321,46: 
    x = CWIDTH
    While x = CWIDTH
      x = 0
      While x < CWIDTH
        piece = Array.GetValue("c", x + y * CWIDTH)
        If piece = "." then
          x = CWIDTH
        EndIf
        x = x + 1
      EndWhile

      ' if non of them were empty (i.e "."), then remove the line.
      If x = CWIDTH Then

        ' Delete the line
        For x1 = 0 to CWIDTH - 1
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))
        EndFor
        linesCleared = linesCleared + 1

        ' Move everything else down one.
        For y1 = y To 1 Step -1
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor
        EndFor
      EndIf
    EndWhile


137 CR_token2
  321,46: 


137 ID = Expr
  322,5: x
  322,7: =
  322,9: CWIDTH

184 = Expr
  322,7: =
  322,9: CWIDTH

70 ID
  322,9: CWIDTH

5 CR_token2
  322,15: 


137 Stmt_token1 Expr Stmt_repeat1 Stmt_token2
  323,5: While
  323,11: x = CWIDTH
  323,21: 
      x = 0
      While x < CWIDTH
        piece = Array.GetValue("c", x + y * CWIDTH)
        If piece = "." then
          x = CWIDTH
        EndIf
        x = x + 1
      EndWhile

      ' if non of them were empty (i.e "."), then remove the line.
      If x = CWIDTH Then

        ' Delete the line
        For x1 = 0 to CWIDTH - 1
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))
        EndFor
        linesCleared = linesCleared + 1

        ' Move everything else down one.
        For y1 = y To 1 Step -1
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor
        EndFor
      EndIf

  351,5: EndWhile

79 ID
  323,11: x

135 = CompExpr
  323,13: =
  323,15: CWIDTH

123 ID
  323,15: CWIDTH

5 CR_token2
  323,21: 


126 ID = Expr
  324,7: x
  324,9: =
  324,11: 0

184 = Expr
  324,9: =
  324,11: 0

70 NUM
  324,11: 0

43 CR_token2
  324,12: 


126 Stmt_token1 Expr CRStmtCRs Stmt_token2
  325,7: While
  325,13: x < CWIDTH
  325,23: 
        piece = Array.GetValue("c", x + y * CWIDTH)
        If piece = "." then
          x = CWIDTH
        EndIf
        x = x + 1

  331,7: EndWhile

79 ID
  325,13: x

90 < AdditiveExpr
  325,15: <
  325,17: CWIDTH

129 ID
  325,17: CWIDTH

5 CR_token2
  325,23: 


126 ID = Expr
  326,9: piece
  326,15: =
  326,17: Array.GetValue("c", x + y * CWIDTH)

184 = Expr
  326,15: =
  326,17: Array.GetValue("c", x + y * CWIDTH)

70 ID . ID ( Exprs )
  326,17: Array
  326,22: .
  326,23: GetValue
  326,31: (
  326,32: "c", x + y * CWIDTH
  326,51: )

5 . ID ( Exprs )
  326,22: .
  326,23: GetValue
  326,31: (
  326,32: "c", x + y * CWIDTH
  326,51: )

260 ID ( Exprs )
  326,23: GetValue
  326,31: (
  326,32: "c", x + y * CWIDTH
  326,51: )

24 ( Exprs )
  326,31: (
  326,32: "c", x + y * CWIDTH
  326,51: )

26 STR
  326,32: "c"

217 , MoreThanOneExpr
  326,35: ,
  326,37: x + y * CWIDTH

54 ID
  326,37: x

65 + MultiplicativeExpr
  326,39: +
  326,41: y * CWIDTH

141 ID
  326,41: y

30 * UnaryExpr
  326,43: *
  326,45: CWIDTH

156 ID
  326,45: CWIDTH

249 )
  326,51: )

49 CR_token2
  326,52: 


126 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  327,9: If
  327,12: piece = "."
  327,24: then
  327,28: 
          x = CWIDTH

  329,9: EndIf

86 ID
  327,12: piece

128 = CompExpr
  327,18: =
  327,20: "."

117 STR
  327,20: "."

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  327,24: then
  327,28: 
          x = CWIDTH

  329,9: EndIf

124 CR_token2
  327,28: 


109 ID = Expr
  328,11: x
  328,13: =
  328,15: CWIDTH

184 = Expr
  328,13: =
  328,15: CWIDTH

70 ID
  328,15: CWIDTH

5 CR_token2
  328,21: 


109 OptionalElse_token1
  329,9: EndIf

218 CR_token2
  329,14: 


126 ID = Expr
  330,9: x
  330,11: =
  330,13: x + 1

184 = Expr
  330,11: =
  330,13: x + 1

70 ID
  330,13: x

59 + MultiplicativeExpr
  330,15: +
  330,17: 1

144 NUM
  330,17: 1

43 CR_token2
  330,18: 


187 Stmt_token2
  331,7: EndWhile

222 CR_token2
  331,15: 



187 Comment CRStmtCRs
  333,7: ' if non of them were empty (i.e "."), then remove the line.
  333,67: 
      If x = CWIDTH Then

        ' Delete the line
        For x1 = 0 to CWIDTH - 1
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))
        EndFor
        linesCleared = linesCleared + 1

        ' Move everything else down one.
        For y1 = y To 1 Step -1
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor
        EndFor
      EndIf


126 CR_token2
  333,67: 


126 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  334,7: If
  334,10: x = CWIDTH
  334,21: Then
  334,25: 

        ' Delete the line
        For x1 = 0 to CWIDTH - 1
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))
        EndFor
        linesCleared = linesCleared + 1

        ' Move everything else down one.
        For y1 = y To 1 Step -1
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor
        EndFor

  350,7: EndIf

86 ID
  334,10: x

128 = CompExpr
  334,12: =
  334,14: CWIDTH

117 ID
  334,14: CWIDTH

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  334,21: Then
  334,25: 

        ' Delete the line
        For x1 = 0 to CWIDTH - 1
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))
        EndFor
        linesCleared = linesCleared + 1

        ' Move everything else down one.
        For y1 = y To 1 Step -1
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor
        EndFor

  350,7: EndIf

124 CR_token2
  334,25: 



122 Comment CRStmtCRs
  336,9: ' Delete the line
  336,26: 
        For x1 = 0 to CWIDTH - 1
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))
        EndFor
        linesCleared = linesCleared + 1



109 CR_token2
  336,26: 


109 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  337,9: For
  337,13: x1
  337,16: =
  337,18: 0
  337,20: to
  337,23: CWIDTH - 1
  337,33: 
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))

  339,9: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  337,13: x1
  337,16: =
  337,18: 0
  337,20: to
  337,23: CWIDTH - 1
  337,33: 
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))

  339,9: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  337,16: =
  337,18: 0
  337,20: to
  337,23: CWIDTH - 1
  337,33: 
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))

  339,9: EndFor

56 NUM
  337,18: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  337,20: to
  337,23: CWIDTH - 1
  337,33: 
          Shapes.Remove(Array.GetValue("c", x1 + y * CWIDTH))

  339,9: EndFor

83 ID
  337,23: CWIDTH

59 - MultiplicativeExpr
  337,30: -
  337,32: 1

144 NUM
  337,32: 1

43 CR_token2
  337,33: 


137 ID . ID ( Exprs )
  338,11: Shapes
  338,17: .
  338,18: Remove
  338,24: (
  338,25: Array.GetValue("c", x1 + y * CWIDTH)
  338,61: )

184 . ID ( Exprs )
  338,17: .
  338,18: Remove
  338,24: (
  338,25: Array.GetValue("c", x1 + y * CWIDTH)
  338,61: )

255 ID ( Exprs )
  338,18: Remove
  338,24: (
  338,25: Array.GetValue("c", x1 + y * CWIDTH)
  338,61: )

221 ( Exprs )
  338,24: (
  338,25: Array.GetValue("c", x1 + y * CWIDTH)
  338,61: )

27 ID . ID ( Exprs )
  338,25: Array
  338,30: .
  338,31: GetValue
  338,39: (
  338,40: "c", x1 + y * CWIDTH
  338,60: )

4 . ID ( Exprs )
  338,30: .
  338,31: GetValue
  338,39: (
  338,40: "c", x1 + y * CWIDTH
  338,60: )

248 ID ( Exprs )
  338,31: GetValue
  338,39: (
  338,40: "c", x1 + y * CWIDTH
  338,60: )

23 ( Exprs )
  338,39: (
  338,40: "c", x1 + y * CWIDTH
  338,60: )

22 STR
  338,40: "c"

217 , MoreThanOneExpr
  338,43: ,
  338,45: x1 + y * CWIDTH

54 ID
  338,45: x1

65 + MultiplicativeExpr
  338,48: +
  338,50: y * CWIDTH

141 ID
  338,50: y

30 * UnaryExpr
  338,52: *
  338,54: CWIDTH

156 ID
  338,54: CWIDTH

239 )
  338,60: )

238 )
  338,61: )

210 CR_token2
  338,62: 


177 Stmt_token6
  339,9: EndFor

216 CR_token2
  339,15: 


109 ID = Expr
  340,9: linesCleared
  340,22: =
  340,24: linesCleared + 1

184 = Expr
  340,22: =
  340,24: linesCleared + 1

70 ID
  340,24: linesCleared

59 + MultiplicativeExpr
  340,37: +
  340,39: 1

144 NUM
  340,39: 1

43 CR_token2
  340,40: 



109 Comment CRStmtCRs
  342,9: ' Move everything else down one.
  342,41: 
        For y1 = y To 1 Step -1
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor
        EndFor


109 CR_token2
  342,41: 


109 Stmt_token4 ID = Expr Stmt_token5 Expr OptStep CRStmtCRs Stmt_token6
  343,9: For
  343,13: y1
  343,16: =
  343,18: y
  343,20: To
  343,23: 1
  343,25: Step -1
  343,32: 
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor

  349,9: EndFor

267 ID = Expr Stmt_token5 Expr OptStep CRStmtCRs Stmt_token6
  343,13: y1
  343,16: =
  343,18: y
  343,20: To
  343,23: 1
  343,25: Step -1
  343,32: 
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor

  349,9: EndFor

266 = Expr Stmt_token5 Expr OptStep CRStmtCRs Stmt_token6
  343,16: =
  343,18: y
  343,20: To
  343,23: 1
  343,25: Step -1
  343,32: 
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor

  349,9: EndFor

56 ID
  343,18: y

264 Stmt_token5 Expr OptStep CRStmtCRs Stmt_token6
  343,20: To
  343,23: 1
  343,25: Step -1
  343,32: 
          For x1 = 0 to CWIDTH - 1
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)
          EndFor

  349,9: EndFor

83 NUM
  343,23: 1

43 OptStep_token1 Expr
  343,25: Step
  343,30: -1

62 - Primary
  343,30: -
  343,31: 1

193 NUM
  343,31: 1

43 CR_token2
  343,32: 


137 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  344,11: For
  344,15: x1
  344,18: =
  344,20: 0
  344,22: to
  344,25: CWIDTH - 1
  344,35: 
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)

  348,11: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  344,15: x1
  344,18: =
  344,20: 0
  344,22: to
  344,25: CWIDTH - 1
  344,35: 
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)

  348,11: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  344,18: =
  344,20: 0
  344,22: to
  344,25: CWIDTH - 1
  344,35: 
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)

  348,11: EndFor

56 NUM
  344,20: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  344,22: to
  344,25: CWIDTH - 1
  344,35: 
            piece = Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)
            Array.SetValue("c", x1 + y1 * CWIDTH, piece)
            Shapes.Move(piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH)

  348,11: EndFor

83 ID
  344,25: CWIDTH

59 - MultiplicativeExpr
  344,32: -
  344,34: 1

144 NUM
  344,34: 1

43 CR_token2
  344,35: 


137 ID = Expr
  345,13: piece
  345,19: =
  345,21: Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)

184 = Expr
  345,19: =
  345,21: Array.GetValue("c", x1 + (y1 - 1) * CWIDTH)

70 ID . ID ( Exprs )
  345,21: Array
  345,26: .
  345,27: GetValue
  345,35: (
  345,36: "c", x1 + (y1 - 1) * CWIDTH
  345,63: )

5 . ID ( Exprs )
  345,26: .
  345,27: GetValue
  345,35: (
  345,36: "c", x1 + (y1 - 1) * CWIDTH
  345,63: )

260 ID ( Exprs )
  345,27: GetValue
  345,35: (
  345,36: "c", x1 + (y1 - 1) * CWIDTH
  345,63: )

24 ( Exprs )
  345,35: (
  345,36: "c", x1 + (y1 - 1) * CWIDTH
  345,63: )

26 STR
  345,36: "c"

217 , MoreThanOneExpr
  345,39: ,
  345,41: x1 + (y1 - 1) * CWIDTH

54 ID
  345,41: x1

65 + MultiplicativeExpr
  345,44: +
  345,46: (y1 - 1) * CWIDTH

141 ( Expr )
  345,46: (
  345,47: y1 - 1
  345,53: )

80 ID
  345,47: y1

65 - MultiplicativeExpr
  345,50: -
  345,52: 1

141 NUM
  345,52: 1

265 )
  345,53: )

30 * UnaryExpr
  345,55: *
  345,57: CWIDTH

156 ID
  345,57: CWIDTH

249 )
  345,63: )

49 CR_token2
  345,64: 


137 ID . ID ( Exprs )
  346,13: Array
  346,18: .
  346,19: SetValue
  346,27: (
  346,28: "c", x1 + y1 * CWIDTH, piece
  346,56: )

184 . ID ( Exprs )
  346,18: .
  346,19: SetValue
  346,27: (
  346,28: "c", x1 + y1 * CWIDTH, piece
  346,56: )

255 ID ( Exprs )
  346,19: SetValue
  346,27: (
  346,28: "c", x1 + y1 * CWIDTH, piece
  346,56: )

221 ( Exprs )
  346,27: (
  346,28: "c", x1 + y1 * CWIDTH, piece
  346,56: )

27 STR
  346,28: "c"

217 , MoreThanOneExpr
  346,31: ,
  346,33: x1 + y1 * CWIDTH, piece

54 ID
  346,33: x1

65 + MultiplicativeExpr
  346,36: +
  346,38: y1 * CWIDTH

141 ID
  346,38: y1

30 * UnaryExpr
  346,41: *
  346,43: CWIDTH

156 ID
  346,43: CWIDTH

217 , MoreThanOneExpr
  346,49: ,
  346,51: piece

54 ID
  346,51: piece

238 )
  346,56: )

210 CR_token2
  346,57: 


137 ID . ID ( Exprs )
  347,13: Shapes
  347,19: .
  347,20: Move
  347,24: (
  347,25: piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH
  347,84: )

184 . ID ( Exprs )
  347,19: .
  347,20: Move
  347,24: (
  347,25: piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH
  347,84: )

255 ID ( Exprs )
  347,20: Move
  347,24: (
  347,25: piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH
  347,84: )

221 ( Exprs )
  347,24: (
  347,25: piece, Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH
  347,84: )

27 ID
  347,25: piece

217 , MoreThanOneExpr
  347,30: ,
  347,32: Shapes.GetLeft(piece), Shapes.GetTop(piece) + BWIDTH

54 ID . ID ( Exprs )
  347,32: Shapes
  347,38: .
  347,39: GetLeft
  347,46: (
  347,47: piece
  347,52: )

4 . ID ( Exprs )
  347,38: .
  347,39: GetLeft
  347,46: (
  347,47: piece
  347,52: )

248 ID ( Exprs )
  347,39: GetLeft
  347,46: (
  347,47: piece
  347,52: )

23 ( Exprs )
  347,46: (
  347,47: piece
  347,52: )

22 ID
  347,47: piece

239 )
  347,52: )

217 , MoreThanOneExpr
  347,53: ,
  347,55: Shapes.GetTop(piece) + BWIDTH

54 ID . ID ( Exprs )
  347,55: Shapes
  347,61: .
  347,62: GetTop
  347,68: (
  347,69: piece
  347,74: )

4 . ID ( Exprs )
  347,61: .
  347,62: GetTop
  347,68: (
  347,69: piece
  347,74: )

248 ID ( Exprs )
  347,62: GetTop
  347,68: (
  347,69: piece
  347,74: )

23 ( Exprs )
  347,68: (
  347,69: piece
  347,74: )

22 ID
  347,69: piece

239 )
  347,74: )

65 + MultiplicativeExpr
  347,76: +
  347,78: BWIDTH

141 ID
  347,78: BWIDTH

238 )
  347,84: )

210 CR_token2
  347,85: 


177 Stmt_token6
  348,11: EndFor

216 CR_token2
  348,17: 


190 Stmt_token6
  349,9: EndFor

224 CR_token2
  349,15: 


109 OptionalElse_token1
  350,7: EndIf

218 CR_token2
  350,12: 


187 Stmt_token2
  351,5: EndWhile

222 CR_token2
  351,13: 


190 Stmt_token6
  352,3: EndFor

224 CR_token2
  352,9: 



160 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  354,3: If
  354,6: linesCleared > 0
  354,23: Then
  354,27: 
    score = score + 100 * Math.Round(linesCleared * 2.15 - 1)
    PrintScore()

  357,3: EndIf

86 ID
  354,6: linesCleared

91 > AdditiveExpr
  354,19: >
  354,21: 0

131 NUM
  354,21: 0

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  354,23: Then
  354,27: 
    score = score + 100 * Math.Round(linesCleared * 2.15 - 1)
    PrintScore()

  357,3: EndIf

124 CR_token2
  354,27: 


109 ID = Expr
  355,5: score
  355,11: =
  355,13: score + 100 * Math.Round(linesCleared * 2.15 - 1)

184 = Expr
  355,11: =
  355,13: score + 100 * Math.Round(linesCleared * 2.15 - 1)

70 ID
  355,13: score

59 + MultiplicativeExpr
  355,19: +
  355,21: 100 * Math.Round(linesCleared * 2.15 - 1)

144 NUM
  355,21: 100

40 * UnaryExpr
  355,25: *
  355,27: Math.Round(linesCleared * 2.15 - 1)

157 ID . ID ( Exprs )
  355,27: Math
  355,31: .
  355,32: Round
  355,37: (
  355,38: linesCleared * 2.15 - 1
  355,61: )

5 . ID ( Exprs )
  355,31: .
  355,32: Round
  355,37: (
  355,38: linesCleared * 2.15 - 1
  355,61: )

260 ID ( Exprs )
  355,32: Round
  355,37: (
  355,38: linesCleared * 2.15 - 1
  355,61: )

24 ( Exprs )
  355,37: (
  355,38: linesCleared * 2.15 - 1
  355,61: )

26 ID
  355,38: linesCleared

50 * UnaryExpr
  355,51: *
  355,53: 2.15

156 NUM
  355,53: 2.15

65 - MultiplicativeExpr
  355,58: -
  355,60: 1

141 NUM
  355,60: 1

249 )
  355,61: )

49 CR_token2
  355,62: 


109 ID ( )
  356,5: PrintScore
  356,15: (
  356,16: )

184 ( )
  356,15: (
  356,16: )

261 )
  356,16: )

215 CR_token2
  356,17: 


109 OptionalElse_token1
  357,3: EndIf

218 CR_token2
  357,8: 


257 Stmt_token8
  358,1: EndSub

146 Stmt_token7 ID CRStmtCRs Stmt_token8
  360,1: Sub
  360,5: SetupCanvas
  360,16: 
' GraphicsWindow.DrawResizedImage( Flickr.GetRandomPicture( "bricks" ), 0, 0, GraphicsWindow.Width, GraphicsWindow.Height)


  GraphicsWindow.BrushColor = GraphicsWindow.BackgroundColor
  GraphicsWindow.FillRectangle(XOFFSET, YOFFSET, CWIDTH*BWIDTH, CHEIGHT*BWIDTH)

  Program.Delay(200)
  GraphicsWindow.PenWidth = 1
  GraphicsWindow.PenColor = "Pink"
  For x = 0 To CWIDTH-1
    For y = 0 To CHEIGHT-1
      Array.SetValue("c", x + y * CWIDTH, ".") ' "." indicates spot is free
      GraphicsWindow.DrawRectangle(XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH)
    EndFor
  EndFor

  GraphicsWindow.PenWidth = 4
  GraphicsWindow.PenColor = "Black"
  GraphicsWindow.DrawLine(XOFFSET, YOFFSET, XOFFSET, YOFFSET + CHEIGHT*BWIDTH)
  GraphicsWindow.DrawLine(XOFFSET + CWIDTH*BWIDTH, YOFFSET, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH)
  GraphicsWindow.DrawLine(XOFFSET, YOFFSET + CHEIGHT*BWIDTH, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH)

  GraphicsWindow.PenColor = "Lime"
  GraphicsWindow.DrawLine(XOFFSET - 4, YOFFSET, XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 6)
  GraphicsWindow.DrawLine(XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 6)
  GraphicsWindow.DrawLine(XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 4, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 4)

  GraphicsWindow.PenColor = "Black"
  GraphicsWindow.BrushColor = "Pink"
  x = XOFFSET + PREVIEW_xpos * BWIDTH - BWIDTH
  y = YOFFSET + PREVIEW_ypos * BWIDTH - BWIDTH
  GraphicsWindow.FillRectangle(x, y, BWIDTH * 5, BWIDTH * 6)
  GraphicsWindow.DrawRectangle(x, y, BWIDTH * 5, BWIDTH * 6)

  GraphicsWindow.FillRectangle(x - 20, y + 190, 310, 170)
  GraphicsWindow.DrawRectangle(x - 20, y + 190, 310, 170)

  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.FontItalic = "False"
  GraphicsWindow.FontName = "Comic Sans MS"
  GraphicsWindow.FontSize = 16
  GraphicsWindow.DrawText(x, y + 200, "Game control keys:")
  GraphicsWindow.DrawText(x + 25, y + 220, "Left Arrow = Move piece left")
  GraphicsWindow.DrawText(x + 25, y + 240, "Right Arrow = Move piece right")
  GraphicsWindow.DrawText(x + 25, y + 260, "Up Arrow = Rotate piece")
  GraphicsWindow.DrawText(x + 25, y + 280, "Down Arrow = Drop piece")
  GraphicsWindow.DrawText(x, y + 320, "Press to stop game")

  Program.Delay(200) ' without this delay, the above text will use the fontsize of the score 

  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.FontName = "Georgia"
  GraphicsWindow.FontItalic = "True"
  GraphicsWindow.FontSize = 36
  GraphicsWindow.DrawText(x - 20, y + 400, "Small Basic Tetris")
  Program.Delay(200) ' without this delay, the above text will use the fontsize of the score 
  GraphicsWindow.FontSize = 16
  GraphicsWindow.DrawText(x - 20, y + 440, "ver.0.1")

  Program.Delay(200) ' without this delay, the above text will use the fontsize of the score 
  score = 0
  PrintScore()

  423,1: EndSub

244 ID CRStmtCRs Stmt_token8
  360,5: SetupCanvas
  360,16: 
' GraphicsWindow.DrawResizedImage( Flickr.GetRandomPicture( "bricks" ), 0, 0, GraphicsWindow.Width, GraphicsWindow.Height)


  GraphicsWindow.BrushColor = GraphicsWindow.BackgroundColor
  GraphicsWindow.FillRectangle(XOFFSET, YOFFSET, CWIDTH*BWIDTH, CHEIGHT*BWIDTH)

  Program.Delay(200)
  GraphicsWindow.PenWidth = 1
  GraphicsWindow.PenColor = "Pink"
  For x = 0 To CWIDTH-1
    For y = 0 To CHEIGHT-1
      Array.SetValue("c", x + y * CWIDTH, ".") ' "." indicates spot is free
      GraphicsWindow.DrawRectangle(XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH)
    EndFor
  EndFor

  GraphicsWindow.PenWidth = 4
  GraphicsWindow.PenColor = "Black"
  GraphicsWindow.DrawLine(XOFFSET, YOFFSET, XOFFSET, YOFFSET + CHEIGHT*BWIDTH)
  GraphicsWindow.DrawLine(XOFFSET + CWIDTH*BWIDTH, YOFFSET, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH)
  GraphicsWindow.DrawLine(XOFFSET, YOFFSET + CHEIGHT*BWIDTH, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH)

  GraphicsWindow.PenColor = "Lime"
  GraphicsWindow.DrawLine(XOFFSET - 4, YOFFSET, XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 6)
  GraphicsWindow.DrawLine(XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 6)
  GraphicsWindow.DrawLine(XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 4, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 4)

  GraphicsWindow.PenColor = "Black"
  GraphicsWindow.BrushColor = "Pink"
  x = XOFFSET + PREVIEW_xpos * BWIDTH - BWIDTH
  y = YOFFSET + PREVIEW_ypos * BWIDTH - BWIDTH
  GraphicsWindow.FillRectangle(x, y, BWIDTH * 5, BWIDTH * 6)
  GraphicsWindow.DrawRectangle(x, y, BWIDTH * 5, BWIDTH * 6)

  GraphicsWindow.FillRectangle(x - 20, y + 190, 310, 170)
  GraphicsWindow.DrawRectangle(x - 20, y + 190, 310, 170)

  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.FontItalic = "False"
  GraphicsWindow.FontName = "Comic Sans MS"
  GraphicsWindow.FontSize = 16
  GraphicsWindow.DrawText(x, y + 200, "Game control keys:")
  GraphicsWindow.DrawText(x + 25, y + 220, "Left Arrow = Move piece left")
  GraphicsWindow.DrawText(x + 25, y + 240, "Right Arrow = Move piece right")
  GraphicsWindow.DrawText(x + 25, y + 260, "Up Arrow = Rotate piece")
  GraphicsWindow.DrawText(x + 25, y + 280, "Down Arrow = Drop piece")
  GraphicsWindow.DrawText(x, y + 320, "Press to stop game")

  Program.Delay(200) ' without this delay, the above text will use the fontsize of the score 

  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.FontName = "Georgia"
  GraphicsWindow.FontItalic = "True"
  GraphicsWindow.FontSize = 36
  GraphicsWindow.DrawText(x - 20, y + 400, "Small Basic Tetris")
  Program.Delay(200) ' without this delay, the above text will use the fontsize of the score 
  GraphicsWindow.FontSize = 16
  GraphicsWindow.DrawText(x - 20, y + 440, "ver.0.1")

  Program.Delay(200) ' without this delay, the above text will use the fontsize of the score 
  score = 0
  PrintScore()

  423,1: EndSub

199 CR_token2
  360,16: 


105 Comment CRStmtCRs_repeat1
  361,1: ' GraphicsWindow.DrawResizedImage( Flickr.GetRandomPicture( "bricks" ), 0, 0, GraphicsWindow.Width, GraphicsWindow.Height)
  364,3: GraphicsWindow.BrushColor = GraphicsWindow.BackgroundColor
  GraphicsWindow.FillRectangle(XOFFSET, YOFFSET, CWIDTH*BWIDTH, CHEIGHT*BWIDTH)

  Program.Delay(200)
  GraphicsWindow.PenWidth = 1
  GraphicsWindow.PenColor = "Pink"
  For x = 0 To CWIDTH-1
    For y = 0 To CHEIGHT-1
      Array.SetValue("c", x + y * CWIDTH, ".") ' "." indicates spot is free
      GraphicsWindow.DrawRectangle(XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH)
    EndFor
  EndFor

  GraphicsWindow.PenWidth = 4
  GraphicsWindow.PenColor = "Black"
  GraphicsWindow.DrawLine(XOFFSET, YOFFSET, XOFFSET, YOFFSET + CHEIGHT*BWIDTH)
  GraphicsWindow.DrawLine(XOFFSET + CWIDTH*BWIDTH, YOFFSET, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH)
  GraphicsWindow.DrawLine(XOFFSET, YOFFSET + CHEIGHT*BWIDTH, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH)

  GraphicsWindow.PenColor = "Lime"
  GraphicsWindow.DrawLine(XOFFSET - 4, YOFFSET, XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 6)
  GraphicsWindow.DrawLine(XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 6)
  GraphicsWindow.DrawLine(XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 4, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 4)

  GraphicsWindow.PenColor = "Black"
  GraphicsWindow.BrushColor = "Pink"
  x = XOFFSET + PREVIEW_xpos * BWIDTH - BWIDTH
  y = YOFFSET + PREVIEW_ypos * BWIDTH - BWIDTH
  GraphicsWindow.FillRectangle(x, y, BWIDTH * 5, BWIDTH * 6)
  GraphicsWindow.DrawRectangle(x, y, BWIDTH * 5, BWIDTH * 6)

  GraphicsWindow.FillRectangle(x - 20, y + 190, 310, 170)
  GraphicsWindow.DrawRectangle(x - 20, y + 190, 310, 170)

  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.FontItalic = "False"
  GraphicsWindow.FontName = "Comic Sans MS"
  GraphicsWindow.FontSize = 16
  GraphicsWindow.DrawText(x, y + 200, "Game control keys:")
  GraphicsWindow.DrawText(x + 25, y + 220, "Left Arrow = Move piece left")
  GraphicsWindow.DrawText(x + 25, y + 240, "Right Arrow = Move piece right")
  GraphicsWindow.DrawText(x + 25, y + 260, "Up Arrow = Rotate piece")
  GraphicsWindow.DrawText(x + 25, y + 280, "Down Arrow = Drop piece")
  GraphicsWindow.DrawText(x, y + 320, "Press to stop game")

  Program.Delay(200) ' without this delay, the above text will use the fontsize of the score 

  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.FontName = "Georgia"
  GraphicsWindow.FontItalic = "True"
  GraphicsWindow.FontSize = 36
  GraphicsWindow.DrawText(x - 20, y + 400, "Small Basic Tetris")
  Program.Delay(200) ' without this delay, the above text will use the fontsize of the score 
  GraphicsWindow.FontSize = 16
  GraphicsWindow.DrawText(x - 20, y + 440, "ver.0.1")

  Program.Delay(200) ' without this delay, the above text will use the fontsize of the score 
  score = 0
  PrintScore()


160 ID . ID = Expr
  364,3: GraphicsWindow
  364,17: .
  364,18: BrushColor
  364,29: =
  364,31: GraphicsWindow.BackgroundColor

184 . ID = Expr
  364,17: .
  364,18: BrushColor
  364,29: =
  364,31: GraphicsWindow.BackgroundColor

255 ID = Expr
  364,18: BrushColor
  364,29: =
  364,31: GraphicsWindow.BackgroundColor

221 = Expr
  364,29: =
  364,31: GraphicsWindow.BackgroundColor

57 ID . ID
  364,31: GraphicsWindow
  364,45: .
  364,46: BackgroundColor

5 . ID
  364,45: .
  364,46: BackgroundColor

260 ID
  364,46: BackgroundColor

24 CR_token2
  364,61: 


160 ID . ID ( Exprs )
  365,3: GraphicsWindow
  365,17: .
  365,18: FillRectangle
  365,31: (
  365,32: XOFFSET, YOFFSET, CWIDTH*BWIDTH, CHEIGHT*BWIDTH
  365,79: )

184 . ID ( Exprs )
  365,17: .
  365,18: FillRectangle
  365,31: (
  365,32: XOFFSET, YOFFSET, CWIDTH*BWIDTH, CHEIGHT*BWIDTH
  365,79: )

255 ID ( Exprs )
  365,18: FillRectangle
  365,31: (
  365,32: XOFFSET, YOFFSET, CWIDTH*BWIDTH, CHEIGHT*BWIDTH
  365,79: )

221 ( Exprs )
  365,31: (
  365,32: XOFFSET, YOFFSET, CWIDTH*BWIDTH, CHEIGHT*BWIDTH
  365,79: )

27 ID
  365,32: XOFFSET

217 , MoreThanOneExpr
  365,39: ,
  365,41: YOFFSET, CWIDTH*BWIDTH, CHEIGHT*BWIDTH

54 ID
  365,41: YOFFSET

217 , MoreThanOneExpr
  365,48: ,
  365,50: CWIDTH*BWIDTH, CHEIGHT*BWIDTH

54 ID
  365,50: CWIDTH

50 * UnaryExpr
  365,56: *
  365,57: BWIDTH

156 ID
  365,57: BWIDTH

217 , MoreThanOneExpr
  365,63: ,
  365,65: CHEIGHT*BWIDTH

54 ID
  365,65: CHEIGHT

50 * UnaryExpr
  365,72: *
  365,73: BWIDTH

156 ID
  365,73: BWIDTH

238 )
  365,79: )

210 CR_token2
  365,80: 



160 ID . ID ( Exprs )
  367,3: Program
  367,10: .
  367,11: Delay
  367,16: (
  367,17: 200
  367,20: )

184 . ID ( Exprs )
  367,10: .
  367,11: Delay
  367,16: (
  367,17: 200
  367,20: )

255 ID ( Exprs )
  367,11: Delay
  367,16: (
  367,17: 200
  367,20: )

221 ( Exprs )
  367,16: (
  367,17: 200
  367,20: )

27 NUM
  367,17: 200

238 )
  367,20: )

210 CR_token2
  367,21: 


160 ID . ID = Expr
  368,3: GraphicsWindow
  368,17: .
  368,18: PenWidth
  368,27: =
  368,29: 1

184 . ID = Expr
  368,17: .
  368,18: PenWidth
  368,27: =
  368,29: 1

255 ID = Expr
  368,18: PenWidth
  368,27: =
  368,29: 1

221 = Expr
  368,27: =
  368,29: 1

57 NUM
  368,29: 1

43 CR_token2
  368,30: 


160 ID . ID = Expr
  369,3: GraphicsWindow
  369,17: .
  369,18: PenColor
  369,27: =
  369,29: "Pink"

184 . ID = Expr
  369,17: .
  369,18: PenColor
  369,27: =
  369,29: "Pink"

255 ID = Expr
  369,18: PenColor
  369,27: =
  369,29: "Pink"

221 = Expr
  369,27: =
  369,29: "Pink"

57 STR
  369,29: "Pink"

43 CR_token2
  369,35: 


160 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  370,3: For
  370,7: x
  370,9: =
  370,11: 0
  370,13: To
  370,16: CWIDTH-1
  370,24: 
    For y = 0 To CHEIGHT-1
      Array.SetValue("c", x + y * CWIDTH, ".") ' "." indicates spot is free
      GraphicsWindow.DrawRectangle(XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH)
    EndFor

  375,3: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  370,7: x
  370,9: =
  370,11: 0
  370,13: To
  370,16: CWIDTH-1
  370,24: 
    For y = 0 To CHEIGHT-1
      Array.SetValue("c", x + y * CWIDTH, ".") ' "." indicates spot is free
      GraphicsWindow.DrawRectangle(XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH)
    EndFor

  375,3: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  370,9: =
  370,11: 0
  370,13: To
  370,16: CWIDTH-1
  370,24: 
    For y = 0 To CHEIGHT-1
      Array.SetValue("c", x + y * CWIDTH, ".") ' "." indicates spot is free
      GraphicsWindow.DrawRectangle(XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH)
    EndFor

  375,3: EndFor

56 NUM
  370,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  370,13: To
  370,16: CWIDTH-1
  370,24: 
    For y = 0 To CHEIGHT-1
      Array.SetValue("c", x + y * CWIDTH, ".") ' "." indicates spot is free
      GraphicsWindow.DrawRectangle(XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH)
    EndFor

  375,3: EndFor

83 ID
  370,16: CWIDTH

59 - MultiplicativeExpr
  370,22: -
  370,23: 1

144 NUM
  370,23: 1

43 CR_token2
  370,24: 


137 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  371,5: For
  371,9: y
  371,11: =
  371,13: 0
  371,15: To
  371,18: CHEIGHT-1
  371,27: 
      Array.SetValue("c", x + y * CWIDTH, ".") ' "." indicates spot is free
      GraphicsWindow.DrawRectangle(XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH)

  374,5: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  371,9: y
  371,11: =
  371,13: 0
  371,15: To
  371,18: CHEIGHT-1
  371,27: 
      Array.SetValue("c", x + y * CWIDTH, ".") ' "." indicates spot is free
      GraphicsWindow.DrawRectangle(XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH)

  374,5: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  371,11: =
  371,13: 0
  371,15: To
  371,18: CHEIGHT-1
  371,27: 
      Array.SetValue("c", x + y * CWIDTH, ".") ' "." indicates spot is free
      GraphicsWindow.DrawRectangle(XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH)

  374,5: EndFor

56 NUM
  371,13: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  371,15: To
  371,18: CHEIGHT-1
  371,27: 
      Array.SetValue("c", x + y * CWIDTH, ".") ' "." indicates spot is free
      GraphicsWindow.DrawRectangle(XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH)

  374,5: EndFor

83 ID
  371,18: CHEIGHT

59 - MultiplicativeExpr
  371,25: -
  371,26: 1

144 NUM
  371,26: 1

43 CR_token2
  371,27: 


137 ID . ID ( Exprs )
  372,7: Array
  372,12: .
  372,13: SetValue
  372,21: (
  372,22: "c", x + y * CWIDTH, "."
  372,46: )

184 . ID ( Exprs )
  372,12: .
  372,13: SetValue
  372,21: (
  372,22: "c", x + y * CWIDTH, "."
  372,46: )

255 ID ( Exprs )
  372,13: SetValue
  372,21: (
  372,22: "c", x + y * CWIDTH, "."
  372,46: )

221 ( Exprs )
  372,21: (
  372,22: "c", x + y * CWIDTH, "."
  372,46: )

27 STR
  372,22: "c"

217 , MoreThanOneExpr
  372,25: ,
  372,27: x + y * CWIDTH, "."

54 ID
  372,27: x

65 + MultiplicativeExpr
  372,29: +
  372,31: y * CWIDTH

141 ID
  372,31: y

30 * UnaryExpr
  372,33: *
  372,35: CWIDTH

156 ID
  372,35: CWIDTH

217 , MoreThanOneExpr
  372,41: ,
  372,43: "."

54 STR
  372,43: "."

238 )
  372,46: )

203 Comment CR
  372,48: ' "." indicates spot is free
  372,76: 


210 CR_token2
  372,76: 


137 ID . ID ( Exprs )
  373,7: GraphicsWindow
  373,21: .
  373,22: DrawRectangle
  373,35: (
  373,36: XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH
  373,94: )

184 . ID ( Exprs )
  373,21: .
  373,22: DrawRectangle
  373,35: (
  373,36: XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH
  373,94: )

255 ID ( Exprs )
  373,22: DrawRectangle
  373,35: (
  373,36: XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH
  373,94: )

221 ( Exprs )
  373,35: (
  373,36: XOFFSET + x * BWIDTH, YOFFSET + y * BWIDTH, BWIDTH, BWIDTH
  373,94: )

27 ID
  373,36: XOFFSET

65 + MultiplicativeExpr
  373,44: +
  373,46: x * BWIDTH

141 ID
  373,46: x

30 * UnaryExpr
  373,48: *
  373,50: BWIDTH

156 ID
  373,50: BWIDTH

217 , MoreThanOneExpr
  373,56: ,
  373,58: YOFFSET + y * BWIDTH, BWIDTH, BWIDTH

54 ID
  373,58: YOFFSET

65 + MultiplicativeExpr
  373,66: +
  373,68: y * BWIDTH

141 ID
  373,68: y

30 * UnaryExpr
  373,70: *
  373,72: BWIDTH

156 ID
  373,72: BWIDTH

217 , MoreThanOneExpr
  373,78: ,
  373,80: BWIDTH, BWIDTH

54 ID
  373,80: BWIDTH

217 , MoreThanOneExpr
  373,86: ,
  373,88: BWIDTH

54 ID
  373,88: BWIDTH

238 )
  373,94: )

210 CR_token2
  373,95: 


177 Stmt_token6
  374,5: EndFor

216 CR_token2
  374,11: 


177 Stmt_token6
  375,3: EndFor

216 CR_token2
  375,9: 



160 ID . ID = Expr
  377,3: GraphicsWindow
  377,17: .
  377,18: PenWidth
  377,27: =
  377,29: 4

184 . ID = Expr
  377,17: .
  377,18: PenWidth
  377,27: =
  377,29: 4

255 ID = Expr
  377,18: PenWidth
  377,27: =
  377,29: 4

221 = Expr
  377,27: =
  377,29: 4

57 NUM
  377,29: 4

43 CR_token2
  377,30: 


160 ID . ID = Expr
  378,3: GraphicsWindow
  378,17: .
  378,18: PenColor
  378,27: =
  378,29: "Black"

184 . ID = Expr
  378,17: .
  378,18: PenColor
  378,27: =
  378,29: "Black"

255 ID = Expr
  378,18: PenColor
  378,27: =
  378,29: "Black"

221 = Expr
  378,27: =
  378,29: "Black"

57 STR
  378,29: "Black"

43 CR_token2
  378,36: 


160 ID . ID ( Exprs )
  379,3: GraphicsWindow
  379,17: .
  379,18: DrawLine
  379,26: (
  379,27: XOFFSET, YOFFSET, XOFFSET, YOFFSET + CHEIGHT*BWIDTH
  379,78: )

184 . ID ( Exprs )
  379,17: .
  379,18: DrawLine
  379,26: (
  379,27: XOFFSET, YOFFSET, XOFFSET, YOFFSET + CHEIGHT*BWIDTH
  379,78: )

255 ID ( Exprs )
  379,18: DrawLine
  379,26: (
  379,27: XOFFSET, YOFFSET, XOFFSET, YOFFSET + CHEIGHT*BWIDTH
  379,78: )

221 ( Exprs )
  379,26: (
  379,27: XOFFSET, YOFFSET, XOFFSET, YOFFSET + CHEIGHT*BWIDTH
  379,78: )

27 ID
  379,27: XOFFSET

217 , MoreThanOneExpr
  379,34: ,
  379,36: YOFFSET, XOFFSET, YOFFSET + CHEIGHT*BWIDTH

54 ID
  379,36: YOFFSET

217 , MoreThanOneExpr
  379,43: ,
  379,45: XOFFSET, YOFFSET + CHEIGHT*BWIDTH

54 ID
  379,45: XOFFSET

217 , MoreThanOneExpr
  379,52: ,
  379,54: YOFFSET + CHEIGHT*BWIDTH

54 ID
  379,54: YOFFSET

65 + MultiplicativeExpr
  379,62: +
  379,64: CHEIGHT*BWIDTH

141 ID
  379,64: CHEIGHT

30 * UnaryExpr
  379,71: *
  379,72: BWIDTH

156 ID
  379,72: BWIDTH

238 )
  379,78: )

210 CR_token2
  379,79: 


160 ID . ID ( Exprs )
  380,3: GraphicsWindow
  380,17: .
  380,18: DrawLine
  380,26: (
  380,27: XOFFSET + CWIDTH*BWIDTH, YOFFSET, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH
  380,110: )

184 . ID ( Exprs )
  380,17: .
  380,18: DrawLine
  380,26: (
  380,27: XOFFSET + CWIDTH*BWIDTH, YOFFSET, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH
  380,110: )

255 ID ( Exprs )
  380,18: DrawLine
  380,26: (
  380,27: XOFFSET + CWIDTH*BWIDTH, YOFFSET, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH
  380,110: )

221 ( Exprs )
  380,26: (
  380,27: XOFFSET + CWIDTH*BWIDTH, YOFFSET, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH
  380,110: )

27 ID
  380,27: XOFFSET

65 + MultiplicativeExpr
  380,35: +
  380,37: CWIDTH*BWIDTH

141 ID
  380,37: CWIDTH

30 * UnaryExpr
  380,43: *
  380,44: BWIDTH

156 ID
  380,44: BWIDTH

217 , MoreThanOneExpr
  380,50: ,
  380,52: YOFFSET, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH

54 ID
  380,52: YOFFSET

217 , MoreThanOneExpr
  380,59: ,
  380,61: XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH

54 ID
  380,61: XOFFSET

65 + MultiplicativeExpr
  380,69: +
  380,71: CWIDTH*BWIDTH

141 ID
  380,71: CWIDTH

30 * UnaryExpr
  380,77: *
  380,78: BWIDTH

156 ID
  380,78: BWIDTH

217 , MoreThanOneExpr
  380,84: ,
  380,86: YOFFSET + CHEIGHT*BWIDTH

54 ID
  380,86: YOFFSET

65 + MultiplicativeExpr
  380,94: +
  380,96: CHEIGHT*BWIDTH

141 ID
  380,96: CHEIGHT

30 * UnaryExpr
  380,103: *
  380,104: BWIDTH

156 ID
  380,104: BWIDTH

238 )
  380,110: )

210 CR_token2
  380,111: 


160 ID . ID ( Exprs )
  381,3: GraphicsWindow
  381,17: .
  381,18: DrawLine
  381,26: (
  381,27: XOFFSET, YOFFSET + CHEIGHT*BWIDTH, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH
  381,111: )

184 . ID ( Exprs )
  381,17: .
  381,18: DrawLine
  381,26: (
  381,27: XOFFSET, YOFFSET + CHEIGHT*BWIDTH, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH
  381,111: )

255 ID ( Exprs )
  381,18: DrawLine
  381,26: (
  381,27: XOFFSET, YOFFSET + CHEIGHT*BWIDTH, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH
  381,111: )

221 ( Exprs )
  381,26: (
  381,27: XOFFSET, YOFFSET + CHEIGHT*BWIDTH, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH
  381,111: )

27 ID
  381,27: XOFFSET

217 , MoreThanOneExpr
  381,34: ,
  381,36: YOFFSET + CHEIGHT*BWIDTH, XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH

54 ID
  381,36: YOFFSET

65 + MultiplicativeExpr
  381,44: +
  381,46: CHEIGHT*BWIDTH

141 ID
  381,46: CHEIGHT

30 * UnaryExpr
  381,53: *
  381,54: BWIDTH

156 ID
  381,54: BWIDTH

217 , MoreThanOneExpr
  381,60: ,
  381,62: XOFFSET + CWIDTH*BWIDTH, YOFFSET + CHEIGHT*BWIDTH

54 ID
  381,62: XOFFSET

65 + MultiplicativeExpr
  381,70: +
  381,72: CWIDTH*BWIDTH

141 ID
  381,72: CWIDTH

30 * UnaryExpr
  381,78: *
  381,79: BWIDTH

156 ID
  381,79: BWIDTH

217 , MoreThanOneExpr
  381,85: ,
  381,87: YOFFSET + CHEIGHT*BWIDTH

54 ID
  381,87: YOFFSET

65 + MultiplicativeExpr
  381,95: +
  381,97: CHEIGHT*BWIDTH

141 ID
  381,97: CHEIGHT

30 * UnaryExpr
  381,104: *
  381,105: BWIDTH

156 ID
  381,105: BWIDTH

238 )
  381,111: )

210 CR_token2
  381,112: 



160 ID . ID = Expr
  383,3: GraphicsWindow
  383,17: .
  383,18: PenColor
  383,27: =
  383,29: "Lime"

184 . ID = Expr
  383,17: .
  383,18: PenColor
  383,27: =
  383,29: "Lime"

255 ID = Expr
  383,18: PenColor
  383,27: =
  383,29: "Lime"

221 = Expr
  383,27: =
  383,29: "Lime"

57 STR
  383,29: "Lime"

43 CR_token2
  383,35: 


160 ID . ID ( Exprs )
  384,3: GraphicsWindow
  384,17: .
  384,18: DrawLine
  384,26: (
  384,27: XOFFSET - 4, YOFFSET, XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 6
  384,90: )

184 . ID ( Exprs )
  384,17: .
  384,18: DrawLine
  384,26: (
  384,27: XOFFSET - 4, YOFFSET, XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 6
  384,90: )

255 ID ( Exprs )
  384,18: DrawLine
  384,26: (
  384,27: XOFFSET - 4, YOFFSET, XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 6
  384,90: )

221 ( Exprs )
  384,26: (
  384,27: XOFFSET - 4, YOFFSET, XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 6
  384,90: )

27 ID
  384,27: XOFFSET

65 - MultiplicativeExpr
  384,35: -
  384,37: 4

141 NUM
  384,37: 4

217 , MoreThanOneExpr
  384,38: ,
  384,40: YOFFSET, XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 6

54 ID
  384,40: YOFFSET

217 , MoreThanOneExpr
  384,47: ,
  384,49: XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 6

54 ID
  384,49: XOFFSET

65 - MultiplicativeExpr
  384,57: -
  384,59: 4

141 NUM
  384,59: 4

217 , MoreThanOneExpr
  384,60: ,
  384,62: YOFFSET + CHEIGHT*BWIDTH + 6

54 ID
  384,62: YOFFSET

65 + MultiplicativeExpr
  384,70: +
  384,72: CHEIGHT*BWIDTH

141 ID
  384,72: CHEIGHT

30 * UnaryExpr
  384,79: *
  384,80: BWIDTH

156 ID
  384,80: BWIDTH

65 + MultiplicativeExpr
  384,87: +
  384,89: 6

141 NUM
  384,89: 6

238 )
  384,90: )

210 CR_token2
  384,91: 


160 ID . ID ( Exprs )
  385,3: GraphicsWindow
  385,17: .
  385,18: DrawLine
  385,26: (
  385,27: XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 6
  385,122: )

184 . ID ( Exprs )
  385,17: .
  385,18: DrawLine
  385,26: (
  385,27: XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 6
  385,122: )

255 ID ( Exprs )
  385,18: DrawLine
  385,26: (
  385,27: XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 6
  385,122: )

221 ( Exprs )
  385,26: (
  385,27: XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 6
  385,122: )

27 ID
  385,27: XOFFSET

65 + MultiplicativeExpr
  385,35: +
  385,37: CWIDTH*BWIDTH

141 ID
  385,37: CWIDTH

30 * UnaryExpr
  385,43: *
  385,44: BWIDTH

156 ID
  385,44: BWIDTH

65 + MultiplicativeExpr
  385,51: +
  385,53: 4

141 NUM
  385,53: 4

217 , MoreThanOneExpr
  385,54: ,
  385,56: YOFFSET, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 6

54 ID
  385,56: YOFFSET

217 , MoreThanOneExpr
  385,63: ,
  385,65: XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 6

54 ID
  385,65: XOFFSET

65 + MultiplicativeExpr
  385,73: +
  385,75: CWIDTH*BWIDTH

141 ID
  385,75: CWIDTH

30 * UnaryExpr
  385,81: *
  385,82: BWIDTH

156 ID
  385,82: BWIDTH

65 + MultiplicativeExpr
  385,89: +
  385,91: 4

141 NUM
  385,91: 4

217 , MoreThanOneExpr
  385,92: ,
  385,94: YOFFSET + CHEIGHT*BWIDTH + 6

54 ID
  385,94: YOFFSET

65 + MultiplicativeExpr
  385,102: +
  385,104: CHEIGHT*BWIDTH

141 ID
  385,104: CHEIGHT

30 * UnaryExpr
  385,111: *
  385,112: BWIDTH

156 ID
  385,112: BWIDTH

65 + MultiplicativeExpr
  385,119: +
  385,121: 6

141 NUM
  385,121: 6

238 )
  385,122: )

210 CR_token2
  385,123: 


160 ID . ID ( Exprs )
  386,3: GraphicsWindow
  386,17: .
  386,18: DrawLine
  386,26: (
  386,27: XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 4, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 4
  386,127: )

184 . ID ( Exprs )
  386,17: .
  386,18: DrawLine
  386,26: (
  386,27: XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 4, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 4
  386,127: )

255 ID ( Exprs )
  386,18: DrawLine
  386,26: (
  386,27: XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 4, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 4
  386,127: )

221 ( Exprs )
  386,26: (
  386,27: XOFFSET - 4, YOFFSET + CHEIGHT*BWIDTH + 4, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 4
  386,127: )

27 ID
  386,27: XOFFSET

65 - MultiplicativeExpr
  386,35: -
  386,37: 4

141 NUM
  386,37: 4

217 , MoreThanOneExpr
  386,38: ,
  386,40: YOFFSET + CHEIGHT*BWIDTH + 4, XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 4

54 ID
  386,40: YOFFSET

65 + MultiplicativeExpr
  386,48: +
  386,50: CHEIGHT*BWIDTH

141 ID
  386,50: CHEIGHT

30 * UnaryExpr
  386,57: *
  386,58: BWIDTH

156 ID
  386,58: BWIDTH

65 + MultiplicativeExpr
  386,65: +
  386,67: 4

141 NUM
  386,67: 4

217 , MoreThanOneExpr
  386,68: ,
  386,70: XOFFSET + CWIDTH*BWIDTH + 4, YOFFSET + CHEIGHT*BWIDTH + 4

54 ID
  386,70: XOFFSET

65 + MultiplicativeExpr
  386,78: +
  386,80: CWIDTH*BWIDTH

141 ID
  386,80: CWIDTH

30 * UnaryExpr
  386,86: *
  386,87: BWIDTH

156 ID
  386,87: BWIDTH

65 + MultiplicativeExpr
  386,94: +
  386,96: 4

141 NUM
  386,96: 4

217 , MoreThanOneExpr
  386,97: ,
  386,99: YOFFSET + CHEIGHT*BWIDTH + 4

54 ID
  386,99: YOFFSET

65 + MultiplicativeExpr
  386,107: +
  386,109: CHEIGHT*BWIDTH

141 ID
  386,109: CHEIGHT

30 * UnaryExpr
  386,116: *
  386,117: BWIDTH

156 ID
  386,117: BWIDTH

65 + MultiplicativeExpr
  386,124: +
  386,126: 4

141 NUM
  386,126: 4

238 )
  386,127: )

210 CR_token2
  386,128: 



160 ID . ID = Expr
  388,3: GraphicsWindow
  388,17: .
  388,18: PenColor
  388,27: =
  388,29: "Black"

184 . ID = Expr
  388,17: .
  388,18: PenColor
  388,27: =
  388,29: "Black"

255 ID = Expr
  388,18: PenColor
  388,27: =
  388,29: "Black"

221 = Expr
  388,27: =
  388,29: "Black"

57 STR
  388,29: "Black"

43 CR_token2
  388,36: 


160 ID . ID = Expr
  389,3: GraphicsWindow
  389,17: .
  389,18: BrushColor
  389,29: =
  389,31: "Pink"

184 . ID = Expr
  389,17: .
  389,18: BrushColor
  389,29: =
  389,31: "Pink"

255 ID = Expr
  389,18: BrushColor
  389,29: =
  389,31: "Pink"

221 = Expr
  389,29: =
  389,31: "Pink"

57 STR
  389,31: "Pink"

43 CR_token2
  389,37: 


160 ID = Expr
  390,3: x
  390,5: =
  390,7: XOFFSET + PREVIEW_xpos * BWIDTH - BWIDTH

184 = Expr
  390,5: =
  390,7: XOFFSET + PREVIEW_xpos * BWIDTH - BWIDTH

70 ID
  390,7: XOFFSET

59 + MultiplicativeExpr
  390,15: +
  390,17: PREVIEW_xpos * BWIDTH

144 ID
  390,17: PREVIEW_xpos

40 * UnaryExpr
  390,30: *
  390,32: BWIDTH

157 ID
  390,32: BWIDTH

59 - MultiplicativeExpr
  390,39: -
  390,41: BWIDTH

144 ID
  390,41: BWIDTH

5 CR_token2
  390,47: 


160 ID = Expr
  391,3: y
  391,5: =
  391,7: YOFFSET + PREVIEW_ypos * BWIDTH - BWIDTH

184 = Expr
  391,5: =
  391,7: YOFFSET + PREVIEW_ypos * BWIDTH - BWIDTH

70 ID
  391,7: YOFFSET

59 + MultiplicativeExpr
  391,15: +
  391,17: PREVIEW_ypos * BWIDTH

144 ID
  391,17: PREVIEW_ypos

40 * UnaryExpr
  391,30: *
  391,32: BWIDTH

157 ID
  391,32: BWIDTH

59 - MultiplicativeExpr
  391,39: -
  391,41: BWIDTH

144 ID
  391,41: BWIDTH

5 CR_token2
  391,47: 


160 ID . ID ( Exprs )
  392,3: GraphicsWindow
  392,17: .
  392,18: FillRectangle
  392,31: (
  392,32: x, y, BWIDTH * 5, BWIDTH * 6
  392,60: )

184 . ID ( Exprs )
  392,17: .
  392,18: FillRectangle
  392,31: (
  392,32: x, y, BWIDTH * 5, BWIDTH * 6
  392,60: )

255 ID ( Exprs )
  392,18: FillRectangle
  392,31: (
  392,32: x, y, BWIDTH * 5, BWIDTH * 6
  392,60: )

221 ( Exprs )
  392,31: (
  392,32: x, y, BWIDTH * 5, BWIDTH * 6
  392,60: )

27 ID
  392,32: x

217 , MoreThanOneExpr
  392,33: ,
  392,35: y, BWIDTH * 5, BWIDTH * 6

54 ID
  392,35: y

217 , MoreThanOneExpr
  392,36: ,
  392,38: BWIDTH * 5, BWIDTH * 6

54 ID
  392,38: BWIDTH

50 * UnaryExpr
  392,45: *
  392,47: 5

156 NUM
  392,47: 5

217 , MoreThanOneExpr
  392,48: ,
  392,50: BWIDTH * 6

54 ID
  392,50: BWIDTH

50 * UnaryExpr
  392,57: *
  392,59: 6

156 NUM
  392,59: 6

238 )
  392,60: )

210 CR_token2
  392,61: 


160 ID . ID ( Exprs )
  393,3: GraphicsWindow
  393,17: .
  393,18: DrawRectangle
  393,31: (
  393,32: x, y, BWIDTH * 5, BWIDTH * 6
  393,60: )

184 . ID ( Exprs )
  393,17: .
  393,18: DrawRectangle
  393,31: (
  393,32: x, y, BWIDTH * 5, BWIDTH * 6
  393,60: )

255 ID ( Exprs )
  393,18: DrawRectangle
  393,31: (
  393,32: x, y, BWIDTH * 5, BWIDTH * 6
  393,60: )

221 ( Exprs )
  393,31: (
  393,32: x, y, BWIDTH * 5, BWIDTH * 6
  393,60: )

27 ID
  393,32: x

217 , MoreThanOneExpr
  393,33: ,
  393,35: y, BWIDTH * 5, BWIDTH * 6

54 ID
  393,35: y

217 , MoreThanOneExpr
  393,36: ,
  393,38: BWIDTH * 5, BWIDTH * 6

54 ID
  393,38: BWIDTH

50 * UnaryExpr
  393,45: *
  393,47: 5

156 NUM
  393,47: 5

217 , MoreThanOneExpr
  393,48: ,
  393,50: BWIDTH * 6

54 ID
  393,50: BWIDTH

50 * UnaryExpr
  393,57: *
  393,59: 6

156 NUM
  393,59: 6

238 )
  393,60: )

210 CR_token2
  393,61: 



160 ID . ID ( Exprs )
  395,3: GraphicsWindow
  395,17: .
  395,18: FillRectangle
  395,31: (
  395,32: x - 20, y + 190, 310, 170
  395,57: )

184 . ID ( Exprs )
  395,17: .
  395,18: FillRectangle
  395,31: (
  395,32: x - 20, y + 190, 310, 170
  395,57: )

255 ID ( Exprs )
  395,18: FillRectangle
  395,31: (
  395,32: x - 20, y + 190, 310, 170
  395,57: )

221 ( Exprs )
  395,31: (
  395,32: x - 20, y + 190, 310, 170
  395,57: )

27 ID
  395,32: x

65 - MultiplicativeExpr
  395,34: -
  395,36: 20

141 NUM
  395,36: 20

217 , MoreThanOneExpr
  395,38: ,
  395,40: y + 190, 310, 170

54 ID
  395,40: y

65 + MultiplicativeExpr
  395,42: +
  395,44: 190

141 NUM
  395,44: 190

217 , MoreThanOneExpr
  395,47: ,
  395,49: 310, 170

54 NUM
  395,49: 310

217 , MoreThanOneExpr
  395,52: ,
  395,54: 170

54 NUM
  395,54: 170

238 )
  395,57: )

210 CR_token2
  395,58: 


160 ID . ID ( Exprs )
  396,3: GraphicsWindow
  396,17: .
  396,18: DrawRectangle
  396,31: (
  396,32: x - 20, y + 190, 310, 170
  396,57: )

184 . ID ( Exprs )
  396,17: .
  396,18: DrawRectangle
  396,31: (
  396,32: x - 20, y + 190, 310, 170
  396,57: )

255 ID ( Exprs )
  396,18: DrawRectangle
  396,31: (
  396,32: x - 20, y + 190, 310, 170
  396,57: )

221 ( Exprs )
  396,31: (
  396,32: x - 20, y + 190, 310, 170
  396,57: )

27 ID
  396,32: x

65 - MultiplicativeExpr
  396,34: -
  396,36: 20

141 NUM
  396,36: 20

217 , MoreThanOneExpr
  396,38: ,
  396,40: y + 190, 310, 170

54 ID
  396,40: y

65 + MultiplicativeExpr
  396,42: +
  396,44: 190

141 NUM
  396,44: 190

217 , MoreThanOneExpr
  396,47: ,
  396,49: 310, 170

54 NUM
  396,49: 310

217 , MoreThanOneExpr
  396,52: ,
  396,54: 170

54 NUM
  396,54: 170

238 )
  396,57: )

210 CR_token2
  396,58: 



160 ID . ID = Expr
  398,3: GraphicsWindow
  398,17: .
  398,18: BrushColor
  398,29: =
  398,31: "Black"

184 . ID = Expr
  398,17: .
  398,18: BrushColor
  398,29: =
  398,31: "Black"

255 ID = Expr
  398,18: BrushColor
  398,29: =
  398,31: "Black"

221 = Expr
  398,29: =
  398,31: "Black"

57 STR
  398,31: "Black"

43 CR_token2
  398,38: 


160 ID . ID = Expr
  399,3: GraphicsWindow
  399,17: .
  399,18: FontItalic
  399,29: =
  399,31: "False"

184 . ID = Expr
  399,17: .
  399,18: FontItalic
  399,29: =
  399,31: "False"

255 ID = Expr
  399,18: FontItalic
  399,29: =
  399,31: "False"

221 = Expr
  399,29: =
  399,31: "False"

57 STR
  399,31: "False"

43 CR_token2
  399,38: 


160 ID . ID = Expr
  400,3: GraphicsWindow
  400,17: .
  400,18: FontName
  400,27: =
  400,29: "Comic Sans MS"

184 . ID = Expr
  400,17: .
  400,18: FontName
  400,27: =
  400,29: "Comic Sans MS"

255 ID = Expr
  400,18: FontName
  400,27: =
  400,29: "Comic Sans MS"

221 = Expr
  400,27: =
  400,29: "Comic Sans MS"

57 STR
  400,29: "Comic Sans MS"

43 CR_token2
  400,44: 


160 ID . ID = Expr
  401,3: GraphicsWindow
  401,17: .
  401,18: FontSize
  401,27: =
  401,29: 16

184 . ID = Expr
  401,17: .
  401,18: FontSize
  401,27: =
  401,29: 16

255 ID = Expr
  401,18: FontSize
  401,27: =
  401,29: 16

221 = Expr
  401,27: =
  401,29: 16

57 NUM
  401,29: 16

43 CR_token2
  401,31: 


160 ID . ID ( Exprs )
  402,3: GraphicsWindow
  402,17: .
  402,18: DrawText
  402,26: (
  402,27: x, y + 200, "Game control keys:"
  402,59: )

184 . ID ( Exprs )
  402,17: .
  402,18: DrawText
  402,26: (
  402,27: x, y + 200, "Game control keys:"
  402,59: )

255 ID ( Exprs )
  402,18: DrawText
  402,26: (
  402,27: x, y + 200, "Game control keys:"
  402,59: )

221 ( Exprs )
  402,26: (
  402,27: x, y + 200, "Game control keys:"
  402,59: )

27 ID
  402,27: x

217 , MoreThanOneExpr
  402,28: ,
  402,30: y + 200, "Game control keys:"

54 ID
  402,30: y

65 + MultiplicativeExpr
  402,32: +
  402,34: 200

141 NUM
  402,34: 200

217 , MoreThanOneExpr
  402,37: ,
  402,39: "Game control keys:"

54 STR
  402,39: "Game control keys:"

238 )
  402,59: )

210 CR_token2
  402,60: 


160 ID . ID ( Exprs )
  403,3: GraphicsWindow
  403,17: .
  403,18: DrawText
  403,26: (
  403,27: x + 25, y + 220, "Left Arrow = Move piece left"
  403,74: )

184 . ID ( Exprs )
  403,17: .
  403,18: DrawText
  403,26: (
  403,27: x + 25, y + 220, "Left Arrow = Move piece left"
  403,74: )

255 ID ( Exprs )
  403,18: DrawText
  403,26: (
  403,27: x + 25, y + 220, "Left Arrow = Move piece left"
  403,74: )

221 ( Exprs )
  403,26: (
  403,27: x + 25, y + 220, "Left Arrow = Move piece left"
  403,74: )

27 ID
  403,27: x

65 + MultiplicativeExpr
  403,29: +
  403,31: 25

141 NUM
  403,31: 25

217 , MoreThanOneExpr
  403,33: ,
  403,35: y + 220, "Left Arrow = Move piece left"

54 ID
  403,35: y

65 + MultiplicativeExpr
  403,37: +
  403,39: 220

141 NUM
  403,39: 220

217 , MoreThanOneExpr
  403,42: ,
  403,44: "Left Arrow = Move piece left"

54 STR
  403,44: "Left Arrow = Move piece left"

238 )
  403,74: )

210 CR_token2
  403,75: 


160 ID . ID ( Exprs )
  404,3: GraphicsWindow
  404,17: .
  404,18: DrawText
  404,26: (
  404,27: x + 25, y + 240, "Right Arrow = Move piece right"
  404,76: )

184 . ID ( Exprs )
  404,17: .
  404,18: DrawText
  404,26: (
  404,27: x + 25, y + 240, "Right Arrow = Move piece right"
  404,76: )

255 ID ( Exprs )
  404,18: DrawText
  404,26: (
  404,27: x + 25, y + 240, "Right Arrow = Move piece right"
  404,76: )

221 ( Exprs )
  404,26: (
  404,27: x + 25, y + 240, "Right Arrow = Move piece right"
  404,76: )

27 ID
  404,27: x

65 + MultiplicativeExpr
  404,29: +
  404,31: 25

141 NUM
  404,31: 25

217 , MoreThanOneExpr
  404,33: ,
  404,35: y + 240, "Right Arrow = Move piece right"

54 ID
  404,35: y

65 + MultiplicativeExpr
  404,37: +
  404,39: 240

141 NUM
  404,39: 240

217 , MoreThanOneExpr
  404,42: ,
  404,44: "Right Arrow = Move piece right"

54 STR
  404,44: "Right Arrow = Move piece right"

238 )
  404,76: )

210 CR_token2
  404,77: 


160 ID . ID ( Exprs )
  405,3: GraphicsWindow
  405,17: .
  405,18: DrawText
  405,26: (
  405,27: x + 25, y + 260, "Up Arrow = Rotate piece"
  405,69: )

184 . ID ( Exprs )
  405,17: .
  405,18: DrawText
  405,26: (
  405,27: x + 25, y + 260, "Up Arrow = Rotate piece"
  405,69: )

255 ID ( Exprs )
  405,18: DrawText
  405,26: (
  405,27: x + 25, y + 260, "Up Arrow = Rotate piece"
  405,69: )

221 ( Exprs )
  405,26: (
  405,27: x + 25, y + 260, "Up Arrow = Rotate piece"
  405,69: )

27 ID
  405,27: x

65 + MultiplicativeExpr
  405,29: +
  405,31: 25

141 NUM
  405,31: 25

217 , MoreThanOneExpr
  405,33: ,
  405,35: y + 260, "Up Arrow = Rotate piece"

54 ID
  405,35: y

65 + MultiplicativeExpr
  405,37: +
  405,39: 260

141 NUM
  405,39: 260

217 , MoreThanOneExpr
  405,42: ,
  405,44: "Up Arrow = Rotate piece"

54 STR
  405,44: "Up Arrow = Rotate piece"

238 )
  405,69: )

210 CR_token2
  405,70: 


160 ID . ID ( Exprs )
  406,3: GraphicsWindow
  406,17: .
  406,18: DrawText
  406,26: (
  406,27: x + 25, y + 280, "Down Arrow = Drop piece"
  406,69: )

184 . ID ( Exprs )
  406,17: .
  406,18: DrawText
  406,26: (
  406,27: x + 25, y + 280, "Down Arrow = Drop piece"
  406,69: )

255 ID ( Exprs )
  406,18: DrawText
  406,26: (
  406,27: x + 25, y + 280, "Down Arrow = Drop piece"
  406,69: )

221 ( Exprs )
  406,26: (
  406,27: x + 25, y + 280, "Down Arrow = Drop piece"
  406,69: )

27 ID
  406,27: x

65 + MultiplicativeExpr
  406,29: +
  406,31: 25

141 NUM
  406,31: 25

217 , MoreThanOneExpr
  406,33: ,
  406,35: y + 280, "Down Arrow = Drop piece"

54 ID
  406,35: y

65 + MultiplicativeExpr
  406,37: +
  406,39: 280

141 NUM
  406,39: 280

217 , MoreThanOneExpr
  406,42: ,
  406,44: "Down Arrow = Drop piece"

54 STR
  406,44: "Down Arrow = Drop piece"

238 )
  406,69: )

210 CR_token2
  406,70: 


160 ID . ID ( Exprs )
  407,3: GraphicsWindow
  407,17: .
  407,18: DrawText
  407,26: (
  407,27: x, y + 320, "Press to stop game"
  407,59: )

184 . ID ( Exprs )
  407,17: .
  407,18: DrawText
  407,26: (
  407,27: x, y + 320, "Press to stop game"
  407,59: )

255 ID ( Exprs )
  407,18: DrawText
  407,26: (
  407,27: x, y + 320, "Press to stop game"
  407,59: )

221 ( Exprs )
  407,26: (
  407,27: x, y + 320, "Press to stop game"
  407,59: )

27 ID
  407,27: x

217 , MoreThanOneExpr
  407,28: ,
  407,30: y + 320, "Press to stop game"

54 ID
  407,30: y

65 + MultiplicativeExpr
  407,32: +
  407,34: 320

141 NUM
  407,34: 320

217 , MoreThanOneExpr
  407,37: ,
  407,39: "Press to stop game"

54 STR
  407,39: "Press to stop game"

238 )
  407,59: )

210 CR_token2
  407,60: 



160 ID . ID ( Exprs )
  409,3: Program
  409,10: .
  409,11: Delay
  409,16: (
  409,17: 200
  409,20: )

184 . ID ( Exprs )
  409,10: .
  409,11: Delay
  409,16: (
  409,17: 200
  409,20: )

255 ID ( Exprs )
  409,11: Delay
  409,16: (
  409,17: 200
  409,20: )

221 ( Exprs )
  409,16: (
  409,17: 200
  409,20: )

27 NUM
  409,17: 200

238 )
  409,20: )

206 Comment CR
  409,22: ' without this delay, the above text will use the fontsize of the score 
  409,94: 



210 CR_token2
  409,94: 



160 ID . ID = Expr
  411,3: GraphicsWindow
  411,17: .
  411,18: BrushColor
  411,29: =
  411,31: "Black"

184 . ID = Expr
  411,17: .
  411,18: BrushColor
  411,29: =
  411,31: "Black"

255 ID = Expr
  411,18: BrushColor
  411,29: =
  411,31: "Black"

221 = Expr
  411,29: =
  411,31: "Black"

57 STR
  411,31: "Black"

43 CR_token2
  411,38: 


160 ID . ID = Expr
  412,3: GraphicsWindow
  412,17: .
  412,18: FontName
  412,27: =
  412,29: "Georgia"

184 . ID = Expr
  412,17: .
  412,18: FontName
  412,27: =
  412,29: "Georgia"

255 ID = Expr
  412,18: FontName
  412,27: =
  412,29: "Georgia"

221 = Expr
  412,27: =
  412,29: "Georgia"

57 STR
  412,29: "Georgia"

43 CR_token2
  412,38: 


160 ID . ID = Expr
  413,3: GraphicsWindow
  413,17: .
  413,18: FontItalic
  413,29: =
  413,31: "True"

184 . ID = Expr
  413,17: .
  413,18: FontItalic
  413,29: =
  413,31: "True"

255 ID = Expr
  413,18: FontItalic
  413,29: =
  413,31: "True"

221 = Expr
  413,29: =
  413,31: "True"

57 STR
  413,31: "True"

43 CR_token2
  413,37: 


160 ID . ID = Expr
  414,3: GraphicsWindow
  414,17: .
  414,18: FontSize
  414,27: =
  414,29: 36

184 . ID = Expr
  414,17: .
  414,18: FontSize
  414,27: =
  414,29: 36

255 ID = Expr
  414,18: FontSize
  414,27: =
  414,29: 36

221 = Expr
  414,27: =
  414,29: 36

57 NUM
  414,29: 36

43 CR_token2
  414,31: 


160 ID . ID ( Exprs )
  415,3: GraphicsWindow
  415,17: .
  415,18: DrawText
  415,26: (
  415,27: x - 20, y + 400, "Small Basic Tetris"
  415,64: )

184 . ID ( Exprs )
  415,17: .
  415,18: DrawText
  415,26: (
  415,27: x - 20, y + 400, "Small Basic Tetris"
  415,64: )

255 ID ( Exprs )
  415,18: DrawText
  415,26: (
  415,27: x - 20, y + 400, "Small Basic Tetris"
  415,64: )

221 ( Exprs )
  415,26: (
  415,27: x - 20, y + 400, "Small Basic Tetris"
  415,64: )

27 ID
  415,27: x

65 - MultiplicativeExpr
  415,29: -
  415,31: 20

141 NUM
  415,31: 20

217 , MoreThanOneExpr
  415,33: ,
  415,35: y + 400, "Small Basic Tetris"

54 ID
  415,35: y

65 + MultiplicativeExpr
  415,37: +
  415,39: 400

141 NUM
  415,39: 400

217 , MoreThanOneExpr
  415,42: ,
  415,44: "Small Basic Tetris"

54 STR
  415,44: "Small Basic Tetris"

238 )
  415,64: )

210 CR_token2
  415,65: 


160 ID . ID ( Exprs )
  416,3: Program
  416,10: .
  416,11: Delay
  416,16: (
  416,17: 200
  416,20: )

184 . ID ( Exprs )
  416,10: .
  416,11: Delay
  416,16: (
  416,17: 200
  416,20: )

255 ID ( Exprs )
  416,11: Delay
  416,16: (
  416,17: 200
  416,20: )

221 ( Exprs )
  416,16: (
  416,17: 200
  416,20: )

27 NUM
  416,17: 200

238 )
  416,20: )

206 Comment CR
  416,22: ' without this delay, the above text will use the fontsize of the score 
  416,94: 


210 CR_token2
  416,94: 


160 ID . ID = Expr
  417,3: GraphicsWindow
  417,17: .
  417,18: FontSize
  417,27: =
  417,29: 16

184 . ID = Expr
  417,17: .
  417,18: FontSize
  417,27: =
  417,29: 16

255 ID = Expr
  417,18: FontSize
  417,27: =
  417,29: 16

221 = Expr
  417,27: =
  417,29: 16

57 NUM
  417,29: 16

43 CR_token2
  417,31: 


160 ID . ID ( Exprs )
  418,3: GraphicsWindow
  418,17: .
  418,18: DrawText
  418,26: (
  418,27: x - 20, y + 440, "ver.0.1"
  418,53: )

184 . ID ( Exprs )
  418,17: .
  418,18: DrawText
  418,26: (
  418,27: x - 20, y + 440, "ver.0.1"
  418,53: )

255 ID ( Exprs )
  418,18: DrawText
  418,26: (
  418,27: x - 20, y + 440, "ver.0.1"
  418,53: )

221 ( Exprs )
  418,26: (
  418,27: x - 20, y + 440, "ver.0.1"
  418,53: )

27 ID
  418,27: x

65 - MultiplicativeExpr
  418,29: -
  418,31: 20

141 NUM
  418,31: 20

217 , MoreThanOneExpr
  418,33: ,
  418,35: y + 440, "ver.0.1"

54 ID
  418,35: y

65 + MultiplicativeExpr
  418,37: +
  418,39: 440

141 NUM
  418,39: 440

217 , MoreThanOneExpr
  418,42: ,
  418,44: "ver.0.1"

54 STR
  418,44: "ver.0.1"

238 )
  418,53: )

210 CR_token2
  418,54: 



160 ID . ID ( Exprs )
  420,3: Program
  420,10: .
  420,11: Delay
  420,16: (
  420,17: 200
  420,20: )

184 . ID ( Exprs )
  420,10: .
  420,11: Delay
  420,16: (
  420,17: 200
  420,20: )

255 ID ( Exprs )
  420,11: Delay
  420,16: (
  420,17: 200
  420,20: )

221 ( Exprs )
  420,16: (
  420,17: 200
  420,20: )

27 NUM
  420,17: 200

238 )
  420,20: )

206 Comment CR
  420,22: ' without this delay, the above text will use the fontsize of the score 
  420,94: 


210 CR_token2
  420,94: 


160 ID = Expr
  421,3: score
  421,9: =
  421,11: 0

184 = Expr
  421,9: =
  421,11: 0

70 NUM
  421,11: 0

43 CR_token2
  421,12: 


160 ID ( )
  422,3: PrintScore
  422,13: (
  422,14: )

184 ( )
  422,13: (
  422,14: )

261 )
  422,14: )

215 CR_token2
  422,15: 


257 Stmt_token8
  423,1: EndSub

146 Stmt_token7 ID CRStmtCRs Stmt_token8
  426,1: Sub
  426,5: PrintScore
  426,15: 
  GraphicsWindow.PenWidth = 4
  GraphicsWindow.BrushColor = "Pink"
  GraphicsWindow.FillRectangle(500, 65, 153, 50)
  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.DrawRectangle(500, 65, 153, 50)
  GraphicsWindow.FontItalic = "False"
  GraphicsWindow.FontSize = 32
  GraphicsWindow.FontName = "Impact"
  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.DrawText(505, 70, Text.Append(Text.GetSubText( "00000000", 0, 8 - Text.GetLength( score ) ), score))

  437,1: EndSub

244 ID CRStmtCRs Stmt_token8
  426,5: PrintScore
  426,15: 
  GraphicsWindow.PenWidth = 4
  GraphicsWindow.BrushColor = "Pink"
  GraphicsWindow.FillRectangle(500, 65, 153, 50)
  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.DrawRectangle(500, 65, 153, 50)
  GraphicsWindow.FontItalic = "False"
  GraphicsWindow.FontSize = 32
  GraphicsWindow.FontName = "Impact"
  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.DrawText(505, 70, Text.Append(Text.GetSubText( "00000000", 0, 8 - Text.GetLength( score ) ), score))

  437,1: EndSub

199 CR_token2
  426,15: 


160 ID . ID = Expr
  427,3: GraphicsWindow
  427,17: .
  427,18: PenWidth
  427,27: =
  427,29: 4

184 . ID = Expr
  427,17: .
  427,18: PenWidth
  427,27: =
  427,29: 4

255 ID = Expr
  427,18: PenWidth
  427,27: =
  427,29: 4

221 = Expr
  427,27: =
  427,29: 4

57 NUM
  427,29: 4

43 CR_token2
  427,30: 


160 ID . ID = Expr
  428,3: GraphicsWindow
  428,17: .
  428,18: BrushColor
  428,29: =
  428,31: "Pink"

184 . ID = Expr
  428,17: .
  428,18: BrushColor
  428,29: =
  428,31: "Pink"

255 ID = Expr
  428,18: BrushColor
  428,29: =
  428,31: "Pink"

221 = Expr
  428,29: =
  428,31: "Pink"

57 STR
  428,31: "Pink"

43 CR_token2
  428,37: 


160 ID . ID ( Exprs )
  429,3: GraphicsWindow
  429,17: .
  429,18: FillRectangle
  429,31: (
  429,32: 500, 65, 153, 50
  429,48: )

184 . ID ( Exprs )
  429,17: .
  429,18: FillRectangle
  429,31: (
  429,32: 500, 65, 153, 50
  429,48: )

255 ID ( Exprs )
  429,18: FillRectangle
  429,31: (
  429,32: 500, 65, 153, 50
  429,48: )

221 ( Exprs )
  429,31: (
  429,32: 500, 65, 153, 50
  429,48: )

27 NUM
  429,32: 500

217 , MoreThanOneExpr
  429,35: ,
  429,37: 65, 153, 50

54 NUM
  429,37: 65

217 , MoreThanOneExpr
  429,39: ,
  429,41: 153, 50

54 NUM
  429,41: 153

217 , MoreThanOneExpr
  429,44: ,
  429,46: 50

54 NUM
  429,46: 50

238 )
  429,48: )

210 CR_token2
  429,49: 


160 ID . ID = Expr
  430,3: GraphicsWindow
  430,17: .
  430,18: BrushColor
  430,29: =
  430,31: "Black"

184 . ID = Expr
  430,17: .
  430,18: BrushColor
  430,29: =
  430,31: "Black"

255 ID = Expr
  430,18: BrushColor
  430,29: =
  430,31: "Black"

221 = Expr
  430,29: =
  430,31: "Black"

57 STR
  430,31: "Black"

43 CR_token2
  430,38: 


160 ID . ID ( Exprs )
  431,3: GraphicsWindow
  431,17: .
  431,18: DrawRectangle
  431,31: (
  431,32: 500, 65, 153, 50
  431,48: )

184 . ID ( Exprs )
  431,17: .
  431,18: DrawRectangle
  431,31: (
  431,32: 500, 65, 153, 50
  431,48: )

255 ID ( Exprs )
  431,18: DrawRectangle
  431,31: (
  431,32: 500, 65, 153, 50
  431,48: )

221 ( Exprs )
  431,31: (
  431,32: 500, 65, 153, 50
  431,48: )

27 NUM
  431,32: 500

217 , MoreThanOneExpr
  431,35: ,
  431,37: 65, 153, 50

54 NUM
  431,37: 65

217 , MoreThanOneExpr
  431,39: ,
  431,41: 153, 50

54 NUM
  431,41: 153

217 , MoreThanOneExpr
  431,44: ,
  431,46: 50

54 NUM
  431,46: 50

238 )
  431,48: )

210 CR_token2
  431,49: 


160 ID . ID = Expr
  432,3: GraphicsWindow
  432,17: .
  432,18: FontItalic
  432,29: =
  432,31: "False"

184 . ID = Expr
  432,17: .
  432,18: FontItalic
  432,29: =
  432,31: "False"

255 ID = Expr
  432,18: FontItalic
  432,29: =
  432,31: "False"

221 = Expr
  432,29: =
  432,31: "False"

57 STR
  432,31: "False"

43 CR_token2
  432,38: 


160 ID . ID = Expr
  433,3: GraphicsWindow
  433,17: .
  433,18: FontSize
  433,27: =
  433,29: 32

184 . ID = Expr
  433,17: .
  433,18: FontSize
  433,27: =
  433,29: 32

255 ID = Expr
  433,18: FontSize
  433,27: =
  433,29: 32

221 = Expr
  433,27: =
  433,29: 32

57 NUM
  433,29: 32

43 CR_token2
  433,31: 


160 ID . ID = Expr
  434,3: GraphicsWindow
  434,17: .
  434,18: FontName
  434,27: =
  434,29: "Impact"

184 . ID = Expr
  434,17: .
  434,18: FontName
  434,27: =
  434,29: "Impact"

255 ID = Expr
  434,18: FontName
  434,27: =
  434,29: "Impact"

221 = Expr
  434,27: =
  434,29: "Impact"

57 STR
  434,29: "Impact"

43 CR_token2
  434,37: 


160 ID . ID = Expr
  435,3: GraphicsWindow
  435,17: .
  435,18: BrushColor
  435,29: =
  435,31: "Black"

184 . ID = Expr
  435,17: .
  435,18: BrushColor
  435,29: =
  435,31: "Black"

255 ID = Expr
  435,18: BrushColor
  435,29: =
  435,31: "Black"

221 = Expr
  435,29: =
  435,31: "Black"

57 STR
  435,31: "Black"

43 CR_token2
  435,38: 


160 ID . ID ( Exprs )
  436,3: GraphicsWindow
  436,17: .
  436,18: DrawText
  436,26: (
  436,27: 505, 70, Text.Append(Text.GetSubText( "00000000", 0, 8 - Text.GetLength( score ) ), score)
  436,117: )

184 . ID ( Exprs )
  436,17: .
  436,18: DrawText
  436,26: (
  436,27: 505, 70, Text.Append(Text.GetSubText( "00000000", 0, 8 - Text.GetLength( score ) ), score)
  436,117: )

255 ID ( Exprs )
  436,18: DrawText
  436,26: (
  436,27: 505, 70, Text.Append(Text.GetSubText( "00000000", 0, 8 - Text.GetLength( score ) ), score)
  436,117: )

221 ( Exprs )
  436,26: (
  436,27: 505, 70, Text.Append(Text.GetSubText( "00000000", 0, 8 - Text.GetLength( score ) ), score)
  436,117: )

27 NUM
  436,27: 505

217 , MoreThanOneExpr
  436,30: ,
  436,32: 70, Text.Append(Text.GetSubText( "00000000", 0, 8 - Text.GetLength( score ) ), score)

54 NUM
  436,32: 70

217 , MoreThanOneExpr
  436,34: ,
  436,36: Text.Append(Text.GetSubText( "00000000", 0, 8 - Text.GetLength( score ) ), score)

54 ID . ID ( Exprs )
  436,36: Text
  436,40: .
  436,41: Append
  436,47: (
  436,48: Text.GetSubText( "00000000", 0, 8 - Text.GetLength( score ) ), score
  436,116: )

4 . ID ( Exprs )
  436,40: .
  436,41: Append
  436,47: (
  436,48: Text.GetSubText( "00000000", 0, 8 - Text.GetLength( score ) ), score
  436,116: )

248 ID ( Exprs )
  436,41: Append
  436,47: (
  436,48: Text.GetSubText( "00000000", 0, 8 - Text.GetLength( score ) ), score
  436,116: )

23 ( Exprs )
  436,47: (
  436,48: Text.GetSubText( "00000000", 0, 8 - Text.GetLength( score ) ), score
  436,116: )

22 ID . ID ( Exprs )
  436,48: Text
  436,52: .
  436,53: GetSubText
  436,63: (
  436,65: "00000000", 0, 8 - Text.GetLength( score )
  436,108: )

4 . ID ( Exprs )
  436,52: .
  436,53: GetSubText
  436,63: (
  436,65: "00000000", 0, 8 - Text.GetLength( score )
  436,108: )

248 ID ( Exprs )
  436,53: GetSubText
  436,63: (
  436,65: "00000000", 0, 8 - Text.GetLength( score )
  436,108: )

23 ( Exprs )
  436,63: (
  436,65: "00000000", 0, 8 - Text.GetLength( score )
  436,108: )

22 STR
  436,65: "00000000"

217 , MoreThanOneExpr
  436,75: ,
  436,77: 0, 8 - Text.GetLength( score )

54 NUM
  436,77: 0

217 , MoreThanOneExpr
  436,78: ,
  436,80: 8 - Text.GetLength( score )

54 NUM
  436,80: 8

65 - MultiplicativeExpr
  436,82: -
  436,84: Text.GetLength( score )

141 ID . ID ( Exprs )
  436,84: Text
  436,88: .
  436,89: GetLength
  436,98: (
  436,100: score
  436,106: )

4 . ID ( Exprs )
  436,88: .
  436,89: GetLength
  436,98: (
  436,100: score
  436,106: )

248 ID ( Exprs )
  436,89: GetLength
  436,98: (
  436,100: score
  436,106: )

23 ( Exprs )
  436,98: (
  436,100: score
  436,106: )

22 ID
  436,100: score

239 )
  436,106: )

239 )
  436,108: )

217 , MoreThanOneExpr
  436,109: ,
  436,111: score

54 ID
  436,111: score

239 )
  436,116: )

238 )
  436,117: )

210 CR_token2
  436,118: 


257 Stmt_token8
  437,1: EndSub

146 Stmt_token7 ID CRStmtCRs Stmt_token8
  440,1: Sub
  440,5: SetupTemplates
  440,19: 
  ' each piece has 4 boxes.
  ' the index of each entry within a piece represents the box number (1-4)
  ' the value of each entry represents to box zero-based box coordinate within the piece: tens place is x, ones place y

  '_X_
  '_X_
  '_XX

  Array.SetValue("template1", 0, 10)
  Array.SetValue("template1", 1, 11)
  Array.SetValue("template1", 2, 12)
  Array.SetValue("template1", 3, 22)
  Array.SetValue("template1", "color", "Yellow")
  Array.SetValue("template1", "dim", 3)
  Array.SetValue("template1", "pviewx", -12)
  Array.SetValue("template1", "pviewy", 12)


  '_X_
  '_X_
  'XX_
  Array.SetValue("template2", 0, 10)
  Array.SetValue("template2", 1, 11)
  Array.SetValue("template2", 2, 12)
  Array.SetValue("template2", 3, 02)
  Array.SetValue("template2", "color", "Magenta")
  Array.SetValue("template2", "dim", 3)
  Array.SetValue("template2", "pviewx", 12)
  Array.SetValue("template2", "pviewy", 12)


  '_X_
  'XXX
  '_
  Array.SetValue("template3", 0, 10)
  Array.SetValue("template3", 1, 01)
  Array.SetValue("template3", 2, 11)
  Array.SetValue("template3", 3, 21)
  Array.SetValue("template3", "color", "Gray")
  Array.SetValue("template3", "dim", 3)
  Array.SetValue("template3", "pviewx", 0)
  Array.SetValue("template3", "pviewy", 25)


  'XX_
  'XX_
  '_
  Array.SetValue("template4", 0, 00)
  Array.SetValue("template4", 1, 10)
  Array.SetValue("template4", 2, 01)
  Array.SetValue("template4", 3, 11)
  Array.SetValue("template4", "color", "Cyan")
  Array.SetValue("template4", "dim", 2)
  Array.SetValue("template4", "pviewx", 12)
  Array.SetValue("template4", "pviewy", 25)


  'XX_
  '_XX
  '_
  Array.SetValue("template5", 0, 00)
  Array.SetValue("template5", 1, 10)
  Array.SetValue("template5", 2, 11)
  Array.SetValue("template5", 3, 21)
  Array.SetValue("template5", "color", "Green")
  Array.SetValue("template5", "dim", 3)
  Array.SetValue("template5", "pviewx", 0)
  Array.SetValue("template5", "pviewy", 25)


  '_XX
  'XX_
  '_
  Array.SetValue("template6", 0, 10)
  Array.SetValue("template6", 1, 20)
  Array.SetValue("template6", 2, 01)
  Array.SetValue("template6", 3, 11)
  Array.SetValue("template6", "color", "Blue")
  Array.SetValue("template6", "dim", 3)
  Array.SetValue("template6", "pviewx", 0)
  Array.SetValue("template6", "pviewy", 25)


  '_X
  '_X
  '_X
  '_X
  Array.SetValue("template7", 0, 10)
  Array.SetValue("template7", 1, 11)
  Array.SetValue("template7", 2, 12)
  Array.SetValue("template7", 3, 13)
  Array.SetValue("template7", "color", "Red")
  Array.SetValue("template7", "dim", 4)
  Array.SetValue("template7", "pviewx", 0)
  Array.SetValue("template7", "pviewy", 0)

  536,1: EndSub

244 ID CRStmtCRs Stmt_token8
  440,5: SetupTemplates
  440,19: 
  ' each piece has 4 boxes.
  ' the index of each entry within a piece represents the box number (1-4)
  ' the value of each entry represents to box zero-based box coordinate within the piece: tens place is x, ones place y

  '_X_
  '_X_
  '_XX

  Array.SetValue("template1", 0, 10)
  Array.SetValue("template1", 1, 11)
  Array.SetValue("template1", 2, 12)
  Array.SetValue("template1", 3, 22)
  Array.SetValue("template1", "color", "Yellow")
  Array.SetValue("template1", "dim", 3)
  Array.SetValue("template1", "pviewx", -12)
  Array.SetValue("template1", "pviewy", 12)


  '_X_
  '_X_
  'XX_
  Array.SetValue("template2", 0, 10)
  Array.SetValue("template2", 1, 11)
  Array.SetValue("template2", 2, 12)
  Array.SetValue("template2", 3, 02)
  Array.SetValue("template2", "color", "Magenta")
  Array.SetValue("template2", "dim", 3)
  Array.SetValue("template2", "pviewx", 12)
  Array.SetValue("template2", "pviewy", 12)


  '_X_
  'XXX
  '_
  Array.SetValue("template3", 0, 10)
  Array.SetValue("template3", 1, 01)
  Array.SetValue("template3", 2, 11)
  Array.SetValue("template3", 3, 21)
  Array.SetValue("template3", "color", "Gray")
  Array.SetValue("template3", "dim", 3)
  Array.SetValue("template3", "pviewx", 0)
  Array.SetValue("template3", "pviewy", 25)


  'XX_
  'XX_
  '_
  Array.SetValue("template4", 0, 00)
  Array.SetValue("template4", 1, 10)
  Array.SetValue("template4", 2, 01)
  Array.SetValue("template4", 3, 11)
  Array.SetValue("template4", "color", "Cyan")
  Array.SetValue("template4", "dim", 2)
  Array.SetValue("template4", "pviewx", 12)
  Array.SetValue("template4", "pviewy", 25)


  'XX_
  '_XX
  '_
  Array.SetValue("template5", 0, 00)
  Array.SetValue("template5", 1, 10)
  Array.SetValue("template5", 2, 11)
  Array.SetValue("template5", 3, 21)
  Array.SetValue("template5", "color", "Green")
  Array.SetValue("template5", "dim", 3)
  Array.SetValue("template5", "pviewx", 0)
  Array.SetValue("template5", "pviewy", 25)


  '_XX
  'XX_
  '_
  Array.SetValue("template6", 0, 10)
  Array.SetValue("template6", 1, 20)
  Array.SetValue("template6", 2, 01)
  Array.SetValue("template6", 3, 11)
  Array.SetValue("template6", "color", "Blue")
  Array.SetValue("template6", "dim", 3)
  Array.SetValue("template6", "pviewx", 0)
  Array.SetValue("template6", "pviewy", 25)


  '_X
  '_X
  '_X
  '_X
  Array.SetValue("template7", 0, 10)
  Array.SetValue("template7", 1, 11)
  Array.SetValue("template7", 2, 12)
  Array.SetValue("template7", 3, 13)
  Array.SetValue("template7", "color", "Red")
  Array.SetValue("template7", "dim", 4)
  Array.SetValue("template7", "pviewx", 0)
  Array.SetValue("template7", "pviewy", 0)

  536,1: EndSub

199 CR_token2
  440,19: 


105 Comment Comment Comment Comment Comment Comment CRStmtCRs_repeat1
  441,3: ' each piece has 4 boxes.
  442,3: ' the index of each entry within a piece represents the box number (1-4)
  443,3: ' the value of each entry represents to box zero-based box coordinate within the piece: tens place is x, ones place y
  445,3: '_X_
  446,3: '_X_
  447,3: '_XX
  449,3: Array.SetValue("template1", 0, 10)
  Array.SetValue("template1", 1, 11)
  Array.SetValue("template1", 2, 12)
  Array.SetValue("template1", 3, 22)
  Array.SetValue("template1", "color", "Yellow")
  Array.SetValue("template1", "dim", 3)
  Array.SetValue("template1", "pviewx", -12)
  Array.SetValue("template1", "pviewy", 12)


  '_X_
  '_X_
  'XX_
  Array.SetValue("template2", 0, 10)
  Array.SetValue("template2", 1, 11)
  Array.SetValue("template2", 2, 12)
  Array.SetValue("template2", 3, 02)
  Array.SetValue("template2", "color", "Magenta")
  Array.SetValue("template2", "dim", 3)
  Array.SetValue("template2", "pviewx", 12)
  Array.SetValue("template2", "pviewy", 12)


  '_X_
  'XXX
  '_
  Array.SetValue("template3", 0, 10)
  Array.SetValue("template3", 1, 01)
  Array.SetValue("template3", 2, 11)
  Array.SetValue("template3", 3, 21)
  Array.SetValue("template3", "color", "Gray")
  Array.SetValue("template3", "dim", 3)
  Array.SetValue("template3", "pviewx", 0)
  Array.SetValue("template3", "pviewy", 25)


  'XX_
  'XX_
  '_
  Array.SetValue("template4", 0, 00)
  Array.SetValue("template4", 1, 10)
  Array.SetValue("template4", 2, 01)
  Array.SetValue("template4", 3, 11)
  Array.SetValue("template4", "color", "Cyan")
  Array.SetValue("template4", "dim", 2)
  Array.SetValue("template4", "pviewx", 12)
  Array.SetValue("template4", "pviewy", 25)


  'XX_
  '_XX
  '_
  Array.SetValue("template5", 0, 00)
  Array.SetValue("template5", 1, 10)
  Array.SetValue("template5", 2, 11)
  Array.SetValue("template5", 3, 21)
  Array.SetValue("template5", "color", "Green")
  Array.SetValue("template5", "dim", 3)
  Array.SetValue("template5", "pviewx", 0)
  Array.SetValue("template5", "pviewy", 25)


  '_XX
  'XX_
  '_
  Array.SetValue("template6", 0, 10)
  Array.SetValue("template6", 1, 20)
  Array.SetValue("template6", 2, 01)
  Array.SetValue("template6", 3, 11)
  Array.SetValue("template6", "color", "Blue")
  Array.SetValue("template6", "dim", 3)
  Array.SetValue("template6", "pviewx", 0)
  Array.SetValue("template6", "pviewy", 25)


  '_X
  '_X
  '_X
  '_X
  Array.SetValue("template7", 0, 10)
  Array.SetValue("template7", 1, 11)
  Array.SetValue("template7", 2, 12)
  Array.SetValue("template7", 3, 13)
  Array.SetValue("template7", "color", "Red")
  Array.SetValue("template7", "dim", 4)
  Array.SetValue("template7", "pviewx", 0)
  Array.SetValue("template7", "pviewy", 0)


105 Comment Comment Comment Comment Comment CRStmtCRs_repeat1
  442,3: ' the index of each entry within a piece represents the box number (1-4)
  443,3: ' the value of each entry represents to box zero-based box coordinate within the piece: tens place is x, ones place y
  445,3: '_X_
  446,3: '_X_
  447,3: '_XX
  449,3: Array.SetValue("template1", 0, 10)
  Array.SetValue("template1", 1, 11)
  Array.SetValue("template1", 2, 12)
  Array.SetValue("template1", 3, 22)
  Array.SetValue("template1", "color", "Yellow")
  Array.SetValue("template1", "dim", 3)
  Array.SetValue("template1", "pviewx", -12)
  Array.SetValue("template1", "pviewy", 12)


  '_X_
  '_X_
  'XX_
  Array.SetValue("template2", 0, 10)
  Array.SetValue("template2", 1, 11)
  Array.SetValue("template2", 2, 12)
  Array.SetValue("template2", 3, 02)
  Array.SetValue("template2", "color", "Magenta")
  Array.SetValue("template2", "dim", 3)
  Array.SetValue("template2", "pviewx", 12)
  Array.SetValue("template2", "pviewy", 12)


  '_X_
  'XXX
  '_
  Array.SetValue("template3", 0, 10)
  Array.SetValue("template3", 1, 01)
  Array.SetValue("template3", 2, 11)
  Array.SetValue("template3", 3, 21)
  Array.SetValue("template3", "color", "Gray")
  Array.SetValue("template3", "dim", 3)
  Array.SetValue("template3", "pviewx", 0)
  Array.SetValue("template3", "pviewy", 25)


  'XX_
  'XX_
  '_
  Array.SetValue("template4", 0, 00)
  Array.SetValue("template4", 1, 10)
  Array.SetValue("template4", 2, 01)
  Array.SetValue("template4", 3, 11)
  Array.SetValue("template4", "color", "Cyan")
  Array.SetValue("template4", "dim", 2)
  Array.SetValue("template4", "pviewx", 12)
  Array.SetValue("template4", "pviewy", 25)


  'XX_
  '_XX
  '_
  Array.SetValue("template5", 0, 00)
  Array.SetValue("template5", 1, 10)
  Array.SetValue("template5", 2, 11)
  Array.SetValue("template5", 3, 21)
  Array.SetValue("template5", "color", "Green")
  Array.SetValue("template5", "dim", 3)
  Array.SetValue("template5", "pviewx", 0)
  Array.SetValue("template5", "pviewy", 25)


  '_XX
  'XX_
  '_
  Array.SetValue("template6", 0, 10)
  Array.SetValue("template6", 1, 20)
  Array.SetValue("template6", 2, 01)
  Array.SetValue("template6", 3, 11)
  Array.SetValue("template6", "color", "Blue")
  Array.SetValue("template6", "dim", 3)
  Array.SetValue("template6", "pviewx", 0)
  Array.SetValue("template6", "pviewy", 25)


  '_X
  '_X
  '_X
  '_X
  Array.SetValue("template7", 0, 10)
  Array.SetValue("template7", 1, 11)
  Array.SetValue("template7", 2, 12)
  Array.SetValue("template7", 3, 13)
  Array.SetValue("template7", "color", "Red")
  Array.SetValue("template7", "dim", 4)
  Array.SetValue("template7", "pviewx", 0)
  Array.SetValue("template7", "pviewy", 0)


105 Comment Comment Comment Comment CRStmtCRs_repeat1
  443,3: ' the value of each entry represents to box zero-based box coordinate within the piece: tens place is x, ones place y
  445,3: '_X_
  446,3: '_X_
  447,3: '_XX
  449,3: Array.SetValue("template1", 0, 10)
  Array.SetValue("template1", 1, 11)
  Array.SetValue("template1", 2, 12)
  Array.SetValue("template1", 3, 22)
  Array.SetValue("template1", "color", "Yellow")
  Array.SetValue("template1", "dim", 3)
  Array.SetValue("template1", "pviewx", -12)
  Array.SetValue("template1", "pviewy", 12)


  '_X_
  '_X_
  'XX_
  Array.SetValue("template2", 0, 10)
  Array.SetValue("template2", 1, 11)
  Array.SetValue("template2", 2, 12)
  Array.SetValue("template2", 3, 02)
  Array.SetValue("template2", "color", "Magenta")
  Array.SetValue("template2", "dim", 3)
  Array.SetValue("template2", "pviewx", 12)
  Array.SetValue("template2", "pviewy", 12)


  '_X_
  'XXX
  '_
  Array.SetValue("template3", 0, 10)
  Array.SetValue("template3", 1, 01)
  Array.SetValue("template3", 2, 11)
  Array.SetValue("template3", 3, 21)
  Array.SetValue("template3", "color", "Gray")
  Array.SetValue("template3", "dim", 3)
  Array.SetValue("template3", "pviewx", 0)
  Array.SetValue("template3", "pviewy", 25)


  'XX_
  'XX_
  '_
  Array.SetValue("template4", 0, 00)
  Array.SetValue("template4", 1, 10)
  Array.SetValue("template4", 2, 01)
  Array.SetValue("template4", 3, 11)
  Array.SetValue("template4", "color", "Cyan")
  Array.SetValue("template4", "dim", 2)
  Array.SetValue("template4", "pviewx", 12)
  Array.SetValue("template4", "pviewy", 25)


  'XX_
  '_XX
  '_
  Array.SetValue("template5", 0, 00)
  Array.SetValue("template5", 1, 10)
  Array.SetValue("template5", 2, 11)
  Array.SetValue("template5", 3, 21)
  Array.SetValue("template5", "color", "Green")
  Array.SetValue("template5", "dim", 3)
  Array.SetValue("template5", "pviewx", 0)
  Array.SetValue("template5", "pviewy", 25)


  '_XX
  'XX_
  '_
  Array.SetValue("template6", 0, 10)
  Array.SetValue("template6", 1, 20)
  Array.SetValue("template6", 2, 01)
  Array.SetValue("template6", 3, 11)
  Array.SetValue("template6", "color", "Blue")
  Array.SetValue("template6", "dim", 3)
  Array.SetValue("template6", "pviewx", 0)
  Array.SetValue("template6", "pviewy", 25)


  '_X
  '_X
  '_X
  '_X
  Array.SetValue("template7", 0, 10)
  Array.SetValue("template7", 1, 11)
  Array.SetValue("template7", 2, 12)
  Array.SetValue("template7", 3, 13)
  Array.SetValue("template7", "color", "Red")
  Array.SetValue("template7", "dim", 4)
  Array.SetValue("template7", "pviewx", 0)
  Array.SetValue("template7", "pviewy", 0)


105 Comment Comment Comment CRStmtCRs_repeat1
  445,3: '_X_
  446,3: '_X_
  447,3: '_XX
  449,3: Array.SetValue("template1", 0, 10)
  Array.SetValue("template1", 1, 11)
  Array.SetValue("template1", 2, 12)
  Array.SetValue("template1", 3, 22)
  Array.SetValue("template1", "color", "Yellow")
  Array.SetValue("template1", "dim", 3)
  Array.SetValue("template1", "pviewx", -12)
  Array.SetValue("template1", "pviewy", 12)


  '_X_
  '_X_
  'XX_
  Array.SetValue("template2", 0, 10)
  Array.SetValue("template2", 1, 11)
  Array.SetValue("template2", 2, 12)
  Array.SetValue("template2", 3, 02)
  Array.SetValue("template2", "color", "Magenta")
  Array.SetValue("template2", "dim", 3)
  Array.SetValue("template2", "pviewx", 12)
  Array.SetValue("template2", "pviewy", 12)


  '_X_
  'XXX
  '_
  Array.SetValue("template3", 0, 10)
  Array.SetValue("template3", 1, 01)
  Array.SetValue("template3", 2, 11)
  Array.SetValue("template3", 3, 21)
  Array.SetValue("template3", "color", "Gray")
  Array.SetValue("template3", "dim", 3)
  Array.SetValue("template3", "pviewx", 0)
  Array.SetValue("template3", "pviewy", 25)


  'XX_
  'XX_
  '_
  Array.SetValue("template4", 0, 00)
  Array.SetValue("template4", 1, 10)
  Array.SetValue("template4", 2, 01)
  Array.SetValue("template4", 3, 11)
  Array.SetValue("template4", "color", "Cyan")
  Array.SetValue("template4", "dim", 2)
  Array.SetValue("template4", "pviewx", 12)
  Array.SetValue("template4", "pviewy", 25)


  'XX_
  '_XX
  '_
  Array.SetValue("template5", 0, 00)
  Array.SetValue("template5", 1, 10)
  Array.SetValue("template5", 2, 11)
  Array.SetValue("template5", 3, 21)
  Array.SetValue("template5", "color", "Green")
  Array.SetValue("template5", "dim", 3)
  Array.SetValue("template5", "pviewx", 0)
  Array.SetValue("template5", "pviewy", 25)


  '_XX
  'XX_
  '_
  Array.SetValue("template6", 0, 10)
  Array.SetValue("template6", 1, 20)
  Array.SetValue("template6", 2, 01)
  Array.SetValue("template6", 3, 11)
  Array.SetValue("template6", "color", "Blue")
  Array.SetValue("template6", "dim", 3)
  Array.SetValue("template6", "pviewx", 0)
  Array.SetValue("template6", "pviewy", 25)


  '_X
  '_X
  '_X
  '_X
  Array.SetValue("template7", 0, 10)
  Array.SetValue("template7", 1, 11)
  Array.SetValue("template7", 2, 12)
  Array.SetValue("template7", 3, 13)
  Array.SetValue("template7", "color", "Red")
  Array.SetValue("template7", "dim", 4)
  Array.SetValue("template7", "pviewx", 0)
  Array.SetValue("template7", "pviewy", 0)


105 Comment Comment CRStmtCRs_repeat1
  446,3: '_X_
  447,3: '_XX
  449,3: Array.SetValue("template1", 0, 10)
  Array.SetValue("template1", 1, 11)
  Array.SetValue("template1", 2, 12)
  Array.SetValue("template1", 3, 22)
  Array.SetValue("template1", "color", "Yellow")
  Array.SetValue("template1", "dim", 3)
  Array.SetValue("template1", "pviewx", -12)
  Array.SetValue("template1", "pviewy", 12)


  '_X_
  '_X_
  'XX_
  Array.SetValue("template2", 0, 10)
  Array.SetValue("template2", 1, 11)
  Array.SetValue("template2", 2, 12)
  Array.SetValue("template2", 3, 02)
  Array.SetValue("template2", "color", "Magenta")
  Array.SetValue("template2", "dim", 3)
  Array.SetValue("template2", "pviewx", 12)
  Array.SetValue("template2", "pviewy", 12)


  '_X_
  'XXX
  '_
  Array.SetValue("template3", 0, 10)
  Array.SetValue("template3", 1, 01)
  Array.SetValue("template3", 2, 11)
  Array.SetValue("template3", 3, 21)
  Array.SetValue("template3", "color", "Gray")
  Array.SetValue("template3", "dim", 3)
  Array.SetValue("template3", "pviewx", 0)
  Array.SetValue("template3", "pviewy", 25)


  'XX_
  'XX_
  '_
  Array.SetValue("template4", 0, 00)
  Array.SetValue("template4", 1, 10)
  Array.SetValue("template4", 2, 01)
  Array.SetValue("template4", 3, 11)
  Array.SetValue("template4", "color", "Cyan")
  Array.SetValue("template4", "dim", 2)
  Array.SetValue("template4", "pviewx", 12)
  Array.SetValue("template4", "pviewy", 25)


  'XX_
  '_XX
  '_
  Array.SetValue("template5", 0, 00)
  Array.SetValue("template5", 1, 10)
  Array.SetValue("template5", 2, 11)
  Array.SetValue("template5", 3, 21)
  Array.SetValue("template5", "color", "Green")
  Array.SetValue("template5", "dim", 3)
  Array.SetValue("template5", "pviewx", 0)
  Array.SetValue("template5", "pviewy", 25)


  '_XX
  'XX_
  '_
  Array.SetValue("template6", 0, 10)
  Array.SetValue("template6", 1, 20)
  Array.SetValue("template6", 2, 01)
  Array.SetValue("template6", 3, 11)
  Array.SetValue("template6", "color", "Blue")
  Array.SetValue("template6", "dim", 3)
  Array.SetValue("template6", "pviewx", 0)
  Array.SetValue("template6", "pviewy", 25)


  '_X
  '_X
  '_X
  '_X
  Array.SetValue("template7", 0, 10)
  Array.SetValue("template7", 1, 11)
  Array.SetValue("template7", 2, 12)
  Array.SetValue("template7", 3, 13)
  Array.SetValue("template7", "color", "Red")
  Array.SetValue("template7", "dim", 4)
  Array.SetValue("template7", "pviewx", 0)
  Array.SetValue("template7", "pviewy", 0)


105 Comment CRStmtCRs_repeat1
  447,3: '_XX
  449,3: Array.SetValue("template1", 0, 10)
  Array.SetValue("template1", 1, 11)
  Array.SetValue("template1", 2, 12)
  Array.SetValue("template1", 3, 22)
  Array.SetValue("template1", "color", "Yellow")
  Array.SetValue("template1", "dim", 3)
  Array.SetValue("template1", "pviewx", -12)
  Array.SetValue("template1", "pviewy", 12)


  '_X_
  '_X_
  'XX_
  Array.SetValue("template2", 0, 10)
  Array.SetValue("template2", 1, 11)
  Array.SetValue("template2", 2, 12)
  Array.SetValue("template2", 3, 02)
  Array.SetValue("template2", "color", "Magenta")
  Array.SetValue("template2", "dim", 3)
  Array.SetValue("template2", "pviewx", 12)
  Array.SetValue("template2", "pviewy", 12)


  '_X_
  'XXX
  '_
  Array.SetValue("template3", 0, 10)
  Array.SetValue("template3", 1, 01)
  Array.SetValue("template3", 2, 11)
  Array.SetValue("template3", 3, 21)
  Array.SetValue("template3", "color", "Gray")
  Array.SetValue("template3", "dim", 3)
  Array.SetValue("template3", "pviewx", 0)
  Array.SetValue("template3", "pviewy", 25)


  'XX_
  'XX_
  '_
  Array.SetValue("template4", 0, 00)
  Array.SetValue("template4", 1, 10)
  Array.SetValue("template4", 2, 01)
  Array.SetValue("template4", 3, 11)
  Array.SetValue("template4", "color", "Cyan")
  Array.SetValue("template4", "dim", 2)
  Array.SetValue("template4", "pviewx", 12)
  Array.SetValue("template4", "pviewy", 25)


  'XX_
  '_XX
  '_
  Array.SetValue("template5", 0, 00)
  Array.SetValue("template5", 1, 10)
  Array.SetValue("template5", 2, 11)
  Array.SetValue("template5", 3, 21)
  Array.SetValue("template5", "color", "Green")
  Array.SetValue("template5", "dim", 3)
  Array.SetValue("template5", "pviewx", 0)
  Array.SetValue("template5", "pviewy", 25)


  '_XX
  'XX_
  '_
  Array.SetValue("template6", 0, 10)
  Array.SetValue("template6", 1, 20)
  Array.SetValue("template6", 2, 01)
  Array.SetValue("template6", 3, 11)
  Array.SetValue("template6", "color", "Blue")
  Array.SetValue("template6", "dim", 3)
  Array.SetValue("template6", "pviewx", 0)
  Array.SetValue("template6", "pviewy", 25)


  '_X
  '_X
  '_X
  '_X
  Array.SetValue("template7", 0, 10)
  Array.SetValue("template7", 1, 11)
  Array.SetValue("template7", 2, 12)
  Array.SetValue("template7", 3, 13)
  Array.SetValue("template7", "color", "Red")
  Array.SetValue("template7", "dim", 4)
  Array.SetValue("template7", "pviewx", 0)
  Array.SetValue("template7", "pviewy", 0)


160 ID . ID ( Exprs )
  449,3: Array
  449,8: .
  449,9: SetValue
  449,17: (
  449,18: "template1", 0, 10
  449,36: )

184 . ID ( Exprs )
  449,8: .
  449,9: SetValue
  449,17: (
  449,18: "template1", 0, 10
  449,36: )

255 ID ( Exprs )
  449,9: SetValue
  449,17: (
  449,18: "template1", 0, 10
  449,36: )

221 ( Exprs )
  449,17: (
  449,18: "template1", 0, 10
  449,36: )

27 STR
  449,18: "template1"

217 , MoreThanOneExpr
  449,29: ,
  449,31: 0, 10

54 NUM
  449,31: 0

217 , MoreThanOneExpr
  449,32: ,
  449,34: 10

54 NUM
  449,34: 10

238 )
  449,36: )

210 CR_token2
  449,37: 


160 ID . ID ( Exprs )
  450,3: Array
  450,8: .
  450,9: SetValue
  450,17: (
  450,18: "template1", 1, 11
  450,36: )

184 . ID ( Exprs )
  450,8: .
  450,9: SetValue
  450,17: (
  450,18: "template1", 1, 11
  450,36: )

255 ID ( Exprs )
  450,9: SetValue
  450,17: (
  450,18: "template1", 1, 11
  450,36: )

221 ( Exprs )
  450,17: (
  450,18: "template1", 1, 11
  450,36: )

27 STR
  450,18: "template1"

217 , MoreThanOneExpr
  450,29: ,
  450,31: 1, 11

54 NUM
  450,31: 1

217 , MoreThanOneExpr
  450,32: ,
  450,34: 11

54 NUM
  450,34: 11

238 )
  450,36: )

210 CR_token2
  450,37: 


160 ID . ID ( Exprs )
  451,3: Array
  451,8: .
  451,9: SetValue
  451,17: (
  451,18: "template1", 2, 12
  451,36: )

184 . ID ( Exprs )
  451,8: .
  451,9: SetValue
  451,17: (
  451,18: "template1", 2, 12
  451,36: )

255 ID ( Exprs )
  451,9: SetValue
  451,17: (
  451,18: "template1", 2, 12
  451,36: )

221 ( Exprs )
  451,17: (
  451,18: "template1", 2, 12
  451,36: )

27 STR
  451,18: "template1"

217 , MoreThanOneExpr
  451,29: ,
  451,31: 2, 12

54 NUM
  451,31: 2

217 , MoreThanOneExpr
  451,32: ,
  451,34: 12

54 NUM
  451,34: 12

238 )
  451,36: )

210 CR_token2
  451,37: 


160 ID . ID ( Exprs )
  452,3: Array
  452,8: .
  452,9: SetValue
  452,17: (
  452,18: "template1", 3, 22
  452,36: )

184 . ID ( Exprs )
  452,8: .
  452,9: SetValue
  452,17: (
  452,18: "template1", 3, 22
  452,36: )

255 ID ( Exprs )
  452,9: SetValue
  452,17: (
  452,18: "template1", 3, 22
  452,36: )

221 ( Exprs )
  452,17: (
  452,18: "template1", 3, 22
  452,36: )

27 STR
  452,18: "template1"

217 , MoreThanOneExpr
  452,29: ,
  452,31: 3, 22

54 NUM
  452,31: 3

217 , MoreThanOneExpr
  452,32: ,
  452,34: 22

54 NUM
  452,34: 22

238 )
  452,36: )

210 CR_token2
  452,37: 


160 ID . ID ( Exprs )
  453,3: Array
  453,8: .
  453,9: SetValue
  453,17: (
  453,18: "template1", "color", "Yellow"
  453,48: )

184 . ID ( Exprs )
  453,8: .
  453,9: SetValue
  453,17: (
  453,18: "template1", "color", "Yellow"
  453,48: )

255 ID ( Exprs )
  453,9: SetValue
  453,17: (
  453,18: "template1", "color", "Yellow"
  453,48: )

221 ( Exprs )
  453,17: (
  453,18: "template1", "color", "Yellow"
  453,48: )

27 STR
  453,18: "template1"

217 , MoreThanOneExpr
  453,29: ,
  453,31: "color", "Yellow"

54 STR
  453,31: "color"

217 , MoreThanOneExpr
  453,38: ,
  453,40: "Yellow"

54 STR
  453,40: "Yellow"

238 )
  453,48: )

210 CR_token2
  453,49: 


160 ID . ID ( Exprs )
  454,3: Array
  454,8: .
  454,9: SetValue
  454,17: (
  454,18: "template1", "dim", 3
  454,39: )

184 . ID ( Exprs )
  454,8: .
  454,9: SetValue
  454,17: (
  454,18: "template1", "dim", 3
  454,39: )

255 ID ( Exprs )
  454,9: SetValue
  454,17: (
  454,18: "template1", "dim", 3
  454,39: )

221 ( Exprs )
  454,17: (
  454,18: "template1", "dim", 3
  454,39: )

27 STR
  454,18: "template1"

217 , MoreThanOneExpr
  454,29: ,
  454,31: "dim", 3

54 STR
  454,31: "dim"

217 , MoreThanOneExpr
  454,36: ,
  454,38: 3

54 NUM
  454,38: 3

238 )
  454,39: )

210 CR_token2
  454,40: 


160 ID . ID ( Exprs )
  455,3: Array
  455,8: .
  455,9: SetValue
  455,17: (
  455,18: "template1", "pviewx", -12
  455,44: )

184 . ID ( Exprs )
  455,8: .
  455,9: SetValue
  455,17: (
  455,18: "template1", "pviewx", -12
  455,44: )

255 ID ( Exprs )
  455,9: SetValue
  455,17: (
  455,18: "template1", "pviewx", -12
  455,44: )

221 ( Exprs )
  455,17: (
  455,18: "template1", "pviewx", -12
  455,44: )

27 STR
  455,18: "template1"

217 , MoreThanOneExpr
  455,29: ,
  455,31: "pviewx", -12

54 STR
  455,31: "pviewx"

217 , MoreThanOneExpr
  455,39: ,
  455,41: -12

54 - Primary
  455,41: -
  455,42: 12

197 NUM
  455,42: 12

238 )
  455,44: )

210 CR_token2
  455,45: 


160 ID . ID ( Exprs )
  456,3: Array
  456,8: .
  456,9: SetValue
  456,17: (
  456,18: "template1", "pviewy", 12
  456,43: )

184 . ID ( Exprs )
  456,8: .
  456,9: SetValue
  456,17: (
  456,18: "template1", "pviewy", 12
  456,43: )

255 ID ( Exprs )
  456,9: SetValue
  456,17: (
  456,18: "template1", "pviewy", 12
  456,43: )

221 ( Exprs )
  456,17: (
  456,18: "template1", "pviewy", 12
  456,43: )

27 STR
  456,18: "template1"

217 , MoreThanOneExpr
  456,29: ,
  456,31: "pviewy", 12

54 STR
  456,31: "pviewy"

217 , MoreThanOneExpr
  456,39: ,
  456,41: 12

54 NUM
  456,41: 12

238 )
  456,43: )

210 CR_token2
  456,44: 




107 Comment Comment Comment TheRest
  459,3: '_X_
  460,3: '_X_
  461,3: 'XX_
  462,3: Array.SetValue("template2", 0, 10)


107 Comment Comment TheRest
  460,3: '_X_
  461,3: 'XX_
  462,3: Array.SetValue("template2", 0, 10)


107 Comment TheRest
  461,3: 'XX_
  462,3: Array.SetValue("template2", 0, 10)


160 ID . ID ( Exprs )
  462,3: Array
  462,8: .
  462,9: SetValue
  462,17: (
  462,18: "template2", 0, 10
  462,36: )

184 . ID ( Exprs )
  462,8: .
  462,9: SetValue
  462,17: (
  462,18: "template2", 0, 10
  462,36: )

255 ID ( Exprs )
  462,9: SetValue
  462,17: (
  462,18: "template2", 0, 10
  462,36: )

221 ( Exprs )
  462,17: (
  462,18: "template2", 0, 10
  462,36: )

27 STR
  462,18: "template2"

217 , MoreThanOneExpr
  462,29: ,
  462,31: 0, 10

54 NUM
  462,31: 0

217 , MoreThanOneExpr
  462,32: ,
  462,34: 10

54 NUM
  462,34: 10

238 )
  462,36: )

210 CR_token2
  462,37: 


160 ID . ID ( Exprs )
  463,3: Array
  463,8: .
  463,9: SetValue
  463,17: (
  463,18: "template2", 1, 11
  463,36: )

184 . ID ( Exprs )
  463,8: .
  463,9: SetValue
  463,17: (
  463,18: "template2", 1, 11
  463,36: )

255 ID ( Exprs )
  463,9: SetValue
  463,17: (
  463,18: "template2", 1, 11
  463,36: )

221 ( Exprs )
  463,17: (
  463,18: "template2", 1, 11
  463,36: )

27 STR
  463,18: "template2"

217 , MoreThanOneExpr
  463,29: ,
  463,31: 1, 11

54 NUM
  463,31: 1

217 , MoreThanOneExpr
  463,32: ,
  463,34: 11

54 NUM
  463,34: 11

238 )
  463,36: )

210 CR_token2
  463,37: 


160 ID . ID ( Exprs )
  464,3: Array
  464,8: .
  464,9: SetValue
  464,17: (
  464,18: "template2", 2, 12
  464,36: )

184 . ID ( Exprs )
  464,8: .
  464,9: SetValue
  464,17: (
  464,18: "template2", 2, 12
  464,36: )

255 ID ( Exprs )
  464,9: SetValue
  464,17: (
  464,18: "template2", 2, 12
  464,36: )

221 ( Exprs )
  464,17: (
  464,18: "template2", 2, 12
  464,36: )

27 STR
  464,18: "template2"

217 , MoreThanOneExpr
  464,29: ,
  464,31: 2, 12

54 NUM
  464,31: 2

217 , MoreThanOneExpr
  464,32: ,
  464,34: 12

54 NUM
  464,34: 12

238 )
  464,36: )

210 CR_token2
  464,37: 


160 ID . ID ( Exprs )
  465,3: Array
  465,8: .
  465,9: SetValue
  465,17: (
  465,18: "template2", 3, 02
  465,36: )

184 . ID ( Exprs )
  465,8: .
  465,9: SetValue
  465,17: (
  465,18: "template2", 3, 02
  465,36: )

255 ID ( Exprs )
  465,9: SetValue
  465,17: (
  465,18: "template2", 3, 02
  465,36: )

221 ( Exprs )
  465,17: (
  465,18: "template2", 3, 02
  465,36: )

27 STR
  465,18: "template2"

217 , MoreThanOneExpr
  465,29: ,
  465,31: 3, 02

54 NUM
  465,31: 3

217 , MoreThanOneExpr
  465,32: ,
  465,34: 02

54 NUM
  465,34: 02

238 )
  465,36: )

210 CR_token2
  465,37: 


160 ID . ID ( Exprs )
  466,3: Array
  466,8: .
  466,9: SetValue
  466,17: (
  466,18: "template2", "color", "Magenta"
  466,49: )

184 . ID ( Exprs )
  466,8: .
  466,9: SetValue
  466,17: (
  466,18: "template2", "color", "Magenta"
  466,49: )

255 ID ( Exprs )
  466,9: SetValue
  466,17: (
  466,18: "template2", "color", "Magenta"
  466,49: )

221 ( Exprs )
  466,17: (
  466,18: "template2", "color", "Magenta"
  466,49: )

27 STR
  466,18: "template2"

217 , MoreThanOneExpr
  466,29: ,
  466,31: "color", "Magenta"

54 STR
  466,31: "color"

217 , MoreThanOneExpr
  466,38: ,
  466,40: "Magenta"

54 STR
  466,40: "Magenta"

238 )
  466,49: )

210 CR_token2
  466,50: 


160 ID . ID ( Exprs )
  467,3: Array
  467,8: .
  467,9: SetValue
  467,17: (
  467,18: "template2", "dim", 3
  467,39: )

184 . ID ( Exprs )
  467,8: .
  467,9: SetValue
  467,17: (
  467,18: "template2", "dim", 3
  467,39: )

255 ID ( Exprs )
  467,9: SetValue
  467,17: (
  467,18: "template2", "dim", 3
  467,39: )

221 ( Exprs )
  467,17: (
  467,18: "template2", "dim", 3
  467,39: )

27 STR
  467,18: "template2"

217 , MoreThanOneExpr
  467,29: ,
  467,31: "dim", 3

54 STR
  467,31: "dim"

217 , MoreThanOneExpr
  467,36: ,
  467,38: 3

54 NUM
  467,38: 3

238 )
  467,39: )

210 CR_token2
  467,40: 


160 ID . ID ( Exprs )
  468,3: Array
  468,8: .
  468,9: SetValue
  468,17: (
  468,18: "template2", "pviewx", 12
  468,43: )

184 . ID ( Exprs )
  468,8: .
  468,9: SetValue
  468,17: (
  468,18: "template2", "pviewx", 12
  468,43: )

255 ID ( Exprs )
  468,9: SetValue
  468,17: (
  468,18: "template2", "pviewx", 12
  468,43: )

221 ( Exprs )
  468,17: (
  468,18: "template2", "pviewx", 12
  468,43: )

27 STR
  468,18: "template2"

217 , MoreThanOneExpr
  468,29: ,
  468,31: "pviewx", 12

54 STR
  468,31: "pviewx"

217 , MoreThanOneExpr
  468,39: ,
  468,41: 12

54 NUM
  468,41: 12

238 )
  468,43: )

210 CR_token2
  468,44: 


160 ID . ID ( Exprs )
  469,3: Array
  469,8: .
  469,9: SetValue
  469,17: (
  469,18: "template2", "pviewy", 12
  469,43: )

184 . ID ( Exprs )
  469,8: .
  469,9: SetValue
  469,17: (
  469,18: "template2", "pviewy", 12
  469,43: )

255 ID ( Exprs )
  469,9: SetValue
  469,17: (
  469,18: "template2", "pviewy", 12
  469,43: )

221 ( Exprs )
  469,17: (
  469,18: "template2", "pviewy", 12
  469,43: )

27 STR
  469,18: "template2"

217 , MoreThanOneExpr
  469,29: ,
  469,31: "pviewy", 12

54 STR
  469,31: "pviewy"

217 , MoreThanOneExpr
  469,39: ,
  469,41: 12

54 NUM
  469,41: 12

238 )
  469,43: )

210 CR_token2
  469,44: 




107 Comment Comment Comment TheRest
  472,3: '_X_
  473,3: 'XXX
  474,3: '_
  475,3: Array.SetValue("template3", 0, 10)


107 Comment Comment TheRest
  473,3: 'XXX
  474,3: '_
  475,3: Array.SetValue("template3", 0, 10)


107 Comment TheRest
  474,3: '_
  475,3: Array.SetValue("template3", 0, 10)


160 ID . ID ( Exprs )
  475,3: Array
  475,8: .
  475,9: SetValue
  475,17: (
  475,18: "template3", 0, 10
  475,36: )

184 . ID ( Exprs )
  475,8: .
  475,9: SetValue
  475,17: (
  475,18: "template3", 0, 10
  475,36: )

255 ID ( Exprs )
  475,9: SetValue
  475,17: (
  475,18: "template3", 0, 10
  475,36: )

221 ( Exprs )
  475,17: (
  475,18: "template3", 0, 10
  475,36: )

27 STR
  475,18: "template3"

217 , MoreThanOneExpr
  475,29: ,
  475,31: 0, 10

54 NUM
  475,31: 0

217 , MoreThanOneExpr
  475,32: ,
  475,34: 10

54 NUM
  475,34: 10

238 )
  475,36: )

210 CR_token2
  475,37: 


160 ID . ID ( Exprs )
  476,3: Array
  476,8: .
  476,9: SetValue
  476,17: (
  476,18: "template3", 1, 01
  476,36: )

184 . ID ( Exprs )
  476,8: .
  476,9: SetValue
  476,17: (
  476,18: "template3", 1, 01
  476,36: )

255 ID ( Exprs )
  476,9: SetValue
  476,17: (
  476,18: "template3", 1, 01
  476,36: )

221 ( Exprs )
  476,17: (
  476,18: "template3", 1, 01
  476,36: )

27 STR
  476,18: "template3"

217 , MoreThanOneExpr
  476,29: ,
  476,31: 1, 01

54 NUM
  476,31: 1

217 , MoreThanOneExpr
  476,32: ,
  476,34: 01

54 NUM
  476,34: 01

238 )
  476,36: )

210 CR_token2
  476,37: 


160 ID . ID ( Exprs )
  477,3: Array
  477,8: .
  477,9: SetValue
  477,17: (
  477,18: "template3", 2, 11
  477,36: )

184 . ID ( Exprs )
  477,8: .
  477,9: SetValue
  477,17: (
  477,18: "template3", 2, 11
  477,36: )

255 ID ( Exprs )
  477,9: SetValue
  477,17: (
  477,18: "template3", 2, 11
  477,36: )

221 ( Exprs )
  477,17: (
  477,18: "template3", 2, 11
  477,36: )

27 STR
  477,18: "template3"

217 , MoreThanOneExpr
  477,29: ,
  477,31: 2, 11

54 NUM
  477,31: 2

217 , MoreThanOneExpr
  477,32: ,
  477,34: 11

54 NUM
  477,34: 11

238 )
  477,36: )

210 CR_token2
  477,37: 


160 ID . ID ( Exprs )
  478,3: Array
  478,8: .
  478,9: SetValue
  478,17: (
  478,18: "template3", 3, 21
  478,36: )

184 . ID ( Exprs )
  478,8: .
  478,9: SetValue
  478,17: (
  478,18: "template3", 3, 21
  478,36: )

255 ID ( Exprs )
  478,9: SetValue
  478,17: (
  478,18: "template3", 3, 21
  478,36: )

221 ( Exprs )
  478,17: (
  478,18: "template3", 3, 21
  478,36: )

27 STR
  478,18: "template3"

217 , MoreThanOneExpr
  478,29: ,
  478,31: 3, 21

54 NUM
  478,31: 3

217 , MoreThanOneExpr
  478,32: ,
  478,34: 21

54 NUM
  478,34: 21

238 )
  478,36: )

210 CR_token2
  478,37: 


160 ID . ID ( Exprs )
  479,3: Array
  479,8: .
  479,9: SetValue
  479,17: (
  479,18: "template3", "color", "Gray"
  479,46: )

184 . ID ( Exprs )
  479,8: .
  479,9: SetValue
  479,17: (
  479,18: "template3", "color", "Gray"
  479,46: )

255 ID ( Exprs )
  479,9: SetValue
  479,17: (
  479,18: "template3", "color", "Gray"
  479,46: )

221 ( Exprs )
  479,17: (
  479,18: "template3", "color", "Gray"
  479,46: )

27 STR
  479,18: "template3"

217 , MoreThanOneExpr
  479,29: ,
  479,31: "color", "Gray"

54 STR
  479,31: "color"

217 , MoreThanOneExpr
  479,38: ,
  479,40: "Gray"

54 STR
  479,40: "Gray"

238 )
  479,46: )

210 CR_token2
  479,47: 


160 ID . ID ( Exprs )
  480,3: Array
  480,8: .
  480,9: SetValue
  480,17: (
  480,18: "template3", "dim", 3
  480,39: )

184 . ID ( Exprs )
  480,8: .
  480,9: SetValue
  480,17: (
  480,18: "template3", "dim", 3
  480,39: )

255 ID ( Exprs )
  480,9: SetValue
  480,17: (
  480,18: "template3", "dim", 3
  480,39: )

221 ( Exprs )
  480,17: (
  480,18: "template3", "dim", 3
  480,39: )

27 STR
  480,18: "template3"

217 , MoreThanOneExpr
  480,29: ,
  480,31: "dim", 3

54 STR
  480,31: "dim"

217 , MoreThanOneExpr
  480,36: ,
  480,38: 3

54 NUM
  480,38: 3

238 )
  480,39: )

210 CR_token2
  480,40: 


160 ID . ID ( Exprs )
  481,3: Array
  481,8: .
  481,9: SetValue
  481,17: (
  481,18: "template3", "pviewx", 0
  481,42: )

184 . ID ( Exprs )
  481,8: .
  481,9: SetValue
  481,17: (
  481,18: "template3", "pviewx", 0
  481,42: )

255 ID ( Exprs )
  481,9: SetValue
  481,17: (
  481,18: "template3", "pviewx", 0
  481,42: )

221 ( Exprs )
  481,17: (
  481,18: "template3", "pviewx", 0
  481,42: )

27 STR
  481,18: "template3"

217 , MoreThanOneExpr
  481,29: ,
  481,31: "pviewx", 0

54 STR
  481,31: "pviewx"

217 , MoreThanOneExpr
  481,39: ,
  481,41: 0

54 NUM
  481,41: 0

238 )
  481,42: )

210 CR_token2
  481,43: 


160 ID . ID ( Exprs )
  482,3: Array
  482,8: .
  482,9: SetValue
  482,17: (
  482,18: "template3", "pviewy", 25
  482,43: )

184 . ID ( Exprs )
  482,8: .
  482,9: SetValue
  482,17: (
  482,18: "template3", "pviewy", 25
  482,43: )

255 ID ( Exprs )
  482,9: SetValue
  482,17: (
  482,18: "template3", "pviewy", 25
  482,43: )

221 ( Exprs )
  482,17: (
  482,18: "template3", "pviewy", 25
  482,43: )

27 STR
  482,18: "template3"

217 , MoreThanOneExpr
  482,29: ,
  482,31: "pviewy", 25

54 STR
  482,31: "pviewy"

217 , MoreThanOneExpr
  482,39: ,
  482,41: 25

54 NUM
  482,41: 25

238 )
  482,43: )

210 CR_token2
  482,44: 




107 Comment Comment Comment TheRest
  485,3: 'XX_
  486,3: 'XX_
  487,3: '_
  488,3: Array.SetValue("template4", 0, 00)


107 Comment Comment TheRest
  486,3: 'XX_
  487,3: '_
  488,3: Array.SetValue("template4", 0, 00)


107 Comment TheRest
  487,3: '_
  488,3: Array.SetValue("template4", 0, 00)


160 ID . ID ( Exprs )
  488,3: Array
  488,8: .
  488,9: SetValue
  488,17: (
  488,18: "template4", 0, 00
  488,36: )

184 . ID ( Exprs )
  488,8: .
  488,9: SetValue
  488,17: (
  488,18: "template4", 0, 00
  488,36: )

255 ID ( Exprs )
  488,9: SetValue
  488,17: (
  488,18: "template4", 0, 00
  488,36: )

221 ( Exprs )
  488,17: (
  488,18: "template4", 0, 00
  488,36: )

27 STR
  488,18: "template4"

217 , MoreThanOneExpr
  488,29: ,
  488,31: 0, 00

54 NUM
  488,31: 0

217 , MoreThanOneExpr
  488,32: ,
  488,34: 00

54 NUM
  488,34: 00

238 )
  488,36: )

210 CR_token2
  488,37: 


160 ID . ID ( Exprs )
  489,3: Array
  489,8: .
  489,9: SetValue
  489,17: (
  489,18: "template4", 1, 10
  489,36: )

184 . ID ( Exprs )
  489,8: .
  489,9: SetValue
  489,17: (
  489,18: "template4", 1, 10
  489,36: )

255 ID ( Exprs )
  489,9: SetValue
  489,17: (
  489,18: "template4", 1, 10
  489,36: )

221 ( Exprs )
  489,17: (
  489,18: "template4", 1, 10
  489,36: )

27 STR
  489,18: "template4"

217 , MoreThanOneExpr
  489,29: ,
  489,31: 1, 10

54 NUM
  489,31: 1

217 , MoreThanOneExpr
  489,32: ,
  489,34: 10

54 NUM
  489,34: 10

238 )
  489,36: )

210 CR_token2
  489,37: 


160 ID . ID ( Exprs )
  490,3: Array
  490,8: .
  490,9: SetValue
  490,17: (
  490,18: "template4", 2, 01
  490,36: )

184 . ID ( Exprs )
  490,8: .
  490,9: SetValue
  490,17: (
  490,18: "template4", 2, 01
  490,36: )

255 ID ( Exprs )
  490,9: SetValue
  490,17: (
  490,18: "template4", 2, 01
  490,36: )

221 ( Exprs )
  490,17: (
  490,18: "template4", 2, 01
  490,36: )

27 STR
  490,18: "template4"

217 , MoreThanOneExpr
  490,29: ,
  490,31: 2, 01

54 NUM
  490,31: 2

217 , MoreThanOneExpr
  490,32: ,
  490,34: 01

54 NUM
  490,34: 01

238 )
  490,36: )

210 CR_token2
  490,37: 


160 ID . ID ( Exprs )
  491,3: Array
  491,8: .
  491,9: SetValue
  491,17: (
  491,18: "template4", 3, 11
  491,36: )

184 . ID ( Exprs )
  491,8: .
  491,9: SetValue
  491,17: (
  491,18: "template4", 3, 11
  491,36: )

255 ID ( Exprs )
  491,9: SetValue
  491,17: (
  491,18: "template4", 3, 11
  491,36: )

221 ( Exprs )
  491,17: (
  491,18: "template4", 3, 11
  491,36: )

27 STR
  491,18: "template4"

217 , MoreThanOneExpr
  491,29: ,
  491,31: 3, 11

54 NUM
  491,31: 3

217 , MoreThanOneExpr
  491,32: ,
  491,34: 11

54 NUM
  491,34: 11

238 )
  491,36: )

210 CR_token2
  491,37: 


160 ID . ID ( Exprs )
  492,3: Array
  492,8: .
  492,9: SetValue
  492,17: (
  492,18: "template4", "color", "Cyan"
  492,46: )

184 . ID ( Exprs )
  492,8: .
  492,9: SetValue
  492,17: (
  492,18: "template4", "color", "Cyan"
  492,46: )

255 ID ( Exprs )
  492,9: SetValue
  492,17: (
  492,18: "template4", "color", "Cyan"
  492,46: )

221 ( Exprs )
  492,17: (
  492,18: "template4", "color", "Cyan"
  492,46: )

27 STR
  492,18: "template4"

217 , MoreThanOneExpr
  492,29: ,
  492,31: "color", "Cyan"

54 STR
  492,31: "color"

217 , MoreThanOneExpr
  492,38: ,
  492,40: "Cyan"

54 STR
  492,40: "Cyan"

238 )
  492,46: )

210 CR_token2
  492,47: 


160 ID . ID ( Exprs )
  493,3: Array
  493,8: .
  493,9: SetValue
  493,17: (
  493,18: "template4", "dim", 2
  493,39: )

184 . ID ( Exprs )
  493,8: .
  493,9: SetValue
  493,17: (
  493,18: "template4", "dim", 2
  493,39: )

255 ID ( Exprs )
  493,9: SetValue
  493,17: (
  493,18: "template4", "dim", 2
  493,39: )

221 ( Exprs )
  493,17: (
  493,18: "template4", "dim", 2
  493,39: )

27 STR
  493,18: "template4"

217 , MoreThanOneExpr
  493,29: ,
  493,31: "dim", 2

54 STR
  493,31: "dim"

217 , MoreThanOneExpr
  493,36: ,
  493,38: 2

54 NUM
  493,38: 2

238 )
  493,39: )

210 CR_token2
  493,40: 


160 ID . ID ( Exprs )
  494,3: Array
  494,8: .
  494,9: SetValue
  494,17: (
  494,18: "template4", "pviewx", 12
  494,43: )

184 . ID ( Exprs )
  494,8: .
  494,9: SetValue
  494,17: (
  494,18: "template4", "pviewx", 12
  494,43: )

255 ID ( Exprs )
  494,9: SetValue
  494,17: (
  494,18: "template4", "pviewx", 12
  494,43: )

221 ( Exprs )
  494,17: (
  494,18: "template4", "pviewx", 12
  494,43: )

27 STR
  494,18: "template4"

217 , MoreThanOneExpr
  494,29: ,
  494,31: "pviewx", 12

54 STR
  494,31: "pviewx"

217 , MoreThanOneExpr
  494,39: ,
  494,41: 12

54 NUM
  494,41: 12

238 )
  494,43: )

210 CR_token2
  494,44: 


160 ID . ID ( Exprs )
  495,3: Array
  495,8: .
  495,9: SetValue
  495,17: (
  495,18: "template4", "pviewy", 25
  495,43: )

184 . ID ( Exprs )
  495,8: .
  495,9: SetValue
  495,17: (
  495,18: "template4", "pviewy", 25
  495,43: )

255 ID ( Exprs )
  495,9: SetValue
  495,17: (
  495,18: "template4", "pviewy", 25
  495,43: )

221 ( Exprs )
  495,17: (
  495,18: "template4", "pviewy", 25
  495,43: )

27 STR
  495,18: "template4"

217 , MoreThanOneExpr
  495,29: ,
  495,31: "pviewy", 25

54 STR
  495,31: "pviewy"

217 , MoreThanOneExpr
  495,39: ,
  495,41: 25

54 NUM
  495,41: 25

238 )
  495,43: )

210 CR_token2
  495,44: 




107 Comment Comment Comment TheRest
  498,3: 'XX_
  499,3: '_XX
  500,3: '_
  501,3: Array.SetValue("template5", 0, 00)


107 Comment Comment TheRest
  499,3: '_XX
  500,3: '_
  501,3: Array.SetValue("template5", 0, 00)


107 Comment TheRest
  500,3: '_
  501,3: Array.SetValue("template5", 0, 00)


160 ID . ID ( Exprs )
  501,3: Array
  501,8: .
  501,9: SetValue
  501,17: (
  501,18: "template5", 0, 00
  501,36: )

184 . ID ( Exprs )
  501,8: .
  501,9: SetValue
  501,17: (
  501,18: "template5", 0, 00
  501,36: )

255 ID ( Exprs )
  501,9: SetValue
  501,17: (
  501,18: "template5", 0, 00
  501,36: )

221 ( Exprs )
  501,17: (
  501,18: "template5", 0, 00
  501,36: )

27 STR
  501,18: "template5"

217 , MoreThanOneExpr
  501,29: ,
  501,31: 0, 00

54 NUM
  501,31: 0

217 , MoreThanOneExpr
  501,32: ,
  501,34: 00

54 NUM
  501,34: 00

238 )
  501,36: )

210 CR_token2
  501,37: 


160 ID . ID ( Exprs )
  502,3: Array
  502,8: .
  502,9: SetValue
  502,17: (
  502,18: "template5", 1, 10
  502,36: )

184 . ID ( Exprs )
  502,8: .
  502,9: SetValue
  502,17: (
  502,18: "template5", 1, 10
  502,36: )

255 ID ( Exprs )
  502,9: SetValue
  502,17: (
  502,18: "template5", 1, 10
  502,36: )

221 ( Exprs )
  502,17: (
  502,18: "template5", 1, 10
  502,36: )

27 STR
  502,18: "template5"

217 , MoreThanOneExpr
  502,29: ,
  502,31: 1, 10

54 NUM
  502,31: 1

217 , MoreThanOneExpr
  502,32: ,
  502,34: 10

54 NUM
  502,34: 10

238 )
  502,36: )

210 CR_token2
  502,37: 


160 ID . ID ( Exprs )
  503,3: Array
  503,8: .
  503,9: SetValue
  503,17: (
  503,18: "template5", 2, 11
  503,36: )

184 . ID ( Exprs )
  503,8: .
  503,9: SetValue
  503,17: (
  503,18: "template5", 2, 11
  503,36: )

255 ID ( Exprs )
  503,9: SetValue
  503,17: (
  503,18: "template5", 2, 11
  503,36: )

221 ( Exprs )
  503,17: (
  503,18: "template5", 2, 11
  503,36: )

27 STR
  503,18: "template5"

217 , MoreThanOneExpr
  503,29: ,
  503,31: 2, 11

54 NUM
  503,31: 2

217 , MoreThanOneExpr
  503,32: ,
  503,34: 11

54 NUM
  503,34: 11

238 )
  503,36: )

210 CR_token2
  503,37: 


160 ID . ID ( Exprs )
  504,3: Array
  504,8: .
  504,9: SetValue
  504,17: (
  504,18: "template5", 3, 21
  504,36: )

184 . ID ( Exprs )
  504,8: .
  504,9: SetValue
  504,17: (
  504,18: "template5", 3, 21
  504,36: )

255 ID ( Exprs )
  504,9: SetValue
  504,17: (
  504,18: "template5", 3, 21
  504,36: )

221 ( Exprs )
  504,17: (
  504,18: "template5", 3, 21
  504,36: )

27 STR
  504,18: "template5"

217 , MoreThanOneExpr
  504,29: ,
  504,31: 3, 21

54 NUM
  504,31: 3

217 , MoreThanOneExpr
  504,32: ,
  504,34: 21

54 NUM
  504,34: 21

238 )
  504,36: )

210 CR_token2
  504,37: 


160 ID . ID ( Exprs )
  505,3: Array
  505,8: .
  505,9: SetValue
  505,17: (
  505,18: "template5", "color", "Green"
  505,47: )

184 . ID ( Exprs )
  505,8: .
  505,9: SetValue
  505,17: (
  505,18: "template5", "color", "Green"
  505,47: )

255 ID ( Exprs )
  505,9: SetValue
  505,17: (
  505,18: "template5", "color", "Green"
  505,47: )

221 ( Exprs )
  505,17: (
  505,18: "template5", "color", "Green"
  505,47: )

27 STR
  505,18: "template5"

217 , MoreThanOneExpr
  505,29: ,
  505,31: "color", "Green"

54 STR
  505,31: "color"

217 , MoreThanOneExpr
  505,38: ,
  505,40: "Green"

54 STR
  505,40: "Green"

238 )
  505,47: )

210 CR_token2
  505,48: 


160 ID . ID ( Exprs )
  506,3: Array
  506,8: .
  506,9: SetValue
  506,17: (
  506,18: "template5", "dim", 3
  506,39: )

184 . ID ( Exprs )
  506,8: .
  506,9: SetValue
  506,17: (
  506,18: "template5", "dim", 3
  506,39: )

255 ID ( Exprs )
  506,9: SetValue
  506,17: (
  506,18: "template5", "dim", 3
  506,39: )

221 ( Exprs )
  506,17: (
  506,18: "template5", "dim", 3
  506,39: )

27 STR
  506,18: "template5"

217 , MoreThanOneExpr
  506,29: ,
  506,31: "dim", 3

54 STR
  506,31: "dim"

217 , MoreThanOneExpr
  506,36: ,
  506,38: 3

54 NUM
  506,38: 3

238 )
  506,39: )

210 CR_token2
  506,40: 


160 ID . ID ( Exprs )
  507,3: Array
  507,8: .
  507,9: SetValue
  507,17: (
  507,18: "template5", "pviewx", 0
  507,42: )

184 . ID ( Exprs )
  507,8: .
  507,9: SetValue
  507,17: (
  507,18: "template5", "pviewx", 0
  507,42: )

255 ID ( Exprs )
  507,9: SetValue
  507,17: (
  507,18: "template5", "pviewx", 0
  507,42: )

221 ( Exprs )
  507,17: (
  507,18: "template5", "pviewx", 0
  507,42: )

27 STR
  507,18: "template5"

217 , MoreThanOneExpr
  507,29: ,
  507,31: "pviewx", 0

54 STR
  507,31: "pviewx"

217 , MoreThanOneExpr
  507,39: ,
  507,41: 0

54 NUM
  507,41: 0

238 )
  507,42: )

210 CR_token2
  507,43: 


160 ID . ID ( Exprs )
  508,3: Array
  508,8: .
  508,9: SetValue
  508,17: (
  508,18: "template5", "pviewy", 25
  508,43: )

184 . ID ( Exprs )
  508,8: .
  508,9: SetValue
  508,17: (
  508,18: "template5", "pviewy", 25
  508,43: )

255 ID ( Exprs )
  508,9: SetValue
  508,17: (
  508,18: "template5", "pviewy", 25
  508,43: )

221 ( Exprs )
  508,17: (
  508,18: "template5", "pviewy", 25
  508,43: )

27 STR
  508,18: "template5"

217 , MoreThanOneExpr
  508,29: ,
  508,31: "pviewy", 25

54 STR
  508,31: "pviewy"

217 , MoreThanOneExpr
  508,39: ,
  508,41: 25

54 NUM
  508,41: 25

238 )
  508,43: )

210 CR_token2
  508,44: 




107 Comment Comment Comment TheRest
  511,3: '_XX
  512,3: 'XX_
  513,3: '_
  514,3: Array.SetValue("template6", 0, 10)


107 Comment Comment TheRest
  512,3: 'XX_
  513,3: '_
  514,3: Array.SetValue("template6", 0, 10)


107 Comment TheRest
  513,3: '_
  514,3: Array.SetValue("template6", 0, 10)


160 ID . ID ( Exprs )
  514,3: Array
  514,8: .
  514,9: SetValue
  514,17: (
  514,18: "template6", 0, 10
  514,36: )

184 . ID ( Exprs )
  514,8: .
  514,9: SetValue
  514,17: (
  514,18: "template6", 0, 10
  514,36: )

255 ID ( Exprs )
  514,9: SetValue
  514,17: (
  514,18: "template6", 0, 10
  514,36: )

221 ( Exprs )
  514,17: (
  514,18: "template6", 0, 10
  514,36: )

27 STR
  514,18: "template6"

217 , MoreThanOneExpr
  514,29: ,
  514,31: 0, 10

54 NUM
  514,31: 0

217 , MoreThanOneExpr
  514,32: ,
  514,34: 10

54 NUM
  514,34: 10

238 )
  514,36: )

210 CR_token2
  514,37: 


160 ID . ID ( Exprs )
  515,3: Array
  515,8: .
  515,9: SetValue
  515,17: (
  515,18: "template6", 1, 20
  515,36: )

184 . ID ( Exprs )
  515,8: .
  515,9: SetValue
  515,17: (
  515,18: "template6", 1, 20
  515,36: )

255 ID ( Exprs )
  515,9: SetValue
  515,17: (
  515,18: "template6", 1, 20
  515,36: )

221 ( Exprs )
  515,17: (
  515,18: "template6", 1, 20
  515,36: )

27 STR
  515,18: "template6"

217 , MoreThanOneExpr
  515,29: ,
  515,31: 1, 20

54 NUM
  515,31: 1

217 , MoreThanOneExpr
  515,32: ,
  515,34: 20

54 NUM
  515,34: 20

238 )
  515,36: )

210 CR_token2
  515,37: 


160 ID . ID ( Exprs )
  516,3: Array
  516,8: .
  516,9: SetValue
  516,17: (
  516,18: "template6", 2, 01
  516,36: )

184 . ID ( Exprs )
  516,8: .
  516,9: SetValue
  516,17: (
  516,18: "template6", 2, 01
  516,36: )

255 ID ( Exprs )
  516,9: SetValue
  516,17: (
  516,18: "template6", 2, 01
  516,36: )

221 ( Exprs )
  516,17: (
  516,18: "template6", 2, 01
  516,36: )

27 STR
  516,18: "template6"

217 , MoreThanOneExpr
  516,29: ,
  516,31: 2, 01

54 NUM
  516,31: 2

217 , MoreThanOneExpr
  516,32: ,
  516,34: 01

54 NUM
  516,34: 01

238 )
  516,36: )

210 CR_token2
  516,37: 


160 ID . ID ( Exprs )
  517,3: Array
  517,8: .
  517,9: SetValue
  517,17: (
  517,18: "template6", 3, 11
  517,36: )

184 . ID ( Exprs )
  517,8: .
  517,9: SetValue
  517,17: (
  517,18: "template6", 3, 11
  517,36: )

255 ID ( Exprs )
  517,9: SetValue
  517,17: (
  517,18: "template6", 3, 11
  517,36: )

221 ( Exprs )
  517,17: (
  517,18: "template6", 3, 11
  517,36: )

27 STR
  517,18: "template6"

217 , MoreThanOneExpr
  517,29: ,
  517,31: 3, 11

54 NUM
  517,31: 3

217 , MoreThanOneExpr
  517,32: ,
  517,34: 11

54 NUM
  517,34: 11

238 )
  517,36: )

210 CR_token2
  517,37: 


160 ID . ID ( Exprs )
  518,3: Array
  518,8: .
  518,9: SetValue
  518,17: (
  518,18: "template6", "color", "Blue"
  518,46: )

184 . ID ( Exprs )
  518,8: .
  518,9: SetValue
  518,17: (
  518,18: "template6", "color", "Blue"
  518,46: )

255 ID ( Exprs )
  518,9: SetValue
  518,17: (
  518,18: "template6", "color", "Blue"
  518,46: )

221 ( Exprs )
  518,17: (
  518,18: "template6", "color", "Blue"
  518,46: )

27 STR
  518,18: "template6"

217 , MoreThanOneExpr
  518,29: ,
  518,31: "color", "Blue"

54 STR
  518,31: "color"

217 , MoreThanOneExpr
  518,38: ,
  518,40: "Blue"

54 STR
  518,40: "Blue"

238 )
  518,46: )

210 CR_token2
  518,47: 


160 ID . ID ( Exprs )
  519,3: Array
  519,8: .
  519,9: SetValue
  519,17: (
  519,18: "template6", "dim", 3
  519,39: )

184 . ID ( Exprs )
  519,8: .
  519,9: SetValue
  519,17: (
  519,18: "template6", "dim", 3
  519,39: )

255 ID ( Exprs )
  519,9: SetValue
  519,17: (
  519,18: "template6", "dim", 3
  519,39: )

221 ( Exprs )
  519,17: (
  519,18: "template6", "dim", 3
  519,39: )

27 STR
  519,18: "template6"

217 , MoreThanOneExpr
  519,29: ,
  519,31: "dim", 3

54 STR
  519,31: "dim"

217 , MoreThanOneExpr
  519,36: ,
  519,38: 3

54 NUM
  519,38: 3

238 )
  519,39: )

210 CR_token2
  519,40: 


160 ID . ID ( Exprs )
  520,3: Array
  520,8: .
  520,9: SetValue
  520,17: (
  520,18: "template6", "pviewx", 0
  520,42: )

184 . ID ( Exprs )
  520,8: .
  520,9: SetValue
  520,17: (
  520,18: "template6", "pviewx", 0
  520,42: )

255 ID ( Exprs )
  520,9: SetValue
  520,17: (
  520,18: "template6", "pviewx", 0
  520,42: )

221 ( Exprs )
  520,17: (
  520,18: "template6", "pviewx", 0
  520,42: )

27 STR
  520,18: "template6"

217 , MoreThanOneExpr
  520,29: ,
  520,31: "pviewx", 0

54 STR
  520,31: "pviewx"

217 , MoreThanOneExpr
  520,39: ,
  520,41: 0

54 NUM
  520,41: 0

238 )
  520,42: )

210 CR_token2
  520,43: 


160 ID . ID ( Exprs )
  521,3: Array
  521,8: .
  521,9: SetValue
  521,17: (
  521,18: "template6", "pviewy", 25
  521,43: )

184 . ID ( Exprs )
  521,8: .
  521,9: SetValue
  521,17: (
  521,18: "template6", "pviewy", 25
  521,43: )

255 ID ( Exprs )
  521,9: SetValue
  521,17: (
  521,18: "template6", "pviewy", 25
  521,43: )

221 ( Exprs )
  521,17: (
  521,18: "template6", "pviewy", 25
  521,43: )

27 STR
  521,18: "template6"

217 , MoreThanOneExpr
  521,29: ,
  521,31: "pviewy", 25

54 STR
  521,31: "pviewy"

217 , MoreThanOneExpr
  521,39: ,
  521,41: 25

54 NUM
  521,41: 25

238 )
  521,43: )

210 CR_token2
  521,44: 




107 Comment Comment Comment Comment TheRest
  524,3: '_X
  525,3: '_X
  526,3: '_X
  527,3: '_X
  528,3: Array.SetValue("template7", 0, 10)


107 Comment Comment Comment TheRest
  525,3: '_X
  526,3: '_X
  527,3: '_X
  528,3: Array.SetValue("template7", 0, 10)


107 Comment Comment TheRest
  526,3: '_X
  527,3: '_X
  528,3: Array.SetValue("template7", 0, 10)


107 Comment TheRest
  527,3: '_X
  528,3: Array.SetValue("template7", 0, 10)


160 ID . ID ( Exprs )
  528,3: Array
  528,8: .
  528,9: SetValue
  528,17: (
  528,18: "template7", 0, 10
  528,36: )

184 . ID ( Exprs )
  528,8: .
  528,9: SetValue
  528,17: (
  528,18: "template7", 0, 10
  528,36: )

255 ID ( Exprs )
  528,9: SetValue
  528,17: (
  528,18: "template7", 0, 10
  528,36: )

221 ( Exprs )
  528,17: (
  528,18: "template7", 0, 10
  528,36: )

27 STR
  528,18: "template7"

217 , MoreThanOneExpr
  528,29: ,
  528,31: 0, 10

54 NUM
  528,31: 0

217 , MoreThanOneExpr
  528,32: ,
  528,34: 10

54 NUM
  528,34: 10

238 )
  528,36: )

210 CR_token2
  528,37: 


160 ID . ID ( Exprs )
  529,3: Array
  529,8: .
  529,9: SetValue
  529,17: (
  529,18: "template7", 1, 11
  529,36: )

184 . ID ( Exprs )
  529,8: .
  529,9: SetValue
  529,17: (
  529,18: "template7", 1, 11
  529,36: )

255 ID ( Exprs )
  529,9: SetValue
  529,17: (
  529,18: "template7", 1, 11
  529,36: )

221 ( Exprs )
  529,17: (
  529,18: "template7", 1, 11
  529,36: )

27 STR
  529,18: "template7"

217 , MoreThanOneExpr
  529,29: ,
  529,31: 1, 11

54 NUM
  529,31: 1

217 , MoreThanOneExpr
  529,32: ,
  529,34: 11

54 NUM
  529,34: 11

238 )
  529,36: )

210 CR_token2
  529,37: 


160 ID . ID ( Exprs )
  530,3: Array
  530,8: .
  530,9: SetValue
  530,17: (
  530,18: "template7", 2, 12
  530,36: )

184 . ID ( Exprs )
  530,8: .
  530,9: SetValue
  530,17: (
  530,18: "template7", 2, 12
  530,36: )

255 ID ( Exprs )
  530,9: SetValue
  530,17: (
  530,18: "template7", 2, 12
  530,36: )

221 ( Exprs )
  530,17: (
  530,18: "template7", 2, 12
  530,36: )

27 STR
  530,18: "template7"

217 , MoreThanOneExpr
  530,29: ,
  530,31: 2, 12

54 NUM
  530,31: 2

217 , MoreThanOneExpr
  530,32: ,
  530,34: 12

54 NUM
  530,34: 12

238 )
  530,36: )

210 CR_token2
  530,37: 


160 ID . ID ( Exprs )
  531,3: Array
  531,8: .
  531,9: SetValue
  531,17: (
  531,18: "template7", 3, 13
  531,36: )

184 . ID ( Exprs )
  531,8: .
  531,9: SetValue
  531,17: (
  531,18: "template7", 3, 13
  531,36: )

255 ID ( Exprs )
  531,9: SetValue
  531,17: (
  531,18: "template7", 3, 13
  531,36: )

221 ( Exprs )
  531,17: (
  531,18: "template7", 3, 13
  531,36: )

27 STR
  531,18: "template7"

217 , MoreThanOneExpr
  531,29: ,
  531,31: 3, 13

54 NUM
  531,31: 3

217 , MoreThanOneExpr
  531,32: ,
  531,34: 13

54 NUM
  531,34: 13

238 )
  531,36: )

210 CR_token2
  531,37: 


160 ID . ID ( Exprs )
  532,3: Array
  532,8: .
  532,9: SetValue
  532,17: (
  532,18: "template7", "color", "Red"
  532,45: )

184 . ID ( Exprs )
  532,8: .
  532,9: SetValue
  532,17: (
  532,18: "template7", "color", "Red"
  532,45: )

255 ID ( Exprs )
  532,9: SetValue
  532,17: (
  532,18: "template7", "color", "Red"
  532,45: )

221 ( Exprs )
  532,17: (
  532,18: "template7", "color", "Red"
  532,45: )

27 STR
  532,18: "template7"

217 , MoreThanOneExpr
  532,29: ,
  532,31: "color", "Red"

54 STR
  532,31: "color"

217 , MoreThanOneExpr
  532,38: ,
  532,40: "Red"

54 STR
  532,40: "Red"

238 )
  532,45: )

210 CR_token2
  532,46: 


160 ID . ID ( Exprs )
  533,3: Array
  533,8: .
  533,9: SetValue
  533,17: (
  533,18: "template7", "dim", 4
  533,39: )

184 . ID ( Exprs )
  533,8: .
  533,9: SetValue
  533,17: (
  533,18: "template7", "dim", 4
  533,39: )

255 ID ( Exprs )
  533,9: SetValue
  533,17: (
  533,18: "template7", "dim", 4
  533,39: )

221 ( Exprs )
  533,17: (
  533,18: "template7", "dim", 4
  533,39: )

27 STR
  533,18: "template7"

217 , MoreThanOneExpr
  533,29: ,
  533,31: "dim", 4

54 STR
  533,31: "dim"

217 , MoreThanOneExpr
  533,36: ,
  533,38: 4

54 NUM
  533,38: 4

238 )
  533,39: )

210 CR_token2
  533,40: 


160 ID . ID ( Exprs )
  534,3: Array
  534,8: .
  534,9: SetValue
  534,17: (
  534,18: "template7", "pviewx", 0
  534,42: )

184 . ID ( Exprs )
  534,8: .
  534,9: SetValue
  534,17: (
  534,18: "template7", "pviewx", 0
  534,42: )

255 ID ( Exprs )
  534,9: SetValue
  534,17: (
  534,18: "template7", "pviewx", 0
  534,42: )

221 ( Exprs )
  534,17: (
  534,18: "template7", "pviewx", 0
  534,42: )

27 STR
  534,18: "template7"

217 , MoreThanOneExpr
  534,29: ,
  534,31: "pviewx", 0

54 STR
  534,31: "pviewx"

217 , MoreThanOneExpr
  534,39: ,
  534,41: 0

54 NUM
  534,41: 0

238 )
  534,42: )

210 CR_token2
  534,43: 


160 ID . ID ( Exprs )
  535,3: Array
  535,8: .
  535,9: SetValue
  535,17: (
  535,18: "template7", "pviewy", 0
  535,42: )

184 . ID ( Exprs )
  535,8: .
  535,9: SetValue
  535,17: (
  535,18: "template7", "pviewy", 0
  535,42: )

255 ID ( Exprs )
  535,9: SetValue
  535,17: (
  535,18: "template7", "pviewy", 0
  535,42: )

221 ( Exprs )
  535,17: (
  535,18: "template7", "pviewy", 0
  535,42: )

27 STR
  535,18: "template7"

217 , MoreThanOneExpr
  535,29: ,
  535,31: "pviewy", 0

54 STR
  535,31: "pviewy"

217 , MoreThanOneExpr
  535,39: ,
  535,41: 0

54 NUM
  535,41: 0

238 )
  535,42: )

210 CR_token2
  535,43: 


257 Stmt_token8
  536,1: EndSub

