0 Start_repeat1
  2,1: -----------------------------------------------------------------------------------------
'To-Do
'-----------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------
'initialize the window first
'-----------------------------------------------------------------------------------------
GraphicsWindow.Hide()
GraphicsWindow.CanResize  = "false"
GraphicsWindow.Width = 1024 
GraphicsWindow.Height = 768
GraphicsWindow.Title = "SOkoCUTE"
GraphicsWindow.Left = (Desktop.Width - 1024) / 2
GraphicsWindow.Top  = (Desktop.Height - 768) / 2

'-----------------------------------------------------------------------------------------
'preload some gfx
'-----------------------------------------------------------------------------------------
Path = "http://smallbasic.com/drop/soko"
background = ImageList.LoadImage( Path + "/sokocuteff.png")
image["A"] = ImageList.LoadImage( Path + "/sokocute0a.png")
image["B"] = ImageList.LoadImage( Path + "/sokocute0b.png")
image["7"] = ImageList.LoadImage( Path + "/sokocute07.png")
image["6"] = ImageList.LoadImage( Path + "/sokocute06.png")
image["5"] = ImageList.LoadImage( Path + "/sokocute05.png")
image["4"] = ImageList.LoadImage( Path + "/sokocute04.png")
image["3"] = ImageList.LoadImage( Path + "/sokocute03.png")
image["2"] = ImageList.LoadImage( Path + "/sokocutegg.png")
image["1"] = ImageList.LoadImage( Path + "/sokocutess.png")
image["0"] = ImageList.LoadImage( Path + "/sokocute00.png")
star       = ImageList.LoadImage( Path + "/sokocutels.png")
heart      = ImageList.LoadImage( Path + "/sokocutelh.png")
'GraphicsWindow.DrawText(100,100, Program.Directory)
GraphicsWindow.DrawImage(background, 0, 0)
'-----------------------------------------------------------------------------------------
'init the keys
'-----------------------------------------------------------------------------------------
leftKey  = "Left"
rightKey = "Right"
forwardKey = "Up"
backKey = "Down"
fireKey = "Space"
returnKey = "Return"
escapeKey = "Escape"
pauseKey = "P"
resetKey = "R"
pluskey = "F1"
minusKey = "F2"
'important var for moving the crystals
korrx = 36
'init any other var
animtime = 1500
status = "start"
game="gamearray"
block = "blockArray"
true = 1
false = 0
stage = 0

'init level data
InitLevels()
'init stars and hearts
InitStars()
ResetStars()

' animate title at first
titleshape = Shapes.AddImage(Path + "/sokocute.png")
Shapes.Move(titleshape, 140,-350)
Shapes.Animate(titleshape, 140,170, 2500)

txtstart = Shapes.AddImage(Path + "/sokocutetx.png")
Shapes.Move(txtstart, 305,1800)
Shapes.Animate(txtstart, 305,420, 3000)

'calculate delay (higher number means more precision)
timestart = Clock.ElapsedMilliseconds
i = 0
while (i < 500000)
i = i + 1
Endwhile  
timeloop = Clock.ElapsedMilliseconds - timestart
mssec = timeloop / 500000
loopmssec = 1 / mssec

KeyUp()
Main()

Sub Main
  GraphicsWindow.Show()
  GraphicsWindow.KeyDown = KeyDown
  GraphicsWindow.KeyUp   = KeyUp  
  endtime = Clock.ElapsedMilliseconds
  starttime = Clock.ElapsedMilliseconds
  blinktime = Clock.ElapsedMilliseconds
  gamestarttime = Clock.ElapsedMilliseconds
  
  gemfall = false
  freecells = 1
  blink     = 0
  fps = 0
  looptime = 0  
  play = 1
  pause = 0
  rot = 0
  
  While(play = 1)
    
    fps = fps + 1
         
    Input()
    if status = "game" then


      'try fixed fps - 60 might be enough
      loopdelay = (1000/60) * loopmssec 
      num = 0
      While(num < loopdelay)
        num = num + 1
      endwhile
      
      
      If gemfall = false and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 then
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true
      EndIf
      If gemfall = true and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 and Clock.ElapsedMilliseconds - watertime < 1400 then
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  
      EndIf
      If gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 1400 then
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false
      EndIf
                 
         
      
        If (gemchng <> 99) And (Clock.ElapsedMilliseconds - gemtime > 400) Then
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99
        EndIf
    
        'move the player
        If newmove < 25 Then
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 
        EndIf
    
    
        'blinking crystals when level is done
        If freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350 then  
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds
        EndIf
        
      ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif
       EndIf
       
       ' show time and fps
       If Clock.ElapsedMilliseconds - endtime > 1000 And status = "game" Then
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0
        EndIf
    EndIf  'of Status = game
  
    'reset level after a short delay  
    If status ="reset" And (Clock.ElapsedMilliseconds - resettime > 2500) Then
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.FillRectangle(800,690,224,80)
      freecells = 1
      blink = 0
      LevelRelease()
      LevelLoad()
      wait1 = Clock.ElapsedMilliseconds
      While Clock.ElapsedMilliseconds - wait1 < 3000
      EndWhile  
      starttime = Clock.ElapsedMilliseconds   
      status = "game" 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FontName = "COMIC SANS MS"
      GraphicsWindow.FontSize = 25
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.BrushColor = "white"
      GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      GraphicsWindow.DrawText(70, 725, " level "+ (stage + 1) )
    EndIf
    If status = "start" then   
      MoveStars()        
    endif
    
  EndWhile
EndSub


Sub KeyDown
  
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  bescapeKey  = false
  
  
  If GraphicsWindow.LastKey = leftKey then
    bleftKey = true
  elseif GraphicsWindow.LastKey = rightKey then
    brightKey = true   
  elseif GraphicsWindow.LastKey = forwardKey then
    bforwardKey = true
  elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif
  
endSub

Sub KeyUp
  ' reset every key first
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  breturnKey  = false
  
  If GraphicsWindow.LastKey = pauseKey then 
    LevelExplosion()
  EndIf
 
 
  If GraphicsWindow.LastKey = escapeKey and status = "start" then
    Program.End()
  EndIf

  
  If GraphicsWindow.LastKey = escapeKey And status = "game" then 
    LevelExplosion()
    stage = 0
    Shapes.Animate(titleshape, 140,170, 2500)
    Shapes.Animate(txtstart, 305,420, 3000)
    GraphicsWindow.BrushColor = "#3975e5"
    GraphicsWindow.FillRectangle(70,690,170,80)
    GraphicsWindow.FillRectangle(800,690,224,85)
    status = "start"
    ResetStars()
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = resetKey then 
    LevelExplosion()
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = pluskey then 
    LevelExplosion()
    'stage = stage + 1   'uncomment this line to cheat with F1
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf

  If GraphicsWindow.LastKey = minuskey then 
    'KeyUp()
    LevelExplosion()
    'stage = stage - 1  'uncomment this line to cheat with F2
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  'reload title after <escape>
  If GraphicsWindow.LastKey = returnKey and status = "start" then 
    Shapes.Animate(titleshape, 140,-350, 2000)
    Shapes.Animate(txtstart, 305, 1220, 1600)
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
EndSub



Sub Input
   
  If newmove >= 25  and blink = 0 then   
  
    'move right  
    If(brightKey   = true) and (level[posy][posx+1] <= 2) Then   
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  
  ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf          
  EndIf
EndSub




Sub Sort  
   For y = 0 To 15
     For x = 0 To 15
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])
    EndFor
  EndFor  
EndSub
  
  
Sub LevelExplosion  
  
  Shapes.Animate(player1, Shapes.GetLeft(player1), 1500, 4000)
  Shapes.Animate(player2, Shapes.GetLeft(player2), 1500, 4000)  

  For i = 0 To shade
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      Shapes.Animate(Shadow[i], xv + 512, yv + 350, 1500)
  EndFor  
  
  For i = 0 To cryst
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      If Shapes.GetTop(crystalimg[i]) > 0 then
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)
      EndIf
      If Shapes.GetTop(crystalbnk[i]) > 0 then
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)
      EndIf
    EndFor  
  
    For y = 0 To 15
     For x = 0 To 19
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)
    EndFor
  EndFor      
EndSub


Sub LevelRelease  
   For y = 0 To 15
     For x = 0 To 19         
       Shapes.Remove(levelshapes[y][x])
    EndFor
  EndFor  
  For i = 0 To shade         
      Shapes.Remove(Shadow[i])
  EndFor  
  
  For i = 0 To cryst
        Shapes.Remove(crystalimg[i])
        Shapes.Remove(crystalbnk[i])
  EndFor   
  For i = 0 To 20
    Shapes.Remove(star)  
  endFor
EndSub

Sub LevelLoad
  cryst = 0
  posx  = 4
  posy  = 4
  moves = 0
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      
    EndFor
  EndFor
         
  
  'load the water first
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      
    EndFor  
  EndFor
  
  'shadows for the water
  LoadShadowWater()
  
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   
    EndFor  
  EndFor   
  
  'tried to fix strange Shapes.Animate behaviors if there are too many shapes flying around - no real  success... 
  loopdelay = (1600) * loopmssec 
   num = 0
   While(num < loopdelay)
    num = num + 1
  endwhile
  
  'load blocks
  f = 0
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      
    EndFor  
  EndFor
  player1 = Shapes.AddImage(Path + "/sokocutep2.png")
 
  'load lower player shape first. it has to be behind the walls 
  Shapes.Move(player1, (posx) * 50 + korrx, (posy) * 40 - 0) 

  LoadShadow()
  '------------------------------------------------------------
  'load the walls
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  
  EndFor
  
  'load players face at last. It has always to be in front of the walls
  player2 = Shapes.AddImage(Path + "/sokocutep1.png")
  Shapes.Move(player2, (posx) * 50 + korrx, (posy) * 40 - 0)  
  xplayer = Shapes.GetLeft(player1)
  yplayer = Shapes.GetTop(player1)  

EndSub

sub LoadShadow
  

  For y = 0 To 15
     For x = 0 To 19
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   
 
EndSub

sub LoadShadowWater 
  shade = 0
 ky = 22
  For y = 0 To 15
     For x = 0 To 19
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   

EndSub

Sub InitStars
  For i = 0 To 12
    star[i] = Shapes.AddImage(Path + "/sokocutels.png")  
    heart[i] = Shapes.AddImage(Path + "/sokocutelh.png") 
  endFor
EndSub


Sub ResetStars
  For i = 0 To 12
    angle = Math.GetRandomNumber(360)
    starxv[i] = Math.Cos(angle * 0.0174) * 0.50
    staryv[i] = Math.Sin(angle * 0.0174) * 0.50    
    starx[i] = 1000
    stary[i] = 1000   
    startime[i] = Math.GetRandomNumber(100)
    Shapes.Move(star[i], starx[i], stary[i])  
  endFor
  For i = 0 To 12
   angle = Math.GetRandomNumber(360)
   heartxv[i] = Math.Cos(angle * 0.0174) * 0.50
   heartyv[i] = Math.Sin(angle * 0.0174) * 0.50    
   heartx[i] = 1000
   hearty[i] = 1000   
   hearttime[i] = Math.GetRandomNumber(100)
   Shapes.Move(heart[i], heartx[i], hearty[i])  
 endFor
EndSub

' move stars and hearts
Sub MoveStars
  
      For i = 0 to 12
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      
    EndFor  
    
    
    For i = 0 to 12
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Rotate(heart[i], hearttime[i] * -10)
      Shapes.Zoom(heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32) )
      Shapes.Move(heart[i], heartx[i], hearty[i])      
    EndFor  
  
EndSub


Sub InitLevels
  
block[0][0] = "                    "
block[0][1] = "                    "
block[0][2] = "                    "
block[0][3] = "     66666          "
block[0][4] = "     60006          "
block[0][5] = "     62006          "
block[0][6] = "   66600266         "
block[0][7] = "   60020206         "
block[0][8] = " 6660606606AA555555 "
block[0][9] = " 600060660666700115 "
block[0][10]= " 60200200000X000115 "
block[0][11]= " 666660666066700115 "
block[0][12]= "     60000066555555 "
block[0][13]= "     6666666        "
block[0][14]= "                    "
block[0][15]= "                    "

block[1][0] = "                    "
block[1][1] = "                    "
block[1][2] = "                    "
block[1][3] = "       6666666      "
block[1][4] = "  76666600000667    "
block[1][5] = "  61111602002006    "
block[1][6] = "  61100626666006    "
block[1][7] = "  6110000X066006    "
block[1][8] = "  61100606002076    "
block[1][9] = "  76666606620206    "
block[1][10]= "    602002020206    "
block[1][11]= "    600007000006    "
block[1][12]= "    766666666667    "
block[1][13]= "                    "
block[1][14]= "                    "
block[1][15]= "                    "

block[2][0] = "                    "
block[2][1] = "                    "
block[2][2] = "                    "
block[2][3] = "         76666667   "
block[2][4] = "         600000X6   "
block[2][5] = "         60262066   "
block[2][6] = "         6020026    "
block[2][7] = "         6720206    "
block[2][8] = " 7666666 602060667  "
block[2][9] = " 61111066602002006  "
block[2][10]= " 61110000020020006  "
block[2][11]= " 61111066666666667  "
block[2][12]= " 7666666            "
block[2][13]= "                    "
block[2][14]= "                    "
block[2][15]= "                    "

block[3][0] = "                    "
block[3][1] = "                    "
block[3][2] = "6666663             "
block[3][3] = "611166366666  66666 "
block[3][4] = "611116360006  60006 "
block[3][5] = "6111163607066660706 "
block[3][6] = "600X063600200000006 "
block[3][7] = "6606663700602260666 "
block[3][8] = "5AAAA73A220060006   "
block[3][9] = "5ACAABBB002666206   "
block[3][10]= "5AA5AA3A700060006   "
block[3][11]= "5555553A666060726   "
block[3][12]= "AAAAAA3AAA6022006   "
block[3][13]= "33333333336000006   "
block[3][14]= "          6666666   "
block[3][15]= "                    "

block[4][0] = "                    "
block[4][1] = "                    "
block[4][2] = "          66666     "
block[4][3] = "    666666600067    "
block[4][4] = "   66070X6602206    "
block[4][5] = "   6000020000006    "
block[4][6] = "   6002006660006    "
block[4][7] = "   6660666662666    "
block[4][8] = "   602006660116     "
block[4][9] = "   602020201116     "
block[4][10]= "   600006661116     "
block[4][11]= "   602206 61116     "
block[4][12]= "   600666 76667     "
block[4][13]= "   7667             "
block[4][14]= "                    "
block[4][15]= "                    "

block[5][0] = "                    "
block[5][1] = "           4444444  "
block[5][2] = "           4AA1114  "
block[5][3] = "       66667AA1114  "
block[5][4] = "       60000AA1A14  "
block[5][5] = "       60067AA1114  "
block[5][6] = "       66066AA1114  "
block[5][7] = "      666066444444  "
block[5][8] = "      60222066AAAA  "
block[5][9] = "  6666600202066666  "
block[5][10]= " 66000720200070006  "
block[5][11]= " 6X020020000200206  "
block[5][12]= " 66666602202066666  "
block[5][13]= "      60000006      "
block[5][14]= "      66666666      "
block[5][15]= "                    "

block[6][0] = "                    "
block[6][1] = "     7777777777     "
block[6][2] = "     7110070007     "
block[6][3] = "     7110000007     "
block[6][4] = "     711007007777   "
block[6][5] = "    77777770070077  "
block[6][6] = "    70000000000007  "
block[6][7] = "    70070077007007  "
block[6][8] = "  7777077007777077  "
block[6][9] = "  7002007777707007  "
block[6][10]= "  7070200200702007  "
block[6][11]= "  70X2002000700077  "
block[6][12]= "  777707707777777   "
block[6][13]= "     700007         "
block[6][14]= "     777777         "
block[6][15]= "                    "

block[7][0] = "                    "
block[7][1] = "                    "
block[7][2] = "                    "
block[7][3] = "          4444      "
block[7][4] = "    4444444AY4      "
block[7][5] = "    4AAAAACAA4      "
block[7][6] = "    4AAAC77AC4      "
block[7][7] = "    44C71117A4      "
block[7][8] = "     4AC111AA4      "
block[7][9] = "     4A71A17A44     "
block[7][10]= "     4AAA7A7CA4     "
block[7][11]= "     4CAACAAAA4     "
block[7][12]= "     4AA4444444     "
block[7][13]= "     4444           "
block[7][14]= "                    "
block[7][15]= "                    "

block[8][0] = "                    "
block[8][1] = "                    "
block[8][2] = "          4444      "
block[8][3] = "  444444444AA77     "
block[8][4] = " 74AACAAAAAACA75557 "
block[8][5] = " 4ABB77B77BBA771115 "
block[8][6] = " 4A7DDBDBDD7C771115 "
block[8][7] = " 4A7BBBBZBB7AAA1115 "
block[8][8] = " 4ABD7B777DDAAA1115 "
block[8][9] = " 4ACAACCAACA7711115 "
block[8][10]= " 744CAAAAAAA7755557 "
block[8][11]= "   4AA4444444       "
block[8][12]= "   4444             "
block[8][13]= "                    "
block[8][14]= "                    "
block[8][15]= "                    "

block[9][0] = " AAAAA A   A AAAA   "
block[9][1] = "   A   A   A A      "
block[9][2] = "   A   AAAAA AAA    "
block[9][3] = "   A   A   A A      "
block[9][4] = "   A   A   A AAAA   "
block[9][5] = 

0 Start_repeat1
  2,1: 'To-Do
'-----------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------
'initialize the window first
'-----------------------------------------------------------------------------------------
GraphicsWindow.Hide()
GraphicsWindow.CanResize  = "false"
GraphicsWindow.Width = 1024 
GraphicsWindow.Height = 768
GraphicsWindow.Title = "SOkoCUTE"
GraphicsWindow.Left = (Desktop.Width - 1024) / 2
GraphicsWindow.Top  = (Desktop.Height - 768) / 2

'-----------------------------------------------------------------------------------------
'preload some gfx
'-----------------------------------------------------------------------------------------
Path = "http://smallbasic.com/drop/soko"
background = ImageList.LoadImage( Path + "/sokocuteff.png")
image["A"] = ImageList.LoadImage( Path + "/sokocute0a.png")
image["B"] = ImageList.LoadImage( Path + "/sokocute0b.png")
image["7"] = ImageList.LoadImage( Path + "/sokocute07.png")
image["6"] = ImageList.LoadImage( Path + "/sokocute06.png")
image["5"] = ImageList.LoadImage( Path + "/sokocute05.png")
image["4"] = ImageList.LoadImage( Path + "/sokocute04.png")
image["3"] = ImageList.LoadImage( Path + "/sokocute03.png")
image["2"] = ImageList.LoadImage( Path + "/sokocutegg.png")
image["1"] = ImageList.LoadImage( Path + "/sokocutess.png")
image["0"] = ImageList.LoadImage( Path + "/sokocute00.png")
star       = ImageList.LoadImage( Path + "/sokocutels.png")
heart      = ImageList.LoadImage( Path + "/sokocutelh.png")
'GraphicsWindow.DrawText(100,100, Program.Directory)
GraphicsWindow.DrawImage(background, 0, 0)
'-----------------------------------------------------------------------------------------
'init the keys
'-----------------------------------------------------------------------------------------
leftKey  = "Left"
rightKey = "Right"
forwardKey = "Up"
backKey = "Down"
fireKey = "Space"
returnKey = "Return"
escapeKey = "Escape"
pauseKey = "P"
resetKey = "R"
pluskey = "F1"
minusKey = "F2"
'important var for moving the crystals
korrx = 36
'init any other var
animtime = 1500
status = "start"
game="gamearray"
block = "blockArray"
true = 1
false = 0
stage = 0

'init level data
InitLevels()
'init stars and hearts
InitStars()
ResetStars()

' animate title at first
titleshape = Shapes.AddImage(Path + "/sokocute.png")
Shapes.Move(titleshape, 140,-350)
Shapes.Animate(titleshape, 140,170, 2500)

txtstart = Shapes.AddImage(Path + "/sokocutetx.png")
Shapes.Move(txtstart, 305,1800)
Shapes.Animate(txtstart, 305,420, 3000)

'calculate delay (higher number means more precision)
timestart = Clock.ElapsedMilliseconds
i = 0
while (i < 500000)
i = i + 1
Endwhile  
timeloop = Clock.ElapsedMilliseconds - timestart
mssec = timeloop / 500000
loopmssec = 1 / mssec

KeyUp()
Main()

Sub Main
  GraphicsWindow.Show()
  GraphicsWindow.KeyDown = KeyDown
  GraphicsWindow.KeyUp   = KeyUp  
  endtime = Clock.ElapsedMilliseconds
  starttime = Clock.ElapsedMilliseconds
  blinktime = Clock.ElapsedMilliseconds
  gamestarttime = Clock.ElapsedMilliseconds
  
  gemfall = false
  freecells = 1
  blink     = 0
  fps = 0
  looptime = 0  
  play = 1
  pause = 0
  rot = 0
  
  While(play = 1)
    
    fps = fps + 1
         
    Input()
    if status = "game" then


      'try fixed fps - 60 might be enough
      loopdelay = (1000/60) * loopmssec 
      num = 0
      While(num < loopdelay)
        num = num + 1
      endwhile
      
      
      If gemfall = false and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 then
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true
      EndIf
      If gemfall = true and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 and Clock.ElapsedMilliseconds - watertime < 1400 then
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  
      EndIf
      If gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 1400 then
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false
      EndIf
                 
         
      
        If (gemchng <> 99) And (Clock.ElapsedMilliseconds - gemtime > 400) Then
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99
        EndIf
    
        'move the player
        If newmove < 25 Then
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 
        EndIf
    
    
        'blinking crystals when level is done
        If freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350 then  
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds
        EndIf
        
      ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif
       EndIf
       
       ' show time and fps
       If Clock.ElapsedMilliseconds - endtime > 1000 And status = "game" Then
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0
        EndIf
    EndIf  'of Status = game
  
    'reset level after a short delay  
    If status ="reset" And (Clock.ElapsedMilliseconds - resettime > 2500) Then
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.FillRectangle(800,690,224,80)
      freecells = 1
      blink = 0
      LevelRelease()
      LevelLoad()
      wait1 = Clock.ElapsedMilliseconds
      While Clock.ElapsedMilliseconds - wait1 < 3000
      EndWhile  
      starttime = Clock.ElapsedMilliseconds   
      status = "game" 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FontName = "COMIC SANS MS"
      GraphicsWindow.FontSize = 25
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.BrushColor = "white"
      GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      GraphicsWindow.DrawText(70, 725, " level "+ (stage + 1) )
    EndIf
    If status = "start" then   
      MoveStars()        
    endif
    
  EndWhile
EndSub


Sub KeyDown
  
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  bescapeKey  = false
  
  
  If GraphicsWindow.LastKey = leftKey then
    bleftKey = true
  elseif GraphicsWindow.LastKey = rightKey then
    brightKey = true   
  elseif GraphicsWindow.LastKey = forwardKey then
    bforwardKey = true
  elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif
  
endSub

Sub KeyUp
  ' reset every key first
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  breturnKey  = false
  
  If GraphicsWindow.LastKey = pauseKey then 
    LevelExplosion()
  EndIf
 
 
  If GraphicsWindow.LastKey = escapeKey and status = "start" then
    Program.End()
  EndIf

  
  If GraphicsWindow.LastKey = escapeKey And status = "game" then 
    LevelExplosion()
    stage = 0
    Shapes.Animate(titleshape, 140,170, 2500)
    Shapes.Animate(txtstart, 305,420, 3000)
    GraphicsWindow.BrushColor = "#3975e5"
    GraphicsWindow.FillRectangle(70,690,170,80)
    GraphicsWindow.FillRectangle(800,690,224,85)
    status = "start"
    ResetStars()
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = resetKey then 
    LevelExplosion()
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = pluskey then 
    LevelExplosion()
    'stage = stage + 1   'uncomment this line to cheat with F1
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf

  If GraphicsWindow.LastKey = minuskey then 
    'KeyUp()
    LevelExplosion()
    'stage = stage - 1  'uncomment this line to cheat with F2
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  'reload title after <escape>
  If GraphicsWindow.LastKey = returnKey and status = "start" then 
    Shapes.Animate(titleshape, 140,-350, 2000)
    Shapes.Animate(txtstart, 305, 1220, 1600)
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
EndSub



Sub Input
   
  If newmove >= 25  and blink = 0 then   
  
    'move right  
    If(brightKey   = true) and (level[posy][posx+1] <= 2) Then   
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  
  ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf          
  EndIf
EndSub




Sub Sort  
   For y = 0 To 15
     For x = 0 To 15
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])
    EndFor
  EndFor  
EndSub
  
  
Sub LevelExplosion  
  
  Shapes.Animate(player1, Shapes.GetLeft(player1), 1500, 4000)
  Shapes.Animate(player2, Shapes.GetLeft(player2), 1500, 4000)  

  For i = 0 To shade
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      Shapes.Animate(Shadow[i], xv + 512, yv + 350, 1500)
  EndFor  
  
  For i = 0 To cryst
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      If Shapes.GetTop(crystalimg[i]) > 0 then
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)
      EndIf
      If Shapes.GetTop(crystalbnk[i]) > 0 then
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)
      EndIf
    EndFor  
  
    For y = 0 To 15
     For x = 0 To 19
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)
    EndFor
  EndFor      
EndSub


Sub LevelRelease  
   For y = 0 To 15
     For x = 0 To 19         
       Shapes.Remove(levelshapes[y][x])
    EndFor
  EndFor  
  For i = 0 To shade         
      Shapes.Remove(Shadow[i])
  EndFor  
  
  For i = 0 To cryst
        Shapes.Remove(crystalimg[i])
        Shapes.Remove(crystalbnk[i])
  EndFor   
  For i = 0 To 20
    Shapes.Remove(star)  
  endFor
EndSub

Sub LevelLoad
  cryst = 0
  posx  = 4
  posy  = 4
  moves = 0
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      
    EndFor
  EndFor
         
  
  'load the water first
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      
    EndFor  
  EndFor
  
  'shadows for the water
  LoadShadowWater()
  
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   
    EndFor  
  EndFor   
  
  'tried to fix strange Shapes.Animate behaviors if there are too many shapes flying around - no real  success... 
  loopdelay = (1600) * loopmssec 
   num = 0
   While(num < loopdelay)
    num = num + 1
  endwhile
  
  'load blocks
  f = 0
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      
    EndFor  
  EndFor
  player1 = Shapes.AddImage(Path + "/sokocutep2.png")
 
  'load lower player shape first. it has to be behind the walls 
  Shapes.Move(player1, (posx) * 50 + korrx, (posy) * 40 - 0) 

  LoadShadow()
  '------------------------------------------------------------
  'load the walls
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  
  EndFor
  
  'load players face at last. It has always to be in front of the walls
  player2 = Shapes.AddImage(Path + "/sokocutep1.png")
  Shapes.Move(player2, (posx) * 50 + korrx, (posy) * 40 - 0)  
  xplayer = Shapes.GetLeft(player1)
  yplayer = Shapes.GetTop(player1)  

EndSub

sub LoadShadow
  

  For y = 0 To 15
     For x = 0 To 19
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   
 
EndSub

sub LoadShadowWater 
  shade = 0
 ky = 22
  For y = 0 To 15
     For x = 0 To 19
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   

EndSub

Sub InitStars
  For i = 0 To 12
    star[i] = Shapes.AddImage(Path + "/sokocutels.png")  
    heart[i] = Shapes.AddImage(Path + "/sokocutelh.png") 
  endFor
EndSub


Sub ResetStars
  For i = 0 To 12
    angle = Math.GetRandomNumber(360)
    starxv[i] = Math.Cos(angle * 0.0174) * 0.50
    staryv[i] = Math.Sin(angle * 0.0174) * 0.50    
    starx[i] = 1000
    stary[i] = 1000   
    startime[i] = Math.GetRandomNumber(100)
    Shapes.Move(star[i], starx[i], stary[i])  
  endFor
  For i = 0 To 12
   angle = Math.GetRandomNumber(360)
   heartxv[i] = Math.Cos(angle * 0.0174) * 0.50
   heartyv[i] = Math.Sin(angle * 0.0174) * 0.50    
   heartx[i] = 1000
   hearty[i] = 1000   
   hearttime[i] = Math.GetRandomNumber(100)
   Shapes.Move(heart[i], heartx[i], hearty[i])  
 endFor
EndSub

' move stars and hearts
Sub MoveStars
  
      For i = 0 to 12
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      
    EndFor  
    
    
    For i = 0 to 12
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Rotate(heart[i], hearttime[i] * -10)
      Shapes.Zoom(heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32) )
      Shapes.Move(heart[i], heartx[i], hearty[i])      
    EndFor  
  
EndSub


Sub InitLevels
  
block[0][0] = "                    "
block[0][1] = "                    "
block[0][2] = "                    "
block[0][3] = "     66666          "
block[0][4] = "     60006          "
block[0][5] = "     62006          "
block[0][6] = "   66600266         "
block[0][7] = "   60020206         "
block[0][8] = " 6660606606AA555555 "
block[0][9] = " 600060660666700115 "
block[0][10]= " 60200200000X000115 "
block[0][11]= " 666660666066700115 "
block[0][12]= "     60000066555555 "
block[0][13]= "     6666666        "
block[0][14]= "                    "
block[0][15]= "                    "

block[1][0] = "                    "
block[1][1] = "                    "
block[1][2] = "                    "
block[1][3] = "       6666666      "
block[1][4] = "  76666600000667    "
block[1][5] = "  61111602002006    "
block[1][6] = "  61100626666006    "
block[1][7] = "  6110000X066006    "
block[1][8] = "  61100606002076    "
block[1][9] = "  76666606620206    "
block[1][10]= "    602002020206    "
block[1][11]= "    600007000006    "
block[1][12]= "    766666666667    "
block[1][13]= "                    "
block[1][14]= "                    "
block[1][15]= "                    "

block[2][0] = "                    "
block[2][1] = "                    "
block[2][2] = "                    "
block[2][3] = "         76666667   "
block[2][4] = "         600000X6   "
block[2][5] = "         60262066   "
block[2][6] = "         6020026    "
block[2][7] = "         6720206    "
block[2][8] = " 7666666 602060667  "
block[2][9] = " 61111066602002006  "
block[2][10]= " 61110000020020006  "
block[2][11]= " 61111066666666667  "
block[2][12]= " 7666666            "
block[2][13]= "                    "
block[2][14]= "                    "
block[2][15]= "                    "

block[3][0] = "                    "
block[3][1] = "                    "
block[3][2] = "6666663             "
block[3][3] = "611166366666  66666 "
block[3][4] = "611116360006  60006 "
block[3][5] = "6111163607066660706 "
block[3][6] = "600X063600200000006 "
block[3][7] = "6606663700602260666 "
block[3][8] = "5AAAA73A220060006   "
block[3][9] = "5ACAABBB002666206   "
block[3][10]= "5AA5AA3A700060006   "
block[3][11]= "5555553A666060726   "
block[3][12]= "AAAAAA3AAA6022006   "
block[3][13]= "33333333336000006   "
block[3][14]= "          6666666   "
block[3][15]= "                    "

block[4][0] = "                    "
block[4][1] = "                    "
block[4][2] = "          66666     "
block[4][3] = "    666666600067    "
block[4][4] = "   66070X6602206    "
block[4][5] = "   6000020000006    "
block[4][6] = "   6002006660006    "
block[4][7] = "   6660666662666    "
block[4][8] = "   602006660116     "
block[4][9] = "   602020201116     "
block[4][10]= "   600006661116     "
block[4][11]= "   602206 61116     "
block[4][12]= "   600666 76667     "
block[4][13]= "   7667             "
block[4][14]= "                    "
block[4][15]= "                    "

block[5][0] = "                    "
block[5][1] = "           4444444  "
block[5][2] = "           4AA1114  "
block[5][3] = "       66667AA1114  "
block[5][4] = "       60000AA1A14  "
block[5][5] = "       60067AA1114  "
block[5][6] = "       66066AA1114  "
block[5][7] = "      666066444444  "
block[5][8] = "      60222066AAAA  "
block[5][9] = "  6666600202066666  "
block[5][10]= " 66000720200070006  "
block[5][11]= " 6X020020000200206  "
block[5][12]= " 66666602202066666  "
block[5][13]= "      60000006      "
block[5][14]= "      66666666      "
block[5][15]= "                    "

block[6][0] = "                    "
block[6][1] = "     7777777777     "
block[6][2] = "     7110070007     "
block[6][3] = "     7110000007     "
block[6][4] = "     711007007777   "
block[6][5] = "    77777770070077  "
block[6][6] = "    70000000000007  "
block[6][7] = "    70070077007007  "
block[6][8] = "  7777077007777077  "
block[6][9] = "  7002007777707007  "
block[6][10]= "  7070200200702007  "
block[6][11]= "  70X2002000700077  "
block[6][12]= "  777707707777777   "
block[6][13]= "     700007         "
block[6][14]= "     777777         "
block[6][15]= "                    "

block[7][0] = "                    "
block[7][1] = "                    "
block[7][2] = "                    "
block[7][3] = "          4444      "
block[7][4] = "    4444444AY4      "
block[7][5] = "    4AAAAACAA4      "
block[7][6] = "    4AAAC77AC4      "
block[7][7] = "    44C71117A4      "
block[7][8] = "     4AC111AA4      "
block[7][9] = "     4A71A17A44     "
block[7][10]= "     4AAA7A7CA4     "
block[7][11]= "     4CAACAAAA4     "
block[7][12]= "     4AA4444444     "
block[7][13]= "     4444           "
block[7][14]= "                    "
block[7][15]= "                    "

block[8][0] = "                    "
block[8][1] = "                    "
block[8][2] = "          4444      "
block[8][3] = "  444444444AA77     "
block[8][4] = " 74AACAAAAAACA75557 "
block[8][5] = " 4ABB77B77BBA771115 "
block[8][6] = " 4A7DDBDBDD7C771115 "
block[8][7] = " 4A7BBBBZBB7AAA1115 "
block[8][8] = " 4ABD7B777DDAAA1115 "
block[8][9] = " 4ACAACCAACA7711115 "
block[8][10]= " 744CAAAAAAA7755557 "
block[8][11]= "   4AA4444444       "
block[8][12]= "   4444             "
block[8][13]= "                    "
block[8][14]= "                    "
block[8][15]= "                    "

block[9][0] = " AAAAA A   A AAAA   "
block[9][1] = "   A   A   A A      "
block[9][2] = "   A   AAAAA AAA    "
block[9][3] = "   A   A   A A      "
block[9][4] = "   A   A   A AAAA   "
block[9][5] = "                    "
block[9][6] = "  AAAA A   A AAA    "
block[9][7] = "  A    AA  A A 

0 Start_repeat1
  3,1: '-----------------------------------------------------------------------------------------

'-----------------------------------------------------------------------------------------
'initialize the window first
'-----------------------------------------------------------------------------------------
GraphicsWindow.Hide()
GraphicsWindow.CanResize  = "false"
GraphicsWindow.Width = 1024 
GraphicsWindow.Height = 768
GraphicsWindow.Title = "SOkoCUTE"
GraphicsWindow.Left = (Desktop.Width - 1024) / 2
GraphicsWindow.Top  = (Desktop.Height - 768) / 2

'-----------------------------------------------------------------------------------------
'preload some gfx
'-----------------------------------------------------------------------------------------
Path = "http://smallbasic.com/drop/soko"
background = ImageList.LoadImage( Path + "/sokocuteff.png")
image["A"] = ImageList.LoadImage( Path + "/sokocute0a.png")
image["B"] = ImageList.LoadImage( Path + "/sokocute0b.png")
image["7"] = ImageList.LoadImage( Path + "/sokocute07.png")
image["6"] = ImageList.LoadImage( Path + "/sokocute06.png")
image["5"] = ImageList.LoadImage( Path + "/sokocute05.png")
image["4"] = ImageList.LoadImage( Path + "/sokocute04.png")
image["3"] = ImageList.LoadImage( Path + "/sokocute03.png")
image["2"] = ImageList.LoadImage( Path + "/sokocutegg.png")
image["1"] = ImageList.LoadImage( Path + "/sokocutess.png")
image["0"] = ImageList.LoadImage( Path + "/sokocute00.png")
star       = ImageList.LoadImage( Path + "/sokocutels.png")
heart      = ImageList.LoadImage( Path + "/sokocutelh.png")
'GraphicsWindow.DrawText(100,100, Program.Directory)
GraphicsWindow.DrawImage(background, 0, 0)
'-----------------------------------------------------------------------------------------
'init the keys
'-----------------------------------------------------------------------------------------
leftKey  = "Left"
rightKey = "Right"
forwardKey = "Up"
backKey = "Down"
fireKey = "Space"
returnKey = "Return"
escapeKey = "Escape"
pauseKey = "P"
resetKey = "R"
pluskey = "F1"
minusKey = "F2"
'important var for moving the crystals
korrx = 36
'init any other var
animtime = 1500
status = "start"
game="gamearray"
block = "blockArray"
true = 1
false = 0
stage = 0

'init level data
InitLevels()
'init stars and hearts
InitStars()
ResetStars()

' animate title at first
titleshape = Shapes.AddImage(Path + "/sokocute.png")
Shapes.Move(titleshape, 140,-350)
Shapes.Animate(titleshape, 140,170, 2500)

txtstart = Shapes.AddImage(Path + "/sokocutetx.png")
Shapes.Move(txtstart, 305,1800)
Shapes.Animate(txtstart, 305,420, 3000)

'calculate delay (higher number means more precision)
timestart = Clock.ElapsedMilliseconds
i = 0
while (i < 500000)
i = i + 1
Endwhile  
timeloop = Clock.ElapsedMilliseconds - timestart
mssec = timeloop / 500000
loopmssec = 1 / mssec

KeyUp()
Main()

Sub Main
  GraphicsWindow.Show()
  GraphicsWindow.KeyDown = KeyDown
  GraphicsWindow.KeyUp   = KeyUp  
  endtime = Clock.ElapsedMilliseconds
  starttime = Clock.ElapsedMilliseconds
  blinktime = Clock.ElapsedMilliseconds
  gamestarttime = Clock.ElapsedMilliseconds
  
  gemfall = false
  freecells = 1
  blink     = 0
  fps = 0
  looptime = 0  
  play = 1
  pause = 0
  rot = 0
  
  While(play = 1)
    
    fps = fps + 1
         
    Input()
    if status = "game" then


      'try fixed fps - 60 might be enough
      loopdelay = (1000/60) * loopmssec 
      num = 0
      While(num < loopdelay)
        num = num + 1
      endwhile
      
      
      If gemfall = false and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 then
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true
      EndIf
      If gemfall = true and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 and Clock.ElapsedMilliseconds - watertime < 1400 then
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  
      EndIf
      If gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 1400 then
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false
      EndIf
                 
         
      
        If (gemchng <> 99) And (Clock.ElapsedMilliseconds - gemtime > 400) Then
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99
        EndIf
    
        'move the player
        If newmove < 25 Then
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 
        EndIf
    
    
        'blinking crystals when level is done
        If freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350 then  
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds
        EndIf
        
      ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif
       EndIf
       
       ' show time and fps
       If Clock.ElapsedMilliseconds - endtime > 1000 And status = "game" Then
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0
        EndIf
    EndIf  'of Status = game
  
    'reset level after a short delay  
    If status ="reset" And (Clock.ElapsedMilliseconds - resettime > 2500) Then
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.FillRectangle(800,690,224,80)
      freecells = 1
      blink = 0
      LevelRelease()
      LevelLoad()
      wait1 = Clock.ElapsedMilliseconds
      While Clock.ElapsedMilliseconds - wait1 < 3000
      EndWhile  
      starttime = Clock.ElapsedMilliseconds   
      status = "game" 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FontName = "COMIC SANS MS"
      GraphicsWindow.FontSize = 25
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.BrushColor = "white"
      GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      GraphicsWindow.DrawText(70, 725, " level "+ (stage + 1) )
    EndIf
    If status = "start" then   
      MoveStars()        
    endif
    
  EndWhile
EndSub


Sub KeyDown
  
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  bescapeKey  = false
  
  
  If GraphicsWindow.LastKey = leftKey then
    bleftKey = true
  elseif GraphicsWindow.LastKey = rightKey then
    brightKey = true   
  elseif GraphicsWindow.LastKey = forwardKey then
    bforwardKey = true
  elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif
  
endSub

Sub KeyUp
  ' reset every key first
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  breturnKey  = false
  
  If GraphicsWindow.LastKey = pauseKey then 
    LevelExplosion()
  EndIf
 
 
  If GraphicsWindow.LastKey = escapeKey and status = "start" then
    Program.End()
  EndIf

  
  If GraphicsWindow.LastKey = escapeKey And status = "game" then 
    LevelExplosion()
    stage = 0
    Shapes.Animate(titleshape, 140,170, 2500)
    Shapes.Animate(txtstart, 305,420, 3000)
    GraphicsWindow.BrushColor = "#3975e5"
    GraphicsWindow.FillRectangle(70,690,170,80)
    GraphicsWindow.FillRectangle(800,690,224,85)
    status = "start"
    ResetStars()
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = resetKey then 
    LevelExplosion()
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = pluskey then 
    LevelExplosion()
    'stage = stage + 1   'uncomment this line to cheat with F1
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf

  If GraphicsWindow.LastKey = minuskey then 
    'KeyUp()
    LevelExplosion()
    'stage = stage - 1  'uncomment this line to cheat with F2
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  'reload title after <escape>
  If GraphicsWindow.LastKey = returnKey and status = "start" then 
    Shapes.Animate(titleshape, 140,-350, 2000)
    Shapes.Animate(txtstart, 305, 1220, 1600)
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
EndSub



Sub Input
   
  If newmove >= 25  and blink = 0 then   
  
    'move right  
    If(brightKey   = true) and (level[posy][posx+1] <= 2) Then   
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  
  ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf          
  EndIf
EndSub




Sub Sort  
   For y = 0 To 15
     For x = 0 To 15
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])
    EndFor
  EndFor  
EndSub
  
  
Sub LevelExplosion  
  
  Shapes.Animate(player1, Shapes.GetLeft(player1), 1500, 4000)
  Shapes.Animate(player2, Shapes.GetLeft(player2), 1500, 4000)  

  For i = 0 To shade
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      Shapes.Animate(Shadow[i], xv + 512, yv + 350, 1500)
  EndFor  
  
  For i = 0 To cryst
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      If Shapes.GetTop(crystalimg[i]) > 0 then
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)
      EndIf
      If Shapes.GetTop(crystalbnk[i]) > 0 then
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)
      EndIf
    EndFor  
  
    For y = 0 To 15
     For x = 0 To 19
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)
    EndFor
  EndFor      
EndSub


Sub LevelRelease  
   For y = 0 To 15
     For x = 0 To 19         
       Shapes.Remove(levelshapes[y][x])
    EndFor
  EndFor  
  For i = 0 To shade         
      Shapes.Remove(Shadow[i])
  EndFor  
  
  For i = 0 To cryst
        Shapes.Remove(crystalimg[i])
        Shapes.Remove(crystalbnk[i])
  EndFor   
  For i = 0 To 20
    Shapes.Remove(star)  
  endFor
EndSub

Sub LevelLoad
  cryst = 0
  posx  = 4
  posy  = 4
  moves = 0
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      
    EndFor
  EndFor
         
  
  'load the water first
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      
    EndFor  
  EndFor
  
  'shadows for the water
  LoadShadowWater()
  
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   
    EndFor  
  EndFor   
  
  'tried to fix strange Shapes.Animate behaviors if there are too many shapes flying around - no real  success... 
  loopdelay = (1600) * loopmssec 
   num = 0
   While(num < loopdelay)
    num = num + 1
  endwhile
  
  'load blocks
  f = 0
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      
    EndFor  
  EndFor
  player1 = Shapes.AddImage(Path + "/sokocutep2.png")
 
  'load lower player shape first. it has to be behind the walls 
  Shapes.Move(player1, (posx) * 50 + korrx, (posy) * 40 - 0) 

  LoadShadow()
  '------------------------------------------------------------
  'load the walls
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  
  EndFor
  
  'load players face at last. It has always to be in front of the walls
  player2 = Shapes.AddImage(Path + "/sokocutep1.png")
  Shapes.Move(player2, (posx) * 50 + korrx, (posy) * 40 - 0)  
  xplayer = Shapes.GetLeft(player1)
  yplayer = Shapes.GetTop(player1)  

EndSub

sub LoadShadow
  

  For y = 0 To 15
     For x = 0 To 19
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   
 
EndSub

sub LoadShadowWater 
  shade = 0
 ky = 22
  For y = 0 To 15
     For x = 0 To 19
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   

EndSub

Sub InitStars
  For i = 0 To 12
    star[i] = Shapes.AddImage(Path + "/sokocutels.png")  
    heart[i] = Shapes.AddImage(Path + "/sokocutelh.png") 
  endFor
EndSub


Sub ResetStars
  For i = 0 To 12
    angle = Math.GetRandomNumber(360)
    starxv[i] = Math.Cos(angle * 0.0174) * 0.50
    staryv[i] = Math.Sin(angle * 0.0174) * 0.50    
    starx[i] = 1000
    stary[i] = 1000   
    startime[i] = Math.GetRandomNumber(100)
    Shapes.Move(star[i], starx[i], stary[i])  
  endFor
  For i = 0 To 12
   angle = Math.GetRandomNumber(360)
   heartxv[i] = Math.Cos(angle * 0.0174) * 0.50
   heartyv[i] = Math.Sin(angle * 0.0174) * 0.50    
   heartx[i] = 1000
   hearty[i] = 1000   
   hearttime[i] = Math.GetRandomNumber(100)
   Shapes.Move(heart[i], heartx[i], hearty[i])  
 endFor
EndSub

' move stars and hearts
Sub MoveStars
  
      For i = 0 to 12
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      
    EndFor  
    
    
    For i = 0 to 12
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Rotate(heart[i], hearttime[i] * -10)
      Shapes.Zoom(heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32) )
      Shapes.Move(heart[i], heartx[i], hearty[i])      
    EndFor  
  
EndSub


Sub InitLevels
  
block[0][0] = "                    "
block[0][1] = "                    "
block[0][2] = "                    "
block[0][3] = "     66666          "
block[0][4] = "     60006          "
block[0][5] = "     62006          "
block[0][6] = "   66600266         "
block[0][7] = "   60020206         "
block[0][8] = " 6660606606AA555555 "
block[0][9] = " 600060660666700115 "
block[0][10]= " 60200200000X000115 "
block[0][11]= " 666660666066700115 "
block[0][12]= "     60000066555555 "
block[0][13]= "     6666666        "
block[0][14]= "                    "
block[0][15]= "                    "

block[1][0] = "                    "
block[1][1] = "                    "
block[1][2] = "                    "
block[1][3] = "       6666666      "
block[1][4] = "  76666600000667    "
block[1][5] = "  61111602002006    "
block[1][6] = "  61100626666006    "
block[1][7] = "  6110000X066006    "
block[1][8] = "  61100606002076    "
block[1][9] = "  76666606620206    "
block[1][10]= "    602002020206    "
block[1][11]= "    600007000006    "
block[1][12]= "    766666666667    "
block[1][13]= "                    "
block[1][14]= "                    "
block[1][15]= "                    "

block[2][0] = "                    "
block[2][1] = "                    "
block[2][2] = "                    "
block[2][3] = "         76666667   "
block[2][4] = "         600000X6   "
block[2][5] = "         60262066   "
block[2][6] = "         6020026    "
block[2][7] = "         6720206    "
block[2][8] = " 7666666 602060667  "
block[2][9] = " 61111066602002006  "
block[2][10]= " 61110000020020006  "
block[2][11]= " 61111066666666667  "
block[2][12]= " 7666666            "
block[2][13]= "                    "
block[2][14]= "                    "
block[2][15]= "                    "

block[3][0] = "                    "
block[3][1] = "                    "
block[3][2] = "6666663             "
block[3][3] = "611166366666  66666 "
block[3][4] = "611116360006  60006 "
block[3][5] = "6111163607066660706 "
block[3][6] = "600X063600200000006 "
block[3][7] = "6606663700602260666 "
block[3][8] = "5AAAA73A220060006   "
block[3][9] = "5ACAABBB002666206   "
block[3][10]= "5AA5AA3A700060006   "
block[3][11]= "5555553A666060726   "
block[3][12]= "AAAAAA3AAA6022006   "
block[3][13]= "33333333336000006   "
block[3][14]= "          6666666   "
block[3][15]= "                    "

block[4][0] = "                    "
block[4][1] = "                    "
block[4][2] = "          66666     "
block[4][3] = "    666666600067    "
block[4][4] = "   66070X6602206    "
block[4][5] = "   6000020000006    "
block[4][6] = "   6002006660006    "
block[4][7] = "   6660666662666    "
block[4][8] = "   602006660116     "
block[4][9] = "   602020201116     "
block[4][10]= "   600006661116     "
block[4][11]= "   602206 61116     "
block[4][12]= "   600666 76667     "
block[4][13]= "   7667             "
block[4][14]= "                    "
block[4][15]= "                    "

block[5][0] = "                    "
block[5][1] = "           4444444  "
block[5][2] = "           4AA1114  "
block[5][3] = "       66667AA1114  "
block[5][4] = "       60000AA1A14  "
block[5][5] = "       60067AA1114  "
block[5][6] = "       66066AA1114  "
block[5][7] = "      666066444444  "
block[5][8] = "      60222066AAAA  "
block[5][9] = "  6666600202066666  "
block[5][10]= " 66000720200070006  "
block[5][11]= " 6X020020000200206  "
block[5][12]= " 66666602202066666  "
block[5][13]= "      60000006      "
block[5][14]= "      66666666      "
block[5][15]= "                    "

block[6][0] = "                    "
block[6][1] = "     7777777777     "
block[6][2] = "     7110070007     "
block[6][3] = "     7110000007     "
block[6][4] = "     711007007777   "
block[6][5] = "    77777770070077  "
block[6][6] = "    70000000000007  "
block[6][7] = "    70070077007007  "
block[6][8] = "  7777077007777077  "
block[6][9] = "  7002007777707007  "
block[6][10]= "  7070200200702007  "
block[6][11]= "  70X2002000700077  "
block[6][12]= "  777707707777777   "
block[6][13]= "     700007         "
block[6][14]= "     777777         "
block[6][15]= "                    "

block[7][0] = "                    "
block[7][1] = "                    "
block[7][2] = "                    "
block[7][3] = "          4444      "
block[7][4] = "    4444444AY4      "
block[7][5] = "    4AAAAACAA4      "
block[7][6] = "    4AAAC77AC4      "
block[7][7] = "    44C71117A4      "
block[7][8] = "     4AC111AA4      "
block[7][9] = "     4A71A17A44     "
block[7][10]= "     4AAA7A7CA4     "
block[7][11]= "     4CAACAAAA4     "
block[7][12]= "     4AA4444444     "
block[7][13]= "     4444           "
block[7][14]= "                    "
block[7][15]= "                    "

block[8][0] = "                    "
block[8][1] = "                    "
block[8][2] = "          4444      "
block[8][3] = "  444444444AA77     "
block[8][4] = " 74AACAAAAAACA75557 "
block[8][5] = " 4ABB77B77BBA771115 "
block[8][6] = " 4A7DDBDBDD7C771115 "
block[8][7] = " 4A7BBBBZBB7AAA1115 "
block[8][8] = " 4ABD7B777DDAAA1115 "
block[8][9] = " 4ACAACCAACA7711115 "
block[8][10]= " 744CAAAAAAA7755557 "
block[8][11]= "   4AA4444444       "
block[8][12]= "   4444             "
block[8][13]= "                    "
block[8][14]= "                    "
block[8][15]= "                    "

block[9][0] = " AAAAA A   A AAAA   "
block[9][1] = "   A   A   A A      "
block[9][2] = "   A   AAAAA AAA    "
block[9][3] = "   A   A   A A      "
block[9][4] = "   A   A   A AAAA   "
block[9][5] = "                    "
block[9][6] = "  AAAA A   A AAA    "
block[9][7] = "  A    AA  A A  A   "


0 Start_repeat1
  4,1: 
'-----------------------------------------------------------------------------------------
'initialize the window first
'-----------------------------------------------------------------------------------------
GraphicsWindow.Hide()
GraphicsWindow.CanResize  = "false"
GraphicsWindow.Width = 1024 
GraphicsWindow.Height = 768
GraphicsWindow.Title = "SOkoCUTE"
GraphicsWindow.Left = (Desktop.Width - 1024) / 2
GraphicsWindow.Top  = (Desktop.Height - 768) / 2

'-----------------------------------------------------------------------------------------
'preload some gfx
'-----------------------------------------------------------------------------------------
Path = "http://smallbasic.com/drop/soko"
background = ImageList.LoadImage( Path + "/sokocuteff.png")
image["A"] = ImageList.LoadImage( Path + "/sokocute0a.png")
image["B"] = ImageList.LoadImage( Path + "/sokocute0b.png")
image["7"] = ImageList.LoadImage( Path + "/sokocute07.png")
image["6"] = ImageList.LoadImage( Path + "/sokocute06.png")
image["5"] = ImageList.LoadImage( Path + "/sokocute05.png")
image["4"] = ImageList.LoadImage( Path + "/sokocute04.png")
image["3"] = ImageList.LoadImage( Path + "/sokocute03.png")
image["2"] = ImageList.LoadImage( Path + "/sokocutegg.png")
image["1"] = ImageList.LoadImage( Path + "/sokocutess.png")
image["0"] = ImageList.LoadImage( Path + "/sokocute00.png")
star       = ImageList.LoadImage( Path + "/sokocutels.png")
heart      = ImageList.LoadImage( Path + "/sokocutelh.png")
'GraphicsWindow.DrawText(100,100, Program.Directory)
GraphicsWindow.DrawImage(background, 0, 0)
'-----------------------------------------------------------------------------------------
'init the keys
'-----------------------------------------------------------------------------------------
leftKey  = "Left"
rightKey = "Right"
forwardKey = "Up"
backKey = "Down"
fireKey = "Space"
returnKey = "Return"
escapeKey = "Escape"
pauseKey = "P"
resetKey = "R"
pluskey = "F1"
minusKey = "F2"
'important var for moving the crystals
korrx = 36
'init any other var
animtime = 1500
status = "start"
game="gamearray"
block = "blockArray"
true = 1
false = 0
stage = 0

'init level data
InitLevels()
'init stars and hearts
InitStars()
ResetStars()

' animate title at first
titleshape = Shapes.AddImage(Path + "/sokocute.png")
Shapes.Move(titleshape, 140,-350)
Shapes.Animate(titleshape, 140,170, 2500)

txtstart = Shapes.AddImage(Path + "/sokocutetx.png")
Shapes.Move(txtstart, 305,1800)
Shapes.Animate(txtstart, 305,420, 3000)

'calculate delay (higher number means more precision)
timestart = Clock.ElapsedMilliseconds
i = 0
while (i < 500000)
i = i + 1
Endwhile  
timeloop = Clock.ElapsedMilliseconds - timestart
mssec = timeloop / 500000
loopmssec = 1 / mssec

KeyUp()
Main()

Sub Main
  GraphicsWindow.Show()
  GraphicsWindow.KeyDown = KeyDown
  GraphicsWindow.KeyUp   = KeyUp  
  endtime = Clock.ElapsedMilliseconds
  starttime = Clock.ElapsedMilliseconds
  blinktime = Clock.ElapsedMilliseconds
  gamestarttime = Clock.ElapsedMilliseconds
  
  gemfall = false
  freecells = 1
  blink     = 0
  fps = 0
  looptime = 0  
  play = 1
  pause = 0
  rot = 0
  
  While(play = 1)
    
    fps = fps + 1
         
    Input()
    if status = "game" then


      'try fixed fps - 60 might be enough
      loopdelay = (1000/60) * loopmssec 
      num = 0
      While(num < loopdelay)
        num = num + 1
      endwhile
      
      
      If gemfall = false and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 then
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true
      EndIf
      If gemfall = true and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 and Clock.ElapsedMilliseconds - watertime < 1400 then
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  
      EndIf
      If gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 1400 then
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false
      EndIf
                 
         
      
        If (gemchng <> 99) And (Clock.ElapsedMilliseconds - gemtime > 400) Then
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99
        EndIf
    
        'move the player
        If newmove < 25 Then
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 
        EndIf
    
    
        'blinking crystals when level is done
        If freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350 then  
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds
        EndIf
        
      ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif
       EndIf
       
       ' show time and fps
       If Clock.ElapsedMilliseconds - endtime > 1000 And status = "game" Then
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0
        EndIf
    EndIf  'of Status = game
  
    'reset level after a short delay  
    If status ="reset" And (Clock.ElapsedMilliseconds - resettime > 2500) Then
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.FillRectangle(800,690,224,80)
      freecells = 1
      blink = 0
      LevelRelease()
      LevelLoad()
      wait1 = Clock.ElapsedMilliseconds
      While Clock.ElapsedMilliseconds - wait1 < 3000
      EndWhile  
      starttime = Clock.ElapsedMilliseconds   
      status = "game" 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FontName = "COMIC SANS MS"
      GraphicsWindow.FontSize = 25
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.BrushColor = "white"
      GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      GraphicsWindow.DrawText(70, 725, " level "+ (stage + 1) )
    EndIf
    If status = "start" then   
      MoveStars()        
    endif
    
  EndWhile
EndSub


Sub KeyDown
  
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  bescapeKey  = false
  
  
  If GraphicsWindow.LastKey = leftKey then
    bleftKey = true
  elseif GraphicsWindow.LastKey = rightKey then
    brightKey = true   
  elseif GraphicsWindow.LastKey = forwardKey then
    bforwardKey = true
  elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif
  
endSub

Sub KeyUp
  ' reset every key first
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  breturnKey  = false
  
  If GraphicsWindow.LastKey = pauseKey then 
    LevelExplosion()
  EndIf
 
 
  If GraphicsWindow.LastKey = escapeKey and status = "start" then
    Program.End()
  EndIf

  
  If GraphicsWindow.LastKey = escapeKey And status = "game" then 
    LevelExplosion()
    stage = 0
    Shapes.Animate(titleshape, 140,170, 2500)
    Shapes.Animate(txtstart, 305,420, 3000)
    GraphicsWindow.BrushColor = "#3975e5"
    GraphicsWindow.FillRectangle(70,690,170,80)
    GraphicsWindow.FillRectangle(800,690,224,85)
    status = "start"
    ResetStars()
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = resetKey then 
    LevelExplosion()
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = pluskey then 
    LevelExplosion()
    'stage = stage + 1   'uncomment this line to cheat with F1
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf

  If GraphicsWindow.LastKey = minuskey then 
    'KeyUp()
    LevelExplosion()
    'stage = stage - 1  'uncomment this line to cheat with F2
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  'reload title after <escape>
  If GraphicsWindow.LastKey = returnKey and status = "start" then 
    Shapes.Animate(titleshape, 140,-350, 2000)
    Shapes.Animate(txtstart, 305, 1220, 1600)
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
EndSub



Sub Input
   
  If newmove >= 25  and blink = 0 then   
  
    'move right  
    If(brightKey   = true) and (level[posy][posx+1] <= 2) Then   
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  
  ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf          
  EndIf
EndSub




Sub Sort  
   For y = 0 To 15
     For x = 0 To 15
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])
    EndFor
  EndFor  
EndSub
  
  
Sub LevelExplosion  
  
  Shapes.Animate(player1, Shapes.GetLeft(player1), 1500, 4000)
  Shapes.Animate(player2, Shapes.GetLeft(player2), 1500, 4000)  

  For i = 0 To shade
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      Shapes.Animate(Shadow[i], xv + 512, yv + 350, 1500)
  EndFor  
  
  For i = 0 To cryst
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      If Shapes.GetTop(crystalimg[i]) > 0 then
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)
      EndIf
      If Shapes.GetTop(crystalbnk[i]) > 0 then
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)
      EndIf
    EndFor  
  
    For y = 0 To 15
     For x = 0 To 19
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)
    EndFor
  EndFor      
EndSub


Sub LevelRelease  
   For y = 0 To 15
     For x = 0 To 19         
       Shapes.Remove(levelshapes[y][x])
    EndFor
  EndFor  
  For i = 0 To shade         
      Shapes.Remove(Shadow[i])
  EndFor  
  
  For i = 0 To cryst
        Shapes.Remove(crystalimg[i])
        Shapes.Remove(crystalbnk[i])
  EndFor   
  For i = 0 To 20
    Shapes.Remove(star)  
  endFor
EndSub

Sub LevelLoad
  cryst = 0
  posx  = 4
  posy  = 4
  moves = 0
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      
    EndFor
  EndFor
         
  
  'load the water first
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      
    EndFor  
  EndFor
  
  'shadows for the water
  LoadShadowWater()
  
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   
    EndFor  
  EndFor   
  
  'tried to fix strange Shapes.Animate behaviors if there are too many shapes flying around - no real  success... 
  loopdelay = (1600) * loopmssec 
   num = 0
   While(num < loopdelay)
    num = num + 1
  endwhile
  
  'load blocks
  f = 0
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      
    EndFor  
  EndFor
  player1 = Shapes.AddImage(Path + "/sokocutep2.png")
 
  'load lower player shape first. it has to be behind the walls 
  Shapes.Move(player1, (posx) * 50 + korrx, (posy) * 40 - 0) 

  LoadShadow()
  '------------------------------------------------------------
  'load the walls
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  
  EndFor
  
  'load players face at last. It has always to be in front of the walls
  player2 = Shapes.AddImage(Path + "/sokocutep1.png")
  Shapes.Move(player2, (posx) * 50 + korrx, (posy) * 40 - 0)  
  xplayer = Shapes.GetLeft(player1)
  yplayer = Shapes.GetTop(player1)  

EndSub

sub LoadShadow
  

  For y = 0 To 15
     For x = 0 To 19
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   
 
EndSub

sub LoadShadowWater 
  shade = 0
 ky = 22
  For y = 0 To 15
     For x = 0 To 19
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   

EndSub

Sub InitStars
  For i = 0 To 12
    star[i] = Shapes.AddImage(Path + "/sokocutels.png")  
    heart[i] = Shapes.AddImage(Path + "/sokocutelh.png") 
  endFor
EndSub


Sub ResetStars
  For i = 0 To 12
    angle = Math.GetRandomNumber(360)
    starxv[i] = Math.Cos(angle * 0.0174) * 0.50
    staryv[i] = Math.Sin(angle * 0.0174) * 0.50    
    starx[i] = 1000
    stary[i] = 1000   
    startime[i] = Math.GetRandomNumber(100)
    Shapes.Move(star[i], starx[i], stary[i])  
  endFor
  For i = 0 To 12
   angle = Math.GetRandomNumber(360)
   heartxv[i] = Math.Cos(angle * 0.0174) * 0.50
   heartyv[i] = Math.Sin(angle * 0.0174) * 0.50    
   heartx[i] = 1000
   hearty[i] = 1000   
   hearttime[i] = Math.GetRandomNumber(100)
   Shapes.Move(heart[i], heartx[i], hearty[i])  
 endFor
EndSub

' move stars and hearts
Sub MoveStars
  
      For i = 0 to 12
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      
    EndFor  
    
    
    For i = 0 to 12
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Rotate(heart[i], hearttime[i] * -10)
      Shapes.Zoom(heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32) )
      Shapes.Move(heart[i], heartx[i], hearty[i])      
    EndFor  
  
EndSub


Sub InitLevels
  
block[0][0] = "                    "
block[0][1] = "                    "
block[0][2] = "                    "
block[0][3] = "     66666          "
block[0][4] = "     60006          "
block[0][5] = "     62006          "
block[0][6] = "   66600266         "
block[0][7] = "   60020206         "
block[0][8] = " 6660606606AA555555 "
block[0][9] = " 600060660666700115 "
block[0][10]= " 60200200000X000115 "
block[0][11]= " 666660666066700115 "
block[0][12]= "     60000066555555 "
block[0][13]= "     6666666        "
block[0][14]= "                    "
block[0][15]= "                    "

block[1][0] = "                    "
block[1][1] = "                    "
block[1][2] = "                    "
block[1][3] = "       6666666      "
block[1][4] = "  76666600000667    "
block[1][5] = "  61111602002006    "
block[1][6] = "  61100626666006    "
block[1][7] = "  6110000X066006    "
block[1][8] = "  61100606002076    "
block[1][9] = "  76666606620206    "
block[1][10]= "    602002020206    "
block[1][11]= "    600007000006    "
block[1][12]= "    766666666667    "
block[1][13]= "                    "
block[1][14]= "                    "
block[1][15]= "                    "

block[2][0] = "                    "
block[2][1] = "                    "
block[2][2] = "                    "
block[2][3] = "         76666667   "
block[2][4] = "         600000X6   "
block[2][5] = "         60262066   "
block[2][6] = "         6020026    "
block[2][7] = "         6720206    "
block[2][8] = " 7666666 602060667  "
block[2][9] = " 61111066602002006  "
block[2][10]= " 61110000020020006  "
block[2][11]= " 61111066666666667  "
block[2][12]= " 7666666            "
block[2][13]= "                    "
block[2][14]= "                    "
block[2][15]= "                    "

block[3][0] = "                    "
block[3][1] = "                    "
block[3][2] = "6666663             "
block[3][3] = "611166366666  66666 "
block[3][4] = "611116360006  60006 "
block[3][5] = "6111163607066660706 "
block[3][6] = "600X063600200000006 "
block[3][7] = "6606663700602260666 "
block[3][8] = "5AAAA73A220060006   "
block[3][9] = "5ACAABBB002666206   "
block[3][10]= "5AA5AA3A700060006   "
block[3][11]= "5555553A666060726   "
block[3][12]= "AAAAAA3AAA6022006   "
block[3][13]= "33333333336000006   "
block[3][14]= "          6666666   "
block[3][15]= "                    "

block[4][0] = "                    "
block[4][1] = "                    "
block[4][2] = "          66666     "
block[4][3] = "    666666600067    "
block[4][4] = "   66070X6602206    "
block[4][5] = "   6000020000006    "
block[4][6] = "   6002006660006    "
block[4][7] = "   6660666662666    "
block[4][8] = "   602006660116     "
block[4][9] = "   602020201116     "
block[4][10]= "   600006661116     "
block[4][11]= "   602206 61116     "
block[4][12]= "   600666 76667     "
block[4][13]= "   7667             "
block[4][14]= "                    "
block[4][15]= "                    "

block[5][0] = "                    "
block[5][1] = "           4444444  "
block[5][2] = "           4AA1114  "
block[5][3] = "       66667AA1114  "
block[5][4] = "       60000AA1A14  "
block[5][5] = "       60067AA1114  "
block[5][6] = "       66066AA1114  "
block[5][7] = "      666066444444  "
block[5][8] = "      60222066AAAA  "
block[5][9] = "  6666600202066666  "
block[5][10]= " 66000720200070006  "
block[5][11]= " 6X020020000200206  "
block[5][12]= " 66666602202066666  "
block[5][13]= "      60000006      "
block[5][14]= "      66666666      "
block[5][15]= "                    "

block[6][0] = "                    "
block[6][1] = "     7777777777     "
block[6][2] = "     7110070007     "
block[6][3] = "     7110000007     "
block[6][4] = "     711007007777   "
block[6][5] = "    77777770070077  "
block[6][6] = "    70000000000007  "
block[6][7] = "    70070077007007  "
block[6][8] = "  7777077007777077  "
block[6][9] = "  7002007777707007  "
block[6][10]= "  7070200200702007  "
block[6][11]= "  70X2002000700077  "
block[6][12]= "  777707707777777   "
block[6][13]= "     700007         "
block[6][14]= "     777777         "
block[6][15]= "                    "

block[7][0] = "                    "
block[7][1] = "                    "
block[7][2] = "                    "
block[7][3] = "          4444      "
block[7][4] = "    4444444AY4      "
block[7][5] = "    4AAAAACAA4      "
block[7][6] = "    4AAAC77AC4      "
block[7][7] = "    44C71117A4      "
block[7][8] = "     4AC111AA4      "
block[7][9] = "     4A71A17A44     "
block[7][10]= "     4AAA7A7CA4     "
block[7][11]= "     4CAACAAAA4     "
block[7][12]= "     4AA4444444     "
block[7][13]= "     4444           "
block[7][14]= "                    "
block[7][15]= "                    "

block[8][0] = "                    "
block[8][1] = "                    "
block[8][2] = "          4444      "
block[8][3] = "  444444444AA77     "
block[8][4] = " 74AACAAAAAACA75557 "
block[8][5] = " 4ABB77B77BBA771115 "
block[8][6] = " 4A7DDBDBDD7C771115 "
block[8][7] = " 4A7BBBBZBB7AAA1115 "
block[8][8] = " 4ABD7B777DDAAA1115 "
block[8][9] = " 4ACAACCAACA7711115 "
block[8][10]= " 744CAAAAAAA7755557 "
block[8][11]= "   4AA4444444       "
block[8][12]= "   4444             "
block[8][13]= "                    "
block[8][14]= "                    "
block[8][15]= "                    "

block[9][0] = " AAAAA A   A AAAA   "
block[9][1] = "   A   A   A A      "
block[9][2] = "   A   AAAAA AAA    "
block[9][3] = "   A   A   A A      "
block[9][4] = "   A   A   A AAAA   "
block[9][5] = "                    "
block[9][6] = "  AAAA A   A AAA    "
block[9][7] = "  A    AA  A A  A   "
block[9][8] = "  AAA  A A A A  A   "
block[9][9]=  "  A    A  AA A  A   "
block[9][10]= "  

0 Start_repeat1
  6,1: 'initialize the window first
'-----------------------------------------------------------------------------------------
GraphicsWindow.Hide()
GraphicsWindow.CanResize  = "false"
GraphicsWindow.Width = 1024 
GraphicsWindow.Height = 768
GraphicsWindow.Title = "SOkoCUTE"
GraphicsWindow.Left = (Desktop.Width - 1024) / 2
GraphicsWindow.Top  = (Desktop.Height - 768) / 2

'-----------------------------------------------------------------------------------------
'preload some gfx
'-----------------------------------------------------------------------------------------
Path = "http://smallbasic.com/drop/soko"
background = ImageList.LoadImage( Path + "/sokocuteff.png")
image["A"] = ImageList.LoadImage( Path + "/sokocute0a.png")
image["B"] = ImageList.LoadImage( Path + "/sokocute0b.png")
image["7"] = ImageList.LoadImage( Path + "/sokocute07.png")
image["6"] = ImageList.LoadImage( Path + "/sokocute06.png")
image["5"] = ImageList.LoadImage( Path + "/sokocute05.png")
image["4"] = ImageList.LoadImage( Path + "/sokocute04.png")
image["3"] = ImageList.LoadImage( Path + "/sokocute03.png")
image["2"] = ImageList.LoadImage( Path + "/sokocutegg.png")
image["1"] = ImageList.LoadImage( Path + "/sokocutess.png")
image["0"] = ImageList.LoadImage( Path + "/sokocute00.png")
star       = ImageList.LoadImage( Path + "/sokocutels.png")
heart      = ImageList.LoadImage( Path + "/sokocutelh.png")
'GraphicsWindow.DrawText(100,100, Program.Directory)
GraphicsWindow.DrawImage(background, 0, 0)
'-----------------------------------------------------------------------------------------
'init the keys
'-----------------------------------------------------------------------------------------
leftKey  = "Left"
rightKey = "Right"
forwardKey = "Up"
backKey = "Down"
fireKey = "Space"
returnKey = "Return"
escapeKey = "Escape"
pauseKey = "P"
resetKey = "R"
pluskey = "F1"
minusKey = "F2"
'important var for moving the crystals
korrx = 36
'init any other var
animtime = 1500
status = "start"
game="gamearray"
block = "blockArray"
true = 1
false = 0
stage = 0

'init level data
InitLevels()
'init stars and hearts
InitStars()
ResetStars()

' animate title at first
titleshape = Shapes.AddImage(Path + "/sokocute.png")
Shapes.Move(titleshape, 140,-350)
Shapes.Animate(titleshape, 140,170, 2500)

txtstart = Shapes.AddImage(Path + "/sokocutetx.png")
Shapes.Move(txtstart, 305,1800)
Shapes.Animate(txtstart, 305,420, 3000)

'calculate delay (higher number means more precision)
timestart = Clock.ElapsedMilliseconds
i = 0
while (i < 500000)
i = i + 1
Endwhile  
timeloop = Clock.ElapsedMilliseconds - timestart
mssec = timeloop / 500000
loopmssec = 1 / mssec

KeyUp()
Main()

Sub Main
  GraphicsWindow.Show()
  GraphicsWindow.KeyDown = KeyDown
  GraphicsWindow.KeyUp   = KeyUp  
  endtime = Clock.ElapsedMilliseconds
  starttime = Clock.ElapsedMilliseconds
  blinktime = Clock.ElapsedMilliseconds
  gamestarttime = Clock.ElapsedMilliseconds
  
  gemfall = false
  freecells = 1
  blink     = 0
  fps = 0
  looptime = 0  
  play = 1
  pause = 0
  rot = 0
  
  While(play = 1)
    
    fps = fps + 1
         
    Input()
    if status = "game" then


      'try fixed fps - 60 might be enough
      loopdelay = (1000/60) * loopmssec 
      num = 0
      While(num < loopdelay)
        num = num + 1
      endwhile
      
      
      If gemfall = false and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 then
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true
      EndIf
      If gemfall = true and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 and Clock.ElapsedMilliseconds - watertime < 1400 then
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  
      EndIf
      If gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 1400 then
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false
      EndIf
                 
         
      
        If (gemchng <> 99) And (Clock.ElapsedMilliseconds - gemtime > 400) Then
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99
        EndIf
    
        'move the player
        If newmove < 25 Then
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 
        EndIf
    
    
        'blinking crystals when level is done
        If freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350 then  
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds
        EndIf
        
      ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif
       EndIf
       
       ' show time and fps
       If Clock.ElapsedMilliseconds - endtime > 1000 And status = "game" Then
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0
        EndIf
    EndIf  'of Status = game
  
    'reset level after a short delay  
    If status ="reset" And (Clock.ElapsedMilliseconds - resettime > 2500) Then
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.FillRectangle(800,690,224,80)
      freecells = 1
      blink = 0
      LevelRelease()
      LevelLoad()
      wait1 = Clock.ElapsedMilliseconds
      While Clock.ElapsedMilliseconds - wait1 < 3000
      EndWhile  
      starttime = Clock.ElapsedMilliseconds   
      status = "game" 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FontName = "COMIC SANS MS"
      GraphicsWindow.FontSize = 25
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.BrushColor = "white"
      GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      GraphicsWindow.DrawText(70, 725, " level "+ (stage + 1) )
    EndIf
    If status = "start" then   
      MoveStars()        
    endif
    
  EndWhile
EndSub


Sub KeyDown
  
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  bescapeKey  = false
  
  
  If GraphicsWindow.LastKey = leftKey then
    bleftKey = true
  elseif GraphicsWindow.LastKey = rightKey then
    brightKey = true   
  elseif GraphicsWindow.LastKey = forwardKey then
    bforwardKey = true
  elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif
  
endSub

Sub KeyUp
  ' reset every key first
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  breturnKey  = false
  
  If GraphicsWindow.LastKey = pauseKey then 
    LevelExplosion()
  EndIf
 
 
  If GraphicsWindow.LastKey = escapeKey and status = "start" then
    Program.End()
  EndIf

  
  If GraphicsWindow.LastKey = escapeKey And status = "game" then 
    LevelExplosion()
    stage = 0
    Shapes.Animate(titleshape, 140,170, 2500)
    Shapes.Animate(txtstart, 305,420, 3000)
    GraphicsWindow.BrushColor = "#3975e5"
    GraphicsWindow.FillRectangle(70,690,170,80)
    GraphicsWindow.FillRectangle(800,690,224,85)
    status = "start"
    ResetStars()
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = resetKey then 
    LevelExplosion()
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = pluskey then 
    LevelExplosion()
    'stage = stage + 1   'uncomment this line to cheat with F1
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf

  If GraphicsWindow.LastKey = minuskey then 
    'KeyUp()
    LevelExplosion()
    'stage = stage - 1  'uncomment this line to cheat with F2
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  'reload title after <escape>
  If GraphicsWindow.LastKey = returnKey and status = "start" then 
    Shapes.Animate(titleshape, 140,-350, 2000)
    Shapes.Animate(txtstart, 305, 1220, 1600)
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
EndSub



Sub Input
   
  If newmove >= 25  and blink = 0 then   
  
    'move right  
    If(brightKey   = true) and (level[posy][posx+1] <= 2) Then   
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  
  ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf          
  EndIf
EndSub




Sub Sort  
   For y = 0 To 15
     For x = 0 To 15
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])
    EndFor
  EndFor  
EndSub
  
  
Sub LevelExplosion  
  
  Shapes.Animate(player1, Shapes.GetLeft(player1), 1500, 4000)
  Shapes.Animate(player2, Shapes.GetLeft(player2), 1500, 4000)  

  For i = 0 To shade
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      Shapes.Animate(Shadow[i], xv + 512, yv + 350, 1500)
  EndFor  
  
  For i = 0 To cryst
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      If Shapes.GetTop(crystalimg[i]) > 0 then
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)
      EndIf
      If Shapes.GetTop(crystalbnk[i]) > 0 then
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)
      EndIf
    EndFor  
  
    For y = 0 To 15
     For x = 0 To 19
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)
    EndFor
  EndFor      
EndSub


Sub LevelRelease  
   For y = 0 To 15
     For x = 0 To 19         
       Shapes.Remove(levelshapes[y][x])
    EndFor
  EndFor  
  For i = 0 To shade         
      Shapes.Remove(Shadow[i])
  EndFor  
  
  For i = 0 To cryst
        Shapes.Remove(crystalimg[i])
        Shapes.Remove(crystalbnk[i])
  EndFor   
  For i = 0 To 20
    Shapes.Remove(star)  
  endFor
EndSub

Sub LevelLoad
  cryst = 0
  posx  = 4
  posy  = 4
  moves = 0
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      
    EndFor
  EndFor
         
  
  'load the water first
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      
    EndFor  
  EndFor
  
  'shadows for the water
  LoadShadowWater()
  
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   
    EndFor  
  EndFor   
  
  'tried to fix strange Shapes.Animate behaviors if there are too many shapes flying around - no real  success... 
  loopdelay = (1600) * loopmssec 
   num = 0
   While(num < loopdelay)
    num = num + 1
  endwhile
  
  'load blocks
  f = 0
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      
    EndFor  
  EndFor
  player1 = Shapes.AddImage(Path + "/sokocutep2.png")
 
  'load lower player shape first. it has to be behind the walls 
  Shapes.Move(player1, (posx) * 50 + korrx, (posy) * 40 - 0) 

  LoadShadow()
  '------------------------------------------------------------
  'load the walls
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  
  EndFor
  
  'load players face at last. It has always to be in front of the walls
  player2 = Shapes.AddImage(Path + "/sokocutep1.png")
  Shapes.Move(player2, (posx) * 50 + korrx, (posy) * 40 - 0)  
  xplayer = Shapes.GetLeft(player1)
  yplayer = Shapes.GetTop(player1)  

EndSub

sub LoadShadow
  

  For y = 0 To 15
     For x = 0 To 19
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   
 
EndSub

sub LoadShadowWater 
  shade = 0
 ky = 22
  For y = 0 To 15
     For x = 0 To 19
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   

EndSub

Sub InitStars
  For i = 0 To 12
    star[i] = Shapes.AddImage(Path + "/sokocutels.png")  
    heart[i] = Shapes.AddImage(Path + "/sokocutelh.png") 
  endFor
EndSub


Sub ResetStars
  For i = 0 To 12
    angle = Math.GetRandomNumber(360)
    starxv[i] = Math.Cos(angle * 0.0174) * 0.50
    staryv[i] = Math.Sin(angle * 0.0174) * 0.50    
    starx[i] = 1000
    stary[i] = 1000   
    startime[i] = Math.GetRandomNumber(100)
    Shapes.Move(star[i], starx[i], stary[i])  
  endFor
  For i = 0 To 12
   angle = Math.GetRandomNumber(360)
   heartxv[i] = Math.Cos(angle * 0.0174) * 0.50
   heartyv[i] = Math.Sin(angle * 0.0174) * 0.50    
   heartx[i] = 1000
   hearty[i] = 1000   
   hearttime[i] = Math.GetRandomNumber(100)
   Shapes.Move(heart[i], heartx[i], hearty[i])  
 endFor
EndSub

' move stars and hearts
Sub MoveStars
  
      For i = 0 to 12
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      
    EndFor  
    
    
    For i = 0 to 12
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Rotate(heart[i], hearttime[i] * -10)
      Shapes.Zoom(heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32) )
      Shapes.Move(heart[i], heartx[i], hearty[i])      
    EndFor  
  
EndSub


Sub InitLevels
  
block[0][0] = "                    "
block[0][1] = "                    "
block[0][2] = "                    "
block[0][3] = "     66666          "
block[0][4] = "     60006          "
block[0][5] = "     62006          "
block[0][6] = "   66600266         "
block[0][7] = "   60020206         "
block[0][8] = " 6660606606AA555555 "
block[0][9] = " 600060660666700115 "
block[0][10]= " 60200200000X000115 "
block[0][11]= " 666660666066700115 "
block[0][12]= "     60000066555555 "
block[0][13]= "     6666666        "
block[0][14]= "                    "
block[0][15]= "                    "

block[1][0] = "                    "
block[1][1] = "                    "
block[1][2] = "                    "
block[1][3] = "       6666666      "
block[1][4] = "  76666600000667    "
block[1][5] = "  61111602002006    "
block[1][6] = "  61100626666006    "
block[1][7] = "  6110000X066006    "
block[1][8] = "  61100606002076    "
block[1][9] = "  76666606620206    "
block[1][10]= "    602002020206    "
block[1][11]= "    600007000006    "
block[1][12]= "    766666666667    "
block[1][13]= "                    "
block[1][14]= "                    "
block[1][15]= "                    "

block[2][0] = "                    "
block[2][1] = "                    "
block[2][2] = "                    "
block[2][3] = "         76666667   "
block[2][4] = "         600000X6   "
block[2][5] = "         60262066   "
block[2][6] = "         6020026    "
block[2][7] = "         6720206    "
block[2][8] = " 7666666 602060667  "
block[2][9] = " 61111066602002006  "
block[2][10]= " 61110000020020006  "
block[2][11]= " 61111066666666667  "
block[2][12]= " 7666666            "
block[2][13]= "                    "
block[2][14]= "                    "
block[2][15]= "                    "

block[3][0] = "                    "
block[3][1] = "                    "
block[3][2] = "6666663             "
block[3][3] = "611166366666  66666 "
block[3][4] = "611116360006  60006 "
block[3][5] = "6111163607066660706 "
block[3][6] = "600X063600200000006 "
block[3][7] = "6606663700602260666 "
block[3][8] = "5AAAA73A220060006   "
block[3][9] = "5ACAABBB002666206   "
block[3][10]= "5AA5AA3A700060006   "
block[3][11]= "5555553A666060726   "
block[3][12]= "AAAAAA3AAA6022006   "
block[3][13]= "33333333336000006   "
block[3][14]= "          6666666   "
block[3][15]= "                    "

block[4][0] = "                    "
block[4][1] = "                    "
block[4][2] = "          66666     "
block[4][3] = "    666666600067    "
block[4][4] = "   66070X6602206    "
block[4][5] = "   6000020000006    "
block[4][6] = "   6002006660006    "
block[4][7] = "   6660666662666    "
block[4][8] = "   602006660116     "
block[4][9] = "   602020201116     "
block[4][10]= "   600006661116     "
block[4][11]= "   602206 61116     "
block[4][12]= "   600666 76667     "
block[4][13]= "   7667             "
block[4][14]= "                    "
block[4][15]= "                    "

block[5][0] = "                    "
block[5][1] = "           4444444  "
block[5][2] = "           4AA1114  "
block[5][3] = "       66667AA1114  "
block[5][4] = "       60000AA1A14  "
block[5][5] = "       60067AA1114  "
block[5][6] = "       66066AA1114  "
block[5][7] = "      666066444444  "
block[5][8] = "      60222066AAAA  "
block[5][9] = "  6666600202066666  "
block[5][10]= " 66000720200070006  "
block[5][11]= " 6X020020000200206  "
block[5][12]= " 66666602202066666  "
block[5][13]= "      60000006      "
block[5][14]= "      66666666      "
block[5][15]= "                    "

block[6][0] = "                    "
block[6][1] = "     7777777777     "
block[6][2] = "     7110070007     "
block[6][3] = "     7110000007     "
block[6][4] = "     711007007777   "
block[6][5] = "    77777770070077  "
block[6][6] = "    70000000000007  "
block[6][7] = "    70070077007007  "
block[6][8] = "  7777077007777077  "
block[6][9] = "  7002007777707007  "
block[6][10]= "  7070200200702007  "
block[6][11]= "  70X2002000700077  "
block[6][12]= "  777707707777777   "
block[6][13]= "     700007         "
block[6][14]= "     777777         "
block[6][15]= "                    "

block[7][0] = "                    "
block[7][1] = "                    "
block[7][2] = "                    "
block[7][3] = "          4444      "
block[7][4] = "    4444444AY4      "
block[7][5] = "    4AAAAACAA4      "
block[7][6] = "    4AAAC77AC4      "
block[7][7] = "    44C71117A4      "
block[7][8] = "     4AC111AA4      "
block[7][9] = "     4A71A17A44     "
block[7][10]= "     4AAA7A7CA4     "
block[7][11]= "     4CAACAAAA4     "
block[7][12]= "     4AA4444444     "
block[7][13]= "     4444           "
block[7][14]= "                    "
block[7][15]= "                    "

block[8][0] = "                    "
block[8][1] = "                    "
block[8][2] = "          4444      "
block[8][3] = "  444444444AA77     "
block[8][4] = " 74AACAAAAAACA75557 "
block[8][5] = " 4ABB77B77BBA771115 "
block[8][6] = " 4A7DDBDBDD7C771115 "
block[8][7] = " 4A7BBBBZBB7AAA1115 "
block[8][8] = " 4ABD7B777DDAAA1115 "
block[8][9] = " 4ACAACCAACA7711115 "
block[8][10]= " 744CAAAAAAA7755557 "
block[8][11]= "   4AA4444444       "
block[8][12]= "   4444             "
block[8][13]= "                    "
block[8][14]= "                    "
block[8][15]= "                    "

block[9][0] = " AAAAA A   A AAAA   "
block[9][1] = "   A   A   A A      "
block[9][2] = "   A   AAAAA AAA    "
block[9][3] = "   A   A   A A      "
block[9][4] = "   A   A   A AAAA   "
block[9][5] = "                    "
block[9][6] = "  AAAA A   A AAA    "
block[9][7] = "  A    AA  A A  A   "
block[9][8] = "  AAA  A A A A  A   "
block[9][9]=  "  A    A  AA A  A   "
block[9][10]= "  AAAA A   A AAA    "
block[9][11]= "                    "
block[9][12]= "                    

0 Start_repeat1
  7,1: '-----------------------------------------------------------------------------------------
GraphicsWindow.Hide()
GraphicsWindow.CanResize  = "false"
GraphicsWindow.Width = 1024 
GraphicsWindow.Height = 768
GraphicsWindow.Title = "SOkoCUTE"
GraphicsWindow.Left = (Desktop.Width - 1024) / 2
GraphicsWindow.Top  = (Desktop.Height - 768) / 2

'-----------------------------------------------------------------------------------------
'preload some gfx
'-----------------------------------------------------------------------------------------
Path = "http://smallbasic.com/drop/soko"
background = ImageList.LoadImage( Path + "/sokocuteff.png")
image["A"] = ImageList.LoadImage( Path + "/sokocute0a.png")
image["B"] = ImageList.LoadImage( Path + "/sokocute0b.png")
image["7"] = ImageList.LoadImage( Path + "/sokocute07.png")
image["6"] = ImageList.LoadImage( Path + "/sokocute06.png")
image["5"] = ImageList.LoadImage( Path + "/sokocute05.png")
image["4"] = ImageList.LoadImage( Path + "/sokocute04.png")
image["3"] = ImageList.LoadImage( Path + "/sokocute03.png")
image["2"] = ImageList.LoadImage( Path + "/sokocutegg.png")
image["1"] = ImageList.LoadImage( Path + "/sokocutess.png")
image["0"] = ImageList.LoadImage( Path + "/sokocute00.png")
star       = ImageList.LoadImage( Path + "/sokocutels.png")
heart      = ImageList.LoadImage( Path + "/sokocutelh.png")
'GraphicsWindow.DrawText(100,100, Program.Directory)
GraphicsWindow.DrawImage(background, 0, 0)
'-----------------------------------------------------------------------------------------
'init the keys
'-----------------------------------------------------------------------------------------
leftKey  = "Left"
rightKey = "Right"
forwardKey = "Up"
backKey = "Down"
fireKey = "Space"
returnKey = "Return"
escapeKey = "Escape"
pauseKey = "P"
resetKey = "R"
pluskey = "F1"
minusKey = "F2"
'important var for moving the crystals
korrx = 36
'init any other var
animtime = 1500
status = "start"
game="gamearray"
block = "blockArray"
true = 1
false = 0
stage = 0

'init level data
InitLevels()
'init stars and hearts
InitStars()
ResetStars()

' animate title at first
titleshape = Shapes.AddImage(Path + "/sokocute.png")
Shapes.Move(titleshape, 140,-350)
Shapes.Animate(titleshape, 140,170, 2500)

txtstart = Shapes.AddImage(Path + "/sokocutetx.png")
Shapes.Move(txtstart, 305,1800)
Shapes.Animate(txtstart, 305,420, 3000)

'calculate delay (higher number means more precision)
timestart = Clock.ElapsedMilliseconds
i = 0
while (i < 500000)
i = i + 1
Endwhile  
timeloop = Clock.ElapsedMilliseconds - timestart
mssec = timeloop / 500000
loopmssec = 1 / mssec

KeyUp()
Main()

Sub Main
  GraphicsWindow.Show()
  GraphicsWindow.KeyDown = KeyDown
  GraphicsWindow.KeyUp   = KeyUp  
  endtime = Clock.ElapsedMilliseconds
  starttime = Clock.ElapsedMilliseconds
  blinktime = Clock.ElapsedMilliseconds
  gamestarttime = Clock.ElapsedMilliseconds
  
  gemfall = false
  freecells = 1
  blink     = 0
  fps = 0
  looptime = 0  
  play = 1
  pause = 0
  rot = 0
  
  While(play = 1)
    
    fps = fps + 1
         
    Input()
    if status = "game" then


      'try fixed fps - 60 might be enough
      loopdelay = (1000/60) * loopmssec 
      num = 0
      While(num < loopdelay)
        num = num + 1
      endwhile
      
      
      If gemfall = false and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 then
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true
      EndIf
      If gemfall = true and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 and Clock.ElapsedMilliseconds - watertime < 1400 then
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  
      EndIf
      If gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 1400 then
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false
      EndIf
                 
         
      
        If (gemchng <> 99) And (Clock.ElapsedMilliseconds - gemtime > 400) Then
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99
        EndIf
    
        'move the player
        If newmove < 25 Then
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 
        EndIf
    
    
        'blinking crystals when level is done
        If freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350 then  
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds
        EndIf
        
      ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif
       EndIf
       
       ' show time and fps
       If Clock.ElapsedMilliseconds - endtime > 1000 And status = "game" Then
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0
        EndIf
    EndIf  'of Status = game
  
    'reset level after a short delay  
    If status ="reset" And (Clock.ElapsedMilliseconds - resettime > 2500) Then
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.FillRectangle(800,690,224,80)
      freecells = 1
      blink = 0
      LevelRelease()
      LevelLoad()
      wait1 = Clock.ElapsedMilliseconds
      While Clock.ElapsedMilliseconds - wait1 < 3000
      EndWhile  
      starttime = Clock.ElapsedMilliseconds   
      status = "game" 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FontName = "COMIC SANS MS"
      GraphicsWindow.FontSize = 25
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.BrushColor = "white"
      GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      GraphicsWindow.DrawText(70, 725, " level "+ (stage + 1) )
    EndIf
    If status = "start" then   
      MoveStars()        
    endif
    
  EndWhile
EndSub


Sub KeyDown
  
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  bescapeKey  = false
  
  
  If GraphicsWindow.LastKey = leftKey then
    bleftKey = true
  elseif GraphicsWindow.LastKey = rightKey then
    brightKey = true   
  elseif GraphicsWindow.LastKey = forwardKey then
    bforwardKey = true
  elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif
  
endSub

Sub KeyUp
  ' reset every key first
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  breturnKey  = false
  
  If GraphicsWindow.LastKey = pauseKey then 
    LevelExplosion()
  EndIf
 
 
  If GraphicsWindow.LastKey = escapeKey and status = "start" then
    Program.End()
  EndIf

  
  If GraphicsWindow.LastKey = escapeKey And status = "game" then 
    LevelExplosion()
    stage = 0
    Shapes.Animate(titleshape, 140,170, 2500)
    Shapes.Animate(txtstart, 305,420, 3000)
    GraphicsWindow.BrushColor = "#3975e5"
    GraphicsWindow.FillRectangle(70,690,170,80)
    GraphicsWindow.FillRectangle(800,690,224,85)
    status = "start"
    ResetStars()
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = resetKey then 
    LevelExplosion()
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = pluskey then 
    LevelExplosion()
    'stage = stage + 1   'uncomment this line to cheat with F1
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf

  If GraphicsWindow.LastKey = minuskey then 
    'KeyUp()
    LevelExplosion()
    'stage = stage - 1  'uncomment this line to cheat with F2
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  'reload title after <escape>
  If GraphicsWindow.LastKey = returnKey and status = "start" then 
    Shapes.Animate(titleshape, 140,-350, 2000)
    Shapes.Animate(txtstart, 305, 1220, 1600)
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
EndSub



Sub Input
   
  If newmove >= 25  and blink = 0 then   
  
    'move right  
    If(brightKey   = true) and (level[posy][posx+1] <= 2) Then   
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  
  ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf          
  EndIf
EndSub




Sub Sort  
   For y = 0 To 15
     For x = 0 To 15
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])
    EndFor
  EndFor  
EndSub
  
  
Sub LevelExplosion  
  
  Shapes.Animate(player1, Shapes.GetLeft(player1), 1500, 4000)
  Shapes.Animate(player2, Shapes.GetLeft(player2), 1500, 4000)  

  For i = 0 To shade
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      Shapes.Animate(Shadow[i], xv + 512, yv + 350, 1500)
  EndFor  
  
  For i = 0 To cryst
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      If Shapes.GetTop(crystalimg[i]) > 0 then
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)
      EndIf
      If Shapes.GetTop(crystalbnk[i]) > 0 then
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)
      EndIf
    EndFor  
  
    For y = 0 To 15
     For x = 0 To 19
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)
    EndFor
  EndFor      
EndSub


Sub LevelRelease  
   For y = 0 To 15
     For x = 0 To 19         
       Shapes.Remove(levelshapes[y][x])
    EndFor
  EndFor  
  For i = 0 To shade         
      Shapes.Remove(Shadow[i])
  EndFor  
  
  For i = 0 To cryst
        Shapes.Remove(crystalimg[i])
        Shapes.Remove(crystalbnk[i])
  EndFor   
  For i = 0 To 20
    Shapes.Remove(star)  
  endFor
EndSub

Sub LevelLoad
  cryst = 0
  posx  = 4
  posy  = 4
  moves = 0
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      
    EndFor
  EndFor
         
  
  'load the water first
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      
    EndFor  
  EndFor
  
  'shadows for the water
  LoadShadowWater()
  
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   
    EndFor  
  EndFor   
  
  'tried to fix strange Shapes.Animate behaviors if there are too many shapes flying around - no real  success... 
  loopdelay = (1600) * loopmssec 
   num = 0
   While(num < loopdelay)
    num = num + 1
  endwhile
  
  'load blocks
  f = 0
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      
    EndFor  
  EndFor
  player1 = Shapes.AddImage(Path + "/sokocutep2.png")
 
  'load lower player shape first. it has to be behind the walls 
  Shapes.Move(player1, (posx) * 50 + korrx, (posy) * 40 - 0) 

  LoadShadow()
  '------------------------------------------------------------
  'load the walls
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  
  EndFor
  
  'load players face at last. It has always to be in front of the walls
  player2 = Shapes.AddImage(Path + "/sokocutep1.png")
  Shapes.Move(player2, (posx) * 50 + korrx, (posy) * 40 - 0)  
  xplayer = Shapes.GetLeft(player1)
  yplayer = Shapes.GetTop(player1)  

EndSub

sub LoadShadow
  

  For y = 0 To 15
     For x = 0 To 19
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   
 
EndSub

sub LoadShadowWater 
  shade = 0
 ky = 22
  For y = 0 To 15
     For x = 0 To 19
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   

EndSub

Sub InitStars
  For i = 0 To 12
    star[i] = Shapes.AddImage(Path + "/sokocutels.png")  
    heart[i] = Shapes.AddImage(Path + "/sokocutelh.png") 
  endFor
EndSub


Sub ResetStars
  For i = 0 To 12
    angle = Math.GetRandomNumber(360)
    starxv[i] = Math.Cos(angle * 0.0174) * 0.50
    staryv[i] = Math.Sin(angle * 0.0174) * 0.50    
    starx[i] = 1000
    stary[i] = 1000   
    startime[i] = Math.GetRandomNumber(100)
    Shapes.Move(star[i], starx[i], stary[i])  
  endFor
  For i = 0 To 12
   angle = Math.GetRandomNumber(360)
   heartxv[i] = Math.Cos(angle * 0.0174) * 0.50
   heartyv[i] = Math.Sin(angle * 0.0174) * 0.50    
   heartx[i] = 1000
   hearty[i] = 1000   
   hearttime[i] = Math.GetRandomNumber(100)
   Shapes.Move(heart[i], heartx[i], hearty[i])  
 endFor
EndSub

' move stars and hearts
Sub MoveStars
  
      For i = 0 to 12
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      
    EndFor  
    
    
    For i = 0 to 12
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Rotate(heart[i], hearttime[i] * -10)
      Shapes.Zoom(heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32) )
      Shapes.Move(heart[i], heartx[i], hearty[i])      
    EndFor  
  
EndSub


Sub InitLevels
  
block[0][0] = "                    "
block[0][1] = "                    "
block[0][2] = "                    "
block[0][3] = "     66666          "
block[0][4] = "     60006          "
block[0][5] = "     62006          "
block[0][6] = "   66600266         "
block[0][7] = "   60020206         "
block[0][8] = " 6660606606AA555555 "
block[0][9] = " 600060660666700115 "
block[0][10]= " 60200200000X000115 "
block[0][11]= " 666660666066700115 "
block[0][12]= "     60000066555555 "
block[0][13]= "     6666666        "
block[0][14]= "                    "
block[0][15]= "                    "

block[1][0] = "                    "
block[1][1] = "                    "
block[1][2] = "                    "
block[1][3] = "       6666666      "
block[1][4] = "  76666600000667    "
block[1][5] = "  61111602002006    "
block[1][6] = "  61100626666006    "
block[1][7] = "  6110000X066006    "
block[1][8] = "  61100606002076    "
block[1][9] = "  76666606620206    "
block[1][10]= "    602002020206    "
block[1][11]= "    600007000006    "
block[1][12]= "    766666666667    "
block[1][13]= "                    "
block[1][14]= "                    "
block[1][15]= "                    "

block[2][0] = "                    "
block[2][1] = "                    "
block[2][2] = "                    "
block[2][3] = "         76666667   "
block[2][4] = "         600000X6   "
block[2][5] = "         60262066   "
block[2][6] = "         6020026    "
block[2][7] = "         6720206    "
block[2][8] = " 7666666 602060667  "
block[2][9] = " 61111066602002006  "
block[2][10]= " 61110000020020006  "
block[2][11]= " 61111066666666667  "
block[2][12]= " 7666666            "
block[2][13]= "                    "
block[2][14]= "                    "
block[2][15]= "                    "

block[3][0] = "                    "
block[3][1] = "                    "
block[3][2] = "6666663             "
block[3][3] = "611166366666  66666 "
block[3][4] = "611116360006  60006 "
block[3][5] = "6111163607066660706 "
block[3][6] = "600X063600200000006 "
block[3][7] = "6606663700602260666 "
block[3][8] = "5AAAA73A220060006   "
block[3][9] = "5ACAABBB002666206   "
block[3][10]= "5AA5AA3A700060006   "
block[3][11]= "5555553A666060726   "
block[3][12]= "AAAAAA3AAA6022006   "
block[3][13]= "33333333336000006   "
block[3][14]= "          6666666   "
block[3][15]= "                    "

block[4][0] = "                    "
block[4][1] = "                    "
block[4][2] = "          66666     "
block[4][3] = "    666666600067    "
block[4][4] = "   66070X6602206    "
block[4][5] = "   6000020000006    "
block[4][6] = "   6002006660006    "
block[4][7] = "   6660666662666    "
block[4][8] = "   602006660116     "
block[4][9] = "   602020201116     "
block[4][10]= "   600006661116     "
block[4][11]= "   602206 61116     "
block[4][12]= "   600666 76667     "
block[4][13]= "   7667             "
block[4][14]= "                    "
block[4][15]= "                    "

block[5][0] = "                    "
block[5][1] = "           4444444  "
block[5][2] = "           4AA1114  "
block[5][3] = "       66667AA1114  "
block[5][4] = "       60000AA1A14  "
block[5][5] = "       60067AA1114  "
block[5][6] = "       66066AA1114  "
block[5][7] = "      666066444444  "
block[5][8] = "      60222066AAAA  "
block[5][9] = "  6666600202066666  "
block[5][10]= " 66000720200070006  "
block[5][11]= " 6X020020000200206  "
block[5][12]= " 66666602202066666  "
block[5][13]= "      60000006      "
block[5][14]= "      66666666      "
block[5][15]= "                    "

block[6][0] = "                    "
block[6][1] = "     7777777777     "
block[6][2] = "     7110070007     "
block[6][3] = "     7110000007     "
block[6][4] = "     711007007777   "
block[6][5] = "    77777770070077  "
block[6][6] = "    70000000000007  "
block[6][7] = "    70070077007007  "
block[6][8] = "  7777077007777077  "
block[6][9] = "  7002007777707007  "
block[6][10]= "  7070200200702007  "
block[6][11]= "  70X2002000700077  "
block[6][12]= "  777707707777777   "
block[6][13]= "     700007         "
block[6][14]= "     777777         "
block[6][15]= "                    "

block[7][0] = "                    "
block[7][1] = "                    "
block[7][2] = "                    "
block[7][3] = "          4444      "
block[7][4] = "    4444444AY4      "
block[7][5] = "    4AAAAACAA4      "
block[7][6] = "    4AAAC77AC4      "
block[7][7] = "    44C71117A4      "
block[7][8] = "     4AC111AA4      "
block[7][9] = "     4A71A17A44     "
block[7][10]= "     4AAA7A7CA4     "
block[7][11]= "     4CAACAAAA4     "
block[7][12]= "     4AA4444444     "
block[7][13]= "     4444           "
block[7][14]= "                    "
block[7][15]= "                    "

block[8][0] = "                    "
block[8][1] = "                    "
block[8][2] = "          4444      "
block[8][3] = "  444444444AA77     "
block[8][4] = " 74AACAAAAAACA75557 "
block[8][5] = " 4ABB77B77BBA771115 "
block[8][6] = " 4A7DDBDBDD7C771115 "
block[8][7] = " 4A7BBBBZBB7AAA1115 "
block[8][8] = " 4ABD7B777DDAAA1115 "
block[8][9] = " 4ACAACCAACA7711115 "
block[8][10]= " 744CAAAAAAA7755557 "
block[8][11]= "   4AA4444444       "
block[8][12]= "   4444             "
block[8][13]= "                    "
block[8][14]= "                    "
block[8][15]= "                    "

block[9][0] = " AAAAA A   A AAAA   "
block[9][1] = "   A   A   A A      "
block[9][2] = "   A   AAAAA AAA    "
block[9][3] = "   A   A   A A      "
block[9][4] = "   A   A   A AAAA   "
block[9][5] = "                    "
block[9][6] = "  AAAA A   A AAA    "
block[9][7] = "  A    AA  A A  A   "
block[9][8] = "  AAA  A A A A  A   "
block[9][9]=  "  A    A  AA A  A   "
block[9][10]= "  AAAA A   A AAA    "
block[9][11]= "                    "
block[9][12]= "                    "
block[9][13]= " 44444444444

1 ID . ID ( )
  8,1: GraphicsWindow
  8,15: .
  8,16: Hide
  8,20: (
  8,21: )

188 . ID ( )
  8,15: .
  8,16: Hide
  8,20: (
  8,21: )

259 ID ( )
  8,16: Hide
  8,20: (
  8,21: )

214 ( )
  8,20: (
  8,21: )

25 )
  8,21: )

97 ID . ID = Expr
  9,1: GraphicsWindow
  9,15: .
  9,16: CanResize
  9,27: =
  9,29: "false"

188 . ID = Expr
  9,15: .
  9,16: CanResize
  9,27: =
  9,29: "false"

259 ID = Expr
  9,16: CanResize
  9,27: =
  9,29: "false"

214 = Expr
  9,27: =
  9,29: "false"

75 STR
  9,29: "false"

97 ID . ID = Expr
  10,1: GraphicsWindow
  10,15: .
  10,16: Width
  10,22: =
  10,24: 1024

188 . ID = Expr
  10,15: .
  10,16: Width
  10,22: =
  10,24: 1024

259 ID = Expr
  10,16: Width
  10,22: =
  10,24: 1024

214 = Expr
  10,22: =
  10,24: 1024

75 NUM
  10,24: 1024

97 ID . ID = Expr
  11,1: GraphicsWindow
  11,15: .
  11,16: Height
  11,23: =
  11,25: 768

188 . ID = Expr
  11,15: .
  11,16: Height
  11,23: =
  11,25: 768

259 ID = Expr
  11,16: Height
  11,23: =
  11,25: 768

214 = Expr
  11,23: =
  11,25: 768

75 NUM
  11,25: 768

97 ID . ID = Expr
  12,1: GraphicsWindow
  12,15: .
  12,16: Title
  12,22: =
  12,24: "SOkoCUTE"

188 . ID = Expr
  12,15: .
  12,16: Title
  12,22: =
  12,24: "SOkoCUTE"

259 ID = Expr
  12,16: Title
  12,22: =
  12,24: "SOkoCUTE"

214 = Expr
  12,22: =
  12,24: "SOkoCUTE"

75 STR
  12,24: "SOkoCUTE"

97 ID . ID = Expr
  13,1: GraphicsWindow
  13,15: .
  13,16: Left
  13,21: =
  13,23: (Desktop.Width - 1024) / 2

188 . ID = Expr
  13,15: .
  13,16: Left
  13,21: =
  13,23: (Desktop.Width - 1024) / 2

259 ID = Expr
  13,16: Left
  13,21: =
  13,23: (Desktop.Width - 1024) / 2

214 = Expr
  13,21: =
  13,23: (Desktop.Width - 1024) / 2

75 ( Expr )
  13,23: (
  13,24: Desktop.Width - 1024
  13,44: )

84 ID . ID
  13,24: Desktop
  13,31: .
  13,32: Width

4 . ID
  13,31: .
  13,32: Width

248 ID
  13,32: Width

65 - MultiplicativeExpr
  13,38: -
  13,40: 1024

141 NUM
  13,40: 1024

246 )
  13,44: )

10 / UnaryExpr
  13,46: /
  13,48: 2

155 NUM
  13,48: 2

97 ID . ID = Expr
  14,1: GraphicsWindow
  14,15: .
  14,16: Top
  14,21: =
  14,23: (Desktop.Height - 768) / 2

188 . ID = Expr
  14,15: .
  14,16: Top
  14,21: =
  14,23: (Desktop.Height - 768) / 2

259 ID = Expr
  14,16: Top
  14,21: =
  14,23: (Desktop.Height - 768) / 2

214 = Expr
  14,21: =
  14,23: (Desktop.Height - 768) / 2

75 ( Expr )
  14,23: (
  14,24: Desktop.Height - 768
  14,44: )

84 ID . ID
  14,24: Desktop
  14,31: .
  14,32: Height

4 . ID
  14,31: .
  14,32: Height

248 ID
  14,32: Height

65 - MultiplicativeExpr
  14,39: -
  14,41: 768

141 NUM
  14,41: 768

246 )
  14,44: )

10 / UnaryExpr
  14,46: /
  14,48: 2

155 NUM
  14,48: 2

97 Start_repeat1
  15,1: 
'-----------------------------------------------------------------------------------------
'preload some gfx
'-----------------------------------------------------------------------------------------
Path = "http://smallbasic.com/drop/soko"
background = ImageList.LoadImage( Path + "/sokocuteff.png")
image["A"] = ImageList.LoadImage( Path + "/sokocute0a.png")
image["B"] = ImageList.LoadImage( Path + "/sokocute0b.png")
image["7"] = ImageList.LoadImage( Path + "/sokocute07.png")
image["6"] = ImageList.LoadImage( Path + "/sokocute06.png")
image["5"] = ImageList.LoadImage( Path + "/sokocute05.png")
image["4"] = ImageList.LoadImage( Path + "/sokocute04.png")
image["3"] = ImageList.LoadImage( Path + "/sokocute03.png")
image["2"] = ImageList.LoadImage( Path + "/sokocutegg.png")
image["1"] = ImageList.LoadImage( Path + "/sokocutess.png")
image["0"] = ImageList.LoadImage( Path + "/sokocute00.png")
star       = ImageList.LoadImage( Path + "/sokocutels.png")
heart      = ImageList.LoadImage( Path + "/sokocutelh.png")
'GraphicsWindow.DrawText(100,100, Program.Directory)
GraphicsWindow.DrawImage(background, 0, 0)
'-----------------------------------------------------------------------------------------
'init the keys
'-----------------------------------------------------------------------------------------
leftKey  = "Left"
rightKey = "Right"
forwardKey = "Up"
backKey = "Down"
fireKey = "Space"
returnKey = "Return"
escapeKey = "Escape"
pauseKey = "P"
resetKey = "R"
pluskey = "F1"
minusKey = "F2"
'important var for moving the crystals
korrx = 36
'init any other var
animtime = 1500
status = "start"
game="gamearray"
block = "blockArray"
true = 1
false = 0
stage = 0

'init level data
InitLevels()
'init stars and hearts
InitStars()
ResetStars()

' animate title at first
titleshape = Shapes.AddImage(Path + "/sokocute.png")
Shapes.Move(titleshape, 140,-350)
Shapes.Animate(titleshape, 140,170, 2500)

txtstart = Shapes.AddImage(Path + "/sokocutetx.png")
Shapes.Move(txtstart, 305,1800)
Shapes.Animate(txtstart, 305,420, 3000)

'calculate delay (higher number means more precision)
timestart = Clock.ElapsedMilliseconds
i = 0
while (i < 500000)
i = i + 1
Endwhile  
timeloop = Clock.ElapsedMilliseconds - timestart
mssec = timeloop / 500000
loopmssec = 1 / mssec

KeyUp()
Main()

Sub Main
  GraphicsWindow.Show()
  GraphicsWindow.KeyDown = KeyDown
  GraphicsWindow.KeyUp   = KeyUp  
  endtime = Clock.ElapsedMilliseconds
  starttime = Clock.ElapsedMilliseconds
  blinktime = Clock.ElapsedMilliseconds
  gamestarttime = Clock.ElapsedMilliseconds
  
  gemfall = false
  freecells = 1
  blink     = 0
  fps = 0
  looptime = 0  
  play = 1
  pause = 0
  rot = 0
  
  While(play = 1)
    
    fps = fps + 1
         
    Input()
    if status = "game" then


      'try fixed fps - 60 might be enough
      loopdelay = (1000/60) * loopmssec 
      num = 0
      While(num < loopdelay)
        num = num + 1
      endwhile
      
      
      If gemfall = false and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 then
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true
      EndIf
      If gemfall = true and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 and Clock.ElapsedMilliseconds - watertime < 1400 then
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  
      EndIf
      If gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 1400 then
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false
      EndIf
                 
         
      
        If (gemchng <> 99) And (Clock.ElapsedMilliseconds - gemtime > 400) Then
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99
        EndIf
    
        'move the player
        If newmove < 25 Then
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 
        EndIf
    
    
        'blinking crystals when level is done
        If freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350 then  
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds
        EndIf
        
      ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif
       EndIf
       
       ' show time and fps
       If Clock.ElapsedMilliseconds - endtime > 1000 And status = "game" Then
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0
        EndIf
    EndIf  'of Status = game
  
    'reset level after a short delay  
    If status ="reset" And (Clock.ElapsedMilliseconds - resettime > 2500) Then
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.FillRectangle(800,690,224,80)
      freecells = 1
      blink = 0
      LevelRelease()
      LevelLoad()
      wait1 = Clock.ElapsedMilliseconds
      While Clock.ElapsedMilliseconds - wait1 < 3000
      EndWhile  
      starttime = Clock.ElapsedMilliseconds   
      status = "game" 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FontName = "COMIC SANS MS"
      GraphicsWindow.FontSize = 25
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.BrushColor = "white"
      GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      GraphicsWindow.DrawText(70, 725, " level "+ (stage + 1) )
    EndIf
    If status = "start" then   
      MoveStars()        
    endif
    
  EndWhile
EndSub


Sub KeyDown
  
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  bescapeKey  = false
  
  
  If GraphicsWindow.LastKey = leftKey then
    bleftKey = true
  elseif GraphicsWindow.LastKey = rightKey then
    brightKey = true   
  elseif GraphicsWindow.LastKey = forwardKey then
    bforwardKey = true
  elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif
  
endSub

Sub KeyUp
  ' reset every key first
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  breturnKey  = false
  
  If GraphicsWindow.LastKey = pauseKey then 
    LevelExplosion()
  EndIf
 
 
  If GraphicsWindow.LastKey = escapeKey and status = "start" then
    Program.End()
  EndIf

  
  If GraphicsWindow.LastKey = escapeKey And status = "game" then 
    LevelExplosion()
    stage = 0
    Shapes.Animate(titleshape, 140,170, 2500)
    Shapes.Animate(txtstart, 305,420, 3000)
    GraphicsWindow.BrushColor = "#3975e5"
    GraphicsWindow.FillRectangle(70,690,170,80)
    GraphicsWindow.FillRectangle(800,690,224,85)
    status = "start"
    ResetStars()
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = resetKey then 
    LevelExplosion()
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = pluskey then 
    LevelExplosion()
    'stage = stage + 1   'uncomment this line to cheat with F1
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf

  If GraphicsWindow.LastKey = minuskey then 
    'KeyUp()
    LevelExplosion()
    'stage = stage - 1  'uncomment this line to cheat with F2
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  'reload title after <escape>
  If GraphicsWindow.LastKey = returnKey and status = "start" then 
    Shapes.Animate(titleshape, 140,-350, 2000)
    Shapes.Animate(txtstart, 305, 1220, 1600)
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
EndSub



Sub Input
   
  If newmove >= 25  and blink = 0 then   
  
    'move right  
    If(brightKey   = true) and (level[posy][posx+1] <= 2) Then   
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  
  ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf          
  EndIf
EndSub




Sub Sort  
   For y = 0 To 15
     For x = 0 To 15
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])
    EndFor
  EndFor  
EndSub
  
  
Sub LevelExplosion  
  
  Shapes.Animate(player1, Shapes.GetLeft(player1), 1500, 4000)
  Shapes.Animate(player2, Shapes.GetLeft(player2), 1500, 4000)  

  For i = 0 To shade
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      Shapes.Animate(Shadow[i], xv + 512, yv + 350, 1500)
  EndFor  
  
  For i = 0 To cryst
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      If Shapes.GetTop(crystalimg[i]) > 0 then
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)
      EndIf
      If Shapes.GetTop(crystalbnk[i]) > 0 then
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)
      EndIf
    EndFor  
  
    For y = 0 To 15
     For x = 0 To 19
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)
    EndFor
  EndFor      
EndSub


Sub LevelRelease  
   For y = 0 To 15
     For x = 0 To 19         
       Shapes.Remove(levelshapes[y][x])
    EndFor
  EndFor  
  For i = 0 To shade         
      Shapes.Remove(Shadow[i])
  EndFor  
  
  For i = 0 To cryst
        Shapes.Remove(crystalimg[i])
        Shapes.Remove(crystalbnk[i])
  EndFor   
  For i = 0 To 20
    Shapes.Remove(star)  
  endFor
EndSub

Sub LevelLoad
  cryst = 0
  posx  = 4
  posy  = 4
  moves = 0
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      
    EndFor
  EndFor
         
  
  'load the water first
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      
    EndFor  
  EndFor
  
  'shadows for the water
  LoadShadowWater()
  
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   
    EndFor  
  EndFor   
  
  'tried to fix strange Shapes.Animate behaviors if there are too many shapes flying around - no real  success... 
  loopdelay = (1600) * loopmssec 
   num = 0
   While(num < loopdelay)
    num = num + 1
  endwhile
  
  'load blocks
  f = 0
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      
    EndFor  
  EndFor
  player1 = Shapes.AddImage(Path + "/sokocutep2.png")
 
  'load lower player shape first. it has to be behind the walls 
  Shapes.Move(player1, (posx) * 50 + korrx, (posy) * 40 - 0) 

  LoadShadow()
  '------------------------------------------------------------
  'load the walls
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  
  EndFor
  
  'load players face at last. It has always to be in front of the walls
  player2 = Shapes.AddImage(Path + "/sokocutep1.png")
  Shapes.Move(player2, (posx) * 50 + korrx, (posy) * 40 - 0)  
  xplayer = Shapes.GetLeft(player1)
  yplayer = Shapes.GetTop(player1)  

EndSub

sub LoadShadow
  

  For y = 0 To 15
     For x = 0 To 19
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   
 
EndSub

sub LoadShadowWater 
  shade = 0
 ky = 22
  For y = 0 To 15
     For x = 0 To 19
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   

EndSub

Sub InitStars
  For i = 0 To 12
    star[i] = Shapes.AddImage(Path + "/sokocutels.png")  
    heart[i] = Shapes.AddImage(Path + "/sokocutelh.png") 
  endFor
EndSub


Sub ResetStars
  For i = 0 To 12
    angle = Math.GetRandomNumber(360)
    starxv[i] = Math.Cos(angle * 0.0174) * 0.50
    staryv[i] = Math.Sin(angle * 0.0174) * 0.50    
    starx[i] = 1000
    stary[i] = 1000   
    startime[i] = Math.GetRandomNumber(100)
    Shapes.Move(star[i], starx[i], stary[i])  
  endFor
  For i = 0 To 12
   angle = Math.GetRandomNumber(360)
   heartxv[i] = Math.Cos(angle * 0.0174) * 0.50
   heartyv[i] = Math.Sin(angle * 0.0174) * 0.50    
   heartx[i] = 1000
   hearty[i] = 1000   
   hearttime[i] = Math.GetRandomNumber(100)
   Shapes.Move(heart[i], heartx[i], hearty[i])  
 endFor
EndSub

' move stars and hearts
Sub MoveStars
  
      For i = 0 to 12
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      
    EndFor  
    
    
    For i = 0 to 12
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Ro

97 Start_repeat1
  17,1: 'preload some gfx
'-----------------------------------------------------------------------------------------
Path = "http://smallbasic.com/drop/soko"
background = ImageList.LoadImage( Path + "/sokocuteff.png")
image["A"] = ImageList.LoadImage( Path + "/sokocute0a.png")
image["B"] = ImageList.LoadImage( Path + "/sokocute0b.png")
image["7"] = ImageList.LoadImage( Path + "/sokocute07.png")
image["6"] = ImageList.LoadImage( Path + "/sokocute06.png")
image["5"] = ImageList.LoadImage( Path + "/sokocute05.png")
image["4"] = ImageList.LoadImage( Path + "/sokocute04.png")
image["3"] = ImageList.LoadImage( Path + "/sokocute03.png")
image["2"] = ImageList.LoadImage( Path + "/sokocutegg.png")
image["1"] = ImageList.LoadImage( Path + "/sokocutess.png")
image["0"] = ImageList.LoadImage( Path + "/sokocute00.png")
star       = ImageList.LoadImage( Path + "/sokocutels.png")
heart      = ImageList.LoadImage( Path + "/sokocutelh.png")
'GraphicsWindow.DrawText(100,100, Program.Directory)
GraphicsWindow.DrawImage(background, 0, 0)
'-----------------------------------------------------------------------------------------
'init the keys
'-----------------------------------------------------------------------------------------
leftKey  = "Left"
rightKey = "Right"
forwardKey = "Up"
backKey = "Down"
fireKey = "Space"
returnKey = "Return"
escapeKey = "Escape"
pauseKey = "P"
resetKey = "R"
pluskey = "F1"
minusKey = "F2"
'important var for moving the crystals
korrx = 36
'init any other var
animtime = 1500
status = "start"
game="gamearray"
block = "blockArray"
true = 1
false = 0
stage = 0

'init level data
InitLevels()
'init stars and hearts
InitStars()
ResetStars()

' animate title at first
titleshape = Shapes.AddImage(Path + "/sokocute.png")
Shapes.Move(titleshape, 140,-350)
Shapes.Animate(titleshape, 140,170, 2500)

txtstart = Shapes.AddImage(Path + "/sokocutetx.png")
Shapes.Move(txtstart, 305,1800)
Shapes.Animate(txtstart, 305,420, 3000)

'calculate delay (higher number means more precision)
timestart = Clock.ElapsedMilliseconds
i = 0
while (i < 500000)
i = i + 1
Endwhile  
timeloop = Clock.ElapsedMilliseconds - timestart
mssec = timeloop / 500000
loopmssec = 1 / mssec

KeyUp()
Main()

Sub Main
  GraphicsWindow.Show()
  GraphicsWindow.KeyDown = KeyDown
  GraphicsWindow.KeyUp   = KeyUp  
  endtime = Clock.ElapsedMilliseconds
  starttime = Clock.ElapsedMilliseconds
  blinktime = Clock.ElapsedMilliseconds
  gamestarttime = Clock.ElapsedMilliseconds
  
  gemfall = false
  freecells = 1
  blink     = 0
  fps = 0
  looptime = 0  
  play = 1
  pause = 0
  rot = 0
  
  While(play = 1)
    
    fps = fps + 1
         
    Input()
    if status = "game" then


      'try fixed fps - 60 might be enough
      loopdelay = (1000/60) * loopmssec 
      num = 0
      While(num < loopdelay)
        num = num + 1
      endwhile
      
      
      If gemfall = false and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 then
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true
      EndIf
      If gemfall = true and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 and Clock.ElapsedMilliseconds - watertime < 1400 then
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  
      EndIf
      If gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 1400 then
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false
      EndIf
                 
         
      
        If (gemchng <> 99) And (Clock.ElapsedMilliseconds - gemtime > 400) Then
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99
        EndIf
    
        'move the player
        If newmove < 25 Then
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 
        EndIf
    
    
        'blinking crystals when level is done
        If freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350 then  
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds
        EndIf
        
      ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif
       EndIf
       
       ' show time and fps
       If Clock.ElapsedMilliseconds - endtime > 1000 And status = "game" Then
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0
        EndIf
    EndIf  'of Status = game
  
    'reset level after a short delay  
    If status ="reset" And (Clock.ElapsedMilliseconds - resettime > 2500) Then
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.FillRectangle(800,690,224,80)
      freecells = 1
      blink = 0
      LevelRelease()
      LevelLoad()
      wait1 = Clock.ElapsedMilliseconds
      While Clock.ElapsedMilliseconds - wait1 < 3000
      EndWhile  
      starttime = Clock.ElapsedMilliseconds   
      status = "game" 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FontName = "COMIC SANS MS"
      GraphicsWindow.FontSize = 25
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.BrushColor = "white"
      GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      GraphicsWindow.DrawText(70, 725, " level "+ (stage + 1) )
    EndIf
    If status = "start" then   
      MoveStars()        
    endif
    
  EndWhile
EndSub


Sub KeyDown
  
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  bescapeKey  = false
  
  
  If GraphicsWindow.LastKey = leftKey then
    bleftKey = true
  elseif GraphicsWindow.LastKey = rightKey then
    brightKey = true   
  elseif GraphicsWindow.LastKey = forwardKey then
    bforwardKey = true
  elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif
  
endSub

Sub KeyUp
  ' reset every key first
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  breturnKey  = false
  
  If GraphicsWindow.LastKey = pauseKey then 
    LevelExplosion()
  EndIf
 
 
  If GraphicsWindow.LastKey = escapeKey and status = "start" then
    Program.End()
  EndIf

  
  If GraphicsWindow.LastKey = escapeKey And status = "game" then 
    LevelExplosion()
    stage = 0
    Shapes.Animate(titleshape, 140,170, 2500)
    Shapes.Animate(txtstart, 305,420, 3000)
    GraphicsWindow.BrushColor = "#3975e5"
    GraphicsWindow.FillRectangle(70,690,170,80)
    GraphicsWindow.FillRectangle(800,690,224,85)
    status = "start"
    ResetStars()
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = resetKey then 
    LevelExplosion()
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = pluskey then 
    LevelExplosion()
    'stage = stage + 1   'uncomment this line to cheat with F1
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf

  If GraphicsWindow.LastKey = minuskey then 
    'KeyUp()
    LevelExplosion()
    'stage = stage - 1  'uncomment this line to cheat with F2
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  'reload title after <escape>
  If GraphicsWindow.LastKey = returnKey and status = "start" then 
    Shapes.Animate(titleshape, 140,-350, 2000)
    Shapes.Animate(txtstart, 305, 1220, 1600)
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
EndSub



Sub Input
   
  If newmove >= 25  and blink = 0 then   
  
    'move right  
    If(brightKey   = true) and (level[posy][posx+1] <= 2) Then   
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  
  ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf          
  EndIf
EndSub




Sub Sort  
   For y = 0 To 15
     For x = 0 To 15
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])
    EndFor
  EndFor  
EndSub
  
  
Sub LevelExplosion  
  
  Shapes.Animate(player1, Shapes.GetLeft(player1), 1500, 4000)
  Shapes.Animate(player2, Shapes.GetLeft(player2), 1500, 4000)  

  For i = 0 To shade
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      Shapes.Animate(Shadow[i], xv + 512, yv + 350, 1500)
  EndFor  
  
  For i = 0 To cryst
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      If Shapes.GetTop(crystalimg[i]) > 0 then
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)
      EndIf
      If Shapes.GetTop(crystalbnk[i]) > 0 then
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)
      EndIf
    EndFor  
  
    For y = 0 To 15
     For x = 0 To 19
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)
    EndFor
  EndFor      
EndSub


Sub LevelRelease  
   For y = 0 To 15
     For x = 0 To 19         
       Shapes.Remove(levelshapes[y][x])
    EndFor
  EndFor  
  For i = 0 To shade         
      Shapes.Remove(Shadow[i])
  EndFor  
  
  For i = 0 To cryst
        Shapes.Remove(crystalimg[i])
        Shapes.Remove(crystalbnk[i])
  EndFor   
  For i = 0 To 20
    Shapes.Remove(star)  
  endFor
EndSub

Sub LevelLoad
  cryst = 0
  posx  = 4
  posy  = 4
  moves = 0
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      
    EndFor
  EndFor
         
  
  'load the water first
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      
    EndFor  
  EndFor
  
  'shadows for the water
  LoadShadowWater()
  
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   
    EndFor  
  EndFor   
  
  'tried to fix strange Shapes.Animate behaviors if there are too many shapes flying around - no real  success... 
  loopdelay = (1600) * loopmssec 
   num = 0
   While(num < loopdelay)
    num = num + 1
  endwhile
  
  'load blocks
  f = 0
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      
    EndFor  
  EndFor
  player1 = Shapes.AddImage(Path + "/sokocutep2.png")
 
  'load lower player shape first. it has to be behind the walls 
  Shapes.Move(player1, (posx) * 50 + korrx, (posy) * 40 - 0) 

  LoadShadow()
  '------------------------------------------------------------
  'load the walls
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  
  EndFor
  
  'load players face at last. It has always to be in front of the walls
  player2 = Shapes.AddImage(Path + "/sokocutep1.png")
  Shapes.Move(player2, (posx) * 50 + korrx, (posy) * 40 - 0)  
  xplayer = Shapes.GetLeft(player1)
  yplayer = Shapes.GetTop(player1)  

EndSub

sub LoadShadow
  

  For y = 0 To 15
     For x = 0 To 19
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   
 
EndSub

sub LoadShadowWater 
  shade = 0
 ky = 22
  For y = 0 To 15
     For x = 0 To 19
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   

EndSub

Sub InitStars
  For i = 0 To 12
    star[i] = Shapes.AddImage(Path + "/sokocutels.png")  
    heart[i] = Shapes.AddImage(Path + "/sokocutelh.png") 
  endFor
EndSub


Sub ResetStars
  For i = 0 To 12
    angle = Math.GetRandomNumber(360)
    starxv[i] = Math.Cos(angle * 0.0174) * 0.50
    staryv[i] = Math.Sin(angle * 0.0174) * 0.50    
    starx[i] = 1000
    stary[i] = 1000   
    startime[i] = Math.GetRandomNumber(100)
    Shapes.Move(star[i], starx[i], stary[i])  
  endFor
  For i = 0 To 12
   angle = Math.GetRandomNumber(360)
   heartxv[i] = Math.Cos(angle * 0.0174) * 0.50
   heartyv[i] = Math.Sin(angle * 0.0174) * 0.50    
   heartx[i] = 1000
   hearty[i] = 1000   
   hearttime[i] = Math.GetRandomNumber(100)
   Shapes.Move(heart[i], heartx[i], hearty[i])  
 endFor
EndSub

' move stars and hearts
Sub MoveStars
  
      For i = 0 to 12
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      
    EndFor  
    
    
    For i = 0 to 12
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Rotate(heart[i], hearttime[i] * -10)
      Shapes.Zoom(heart[i], Math.Sin(hearttime[i] / 32) ,

97 Start_repeat1
  18,1: '-----------------------------------------------------------------------------------------
Path = "http://smallbasic.com/drop/soko"
background = ImageList.LoadImage( Path + "/sokocuteff.png")
image["A"] = ImageList.LoadImage( Path + "/sokocute0a.png")
image["B"] = ImageList.LoadImage( Path + "/sokocute0b.png")
image["7"] = ImageList.LoadImage( Path + "/sokocute07.png")
image["6"] = ImageList.LoadImage( Path + "/sokocute06.png")
image["5"] = ImageList.LoadImage( Path + "/sokocute05.png")
image["4"] = ImageList.LoadImage( Path + "/sokocute04.png")
image["3"] = ImageList.LoadImage( Path + "/sokocute03.png")
image["2"] = ImageList.LoadImage( Path + "/sokocutegg.png")
image["1"] = ImageList.LoadImage( Path + "/sokocutess.png")
image["0"] = ImageList.LoadImage( Path + "/sokocute00.png")
star       = ImageList.LoadImage( Path + "/sokocutels.png")
heart      = ImageList.LoadImage( Path + "/sokocutelh.png")
'GraphicsWindow.DrawText(100,100, Program.Directory)
GraphicsWindow.DrawImage(background, 0, 0)
'-----------------------------------------------------------------------------------------
'init the keys
'-----------------------------------------------------------------------------------------
leftKey  = "Left"
rightKey = "Right"
forwardKey = "Up"
backKey = "Down"
fireKey = "Space"
returnKey = "Return"
escapeKey = "Escape"
pauseKey = "P"
resetKey = "R"
pluskey = "F1"
minusKey = "F2"
'important var for moving the crystals
korrx = 36
'init any other var
animtime = 1500
status = "start"
game="gamearray"
block = "blockArray"
true = 1
false = 0
stage = 0

'init level data
InitLevels()
'init stars and hearts
InitStars()
ResetStars()

' animate title at first
titleshape = Shapes.AddImage(Path + "/sokocute.png")
Shapes.Move(titleshape, 140,-350)
Shapes.Animate(titleshape, 140,170, 2500)

txtstart = Shapes.AddImage(Path + "/sokocutetx.png")
Shapes.Move(txtstart, 305,1800)
Shapes.Animate(txtstart, 305,420, 3000)

'calculate delay (higher number means more precision)
timestart = Clock.ElapsedMilliseconds
i = 0
while (i < 500000)
i = i + 1
Endwhile  
timeloop = Clock.ElapsedMilliseconds - timestart
mssec = timeloop / 500000
loopmssec = 1 / mssec

KeyUp()
Main()

Sub Main
  GraphicsWindow.Show()
  GraphicsWindow.KeyDown = KeyDown
  GraphicsWindow.KeyUp   = KeyUp  
  endtime = Clock.ElapsedMilliseconds
  starttime = Clock.ElapsedMilliseconds
  blinktime = Clock.ElapsedMilliseconds
  gamestarttime = Clock.ElapsedMilliseconds
  
  gemfall = false
  freecells = 1
  blink     = 0
  fps = 0
  looptime = 0  
  play = 1
  pause = 0
  rot = 0
  
  While(play = 1)
    
    fps = fps + 1
         
    Input()
    if status = "game" then


      'try fixed fps - 60 might be enough
      loopdelay = (1000/60) * loopmssec 
      num = 0
      While(num < loopdelay)
        num = num + 1
      endwhile
      
      
      If gemfall = false and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 then
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true
      EndIf
      If gemfall = true and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 and Clock.ElapsedMilliseconds - watertime < 1400 then
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  
      EndIf
      If gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 1400 then
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false
      EndIf
                 
         
      
        If (gemchng <> 99) And (Clock.ElapsedMilliseconds - gemtime > 400) Then
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99
        EndIf
    
        'move the player
        If newmove < 25 Then
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 
        EndIf
    
    
        'blinking crystals when level is done
        If freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350 then  
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds
        EndIf
        
      ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif
       EndIf
       
       ' show time and fps
       If Clock.ElapsedMilliseconds - endtime > 1000 And status = "game" Then
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0
        EndIf
    EndIf  'of Status = game
  
    'reset level after a short delay  
    If status ="reset" And (Clock.ElapsedMilliseconds - resettime > 2500) Then
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.FillRectangle(800,690,224,80)
      freecells = 1
      blink = 0
      LevelRelease()
      LevelLoad()
      wait1 = Clock.ElapsedMilliseconds
      While Clock.ElapsedMilliseconds - wait1 < 3000
      EndWhile  
      starttime = Clock.ElapsedMilliseconds   
      status = "game" 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FontName = "COMIC SANS MS"
      GraphicsWindow.FontSize = 25
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.BrushColor = "white"
      GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      GraphicsWindow.DrawText(70, 725, " level "+ (stage + 1) )
    EndIf
    If status = "start" then   
      MoveStars()        
    endif
    
  EndWhile
EndSub


Sub KeyDown
  
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  bescapeKey  = false
  
  
  If GraphicsWindow.LastKey = leftKey then
    bleftKey = true
  elseif GraphicsWindow.LastKey = rightKey then
    brightKey = true   
  elseif GraphicsWindow.LastKey = forwardKey then
    bforwardKey = true
  elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif
  
endSub

Sub KeyUp
  ' reset every key first
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  breturnKey  = false
  
  If GraphicsWindow.LastKey = pauseKey then 
    LevelExplosion()
  EndIf
 
 
  If GraphicsWindow.LastKey = escapeKey and status = "start" then
    Program.End()
  EndIf

  
  If GraphicsWindow.LastKey = escapeKey And status = "game" then 
    LevelExplosion()
    stage = 0
    Shapes.Animate(titleshape, 140,170, 2500)
    Shapes.Animate(txtstart, 305,420, 3000)
    GraphicsWindow.BrushColor = "#3975e5"
    GraphicsWindow.FillRectangle(70,690,170,80)
    GraphicsWindow.FillRectangle(800,690,224,85)
    status = "start"
    ResetStars()
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = resetKey then 
    LevelExplosion()
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = pluskey then 
    LevelExplosion()
    'stage = stage + 1   'uncomment this line to cheat with F1
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf

  If GraphicsWindow.LastKey = minuskey then 
    'KeyUp()
    LevelExplosion()
    'stage = stage - 1  'uncomment this line to cheat with F2
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  'reload title after <escape>
  If GraphicsWindow.LastKey = returnKey and status = "start" then 
    Shapes.Animate(titleshape, 140,-350, 2000)
    Shapes.Animate(txtstart, 305, 1220, 1600)
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
EndSub



Sub Input
   
  If newmove >= 25  and blink = 0 then   
  
    'move right  
    If(brightKey   = true) and (level[posy][posx+1] <= 2) Then   
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  
  ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf          
  EndIf
EndSub




Sub Sort  
   For y = 0 To 15
     For x = 0 To 15
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])
    EndFor
  EndFor  
EndSub
  
  
Sub LevelExplosion  
  
  Shapes.Animate(player1, Shapes.GetLeft(player1), 1500, 4000)
  Shapes.Animate(player2, Shapes.GetLeft(player2), 1500, 4000)  

  For i = 0 To shade
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      Shapes.Animate(Shadow[i], xv + 512, yv + 350, 1500)
  EndFor  
  
  For i = 0 To cryst
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      If Shapes.GetTop(crystalimg[i]) > 0 then
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)
      EndIf
      If Shapes.GetTop(crystalbnk[i]) > 0 then
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)
      EndIf
    EndFor  
  
    For y = 0 To 15
     For x = 0 To 19
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)
    EndFor
  EndFor      
EndSub


Sub LevelRelease  
   For y = 0 To 15
     For x = 0 To 19         
       Shapes.Remove(levelshapes[y][x])
    EndFor
  EndFor  
  For i = 0 To shade         
      Shapes.Remove(Shadow[i])
  EndFor  
  
  For i = 0 To cryst
        Shapes.Remove(crystalimg[i])
        Shapes.Remove(crystalbnk[i])
  EndFor   
  For i = 0 To 20
    Shapes.Remove(star)  
  endFor
EndSub

Sub LevelLoad
  cryst = 0
  posx  = 4
  posy  = 4
  moves = 0
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      
    EndFor
  EndFor
         
  
  'load the water first
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      
    EndFor  
  EndFor
  
  'shadows for the water
  LoadShadowWater()
  
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   
    EndFor  
  EndFor   
  
  'tried to fix strange Shapes.Animate behaviors if there are too many shapes flying around - no real  success... 
  loopdelay = (1600) * loopmssec 
   num = 0
   While(num < loopdelay)
    num = num + 1
  endwhile
  
  'load blocks
  f = 0
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      
    EndFor  
  EndFor
  player1 = Shapes.AddImage(Path + "/sokocutep2.png")
 
  'load lower player shape first. it has to be behind the walls 
  Shapes.Move(player1, (posx) * 50 + korrx, (posy) * 40 - 0) 

  LoadShadow()
  '------------------------------------------------------------
  'load the walls
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  
  EndFor
  
  'load players face at last. It has always to be in front of the walls
  player2 = Shapes.AddImage(Path + "/sokocutep1.png")
  Shapes.Move(player2, (posx) * 50 + korrx, (posy) * 40 - 0)  
  xplayer = Shapes.GetLeft(player1)
  yplayer = Shapes.GetTop(player1)  

EndSub

sub LoadShadow
  

  For y = 0 To 15
     For x = 0 To 19
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   
 
EndSub

sub LoadShadowWater 
  shade = 0
 ky = 22
  For y = 0 To 15
     For x = 0 To 19
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   

EndSub

Sub InitStars
  For i = 0 To 12
    star[i] = Shapes.AddImage(Path + "/sokocutels.png")  
    heart[i] = Shapes.AddImage(Path + "/sokocutelh.png") 
  endFor
EndSub


Sub ResetStars
  For i = 0 To 12
    angle = Math.GetRandomNumber(360)
    starxv[i] = Math.Cos(angle * 0.0174) * 0.50
    staryv[i] = Math.Sin(angle * 0.0174) * 0.50    
    starx[i] = 1000
    stary[i] = 1000   
    startime[i] = Math.GetRandomNumber(100)
    Shapes.Move(star[i], starx[i], stary[i])  
  endFor
  For i = 0 To 12
   angle = Math.GetRandomNumber(360)
   heartxv[i] = Math.Cos(angle * 0.0174) * 0.50
   heartyv[i] = Math.Sin(angle * 0.0174) * 0.50    
   heartx[i] = 1000
   hearty[i] = 1000   
   hearttime[i] = Math.GetRandomNumber(100)
   Shapes.Move(heart[i], heartx[i], hearty[i])  
 endFor
EndSub

' move stars and hearts
Sub MoveStars
  
      For i = 0 to 12
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      
    EndFor  
    
    
    For i = 0 to 12
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Rotate(heart[i], hearttime[i] * -10)
      Shapes.Zoom(heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttim

97 ID = Expr
  19,1: Path
  19,6: =
  19,8: "http://smallbasic.com/drop/soko"

188 = Expr
  19,6: =
  19,8: "http://smallbasic.com/drop/soko"

73 STR
  19,8: "http://smallbasic.com/drop/soko"

97 ID = Expr
  20,1: background
  20,12: =
  20,14: ImageList.LoadImage( Path + "/sokocuteff.png")

188 = Expr
  20,12: =
  20,14: ImageList.LoadImage( Path + "/sokocuteff.png")

73 ID . ID ( Exprs )
  20,14: ImageList
  20,23: .
  20,24: LoadImage
  20,33: (
  20,35: Path + "/sokocuteff.png"
  20,59: )

2 . ID ( Exprs )
  20,23: .
  20,24: LoadImage
  20,33: (
  20,35: Path + "/sokocuteff.png"
  20,59: )

247 ID ( Exprs )
  20,24: LoadImage
  20,33: (
  20,35: Path + "/sokocuteff.png"
  20,59: )

6 ( Exprs )
  20,33: (
  20,35: Path + "/sokocuteff.png"
  20,59: )

21 ID
  20,35: Path

65 + MultiplicativeExpr
  20,40: +
  20,42: "/sokocuteff.png"

141 STR
  20,42: "/sokocuteff.png"

250 )
  20,59: )

97 ID Idxs = Expr
  21,1: image
  21,6: ["A"]
  21,12: =
  21,14: ImageList.LoadImage( Path + "/sokocute0a.png")

188 [ Expr ]
  21,6: [
  21,7: "A"
  21,10: ]

76 STR
  21,7: "A"

245 ]
  21,10: ]

251 = Expr
  21,12: =
  21,14: ImageList.LoadImage( Path + "/sokocute0a.png")

63 ID . ID ( Exprs )
  21,14: ImageList
  21,23: .
  21,24: LoadImage
  21,33: (
  21,35: Path + "/sokocute0a.png"
  21,59: )

2 . ID ( Exprs )
  21,23: .
  21,24: LoadImage
  21,33: (
  21,35: Path + "/sokocute0a.png"
  21,59: )

247 ID ( Exprs )
  21,24: LoadImage
  21,33: (
  21,35: Path + "/sokocute0a.png"
  21,59: )

6 ( Exprs )
  21,33: (
  21,35: Path + "/sokocute0a.png"
  21,59: )

21 ID
  21,35: Path

65 + MultiplicativeExpr
  21,40: +
  21,42: "/sokocute0a.png"

141 STR
  21,42: "/sokocute0a.png"

250 )
  21,59: )

97 ID Idxs = Expr
  22,1: image
  22,6: ["B"]
  22,12: =
  22,14: ImageList.LoadImage( Path + "/sokocute0b.png")

188 [ Expr ]
  22,6: [
  22,7: "B"
  22,10: ]

76 STR
  22,7: "B"

245 ]
  22,10: ]

251 = Expr
  22,12: =
  22,14: ImageList.LoadImage( Path + "/sokocute0b.png")

63 ID . ID ( Exprs )
  22,14: ImageList
  22,23: .
  22,24: LoadImage
  22,33: (
  22,35: Path + "/sokocute0b.png"
  22,59: )

2 . ID ( Exprs )
  22,23: .
  22,24: LoadImage
  22,33: (
  22,35: Path + "/sokocute0b.png"
  22,59: )

247 ID ( Exprs )
  22,24: LoadImage
  22,33: (
  22,35: Path + "/sokocute0b.png"
  22,59: )

6 ( Exprs )
  22,33: (
  22,35: Path + "/sokocute0b.png"
  22,59: )

21 ID
  22,35: Path

65 + MultiplicativeExpr
  22,40: +
  22,42: "/sokocute0b.png"

141 STR
  22,42: "/sokocute0b.png"

250 )
  22,59: )

97 ID Idxs = Expr
  23,1: image
  23,6: ["7"]
  23,12: =
  23,14: ImageList.LoadImage( Path + "/sokocute07.png")

188 [ Expr ]
  23,6: [
  23,7: "7"
  23,10: ]

76 STR
  23,7: "7"

245 ]
  23,10: ]

251 = Expr
  23,12: =
  23,14: ImageList.LoadImage( Path + "/sokocute07.png")

63 ID . ID ( Exprs )
  23,14: ImageList
  23,23: .
  23,24: LoadImage
  23,33: (
  23,35: Path + "/sokocute07.png"
  23,59: )

2 . ID ( Exprs )
  23,23: .
  23,24: LoadImage
  23,33: (
  23,35: Path + "/sokocute07.png"
  23,59: )

247 ID ( Exprs )
  23,24: LoadImage
  23,33: (
  23,35: Path + "/sokocute07.png"
  23,59: )

6 ( Exprs )
  23,33: (
  23,35: Path + "/sokocute07.png"
  23,59: )

21 ID
  23,35: Path

65 + MultiplicativeExpr
  23,40: +
  23,42: "/sokocute07.png"

141 STR
  23,42: "/sokocute07.png"

250 )
  23,59: )

97 ID Idxs = Expr
  24,1: image
  24,6: ["6"]
  24,12: =
  24,14: ImageList.LoadImage( Path + "/sokocute06.png")

188 [ Expr ]
  24,6: [
  24,7: "6"
  24,10: ]

76 STR
  24,7: "6"

245 ]
  24,10: ]

251 = Expr
  24,12: =
  24,14: ImageList.LoadImage( Path + "/sokocute06.png")

63 ID . ID ( Exprs )
  24,14: ImageList
  24,23: .
  24,24: LoadImage
  24,33: (
  24,35: Path + "/sokocute06.png"
  24,59: )

2 . ID ( Exprs )
  24,23: .
  24,24: LoadImage
  24,33: (
  24,35: Path + "/sokocute06.png"
  24,59: )

247 ID ( Exprs )
  24,24: LoadImage
  24,33: (
  24,35: Path + "/sokocute06.png"
  24,59: )

6 ( Exprs )
  24,33: (
  24,35: Path + "/sokocute06.png"
  24,59: )

21 ID
  24,35: Path

65 + MultiplicativeExpr
  24,40: +
  24,42: "/sokocute06.png"

141 STR
  24,42: "/sokocute06.png"

250 )
  24,59: )

97 ID Idxs = Expr
  25,1: image
  25,6: ["5"]
  25,12: =
  25,14: ImageList.LoadImage( Path + "/sokocute05.png")

188 [ Expr ]
  25,6: [
  25,7: "5"
  25,10: ]

76 STR
  25,7: "5"

245 ]
  25,10: ]

251 = Expr
  25,12: =
  25,14: ImageList.LoadImage( Path + "/sokocute05.png")

63 ID . ID ( Exprs )
  25,14: ImageList
  25,23: .
  25,24: LoadImage
  25,33: (
  25,35: Path + "/sokocute05.png"
  25,59: )

2 . ID ( Exprs )
  25,23: .
  25,24: LoadImage
  25,33: (
  25,35: Path + "/sokocute05.png"
  25,59: )

247 ID ( Exprs )
  25,24: LoadImage
  25,33: (
  25,35: Path + "/sokocute05.png"
  25,59: )

6 ( Exprs )
  25,33: (
  25,35: Path + "/sokocute05.png"
  25,59: )

21 ID
  25,35: Path

65 + MultiplicativeExpr
  25,40: +
  25,42: "/sokocute05.png"

141 STR
  25,42: "/sokocute05.png"

250 )
  25,59: )

97 ID Idxs = Expr
  26,1: image
  26,6: ["4"]
  26,12: =
  26,14: ImageList.LoadImage( Path + "/sokocute04.png")

188 [ Expr ]
  26,6: [
  26,7: "4"
  26,10: ]

76 STR
  26,7: "4"

245 ]
  26,10: ]

251 = Expr
  26,12: =
  26,14: ImageList.LoadImage( Path + "/sokocute04.png")

63 ID . ID ( Exprs )
  26,14: ImageList
  26,23: .
  26,24: LoadImage
  26,33: (
  26,35: Path + "/sokocute04.png"
  26,59: )

2 . ID ( Exprs )
  26,23: .
  26,24: LoadImage
  26,33: (
  26,35: Path + "/sokocute04.png"
  26,59: )

247 ID ( Exprs )
  26,24: LoadImage
  26,33: (
  26,35: Path + "/sokocute04.png"
  26,59: )

6 ( Exprs )
  26,33: (
  26,35: Path + "/sokocute04.png"
  26,59: )

21 ID
  26,35: Path

65 + MultiplicativeExpr
  26,40: +
  26,42: "/sokocute04.png"

141 STR
  26,42: "/sokocute04.png"

250 )
  26,59: )

97 ID Idxs = Expr
  27,1: image
  27,6: ["3"]
  27,12: =
  27,14: ImageList.LoadImage( Path + "/sokocute03.png")

188 [ Expr ]
  27,6: [
  27,7: "3"
  27,10: ]

76 STR
  27,7: "3"

245 ]
  27,10: ]

251 = Expr
  27,12: =
  27,14: ImageList.LoadImage( Path + "/sokocute03.png")

63 ID . ID ( Exprs )
  27,14: ImageList
  27,23: .
  27,24: LoadImage
  27,33: (
  27,35: Path + "/sokocute03.png"
  27,59: )

2 . ID ( Exprs )
  27,23: .
  27,24: LoadImage
  27,33: (
  27,35: Path + "/sokocute03.png"
  27,59: )

247 ID ( Exprs )
  27,24: LoadImage
  27,33: (
  27,35: Path + "/sokocute03.png"
  27,59: )

6 ( Exprs )
  27,33: (
  27,35: Path + "/sokocute03.png"
  27,59: )

21 ID
  27,35: Path

65 + MultiplicativeExpr
  27,40: +
  27,42: "/sokocute03.png"

141 STR
  27,42: "/sokocute03.png"

250 )
  27,59: )

97 ID Idxs = Expr
  28,1: image
  28,6: ["2"]
  28,12: =
  28,14: ImageList.LoadImage( Path + "/sokocutegg.png")

188 [ Expr ]
  28,6: [
  28,7: "2"
  28,10: ]

76 STR
  28,7: "2"

245 ]
  28,10: ]

251 = Expr
  28,12: =
  28,14: ImageList.LoadImage( Path + "/sokocutegg.png")

63 ID . ID ( Exprs )
  28,14: ImageList
  28,23: .
  28,24: LoadImage
  28,33: (
  28,35: Path + "/sokocutegg.png"
  28,59: )

2 . ID ( Exprs )
  28,23: .
  28,24: LoadImage
  28,33: (
  28,35: Path + "/sokocutegg.png"
  28,59: )

247 ID ( Exprs )
  28,24: LoadImage
  28,33: (
  28,35: Path + "/sokocutegg.png"
  28,59: )

6 ( Exprs )
  28,33: (
  28,35: Path + "/sokocutegg.png"
  28,59: )

21 ID
  28,35: Path

65 + MultiplicativeExpr
  28,40: +
  28,42: "/sokocutegg.png"

141 STR
  28,42: "/sokocutegg.png"

250 )
  28,59: )

97 ID Idxs = Expr
  29,1: image
  29,6: ["1"]
  29,12: =
  29,14: ImageList.LoadImage( Path + "/sokocutess.png")

188 [ Expr ]
  29,6: [
  29,7: "1"
  29,10: ]

76 STR
  29,7: "1"

245 ]
  29,10: ]

251 = Expr
  29,12: =
  29,14: ImageList.LoadImage( Path + "/sokocutess.png")

63 ID . ID ( Exprs )
  29,14: ImageList
  29,23: .
  29,24: LoadImage
  29,33: (
  29,35: Path + "/sokocutess.png"
  29,59: )

2 . ID ( Exprs )
  29,23: .
  29,24: LoadImage
  29,33: (
  29,35: Path + "/sokocutess.png"
  29,59: )

247 ID ( Exprs )
  29,24: LoadImage
  29,33: (
  29,35: Path + "/sokocutess.png"
  29,59: )

6 ( Exprs )
  29,33: (
  29,35: Path + "/sokocutess.png"
  29,59: )

21 ID
  29,35: Path

65 + MultiplicativeExpr
  29,40: +
  29,42: "/sokocutess.png"

141 STR
  29,42: "/sokocutess.png"

250 )
  29,59: )

97 ID Idxs = Expr
  30,1: image
  30,6: ["0"]
  30,12: =
  30,14: ImageList.LoadImage( Path + "/sokocute00.png")

188 [ Expr ]
  30,6: [
  30,7: "0"
  30,10: ]

76 STR
  30,7: "0"

245 ]
  30,10: ]

251 = Expr
  30,12: =
  30,14: ImageList.LoadImage( Path + "/sokocute00.png")

63 ID . ID ( Exprs )
  30,14: ImageList
  30,23: .
  30,24: LoadImage
  30,33: (
  30,35: Path + "/sokocute00.png"
  30,59: )

2 . ID ( Exprs )
  30,23: .
  30,24: LoadImage
  30,33: (
  30,35: Path + "/sokocute00.png"
  30,59: )

247 ID ( Exprs )
  30,24: LoadImage
  30,33: (
  30,35: Path + "/sokocute00.png"
  30,59: )

6 ( Exprs )
  30,33: (
  30,35: Path + "/sokocute00.png"
  30,59: )

21 ID
  30,35: Path

65 + MultiplicativeExpr
  30,40: +
  30,42: "/sokocute00.png"

141 STR
  30,42: "/sokocute00.png"

250 )
  30,59: )

97 ID = Expr
  31,1: star
  31,12: =
  31,14: ImageList.LoadImage( Path + "/sokocutels.png")

188 = Expr
  31,12: =
  31,14: ImageList.LoadImage( Path + "/sokocutels.png")

73 ID . ID ( Exprs )
  31,14: ImageList
  31,23: .
  31,24: LoadImage
  31,33: (
  31,35: Path + "/sokocutels.png"
  31,59: )

2 . ID ( Exprs )
  31,23: .
  31,24: LoadImage
  31,33: (
  31,35: Path + "/sokocutels.png"
  31,59: )

247 ID ( Exprs )
  31,24: LoadImage
  31,33: (
  31,35: Path + "/sokocutels.png"
  31,59: )

6 ( Exprs )
  31,33: (
  31,35: Path + "/sokocutels.png"
  31,59: )

21 ID
  31,35: Path

65 + MultiplicativeExpr
  31,40: +
  31,42: "/sokocutels.png"

141 STR
  31,42: "/sokocutels.png"

250 )
  31,59: )

97 ID = Expr
  32,1: heart
  32,12: =
  32,14: ImageList.LoadImage( Path + "/sokocutelh.png")

188 = Expr
  32,12: =
  32,14: ImageList.LoadImage( Path + "/sokocutelh.png")

73 ID . ID ( Exprs )
  32,14: ImageList
  32,23: .
  32,24: LoadImage
  32,33: (
  32,35: Path + "/sokocutelh.png"
  32,59: )

2 . ID ( Exprs )
  32,23: .
  32,24: LoadImage
  32,33: (
  32,35: Path + "/sokocutelh.png"
  32,59: )

247 ID ( Exprs )
  32,24: LoadImage
  32,33: (
  32,35: Path + "/sokocutelh.png"
  32,59: )

6 ( Exprs )
  32,33: (
  32,35: Path + "/sokocutelh.png"
  32,59: )

21 ID
  32,35: Path

65 + MultiplicativeExpr
  32,40: +
  32,42: "/sokocutelh.png"

141 STR
  32,42: "/sokocutelh.png"

250 )
  32,59: )

101 Start_repeat1
  33,1: 'GraphicsWindow.DrawText(100,100, Program.Directory)
GraphicsWindow.DrawImage(background, 0, 0)
'-----------------------------------------------------------------------------------------
'init the keys
'------------------------------------------------------

97 ID . ID ( Exprs )
  34,1: GraphicsWindow
  34,15: .
  34,16: DrawImage
  34,25: (
  34,26: background, 0, 0
  34,42: )

188 . ID ( Exprs )
  34,15: .
  34,16: DrawImage
  34,25: (
  34,26: background, 0, 0
  34,42: )

259 ID ( Exprs )
  34,16: DrawImage
  34,25: (
  34,26: background, 0, 0
  34,42: )

214 ( Exprs )
  34,25: (
  34,26: background, 0, 0
  34,42: )

25 ID
  34,26: background

217 , MoreThanOneExpr
  34,36: ,
  34,38: 0, 0

54 NUM
  34,38: 0

217 , MoreThanOneExpr
  34,39: ,
  34,41: 0

54 NUM
  34,41: 0

240 )
  34,42: )

101 Prog
  35,1: '----------------

101 Prog
  36,1: 'init the keys
'-

101 Prog
  37,1: '----------------

97 ID = Expr
  38,1: leftKey
  38,10: =
  38,12: "Left"

188 = Expr
  38,10: =
  38,12: "Left"

73 STR
  38,12: "Left"

97 ID = Expr
  39,1: rightKey
  39,10: =
  39,12: "Right"

188 = Expr
  39,10: =
  39,12: "Right"

73 STR
  39,12: "Right"

97 ID = Expr
  40,1: forwardKey
  40,12: =
  40,14: "Up"

188 = Expr
  40,12: =
  40,14: "Up"

73 STR
  40,14: "Up"

97 ID = Expr
  41,1: backKey
  41,9: =
  41,11: "Down"

188 = Expr
  41,9: =
  41,11: "Down"

73 STR
  41,11: "Down"

97 ID = Expr
  42,1: fireKey
  42,9: =
  42,11: "Space"

188 = Expr
  42,9: =
  42,11: "Space"

73 STR
  42,11: "Space"

97 ID = Expr
  43,1: returnKey
  43,11: =
  43,13: "Return"

188 = Expr
  43,11: =
  43,13: "Return"

73 STR
  43,13: "Return"

97 ID = Expr
  44,1: escapeKey
  44,11: =
  44,13: "Escape"

188 = Expr
  44,11: =
  44,13: "Escape"

73 STR
  44,13: "Escape"

97 ID = Expr
  45,1: pauseKey
  45,10: =
  45,12: "P"

188 = Expr
  45,10: =
  45,12: "P"

73 STR
  45,12: "P"

97 ID = Expr
  46,1: resetKey
  46,10: =
  46,12: "R"

188 = Expr
  46,10: =
  46,12: "R"

73 STR
  46,12: "R"

97 ID = Expr
  47,1: pluskey
  47,9: =
  47,11: "F1"

188 = Expr
  47,9: =
  47,11: "F1"

73 STR
  47,11: "F1"

97 ID = Expr
  48,1: minusKey
  48,10: =
  48,12: "F2"

188 = Expr
  48,10: =
  48,12: "F2"

73 STR
  48,12: "F2"

101 Start_repeat1
  49,1: 'important var for moving the crystals
korrx =

97 ID = Expr
  50,1: korrx
  50,7: =
  50,9: 36

188 = Expr
  50,7: =
  50,9: 36

73 NUM
  50,9: 36

101 Prog
  51,1: 'init any other

97 ID = Expr
  52,1: animtime
  52,10: =
  52,12: 1500

188 = Expr
  52,10: =
  52,12: 1500

73 NUM
  52,12: 1500

97 ID = Expr
  53,1: status
  53,8: =
  53,10: "start"

188 = Expr
  53,8: =
  53,10: "start"

73 STR
  53,10: "start"

97 ID = Expr
  54,1: game
  54,5: =
  54,6: "gamearray"

188 = Expr
  54,5: =
  54,6: "gamearray"

73 STR
  54,6: "gamearray"

97 ID = Expr
  55,1: block
  55,7: =
  55,9: "blockArray"

188 = Expr
  55,7: =
  55,9: "blockArray"

73 STR
  55,9: "blockArray"

97 ID = Expr
  56,1: true
  56,6: =
  56,8: 1

188 = Expr
  56,6: =
  56,8: 1

73 NUM
  56,8: 1

97 ID = Expr
  57,1: false
  57,7: =
  57,9: 0

188 = Expr
  57,7: =
  57,9: 0

73 NUM
  57,9: 0

97 ID = Expr
  58,1: stage
  58,7: =
  58,9: 0

188 = Expr
  58,7: =
  58,9: 0

73 NUM
  58,9: 0

101 Start_repeat1
  59,1: 
'init level data
InitLevels()
'init stars and 

97 ID ( )
  61,1: InitLevels
  61,11: (
  61,12: )

188 ( )
  61,11: (
  61,12: )

256 )
  61,12: )

101 Prog
  62,1: 'init stars

97 ID ( )
  63,1: InitStars
  63,10: (
  63,11: )

188 ( )
  63,10: (
  63,11: )

256 )
  63,11: )

97 ID ( )
  64,1: ResetStars
  64,11: (
  64,12: )

188 ( )
  64,11: (
  64,12: )

256 )
  64,12: )

101 Prog
  65,1: 
' animate title at first
titleshape = Shapes.AddIma

97 ID = Expr
  67,1: titleshape
  67,12: =
  67,14: Shapes.AddImage(Path + "/sokocute.png")

188 = Expr
  67,12: =
  67,14: Shapes.AddImage(Path + "/sokocute.png")

73 ID . ID ( Exprs )
  67,14: Shapes
  67,20: .
  67,21: AddImage
  67,29: (
  67,30: Path + "/sokocute.png"
  67,52: )

2 . ID ( Exprs )
  67,20: .
  67,21: AddImage
  67,29: (
  67,30: Path + "/sokocute.png"
  67,52: )

247 ID ( Exprs )
  67,21: AddImage
  67,29: (
  67,30: Path + "/sokocute.png"
  67,52: )

6 ( Exprs )
  67,29: (
  67,30: Path + "/sokocute.png"
  67,52: )

21 ID
  67,30: Path

65 + MultiplicativeExpr
  67,35: +
  67,37: "/sokocute.png"

141 STR
  67,37: "/sokocute.png"

250 )
  67,52: )

97 ID . ID ( Exprs )
  68,1: Shapes
  68,7: .
  68,8: Move
  68,12: (
  68,13: titleshape, 140,-350
  68,33: )

188 . ID ( Exprs )
  68,7: .
  68,8: Move
  68,12: (
  68,13: titleshape, 140,-350
  68,33: )

259 ID ( Exprs )
  68,8: Move
  68,12: (
  68,13: titleshape, 140,-350
  68,33: )

214 ( Exprs )
  68,12: (
  68,13: titleshape, 140,-350
  68,33: )

25 ID
  68,13: titleshape

217 , MoreThanOneExpr
  68,23: ,
  68,25: 140,-350

54 NUM
  68,25: 140

217 , MoreThanOneExpr
  68,28: ,
  68,29: -350

54 - Primary
  68,29: -
  68,30: 350

197 NUM
  68,30: 350

240 )
  68,33: )

97 ID . ID ( Exprs )
  69,1: Shapes
  69,7: .
  69,8: Animate
  69,15: (
  69,16: titleshape, 140,170, 2500
  69,41: )

188 . ID ( Exprs )
  69,7: .
  69,8: Animate
  69,15: (
  69,16: titleshape, 140,170, 2500
  69,41: )

259 ID ( Exprs )
  69,8: Animate
  69,15: (
  69,16: titleshape, 140,170, 2500
  69,41: )

214 ( Exprs )
  69,15: (
  69,16: titleshape, 140,170, 2500
  69,41: )

25 ID
  69,16: titleshape

217 , MoreThanOneExpr
  69,26: ,
  69,28: 140,170, 2500

54 NUM
  69,28: 140

217 , MoreThanOneExpr
  69,31: ,
  69,32: 170, 2500

54 NUM
  69,32: 170

217 , MoreThanOneExpr
  69,35: ,
  69,37: 2500

54 NUM
  69,37: 2500

240 )
  69,41: )

97 ID = Expr
  71,1: txtstart
  71,10: =
  71,12: Shapes.AddImage(Path + "/sokocutetx.png")

188 = Expr
  71,10: =
  71,12: Shapes.AddImage(Path + "/sokocutetx.png")

73 ID . ID ( Exprs )
  71,12: Shapes
  71,18: .
  71,19: AddImage
  71,27: (
  71,28: Path + "/sokocutetx.png"
  71,52: )

2 . ID ( Exprs )
  71,18: .
  71,19: AddImage
  71,27: (
  71,28: Path + "/sokocutetx.png"
  71,52: )

247 ID ( Exprs )
  71,19: AddImage
  71,27: (
  71,28: Path + "/sokocutetx.png"
  71,52: )

6 ( Exprs )
  71,27: (
  71,28: Path + "/sokocutetx.png"
  71,52: )

21 ID
  71,28: Path

65 + MultiplicativeExpr
  71,33: +
  71,35: "/sokocutetx.png"

141 STR
  71,35: "/sokocutetx.png"

250 )
  71,52: )

97 ID . ID ( Exprs )
  72,1: Shapes
  72,7: .
  72,8: Move
  72,12: (
  72,13: txtstart, 305,1800
  72,31: )

188 . ID ( Exprs )
  72,7: .
  72,8: Move
  72,12: (
  72,13: txtstart, 305,1800
  72,31: )

259 ID ( Exprs )
  72,8: Move
  72,12: (
  72,13: txtstart, 305,1800
  72,31: )

214 ( Exprs )
  72,12: (
  72,13: txtstart, 305,1800
  72,31: )

25 ID
  72,13: txtstart

217 , MoreThanOneExpr
  72,21: ,
  72,23: 305,1800

54 NUM
  72,23: 305

217 , MoreThanOneExpr
  72,26: ,
  72,27: 1800

54 NUM
  72,27: 1800

240 )
  72,31: )

97 ID . ID ( Exprs )
  73,1: Shapes
  73,7: .
  73,8: Animate
  73,15: (
  73,16: txtstart, 305,420, 3000
  73,39: )

188 . ID ( Exprs )
  73,7: .
  73,8: Animate
  73,15: (
  73,16: txtstart, 305,420, 3000
  73,39: )

259 ID ( Exprs )
  73,8: Animate
  73,15: (
  73,16: txtstart, 305,420, 3000
  73,39: )

214 ( Exprs )
  73,15: (
  73,16: txtstart, 305,420, 3000
  73,39: )

25 ID
  73,16: txtstart

217 , MoreThanOneExpr
  73,24: ,
  73,26: 305,420, 3000

54 NUM
  73,26: 305

217 , MoreThanOneExpr
  73,29: ,
  73,30: 420, 3000

54 NUM
  73,30: 420

217 , MoreThanOneExpr
  73,33: ,
  73,35: 3000

54 NUM
  73,35: 3000

240 )
  73,39: )

101 Prog
  74,1: 
'calculate delay (higher number mean

97 ID = Expr
  76,1: timestart
  76,11: =
  76,13: Clock.ElapsedMilliseconds

188 = Expr
  76,11: =
  76,13: Clock.ElapsedMilliseconds

73 ID . ID
  76,13: Clock
  76,18: .
  76,19: ElapsedMilliseconds

2 . ID
  76,18: .
  76,19: ElapsedMilliseconds

247 ID
  76,19: ElapsedMilliseconds

97 ID = Expr
  77,1: i
  77,3: =
  77,5: 0

188 = Expr
  77,3: =
  77,5: 0

73 NUM
  77,5: 0

97 Stmt_token1 Expr CRStmtCRs Stmt_token2
  78,1: while
  78,7: (i < 500000)
  78,19: 
i = i + 1

  80,1: Endwhile

77 ( Expr )
  78,7: (
  78,8: i < 500000
  78,18: )

64 ID
  78,8: i

91 < AdditiveExpr
  78,10: <
  78,12: 500000

131 NUM
  78,12: 500000

235 )
  78,18: )

192 CR_token2
  78,19: 


93 ID = Expr
  79,1: i
  79,3: =
  79,5: i + 1

184 = Expr
  79,3: =
  79,5: i + 1

70 ID
  79,5: i

59 + MultiplicativeExpr
  79,7: +
  79,9: 1

144 NUM
  79,9: 1

205 CR_token2
  79,10: 


179 Stmt_token2
  80,1: Endwhile

97 ID = Expr
  81,1: timeloop
  81,10: =
  81,12: Clock.ElapsedMilliseconds - timestart

188 = Expr
  81,10: =
  81,12: Clock.ElapsedMilliseconds - timestart

73 ID . ID
  81,12: Clock
  81,17: .
  81,18: ElapsedMilliseconds

2 . ID
  81,17: .
  81,18: ElapsedMilliseconds

247 ID
  81,18: ElapsedMilliseconds

28 - MultiplicativeExpr
  81,38: -
  81,40: timestart

143 ID
  81,40: timestart

97 ID = Expr
  82,1: mssec
  82,7: =
  82,9: timeloop / 500000

188 = Expr
  82,7: =
  82,9: timeloop / 500000

73 ID
  82,9: timeloop

10 / UnaryExpr
  82,18: /
  82,20: 500000

155 NUM
  82,20: 500000

97 ID = Expr
  83,1: loopmssec
  83,11: =
  83,13: 1 / mssec

188 = Expr
  83,11: =
  83,13: 1 / mssec

73 NUM
  83,13: 1

10 / UnaryExpr
  83,15: /
  83,17: mssec

155 ID
  83,17: mssec

97 ID ( )
  85,1: KeyUp
  85,6: (
  85,7: )

188 ( )
  85,6: (
  85,7: )

256 )
  85,7: )

97 ID ( )
  86,1: Main
  86,5: (
  86,6: )

188 ( )
  86,5: (
  86,6: )

256 )
  86,6: )

97 Stmt_token7 ID CRStmtCRs Stmt_token8
  88,1: Sub
  88,5: Main
  88,9: 
  GraphicsWindow.Show()
  GraphicsWindow.KeyDown = KeyDown
  GraphicsWindow.KeyUp   = KeyUp  
  endtime = Clock.ElapsedMilliseconds
  starttime = Clock.ElapsedMilliseconds
  blinktime = Clock.ElapsedMilliseconds
  gamestarttime = Clock.ElapsedMilliseconds
  
  gemfall = false
  freecells = 1
  blink     = 0
  fps = 0
  looptime = 0  
  play = 1
  pause = 0
  rot = 0
  
  While(play = 1)
    
    fps = fps + 1
         
    Input()
    if status = "game" then


      'try fixed fps - 60 might be enough
      loopdelay = (1000/60) * loopmssec 
      num = 0
      While(num < loopdelay)
        num = num + 1
      endwhile
      
      
      If gemfall = false and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 then
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true
      EndIf
      If gemfall = true and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 and Clock.ElapsedMilliseconds - watertime < 1400 then
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  
      EndIf
      If gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 1400 then
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false
      EndIf
                 
         
      
        If (gemchng <> 99) And (Clock.ElapsedMilliseconds - gemtime > 400) Then
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99
        EndIf
    
        'move the player
        If newmove < 25 Then
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 
        EndIf
    
    
        'blinking crystals when level is done
        If freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350 then  
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds
        EndIf
        
      ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif
       EndIf
       
       ' show time and fps
       If Clock.ElapsedMilliseconds - endtime > 1000 And status = "game" Then
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0
        EndIf
    EndIf  'of Status = game
  
    'reset level after a short delay  
    If status ="reset" And (Clock.ElapsedMilliseconds - resettime > 2500) Then
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.FillRectangle(800,690,224,80)
      freecells = 1
      blink = 0
      LevelRelease()
      LevelLoad()
      wait1 = Clock.ElapsedMilliseconds
      While Clock.ElapsedMilliseconds - wait1 < 3000
      EndWhile  
      starttime = Clock.ElapsedMilliseconds   
      status = "game" 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FontName = "COMIC SANS MS"
      GraphicsWindow.FontSize = 25
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.BrushColor = "white"
      GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      GraphicsWindow.DrawText(70, 725, " level "+ (stage + 1) )
    EndIf
    If status = "start" then   
      MoveStars()        
    endif
    
  EndWhile

  276,1: EndSub

244 ID CRStmtCRs Stmt_token8
  88,5: Main
  88,9: 
  GraphicsWindow.Show()
  GraphicsWindow.KeyDown = KeyDown
  GraphicsWindow.KeyUp   = KeyUp  
  endtime = Clock.ElapsedMilliseconds
  starttime = Clock.ElapsedMilliseconds
  blinktime = Clock.ElapsedMilliseconds
  gamestarttime = Clock.ElapsedMilliseconds
  
  gemfall = false
  freecells = 1
  blink     = 0
  fps = 0
  looptime = 0  
  play = 1
  pause = 0
  rot = 0
  
  While(play = 1)
    
    fps = fps + 1
         
    Input()
    if status = "game" then


      'try fixed fps - 60 might be enough
      loopdelay = (1000/60) * loopmssec 
      num = 0
      While(num < loopdelay)
        num = num + 1
      endwhile
      
      
      If gemfall = false and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 then
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true
      EndIf
      If gemfall = true and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 and Clock.ElapsedMilliseconds - watertime < 1400 then
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  
      EndIf
      If gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 1400 then
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false
      EndIf
                 
         
      
        If (gemchng <> 99) And (Clock.ElapsedMilliseconds - gemtime > 400) Then
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99
        EndIf
    
        'move the player
        If newmove < 25 Then
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 
        EndIf
    
    
        'blinking crystals when level is done
        If freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350 then  
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds
        EndIf
        
      ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif
       EndIf
       
       ' show time and fps
       If Clock.ElapsedMilliseconds - endtime > 1000 And status = "game" Then
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0
        EndIf
    EndIf  'of Status = game
  
    'reset level after a short delay  
    If status ="reset" And (Clock.ElapsedMilliseconds - resettime > 2500) Then
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.FillRectangle(800,690,224,80)
      freecells = 1
      blink = 0
      LevelRelease()
      LevelLoad()
      wait1 = Clock.ElapsedMilliseconds
      While Clock.ElapsedMilliseconds - wait1 < 3000
      EndWhile  
      starttime = Clock.ElapsedMilliseconds   
      status = "game" 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FontName = "COMIC SANS MS"
      GraphicsWindow.FontSize = 25
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.BrushColor = "white"
      GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      GraphicsWindow.DrawText(70, 725, " level "+ (stage + 1) )
    EndIf
    If status = "start" then   
      MoveStars()        
    endif
    
  EndWhile

  276,1: EndSub

199 CR_token2
  88,9: 


105 ID . ID ( )
  89,3: GraphicsWindow
  89,17: .
  89,18: Show
  89,22: (
  89,23: )

184 . ID ( )
  89,17: .
  89,18: Show
  89,22: (
  89,23: )

255 ID ( )
  89,18: Show
  89,22: (
  89,23: )

221 ( )
  89,22: (
  89,23: )

27 )
  89,23: )

206 CR_token2
  89,24: 


106 ID . ID = Expr
  90,3: GraphicsWindow
  90,17: .
  90,18: KeyDown
  90,26: =
  90,28: KeyDown

184 . ID = Expr
  90,17: .
  90,18: KeyDown
  90,26: =
  90,28: KeyDown

255 ID = Expr
  90,18: KeyDown
  90,26: =
  90,28: KeyDown

221 = Expr
  90,26: =
  90,28: KeyDown

57 ID
  90,28: KeyDown

206 CR_token2
  90,35: 


106 ID . ID = Expr
  91,3: GraphicsWindow
  91,17: .
  91,18: KeyUp
  91,26: =
  91,28: KeyUp

184 . ID = Expr
  91,17: .
  91,18: KeyUp
  91,26: =
  91,28: KeyUp

255 ID = Expr
  91,18: KeyUp
  91,26: =
  91,28: KeyUp

221 = Expr
  91,26: =
  91,28: KeyUp

57 ID
  91,28: KeyUp

206 CR_token2
  91,35: 


106 ID = Expr
  92,3: endtime
  92,11: =
  92,13: Clock.ElapsedMilliseconds

184 = Expr
  92,11: =
  92,13: Clock.ElapsedMilliseconds

70 ID . ID
  92,13: Clock
  92,18: .
  92,19: ElapsedMilliseconds

5 . ID
  92,18: .
  92,19: ElapsedMilliseconds

260 ID
  92,19: ElapsedMilliseconds

206 CR_token2
  92,38: 


106 ID = Expr
  93,3: starttime
  93,13: =
  93,15: Clock.ElapsedMilliseconds

184 = Expr
  93,13: =
  93,15: Clock.ElapsedMilliseconds

70 ID . ID
  93,15: Clock
  93,20: .
  93,21: ElapsedMilliseconds

5 . ID
  93,20: .
  93,21: ElapsedMilliseconds

260 ID
  93,21: ElapsedMilliseconds

206 CR_token2
  93,40: 


106 ID = Expr
  94,3: blinktime
  94,13: =
  94,15: Clock.ElapsedMilliseconds

184 = Expr
  94,13: =
  94,15: Clock.ElapsedMilliseconds

70 ID . ID
  94,15: Clock
  94,20: .
  94,21: ElapsedMilliseconds

5 . ID
  94,20: .
  94,21: ElapsedMilliseconds

260 ID
  94,21: ElapsedMilliseconds

206 CR_token2
  94,40: 


106 ID = Expr
  95,3: gamestarttime
  95,17: =
  95,19: Clock.ElapsedMilliseconds

184 = Expr
  95,17: =
  95,19: Clock.ElapsedMilliseconds

70 ID . ID
  95,19: Clock
  95,24: .
  95,25: ElapsedMilliseconds

5 . ID
  95,24: .
  95,25: ElapsedMilliseconds

260 ID
  95,25: ElapsedMilliseconds

206 CR_token2
  95,44: 


106 ID = Expr
  97,3: gemfall
  97,11: =
  97,13: false

184 = Expr
  97,11: =
  97,13: false

70 ID
  97,13: false

206 CR_token2
  97,18: 


106 ID = Expr
  98,3: freecells
  98,13: =
  98,15: 1

184 = Expr
  98,13: =
  98,15: 1

70 NUM
  98,15: 1

206 CR_token2
  98,16: 


106 ID = Expr
  99,3: blink
  99,13: =
  99,15: 0

184 = Expr
  99,13: =
  99,15: 0

70 NUM
  99,15: 0

206 CR_token2
  99,16: 


106 ID = Expr
  100,3: fps
  100,7: =
  100,9: 0

184 = Expr
  100,7: =
  100,9: 0

70 NUM
  100,9: 0

206 CR_token2
  100,10: 


106 ID = Expr
  101,3: looptime
  101,12: =
  101,14: 0

184 = Expr
  101,12: =
  101,14: 0

70 NUM
  101,14: 0

206 CR_token2
  101,17: 


106 ID = Expr
  102,3: play
  102,8: =
  102,10: 1

184 = Expr
  102,8: =
  102,10: 1

70 NUM
  102,10: 1

206 CR_token2
  102,11: 


106 ID = Expr
  103,3: pause
  103,9: =
  103,11: 0

184 = Expr
  103,9: =
  103,11: 0

70 NUM
  103,11: 0

206 CR_token2
  103,12: 


106 ID = Expr
  104,3: rot
  104,7: =
  104,9: 0

184 = Expr
  104,7: =
  104,9: 0

70 NUM
  104,9: 0

206 CR_token2
  104,10: 


106 Stmt_token1 Expr Stmt_repeat1 Stmt_token2
  106,3: While
  106,8: (play = 1)
  106,18: 
    
    fps = fps + 1
         
    Input()
    if status = "game" then


      'try fixed fps - 60 might be enough
      loopdelay = (1000/60) * loopmssec 
      num = 0
      While(num < loopdelay)
        num = num + 1
      endwhile
      
      
      If gemfall = false and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 then
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true
      EndIf
      If gemfall = true and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 and Clock.ElapsedMilliseconds - watertime < 1400 then
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  
      EndIf
      If gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 1400 then
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false
      EndIf
                 
         
      
        If (gemchng <> 99) And (Clock.ElapsedMilliseconds - gemtime > 400) Then
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99
        EndIf
    
        'move the player
        If newmove < 25 Then
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 
        EndIf
    
    
        'blinking crystals when level is done
        If freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350 then  
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds
        EndIf
        
      ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif
       EndIf
       
       ' show time and fps
       If Clock.ElapsedMilliseconds - endtime > 1000 And status = "game" Then
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0
        EndIf
    EndIf  'of Status = game
  
    'reset level after a short delay  
    If status ="reset" And (Clock.ElapsedMilliseconds - resettime > 2500) Then
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.FillRectangle(800,690,224,80)
      freecells = 1
      blink = 0
      LevelRelease()
      LevelLoad()
      wait1 = Clock.ElapsedMilliseconds
      While Clock.ElapsedMilliseconds - wait1 < 3000
      EndWhile  
      starttime = Clock.ElapsedMilliseconds   
      status = "game" 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FontName = "COMIC SANS MS"
      GraphicsWindow.FontSize = 25
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.BrushColor = "white"
      GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      GraphicsWindow.DrawText(70, 725, " level "+ (stage + 1) )
    EndIf
    If status = "start" then   
      MoveStars()        
    endif
    

  275,3: EndWhile

79 ( Expr )
  106,8: (
  106,9: play = 1
  106,17: )

64 ID
  106,9: play

128 = CompExpr
  106,14: =
  106,16: 1

117 NUM
  106,16: 1

235 )
  106,17: )

186 CR_token2
  106,18: 


187 CR_token2
  107,5: 


93 ID = Expr
  108,5: fps
  108,9: =
  108,11: fps + 1

184 = Expr
  108,9: =
  108,11: fps + 1

70 ID
  108,11: fps

59 + MultiplicativeExpr
  108,15: +
  108,17: 1

144 NUM
  108,17: 1

205 CR_token2
  108,18: 


187 CR_token2
  109,10: 


93 ID ( )
  110,5: Input
  110,10: (
  110,11: )

184 ( )
  110,10: (
  110,11: )

261 )
  110,11: )

205 CR_token2
  110,12: 


95 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  111,5: if
  111,8: status = "game"
  111,24: then
  111,28: 


      'try fixed fps - 60 might be enough
      loopdelay = (1000/60) * loopmssec 
      num = 0
      While(num < loopdelay)
        num = num + 1
      endwhile
      
      
      If gemfall = false and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 then
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true
      EndIf
      If gemfall = true and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 and Clock.ElapsedMilliseconds - watertime < 1400 then
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  
      EndIf
      If gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 1400 then
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false
      EndIf
                 
         
      
        If (gemchng <> 99) And (Clock.ElapsedMilliseconds - gemtime > 400) Then
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99
        EndIf
    
        'move the player
        If newmove < 25 Then
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 
        EndIf
    
    
        'blinking crystals when level is done
        If freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350 then  
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds
        EndIf
        
      ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif
       EndIf
       
       ' show time and fps
       If Clock.ElapsedMilliseconds - endtime > 1000 And status = "game" Then
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0
        EndIf

  247,5: EndIf

86 ID
  111,8: status

128 = CompExpr
  111,15: =
  111,17: "game"

117 STR
  111,17: "game"

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  111,24: then
  111,28: 


      'try fixed fps - 60 might be enough
      loopdelay = (1000/60) * loopmssec 
      num = 0
      While(num < loopdelay)
        num = num + 1
      endwhile
      
      
      If gemfall = false and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 then
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true
      EndIf
      If gemfall = true and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 and Clock.ElapsedMilliseconds - watertime < 1400 then
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  
      EndIf
      If gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 1400 then
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false
      EndIf
                 
         
      
        If (gemchng <> 99) And (Clock.ElapsedMilliseconds - gemtime > 400) Then
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99
        EndIf
    
        'move the player
        If newmove < 25 Then
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 
        EndIf
    
    
        'blinking crystals when level is done
        If freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350 then  
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds
        EndIf
        
      ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif
       EndIf
       
       ' show time and fps
       If Clock.ElapsedMilliseconds - endtime > 1000 And status = "game" Then
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0
        EndIf

  247,5: EndIf

124 CR_token2
  111,28: 




122 CRStmtCRs
  114,1:       'try fixed fps - 60 might be enough
      loopdelay = (1000/60) * loopmssec 
      num = 0
      While(num < loopdel

122 CR_token2
  114,42: 


67 ID = Expr
  115,7: loopdelay
  115,17: =
  115,19: (1000/60) * loopmssec

184 = Expr
  115,17: =
  115,19: (1000/60) * loopmssec

70 ( Expr )
  115,19: (
  115,20: 1000/60
  115,27: )

64 NUM
  115,20: 1000

50 / UnaryExpr
  115,24: /
  115,25: 60

156 NUM
  115,25: 60

235 )
  115,27: )

48 * UnaryExpr
  115,29: *
  115,31: loopmssec

157 ID
  115,31: loopmssec

207 CR_token2
  115,41: 


68 ID = Expr
  116,7: num
  116,11: =
  116,13: 0

184 = Expr
  116,11: =
  116,13: 0

70 NUM
  116,13: 0

207 CR_token2
  116,14: 


68 Stmt_token1 Expr CRStmtCRs Stmt_token2
  117,7: While
  117,12: (num < loopdelay)
  117,29: 
        num = num + 1

  119,7: endwhile

79 ( Expr )
  117,12: (
  117,13: num < loopdelay
  117,28: )

64 ID
  117,13: num

91 < AdditiveExpr
  117,17: <
  117,19: loopdelay

131 ID
  117,19: loopdelay

235 )
  117,28: )

186 CR_token2
  117,29: 


93 ID = Expr
  118,9: num
  118,13: =
  118,15: num + 1

184 = Expr
  118,13: =
  118,15: num + 1

70 ID
  118,15: num

59 + MultiplicativeExpr
  118,19: +
  118,21: 1

144 NUM
  118,21: 1

205 CR_token2
  118,22: 


187 Stmt_token2
  119,7: endwhile

207 CR_token2
  119,15: 


122 CR_token2
  120,7: 


122 CR_token2
  121,7: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  122,7: If
  122,10: gemfall = false and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550
  122,93: then
  122,97: 
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true

  125,7: EndIf

86 ID
  122,10: gemfall

128 = CompExpr
  122,18: =
  122,20: false

117 ID
  122,20: false

167 AndExpr_token1 EqNeqExpr
  122,26: and
  122,30: gemwater <> 99

102 ID
  122,30: gemwater

134 <> CompExpr
  122,39: <>
  122,42: 99

117 NUM
  122,42: 99

167 AndExpr_token1 EqNeqExpr
  122,45: and
  122,49: Clock.ElapsedMilliseconds - watertime > 550

102 ID . ID
  122,49: Clock
  122,54: .
  122,55: ElapsedMilliseconds

4 . ID
  122,54: .
  122,55: ElapsedMilliseconds

248 ID
  122,55: ElapsedMilliseconds

65 - MultiplicativeExpr
  122,75: -
  122,77: watertime

141 ID
  122,77: watertime

91 > AdditiveExpr
  122,87: >
  122,89: 550

131 NUM
  122,89: 550

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  122,93: then
  122,97: 
        Shapes.Animate(crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650)
        gemfall = true

  125,7: EndIf

124 CR_token2
  122,97: 


67 ID . ID ( Exprs )
  123,9: Shapes
  123,15: .
  123,16: Animate
  123,23: (
  123,24: crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650
  123,128: )

184 . ID ( Exprs )
  123,15: .
  123,16: Animate
  123,23: (
  123,24: crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650
  123,128: )

255 ID ( Exprs )
  123,16: Animate
  123,23: (
  123,24: crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650
  123,128: )

221 ( Exprs )
  123,23: (
  123,24: crystalimg[gemwater],Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650
  123,128: )

27 ID Idxs
  123,24: crystalimg
  123,34: [gemwater]

4 [ Expr ]
  123,34: [
  123,35: gemwater
  123,43: ]

76 ID
  123,35: gemwater

245 ]
  123,43: ]

217 , MoreThanOneExpr
  123,44: ,
  123,45: Shapes.GetLeft(crystalimg[gemwater]), Shapes.GetTop(crystalimg[gemwater]) + 35, 650

54 ID . ID ( Exprs )
  123,45: Shapes
  123,51: .
  123,52: GetLeft
  123,59: (
  123,60: crystalimg[gemwater]
  123,80: )

4 . ID ( Exprs )
  123,51: .
  123,52: GetLeft
  123,59: (
  123,60: crystalimg[gemwater]
  123,80: )

248 ID ( Exprs )
  123,52: GetLeft
  123,59: (
  123,60: crystalimg[gemwater]
  123,80: )

23 ( Exprs )
  123,59: (
  123,60: crystalimg[gemwater]
  123,80: )

22 ID Idxs
  123,60: crystalimg
  123,70: [gemwater]

4 [ Expr ]
  123,70: [
  123,71: gemwater
  123,79: ]

76 ID
  123,71: gemwater

245 ]
  123,79: ]

239 )
  123,80: )

217 , MoreThanOneExpr
  123,81: ,
  123,83: Shapes.GetTop(crystalimg[gemwater]) + 35, 650

54 ID . ID ( Exprs )
  123,83: Shapes
  123,89: .
  123,90: GetTop
  123,96: (
  123,97: crystalimg[gemwater]
  123,117: )

4 . ID ( Exprs )
  123,89: .
  123,90: GetTop
  123,96: (
  123,97: crystalimg[gemwater]
  123,117: )

248 ID ( Exprs )
  123,90: GetTop
  123,96: (
  123,97: crystalimg[gemwater]
  123,117: )

23 ( Exprs )
  123,96: (
  123,97: crystalimg[gemwater]
  123,117: )

22 ID Idxs
  123,97: crystalimg
  123,107: [gemwater]

4 [ Expr ]
  123,107: [
  123,108: gemwater
  123,116: ]

76 ID
  123,108: gemwater

245 ]
  123,116: ]

239 )
  123,117: )

65 + MultiplicativeExpr
  123,119: +
  123,121: 35

141 NUM
  123,121: 35

217 , MoreThanOneExpr
  123,123: ,
  123,125: 650

54 NUM
  123,125: 650

238 )
  123,128: )

207 CR_token2
  123,129: 


68 ID = Expr
  124,9: gemfall
  124,17: =
  124,19: true

184 = Expr
  124,17: =
  124,19: true

70 ID
  124,19: true

207 CR_token2
  124,23: 


122 OptionalElse_token1
  125,7: EndIf

207 CR_token2
  125,12: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  126,7: If
  126,10: gemfall = true and gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 550 and Clock.ElapsedMilliseconds - watertime < 1400
  126,141: then
  126,145: 
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  

  132,7: EndIf

86 ID
  126,10: gemfall

128 = CompExpr
  126,18: =
  126,20: true

117 ID
  126,20: true

167 AndExpr_token1 EqNeqExpr
  126,25: and
  126,29: gemwater <> 99

102 ID
  126,29: gemwater

134 <> CompExpr
  126,38: <>
  126,41: 99

117 NUM
  126,41: 99

167 AndExpr_token1 EqNeqExpr
  126,44: and
  126,48: Clock.ElapsedMilliseconds - watertime > 550

102 ID . ID
  126,48: Clock
  126,53: .
  126,54: ElapsedMilliseconds

4 . ID
  126,53: .
  126,54: ElapsedMilliseconds

248 ID
  126,54: ElapsedMilliseconds

65 - MultiplicativeExpr
  126,74: -
  126,76: watertime

141 ID
  126,76: watertime

91 > AdditiveExpr
  126,86: >
  126,88: 550

131 NUM
  126,88: 550

167 AndExpr_token1 EqNeqExpr
  126,92: and
  126,96: Clock.ElapsedMilliseconds - watertime < 1400

102 ID . ID
  126,96: Clock
  126,101: .
  126,102: ElapsedMilliseconds

4 . ID
  126,101: .
  126,102: ElapsedMilliseconds

248 ID
  126,102: ElapsedMilliseconds

65 - MultiplicativeExpr
  126,122: -
  126,124: watertime

141 ID
  126,124: watertime

91 < AdditiveExpr
  126,134: <
  126,136: 1400

131 NUM
  126,136: 1400

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  126,141: then
  126,145: 
        gemzoom = gemzoom - gemmove
        gemmove = gemmove + 0.001
        Sound.Stop(Path + "/sokocute02.wav")
        Sound.Play(Path + "/sokocute02.wav")
        Shapes.Zoom(crystalimg[gemwater], gemzoom, gemzoom)  

  132,7: EndIf

124 CR_token2
  126,145: 


67 ID = Expr
  127,9: gemzoom
  127,17: =
  127,19: gemzoom - gemmove

184 = Expr
  127,17: =
  127,19: gemzoom - gemmove

70 ID
  127,19: gemzoom

59 - MultiplicativeExpr
  127,27: -
  127,29: gemmove

144 ID
  127,29: gemmove

207 CR_token2
  127,36: 


68 ID = Expr
  128,9: gemmove
  128,17: =
  128,19: gemmove + 0.001

184 = Expr
  128,17: =
  128,19: gemmove + 0.001

70 ID
  128,19: gemmove

59 + MultiplicativeExpr
  128,27: +
  128,29: 0.001

144 NUM
  128,29: 0.001

207 CR_token2
  128,34: 


68 ID . ID ( Exprs )
  129,9: Sound
  129,14: .
  129,15: Stop
  129,19: (
  129,20: Path + "/sokocute02.wav"
  129,44: )

184 . ID ( Exprs )
  129,14: .
  129,15: Stop
  129,19: (
  129,20: Path + "/sokocute02.wav"
  129,44: )

255 ID ( Exprs )
  129,15: Stop
  129,19: (
  129,20: Path + "/sokocute02.wav"
  129,44: )

221 ( Exprs )
  129,19: (
  129,20: Path + "/sokocute02.wav"
  129,44: )

27 ID
  129,20: Path

65 + MultiplicativeExpr
  129,25: +
  129,27: "/sokocute02.wav"

141 STR
  129,27: "/sokocute02.wav"

238 )
  129,44: )

207 CR_token2
  129,45: 


68 ID . ID ( Exprs )
  130,9: Sound
  130,14: .
  130,15: Play
  130,19: (
  130,20: Path + "/sokocute02.wav"
  130,44: )

184 . ID ( Exprs )
  130,14: .
  130,15: Play
  130,19: (
  130,20: Path + "/sokocute02.wav"
  130,44: )

255 ID ( Exprs )
  130,15: Play
  130,19: (
  130,20: Path + "/sokocute02.wav"
  130,44: )

221 ( Exprs )
  130,19: (
  130,20: Path + "/sokocute02.wav"
  130,44: )

27 ID
  130,20: Path

65 + MultiplicativeExpr
  130,25: +
  130,27: "/sokocute02.wav"

141 STR
  130,27: "/sokocute02.wav"

238 )
  130,44: )

207 CR_token2
  130,45: 


68 ID . ID ( Exprs )
  131,9: Shapes
  131,15: .
  131,16: Zoom
  131,20: (
  131,21: crystalimg[gemwater], gemzoom, gemzoom
  131,59: )

184 . ID ( Exprs )
  131,15: .
  131,16: Zoom
  131,20: (
  131,21: crystalimg[gemwater], gemzoom, gemzoom
  131,59: )

255 ID ( Exprs )
  131,16: Zoom
  131,20: (
  131,21: crystalimg[gemwater], gemzoom, gemzoom
  131,59: )

221 ( Exprs )
  131,20: (
  131,21: crystalimg[gemwater], gemzoom, gemzoom
  131,59: )

27 ID Idxs
  131,21: crystalimg
  131,31: [gemwater]

4 [ Expr ]
  131,31: [
  131,32: gemwater
  131,40: ]

76 ID
  131,32: gemwater

245 ]
  131,40: ]

217 , MoreThanOneExpr
  131,41: ,
  131,43: gemzoom, gemzoom

54 ID
  131,43: gemzoom

217 , MoreThanOneExpr
  131,50: ,
  131,52: gemzoom

54 ID
  131,52: gemzoom

238 )
  131,59: )

207 CR_token2
  131,62: 


122 OptionalElse_token1
  132,7: EndIf

207 CR_token2
  132,12: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  133,7: If
  133,10: gemwater <> 99 and Clock.ElapsedMilliseconds - watertime > 1400
  133,74: then
  133,78: 
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false

  139,7: EndIf

86 ID
  133,10: gemwater

128 <> CompExpr
  133,19: <>
  133,22: 99

117 NUM
  133,22: 99

167 AndExpr_token1 EqNeqExpr
  133,25: and
  133,29: Clock.ElapsedMilliseconds - watertime > 1400

102 ID . ID
  133,29: Clock
  133,34: .
  133,35: ElapsedMilliseconds

4 . ID
  133,34: .
  133,35: ElapsedMilliseconds

248 ID
  133,35: ElapsedMilliseconds

65 - MultiplicativeExpr
  133,55: -
  133,57: watertime

141 ID
  133,57: watertime

91 > AdditiveExpr
  133,67: >
  133,69: 1400

131 NUM
  133,69: 1400

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  133,74: then
  133,78: 
        Shapes.Move(crystalimg[gemwater], 1000, 1000)
        Shapes.Move(crystalbnk[gemwater], 1000, 1000)
        gemwater = 99
        gemmove = 0
        gemfall = false

  139,7: EndIf

124 CR_token2
  133,78: 


67 ID . ID ( Exprs )
  134,9: Shapes
  134,15: .
  134,16: Move
  134,20: (
  134,21: crystalimg[gemwater], 1000, 1000
  134,53: )

184 . ID ( Exprs )
  134,15: .
  134,16: Move
  134,20: (
  134,21: crystalimg[gemwater], 1000, 1000
  134,53: )

255 ID ( Exprs )
  134,16: Move
  134,20: (
  134,21: crystalimg[gemwater], 1000, 1000
  134,53: )

221 ( Exprs )
  134,20: (
  134,21: crystalimg[gemwater], 1000, 1000
  134,53: )

27 ID Idxs
  134,21: crystalimg
  134,31: [gemwater]

4 [ Expr ]
  134,31: [
  134,32: gemwater
  134,40: ]

76 ID
  134,32: gemwater

245 ]
  134,40: ]

217 , MoreThanOneExpr
  134,41: ,
  134,43: 1000, 1000

54 NUM
  134,43: 1000

217 , MoreThanOneExpr
  134,47: ,
  134,49: 1000

54 NUM
  134,49: 1000

238 )
  134,53: )

207 CR_token2
  134,54: 


68 ID . ID ( Exprs )
  135,9: Shapes
  135,15: .
  135,16: Move
  135,20: (
  135,21: crystalbnk[gemwater], 1000, 1000
  135,53: )

184 . ID ( Exprs )
  135,15: .
  135,16: Move
  135,20: (
  135,21: crystalbnk[gemwater], 1000, 1000
  135,53: )

255 ID ( Exprs )
  135,16: Move
  135,20: (
  135,21: crystalbnk[gemwater], 1000, 1000
  135,53: )

221 ( Exprs )
  135,20: (
  135,21: crystalbnk[gemwater], 1000, 1000
  135,53: )

27 ID Idxs
  135,21: crystalbnk
  135,31: [gemwater]

4 [ Expr ]
  135,31: [
  135,32: gemwater
  135,40: ]

76 ID
  135,32: gemwater

245 ]
  135,40: ]

217 , MoreThanOneExpr
  135,41: ,
  135,43: 1000, 1000

54 NUM
  135,43: 1000

217 , MoreThanOneExpr
  135,47: ,
  135,49: 1000

54 NUM
  135,49: 1000

238 )
  135,53: )

207 CR_token2
  135,54: 


68 ID = Expr
  136,9: gemwater
  136,18: =
  136,20: 99

184 = Expr
  136,18: =
  136,20: 99

70 NUM
  136,20: 99

207 CR_token2
  136,22: 


68 ID = Expr
  137,9: gemmove
  137,17: =
  137,19: 0

184 = Expr
  137,17: =
  137,19: 0

70 NUM
  137,19: 0

207 CR_token2
  137,20: 


68 ID = Expr
  138,9: gemfall
  138,17: =
  138,19: false

184 = Expr
  138,17: =
  138,19: false

70 ID
  138,19: false

207 CR_token2
  138,24: 


122 OptionalElse_token1
  139,7: EndIf

207 CR_token2
  139,12: 


122 CR_token2
  140,18: 


122 CR_token2
  141,10: 


122 CR_token2
  142,7: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  143,9: If
  143,12: (gemchng <> 99) And (Clock.ElapsedMilliseconds - gemtime > 400)
  143,76: Then
  143,80: 
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99

  164,9: EndIf

86 ( Expr )
  143,12: (
  143,13: gemchng <> 99
  143,26: )

80 ID
  143,13: gemchng

128 <> CompExpr
  143,21: <>
  143,24: 99

117 NUM
  143,24: 99

265 )
  143,26: )

167 AndExpr_token1 EqNeqExpr
  143,28: And
  143,32: (Clock.ElapsedMilliseconds - gemtime > 400)

102 ( Expr )
  143,32: (
  143,33: Clock.ElapsedMilliseconds - gemtime > 400
  143,74: )

80 ID . ID
  143,33: Clock
  143,38: .
  143,39: ElapsedMilliseconds

4 . ID
  143,38: .
  143,39: ElapsedMilliseconds

248 ID
  143,39: ElapsedMilliseconds

65 - MultiplicativeExpr
  143,59: -
  143,61: gemtime

141 ID
  143,61: gemtime

91 > AdditiveExpr
  143,69: >
  143,71: 400

131 NUM
  143,71: 400

265 )
  143,74: )

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  143,76: Then
  143,80: 
          if ground[gemy][gemx] = 1 then
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf
          else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif
          gemchng = 99

  164,9: EndIf

124 CR_token2
  143,80: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  144,11: if
  144,14: ground[gemy][gemx] = 1
  144,37: then
  144,41: 
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf

  159,11: else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif

86 ID Idxs
  144,14: ground
  144,20: [gemy][gemx]

4 [ Expr ] Idxs
  144,20: [
  144,21: gemy
  144,25: ]
  144,26: [gemx]

76 ID
  144,21: gemy

245 ] Idxs
  144,25: ]
  144,26: [gemx]

7 [ Expr ]
  144,26: [
  144,27: gemx
  144,31: ]

76 ID
  144,27: gemx

245 ]
  144,31: ]

128 = CompExpr
  144,33: =
  144,35: 1

117 NUM
  144,35: 1

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  144,37: then
  144,41: 
            Shapes.Move(crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng]))
            Shapes.Move(crystalimg[gemchng], gemchng * 52, -100)        
            freecells = 0
            For y = 0 To 15
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor
            EndFor
            If freecells = 0 then
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 
            EndIf

  159,11: else
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          
          endif

124 CR_token2
  144,41: 


67 ID . ID ( Exprs )
  145,13: Shapes
  145,19: .
  145,20: Move
  145,24: (
  145,25: crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng])
  145,117: )

184 . ID ( Exprs )
  145,19: .
  145,20: Move
  145,24: (
  145,25: crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng])
  145,117: )

255 ID ( Exprs )
  145,20: Move
  145,24: (
  145,25: crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng])
  145,117: )

221 ( Exprs )
  145,24: (
  145,25: crystalbnk[gemchng], Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng])
  145,117: )

27 ID Idxs
  145,25: crystalbnk
  145,35: [gemchng]

4 [ Expr ]
  145,35: [
  145,36: gemchng
  145,43: ]

76 ID
  145,36: gemchng

245 ]
  145,43: ]

217 , MoreThanOneExpr
  145,44: ,
  145,46: Shapes.GetLeft(crystalimg[gemchng]), Shapes.GetTop(crystalimg[gemchng])

54 ID . ID ( Exprs )
  145,46: Shapes
  145,52: .
  145,53: GetLeft
  145,60: (
  145,61: crystalimg[gemchng]
  145,80: )

4 . ID ( Exprs )
  145,52: .
  145,53: GetLeft
  145,60: (
  145,61: crystalimg[gemchng]
  145,80: )

248 ID ( Exprs )
  145,53: GetLeft
  145,60: (
  145,61: crystalimg[gemchng]
  145,80: )

23 ( Exprs )
  145,60: (
  145,61: crystalimg[gemchng]
  145,80: )

22 ID Idxs
  145,61: crystalimg
  145,71: [gemchng]

4 [ Expr ]
  145,71: [
  145,72: gemchng
  145,79: ]

76 ID
  145,72: gemchng

245 ]
  145,79: ]

239 )
  145,80: )

217 , MoreThanOneExpr
  145,81: ,
  145,83: Shapes.GetTop(crystalimg[gemchng])

54 ID . ID ( Exprs )
  145,83: Shapes
  145,89: .
  145,90: GetTop
  145,96: (
  145,97: crystalimg[gemchng]
  145,116: )

4 . ID ( Exprs )
  145,89: .
  145,90: GetTop
  145,96: (
  145,97: crystalimg[gemchng]
  145,116: )

248 ID ( Exprs )
  145,90: GetTop
  145,96: (
  145,97: crystalimg[gemchng]
  145,116: )

23 ( Exprs )
  145,96: (
  145,97: crystalimg[gemchng]
  145,116: )

22 ID Idxs
  145,97: crystalimg
  145,107: [gemchng]

4 [ Expr ]
  145,107: [
  145,108: gemchng
  145,115: ]

76 ID
  145,108: gemchng

245 ]
  145,115: ]

239 )
  145,116: )

238 )
  145,117: )

207 CR_token2
  145,118: 


68 ID . ID ( Exprs )
  146,13: Shapes
  146,19: .
  146,20: Move
  146,24: (
  146,25: crystalimg[gemchng], gemchng * 52, -100
  146,64: )

184 . ID ( Exprs )
  146,19: .
  146,20: Move
  146,24: (
  146,25: crystalimg[gemchng], gemchng * 52, -100
  146,64: )

255 ID ( Exprs )
  146,20: Move
  146,24: (
  146,25: crystalimg[gemchng], gemchng * 52, -100
  146,64: )

221 ( Exprs )
  146,24: (
  146,25: crystalimg[gemchng], gemchng * 52, -100
  146,64: )

27 ID Idxs
  146,25: crystalimg
  146,35: [gemchng]

4 [ Expr ]
  146,35: [
  146,36: gemchng
  146,43: ]

76 ID
  146,36: gemchng

245 ]
  146,43: ]

217 , MoreThanOneExpr
  146,44: ,
  146,46: gemchng * 52, -100

54 ID
  146,46: gemchng

50 * UnaryExpr
  146,54: *
  146,56: 52

156 NUM
  146,56: 52

217 , MoreThanOneExpr
  146,58: ,
  146,60: -100

54 - Primary
  146,60: -
  146,61: 100

197 NUM
  146,61: 100

238 )
  146,64: )

207 CR_token2
  146,73: 


68 ID = Expr
  147,13: freecells
  147,23: =
  147,25: 0

184 = Expr
  147,23: =
  147,25: 0

70 NUM
  147,25: 0

207 CR_token2
  147,26: 


68 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  148,13: For
  148,17: y
  148,19: =
  148,21: 0
  148,23: To
  148,26: 15
  148,28: 
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor

  154,13: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  148,17: y
  148,19: =
  148,21: 0
  148,23: To
  148,26: 15
  148,28: 
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor

  154,13: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  148,19: =
  148,21: 0
  148,23: To
  148,26: 15
  148,28: 
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor

  154,13: EndFor

56 NUM
  148,21: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  148,23: To
  148,26: 15
  148,28: 
               For x = 0 To 19
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF
               EndFor

  154,13: EndFor

83 NUM
  148,26: 15

145 CR_token2
  148,28: 


88 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  149,16: For
  149,20: x
  149,22: =
  149,24: 0
  149,26: To
  149,29: 19
  149,31: 
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF

  153,16: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  149,20: x
  149,22: =
  149,24: 0
  149,26: To
  149,29: 19
  149,31: 
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF

  153,16: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  149,22: =
  149,24: 0
  149,26: To
  149,29: 19
  149,31: 
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF

  153,16: EndFor

56 NUM
  149,24: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  149,26: To
  149,29: 19
  149,31: 
                  if level[y][x] = 1 then 
                    freecells = freecells + 1               
                  EndIF

  153,16: EndFor

83 NUM
  149,29: 19

145 CR_token2
  149,31: 


88 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  150,19: if
  150,22: level[y][x] = 1
  150,38: then
  150,43: 
                    freecells = freecells + 1               

  152,19: EndIF

86 ID Idxs
  150,22: level
  150,27: [y][x]

4 [ Expr ] Idxs
  150,27: [
  150,28: y
  150,29: ]
  150,30: [x]

76 ID
  150,28: y

245 ] Idxs
  150,29: ]
  150,30: [x]

7 [ Expr ]
  150,30: [
  150,31: x
  150,32: ]

76 ID
  150,31: x

245 ]
  150,32: ]

128 = CompExpr
  150,34: =
  150,36: 1

117 NUM
  150,36: 1

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  150,38: then
  150,43: 
                    freecells = freecells + 1               

  152,19: EndIF

124 CR_token2
  150,43: 


67 ID = Expr
  151,21: freecells
  151,31: =
  151,33: freecells + 1

184 = Expr
  151,31: =
  151,33: freecells + 1

70 ID
  151,33: freecells

59 + MultiplicativeExpr
  151,43: +
  151,45: 1

144 NUM
  151,45: 1

207 CR_token2
  151,61: 


122 OptionalElse_token1
  152,19: EndIF

203 CR_token2
  152,24: 


177 Stmt_token6
  153,16: EndFor

203 CR_token2
  153,22: 


177 Stmt_token6
  154,13: EndFor

207 CR_token2
  154,19: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  155,13: If
  155,16: freecells = 0
  155,30: then
  155,34: 
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 

  158,13: EndIf

86 ID
  155,16: freecells

128 = CompExpr
  155,26: =
  155,28: 0

117 NUM
  155,28: 0

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  155,30: then
  155,34: 
               Sound.Stop(Path + "/sokocute03.wav")
               Sound.Play(Path + "/sokocute03.wav") 

  158,13: EndIf

124 CR_token2
  155,34: 


67 ID . ID ( Exprs )
  156,16: Sound
  156,21: .
  156,22: Stop
  156,26: (
  156,27: Path + "/sokocute03.wav"
  156,51: )

184 . ID ( Exprs )
  156,21: .
  156,22: Stop
  156,26: (
  156,27: Path + "/sokocute03.wav"
  156,51: )

255 ID ( Exprs )
  156,22: Stop
  156,26: (
  156,27: Path + "/sokocute03.wav"
  156,51: )

221 ( Exprs )
  156,26: (
  156,27: Path + "/sokocute03.wav"
  156,51: )

27 ID
  156,27: Path

65 + MultiplicativeExpr
  156,32: +
  156,34: "/sokocute03.wav"

141 STR
  156,34: "/sokocute03.wav"

238 )
  156,51: )

207 CR_token2
  156,52: 


68 ID . ID ( Exprs )
  157,16: Sound
  157,21: .
  157,22: Play
  157,26: (
  157,27: Path + "/sokocute03.wav"
  157,51: )

184 . ID ( Exprs )
  157,21: .
  157,22: Play
  157,26: (
  157,27: Path + "/sokocute03.wav"
  157,51: )

255 ID ( Exprs )
  157,22: Play
  157,26: (
  157,27: Path + "/sokocute03.wav"
  157,51: )

221 ( Exprs )
  157,26: (
  157,27: Path + "/sokocute03.wav"
  157,51: )

27 ID
  157,27: Path

65 + MultiplicativeExpr
  157,32: +
  157,34: "/sokocute03.wav"

141 STR
  157,34: "/sokocute03.wav"

238 )
  157,51: )

207 CR_token2
  157,53: 


122 OptionalElse_token1
  158,13: EndIf

207 CR_token2
  158,18: 


122 OptionalElse_token2 CRStmtCRs OptionalElse_token1
  159,11: else
  159,15: 
            Shapes.Move(crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng]))
            Shapes.Move(crystalbnk[gemchng], gemchng * 52, -100)          

  162,11: endif

201 CR_token2
  159,15: 


113 ID . ID ( Exprs )
  160,13: Shapes
  160,19: .
  160,20: Move
  160,24: (
  160,25: crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng])
  160,117: )

184 . ID ( Exprs )
  160,19: .
  160,20: Move
  160,24: (
  160,25: crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng])
  160,117: )

255 ID ( Exprs )
  160,20: Move
  160,24: (
  160,25: crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng])
  160,117: )

221 ( Exprs )
  160,24: (
  160,25: crystalimg[gemchng], Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng])
  160,117: )

27 ID Idxs
  160,25: crystalimg
  160,35: [gemchng]

4 [ Expr ]
  160,35: [
  160,36: gemchng
  160,43: ]

76 ID
  160,36: gemchng

245 ]
  160,43: ]

217 , MoreThanOneExpr
  160,44: ,
  160,46: Shapes.GetLeft(crystalbnk[gemchng]), Shapes.GetTop(crystalbnk[gemchng])

54 ID . ID ( Exprs )
  160,46: Shapes
  160,52: .
  160,53: GetLeft
  160,60: (
  160,61: crystalbnk[gemchng]
  160,80: )

4 . ID ( Exprs )
  160,52: .
  160,53: GetLeft
  160,60: (
  160,61: crystalbnk[gemchng]
  160,80: )

248 ID ( Exprs )
  160,53: GetLeft
  160,60: (
  160,61: crystalbnk[gemchng]
  160,80: )

23 ( Exprs )
  160,60: (
  160,61: crystalbnk[gemchng]
  160,80: )

22 ID Idxs
  160,61: crystalbnk
  160,71: [gemchng]

4 [ Expr ]
  160,71: [
  160,72: gemchng
  160,79: ]

76 ID
  160,72: gemchng

245 ]
  160,79: ]

239 )
  160,80: )

217 , MoreThanOneExpr
  160,81: ,
  160,83: Shapes.GetTop(crystalbnk[gemchng])

54 ID . ID ( Exprs )
  160,83: Shapes
  160,89: .
  160,90: GetTop
  160,96: (
  160,97: crystalbnk[gemchng]
  160,116: )

4 . ID ( Exprs )
  160,89: .
  160,90: GetTop
  160,96: (
  160,97: crystalbnk[gemchng]
  160,116: )

248 ID ( Exprs )
  160,90: GetTop
  160,96: (
  160,97: crystalbnk[gemchng]
  160,116: )

23 ( Exprs )
  160,96: (
  160,97: crystalbnk[gemchng]
  160,116: )

22 ID Idxs
  160,97: crystalbnk
  160,107: [gemchng]

4 [ Expr ]
  160,107: [
  160,108: gemchng
  160,115: ]

76 ID
  160,108: gemchng

245 ]
  160,115: ]

239 )
  160,116: )

238 )
  160,117: )

202 CR_token2
  160,118: 


114 ID . ID ( Exprs )
  161,13: Shapes
  161,19: .
  161,20: Move
  161,24: (
  161,25: crystalbnk[gemchng], gemchng * 52, -100
  161,64: )

184 . ID ( Exprs )
  161,19: .
  161,20: Move
  161,24: (
  161,25: crystalbnk[gemchng], gemchng * 52, -100
  161,64: )

255 ID ( Exprs )
  161,20: Move
  161,24: (
  161,25: crystalbnk[gemchng], gemchng * 52, -100
  161,64: )

221 ( Exprs )
  161,24: (
  161,25: crystalbnk[gemchng], gemchng * 52, -100
  161,64: )

27 ID Idxs
  161,25: crystalbnk
  161,35: [gemchng]

4 [ Expr ]
  161,35: [
  161,36: gemchng
  161,43: ]

76 ID
  161,36: gemchng

245 ]
  161,43: ]

217 , MoreThanOneExpr
  161,44: ,
  161,46: gemchng * 52, -100

54 ID
  161,46: gemchng

50 * UnaryExpr
  161,54: *
  161,56: 52

156 NUM
  161,56: 52

217 , MoreThanOneExpr
  161,58: ,
  161,60: -100

54 - Primary
  161,60: -
  161,61: 100

197 NUM
  161,61: 100

238 )
  161,64: )

202 CR_token2
  161,75: 


237 OptionalElse_token1
  162,11: endif

207 CR_token2
  162,16: 


68 ID = Expr
  163,11: gemchng
  163,19: =
  163,21: 99

184 = Expr
  163,19: =
  163,21: 99

70 NUM
  163,21: 99

207 CR_token2
  163,23: 


122 OptionalElse_token1
  164,9: EndIf

207 CR_token2
  164,14: 


122 CR_token2
  165,5: 


142 CRStmtCRs
  166,1:         'move the player
        If newmove < 25 Then
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, 

122 CR_token2
  166,25: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  167,9: If
  167,12: newmove < 25
  167,25: Then
  167,29: 
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 

  173,9: EndIf

86 ID
  167,12: newmove

91 < AdditiveExpr
  167,20: <
  167,22: 25

131 NUM
  167,22: 25

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  167,25: Then
  167,29: 
          newmove = newmove + 1
          xplayer = xplayer + movex 
          yplayer = yplayer + movey     
          Shapes.Move(player1, xplayer, yplayer) 
          Shapes.Move(player2, xplayer, yplayer) 

  173,9: EndIf

124 CR_token2
  167,29: 


67 ID = Expr
  168,11: newmove
  168,19: =
  168,21: newmove + 1

184 = Expr
  168,19: =
  168,21: newmove + 1

70 ID
  168,21: newmove

59 + MultiplicativeExpr
  168,29: +
  168,31: 1

144 NUM
  168,31: 1

207 CR_token2
  168,32: 


68 ID = Expr
  169,11: xplayer
  169,19: =
  169,21: xplayer + movex

184 = Expr
  169,19: =
  169,21: xplayer + movex

70 ID
  169,21: xplayer

59 + MultiplicativeExpr
  169,29: +
  169,31: movex

144 ID
  169,31: movex

207 CR_token2
  169,37: 


68 ID = Expr
  170,11: yplayer
  170,19: =
  170,21: yplayer + movey

184 = Expr
  170,19: =
  170,21: yplayer + movey

70 ID
  170,21: yplayer

59 + MultiplicativeExpr
  170,29: +
  170,31: movey

144 ID
  170,31: movey

207 CR_token2
  170,41: 


68 ID . ID ( Exprs )
  171,11: Shapes
  171,17: .
  171,18: Move
  171,22: (
  171,23: player1, xplayer, yplayer
  171,48: )

184 . ID ( Exprs )
  171,17: .
  171,18: Move
  171,22: (
  171,23: player1, xplayer, yplayer
  171,48: )

255 ID ( Exprs )
  171,18: Move
  171,22: (
  171,23: player1, xplayer, yplayer
  171,48: )

221 ( Exprs )
  171,22: (
  171,23: player1, xplayer, yplayer
  171,48: )

27 ID
  171,23: player1

217 , MoreThanOneExpr
  171,30: ,
  171,32: xplayer, yplayer

54 ID
  171,32: xplayer

217 , MoreThanOneExpr
  171,39: ,
  171,41: yplayer

54 ID
  171,41: yplayer

238 )
  171,48: )

207 CR_token2
  171,50: 


68 ID . ID ( Exprs )
  172,11: Shapes
  172,17: .
  172,18: Move
  172,22: (
  172,23: player2, xplayer, yplayer
  172,48: )

184 . ID ( Exprs )
  172,17: .
  172,18: Move
  172,22: (
  172,23: player2, xplayer, yplayer
  172,48: )

255 ID ( Exprs )
  172,18: Move
  172,22: (
  172,23: player2, xplayer, yplayer
  172,48: )

221 ( Exprs )
  172,22: (
  172,23: player2, xplayer, yplayer
  172,48: )

27 ID
  172,23: player2

217 , MoreThanOneExpr
  172,30: ,
  172,32: xplayer, yplayer

54 ID
  172,32: xplayer

217 , MoreThanOneExpr
  172,39: ,
  172,41: yplayer

54 ID
  172,41: yplayer

238 )
  172,48: )

207 CR_token2
  172,50: 


122 OptionalElse_token1
  173,9: EndIf

207 CR_token2
  173,14: 


122 CR_token2
  174,5: 


122 CR_token2
  175,5: 


142 Stmt_repeat1
  176,1:         'blinking crystals when level is done
        If freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350 then  
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds
        EndIf
        
      ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds 

122 CR_token2
  176,46: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  177,9: If
  177,12: freecells = 0 And Clock.ElapsedMilliseconds - blinktime > 350
  177,74: then
  177,80: 
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds

  188,9: EndIf

86 ID
  177,12: freecells

128 = CompExpr
  177,22: =
  177,24: 0

117 NUM
  177,24: 0

167 AndExpr_token1 EqNeqExpr
  177,26: And
  177,30: Clock.ElapsedMilliseconds - blinktime > 350

102 ID . ID
  177,30: Clock
  177,35: .
  177,36: ElapsedMilliseconds

4 . ID
  177,35: .
  177,36: ElapsedMilliseconds

248 ID
  177,36: ElapsedMilliseconds

65 - MultiplicativeExpr
  177,56: -
  177,58: blinktime

141 ID
  177,58: blinktime

91 > AdditiveExpr
  177,68: >
  177,70: 350

131 NUM
  177,70: 350

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  177,74: then
  177,80: 
          For i = 0 to (cryst - 1)
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       
          EndFor 
          blink = blink + 1
          blinktime = Clock.ElapsedMilliseconds

  188,9: EndIf

124 CR_token2
  177,80: 


67 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  178,11: For
  178,15: i
  178,17: =
  178,19: 0
  178,21: to
  178,24: (cryst - 1)
  178,35: 
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       

  185,11: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  178,15: i
  178,17: =
  178,19: 0
  178,21: to
  178,24: (cryst - 1)
  178,35: 
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       

  185,11: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  178,17: =
  178,19: 0
  178,21: to
  178,24: (cryst - 1)
  178,35: 
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       

  185,11: EndFor

56 NUM
  178,19: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  178,21: to
  178,24: (cryst - 1)
  178,35: 
            x1 = Shapes.GetLeft(crystalimg[i])
            y1 = Shapes.GetTop(crystalimg[i])
            x2 = Shapes.GetLeft(crystalbnk[i])
            y2 = Shapes.GetTop(crystalbnk[i])     
            Shapes.Move(crystalimg[i], x2, y2)
            Shapes.Move(crystalbnk[i], x1, y1)       

  185,11: EndFor

83 ( Expr )
  178,24: (
  178,25: cryst - 1
  178,34: )

64 ID
  178,25: cryst

65 - MultiplicativeExpr
  178,31: -
  178,33: 1

141 NUM
  178,33: 1

235 )
  178,34: )

145 CR_token2
  178,35: 


88 ID = Expr
  179,13: x1
  179,16: =
  179,18: Shapes.GetLeft(crystalimg[i])

184 = Expr
  179,16: =
  179,18: Shapes.GetLeft(crystalimg[i])

70 ID . ID ( Exprs )
  179,18: Shapes
  179,24: .
  179,25: GetLeft
  179,32: (
  179,33: crystalimg[i]
  179,46: )

5 . ID ( Exprs )
  179,24: .
  179,25: GetLeft
  179,32: (
  179,33: crystalimg[i]
  179,46: )

260 ID ( Exprs )
  179,25: GetLeft
  179,32: (
  179,33: crystalimg[i]
  179,46: )

24 ( Exprs )
  179,32: (
  179,33: crystalimg[i]
  179,46: )

26 ID Idxs
  179,33: crystalimg
  179,43: [i]

4 [ Expr ]
  179,43: [
  179,44: i
  179,45: ]

76 ID
  179,44: i

245 ]
  179,45: ]

249 )
  179,46: )

203 CR_token2
  179,47: 


96 ID = Expr
  180,13: y1
  180,16: =
  180,18: Shapes.GetTop(crystalimg[i])

184 = Expr
  180,16: =
  180,18: Shapes.GetTop(crystalimg[i])

70 ID . ID ( Exprs )
  180,18: Shapes
  180,24: .
  180,25: GetTop
  180,31: (
  180,32: crystalimg[i]
  180,45: )

5 . ID ( Exprs )
  180,24: .
  180,25: GetTop
  180,31: (
  180,32: crystalimg[i]
  180,45: )

260 ID ( Exprs )
  180,25: GetTop
  180,31: (
  180,32: crystalimg[i]
  180,45: )

24 ( Exprs )
  180,31: (
  180,32: crystalimg[i]
  180,45: )

26 ID Idxs
  180,32: crystalimg
  180,42: [i]

4 [ Expr ]
  180,42: [
  180,43: i
  180,44: ]

76 ID
  180,43: i

245 ]
  180,44: ]

249 )
  180,45: )

203 CR_token2
  180,46: 


96 ID = Expr
  181,13: x2
  181,16: =
  181,18: Shapes.GetLeft(crystalbnk[i])

184 = Expr
  181,16: =
  181,18: Shapes.GetLeft(crystalbnk[i])

70 ID . ID ( Exprs )
  181,18: Shapes
  181,24: .
  181,25: GetLeft
  181,32: (
  181,33: crystalbnk[i]
  181,46: )

5 . ID ( Exprs )
  181,24: .
  181,25: GetLeft
  181,32: (
  181,33: crystalbnk[i]
  181,46: )

260 ID ( Exprs )
  181,25: GetLeft
  181,32: (
  181,33: crystalbnk[i]
  181,46: )

24 ( Exprs )
  181,32: (
  181,33: crystalbnk[i]
  181,46: )

26 ID Idxs
  181,33: crystalbnk
  181,43: [i]

4 [ Expr ]
  181,43: [
  181,44: i
  181,45: ]

76 ID
  181,44: i

245 ]
  181,45: ]

249 )
  181,46: )

203 CR_token2
  181,47: 


96 ID = Expr
  182,13: y2
  182,16: =
  182,18: Shapes.GetTop(crystalbnk[i])

184 = Expr
  182,16: =
  182,18: Shapes.GetTop(crystalbnk[i])

70 ID . ID ( Exprs )
  182,18: Shapes
  182,24: .
  182,25: GetTop
  182,31: (
  182,32: crystalbnk[i]
  182,45: )

5 . ID ( Exprs )
  182,24: .
  182,25: GetTop
  182,31: (
  182,32: crystalbnk[i]
  182,45: )

260 ID ( Exprs )
  182,25: GetTop
  182,31: (
  182,32: crystalbnk[i]
  182,45: )

24 ( Exprs )
  182,31: (
  182,32: crystalbnk[i]
  182,45: )

26 ID Idxs
  182,32: crystalbnk
  182,42: [i]

4 [ Expr ]
  182,42: [
  182,43: i
  182,44: ]

76 ID
  182,43: i

245 ]
  182,44: ]

249 )
  182,45: )

203 CR_token2
  182,51: 


96 ID . ID ( Exprs )
  183,13: Shapes
  183,19: .
  183,20: Move
  183,24: (
  183,25: crystalimg[i], x2, y2
  183,46: )

184 . ID ( Exprs )
  183,19: .
  183,20: Move
  183,24: (
  183,25: crystalimg[i], x2, y2
  183,46: )

255 ID ( Exprs )
  183,20: Move
  183,24: (
  183,25: crystalimg[i], x2, y2
  183,46: )

221 ( Exprs )
  183,24: (
  183,25: crystalimg[i], x2, y2
  183,46: )

27 ID Idxs
  183,25: crystalimg
  183,35: [i]

4 [ Expr ]
  183,35: [
  183,36: i
  183,37: ]

76 ID
  183,36: i

245 ]
  183,37: ]

217 , MoreThanOneExpr
  183,38: ,
  183,40: x2, y2

54 ID
  183,40: x2

217 , MoreThanOneExpr
  183,42: ,
  183,44: y2

54 ID
  183,44: y2

238 )
  183,46: )

203 CR_token2
  183,47: 


96 ID . ID ( Exprs )
  184,13: Shapes
  184,19: .
  184,20: Move
  184,24: (
  184,25: crystalbnk[i], x1, y1
  184,46: )

184 . ID ( Exprs )
  184,19: .
  184,20: Move
  184,24: (
  184,25: crystalbnk[i], x1, y1
  184,46: )

255 ID ( Exprs )
  184,20: Move
  184,24: (
  184,25: crystalbnk[i], x1, y1
  184,46: )

221 ( Exprs )
  184,24: (
  184,25: crystalbnk[i], x1, y1
  184,46: )

27 ID Idxs
  184,25: crystalbnk
  184,35: [i]

4 [ Expr ]
  184,35: [
  184,36: i
  184,37: ]

76 ID
  184,36: i

245 ]
  184,37: ]

217 , MoreThanOneExpr
  184,38: ,
  184,40: x1, y1

54 ID
  184,40: x1

217 , MoreThanOneExpr
  184,42: ,
  184,44: y1

54 ID
  184,44: y1

238 )
  184,46: )

203 CR_token2
  184,54: 


177 Stmt_token6
  185,11: EndFor

207 CR_token2
  185,18: 


68 ID = Expr
  186,11: blink
  186,17: =
  186,19: blink + 1

184 = Expr
  186,17: =
  186,19: blink + 1

70 ID
  186,19: blink

59 + MultiplicativeExpr
  186,25: +
  186,27: 1

144 NUM
  186,27: 1

207 CR_token2
  186,28: 


68 ID = Expr
  187,11: blinktime
  187,21: =
  187,23: Clock.ElapsedMilliseconds

184 = Expr
  187,21: =
  187,23: Clock.ElapsedMilliseconds

70 ID . ID
  187,23: Clock
  187,28: .
  187,29: ElapsedMilliseconds

5 . ID
  187,28: .
  187,29: ElapsedMilliseconds

260 ID
  187,29: ElapsedMilliseconds

207 CR_token2
  187,48: 


122 OptionalElse_token1
  188,9: EndIf

207 CR_token2
  188,14: 


122 CR_token2
  189,9: 


142 Stmt_repeat1
  190,1:       ' end level if crystals changed color 10 times  
      If blink = 10 then
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMill

122 CR_token2
  190,55: 


67 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  191,7: If
  191,10: blink = 10
  191,21: then
  191,25: 
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif

  215,8: EndIf

86 ID
  191,10: blink

128 = CompExpr
  191,16: =
  191,18: 10

117 NUM
  191,18: 10

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  191,21: then
  191,25: 
         LevelExplosion()
         stage = stage + 1
         if stage <> 10 then
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
         endif
         
         'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         
         endif

  215,8: EndIf

124 CR_token2
  191,25: 


67 ID ( )
  192,10: LevelExplosion
  192,24: (
  192,25: )

184 ( )
  192,24: (
  192,25: )

261 )
  192,25: )

207 CR_token2
  192,26: 


68 ID = Expr
  193,10: stage
  193,16: =
  193,18: stage + 1

184 = Expr
  193,16: =
  193,18: stage + 1

70 ID
  193,18: stage

59 + MultiplicativeExpr
  193,24: +
  193,26: 1

144 NUM
  193,26: 1

207 CR_token2
  193,27: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  194,10: if
  194,13: stage <> 10
  194,25: then
  194,29: 
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)

  200,10: endif

86 ID
  194,13: stage

128 <> CompExpr
  194,19: <>
  194,22: 10

117 NUM
  194,22: 10

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  194,25: then
  194,29: 
           status = "reset"
           resettime = Clock.ElapsedMilliseconds
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)

  200,10: endif

124 CR_token2
  194,29: 


67 ID = Expr
  195,12: status
  195,19: =
  195,21: "reset"

184 = Expr
  195,19: =
  195,21: "reset"

70 STR
  195,21: "reset"

207 CR_token2
  195,28: 


68 ID = Expr
  196,12: resettime
  196,22: =
  196,24: Clock.ElapsedMilliseconds

184 = Expr
  196,22: =
  196,24: Clock.ElapsedMilliseconds

70 ID . ID
  196,24: Clock
  196,29: .
  196,30: ElapsedMilliseconds

5 . ID
  196,29: .
  196,30: ElapsedMilliseconds

260 ID
  196,30: ElapsedMilliseconds

207 CR_token2
  196,49: 


68 ID . ID = Expr
  197,12: GraphicsWindow
  197,26: .
  197,27: BrushColor
  197,38: =
  197,40: "#3975e5"

184 . ID = Expr
  197,26: .
  197,27: BrushColor
  197,38: =
  197,40: "#3975e5"

255 ID = Expr
  197,27: BrushColor
  197,38: =
  197,40: "#3975e5"

221 = Expr
  197,38: =
  197,40: "#3975e5"

57 STR
  197,40: "#3975e5"

207 CR_token2
  197,49: 


68 ID . ID ( Exprs )
  198,12: GraphicsWindow
  198,26: .
  198,27: FillRectangle
  198,40: (
  198,41: 70,690,170,80
  198,54: )

184 . ID ( Exprs )
  198,26: .
  198,27: FillRectangle
  198,40: (
  198,41: 70,690,170,80
  198,54: )

255 ID ( Exprs )
  198,27: FillRectangle
  198,40: (
  198,41: 70,690,170,80
  198,54: )

221 ( Exprs )
  198,40: (
  198,41: 70,690,170,80
  198,54: )

27 NUM
  198,41: 70

217 , MoreThanOneExpr
  198,43: ,
  198,44: 690,170,80

54 NUM
  198,44: 690

217 , MoreThanOneExpr
  198,47: ,
  198,48: 170,80

54 NUM
  198,48: 170

217 , MoreThanOneExpr
  198,51: ,
  198,52: 80

54 NUM
  198,52: 80

238 )
  198,54: )

207 CR_token2
  198,55: 


68 ID . ID ( Exprs )
  199,12: GraphicsWindow
  199,26: .
  199,27: FillRectangle
  199,40: (
  199,41: 800,690,224,85
  199,55: )

184 . ID ( Exprs )
  199,26: .
  199,27: FillRectangle
  199,40: (
  199,41: 800,690,224,85
  199,55: )

255 ID ( Exprs )
  199,27: FillRectangle
  199,40: (
  199,41: 800,690,224,85
  199,55: )

221 ( Exprs )
  199,40: (
  199,41: 800,690,224,85
  199,55: )

27 NUM
  199,41: 800

217 , MoreThanOneExpr
  199,44: ,
  199,45: 690,224,85

54 NUM
  199,45: 690

217 , MoreThanOneExpr
  199,48: ,
  199,49: 224,85

54 NUM
  199,49: 224

217 , MoreThanOneExpr
  199,52: ,
  199,53: 85

54 NUM
  199,53: 85

238 )
  199,55: )

207 CR_token2
  199,56: 


122 OptionalElse_token1
  200,10: endif

207 CR_token2
  200,15: 


122 CR_token2
  201,10: 


122 CRStmtCRs
  202,1:          'load title sceen when finished level 10
         If stage = 10 then
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = C

122 CR_token2
  202,50: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  203,10: If
  203,13: stage = 10
  203,24: then
  203,28: 
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         

  214,10: endif

86 ID
  203,13: stage

128 = CompExpr
  203,19: =
  203,21: 10

117 NUM
  203,21: 10

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  203,24: then
  203,28: 
           LevelExplosion()
           stage = 0
           Shapes.Animate(titleshape, 140,170, 2500)
           Shapes.Animate(txtstart, 305,420, 3000)
           GraphicsWindow.BrushColor = "#3975e5"
           GraphicsWindow.FillRectangle(70,690,170,80)
           GraphicsWindow.FillRectangle(800,690,224,85)
           status = "start"
           ResetStars()
           resettime = Clock.ElapsedMilliseconds         

  214,10: endif

124 CR_token2
  203,28: 


67 ID ( )
  204,12: LevelExplosion
  204,26: (
  204,27: )

184 ( )
  204,26: (
  204,27: )

261 )
  204,27: )

207 CR_token2
  204,28: 


68 ID = Expr
  205,12: stage
  205,18: =
  205,20: 0

184 = Expr
  205,18: =
  205,20: 0

70 NUM
  205,20: 0

207 CR_token2
  205,21: 


68 ID . ID ( Exprs )
  206,12: Shapes
  206,18: .
  206,19: Animate
  206,26: (
  206,27: titleshape, 140,170, 2500
  206,52: )

184 . ID ( Exprs )
  206,18: .
  206,19: Animate
  206,26: (
  206,27: titleshape, 140,170, 2500
  206,52: )

255 ID ( Exprs )
  206,19: Animate
  206,26: (
  206,27: titleshape, 140,170, 2500
  206,52: )

221 ( Exprs )
  206,26: (
  206,27: titleshape, 140,170, 2500
  206,52: )

27 ID
  206,27: titleshape

217 , MoreThanOneExpr
  206,37: ,
  206,39: 140,170, 2500

54 NUM
  206,39: 140

217 , MoreThanOneExpr
  206,42: ,
  206,43: 170, 2500

54 NUM
  206,43: 170

217 , MoreThanOneExpr
  206,46: ,
  206,48: 2500

54 NUM
  206,48: 2500

238 )
  206,52: )

207 CR_token2
  206,53: 


68 ID . ID ( Exprs )
  207,12: Shapes
  207,18: .
  207,19: Animate
  207,26: (
  207,27: txtstart, 305,420, 3000
  207,50: )

184 . ID ( Exprs )
  207,18: .
  207,19: Animate
  207,26: (
  207,27: txtstart, 305,420, 3000
  207,50: )

255 ID ( Exprs )
  207,19: Animate
  207,26: (
  207,27: txtstart, 305,420, 3000
  207,50: )

221 ( Exprs )
  207,26: (
  207,27: txtstart, 305,420, 3000
  207,50: )

27 ID
  207,27: txtstart

217 , MoreThanOneExpr
  207,35: ,
  207,37: 305,420, 3000

54 NUM
  207,37: 305

217 , MoreThanOneExpr
  207,40: ,
  207,41: 420, 3000

54 NUM
  207,41: 420

217 , MoreThanOneExpr
  207,44: ,
  207,46: 3000

54 NUM
  207,46: 3000

238 )
  207,50: )

207 CR_token2
  207,51: 


68 ID . ID = Expr
  208,12: GraphicsWindow
  208,26: .
  208,27: BrushColor
  208,38: =
  208,40: "#3975e5"

184 . ID = Expr
  208,26: .
  208,27: BrushColor
  208,38: =
  208,40: "#3975e5"

255 ID = Expr
  208,27: BrushColor
  208,38: =
  208,40: "#3975e5"

221 = Expr
  208,38: =
  208,40: "#3975e5"

57 STR
  208,40: "#3975e5"

207 CR_token2
  208,49: 


68 ID . ID ( Exprs )
  209,12: GraphicsWindow
  209,26: .
  209,27: FillRectangle
  209,40: (
  209,41: 70,690,170,80
  209,54: )

184 . ID ( Exprs )
  209,26: .
  209,27: FillRectangle
  209,40: (
  209,41: 70,690,170,80
  209,54: )

255 ID ( Exprs )
  209,27: FillRectangle
  209,40: (
  209,41: 70,690,170,80
  209,54: )

221 ( Exprs )
  209,40: (
  209,41: 70,690,170,80
  209,54: )

27 NUM
  209,41: 70

217 , MoreThanOneExpr
  209,43: ,
  209,44: 690,170,80

54 NUM
  209,44: 690

217 , MoreThanOneExpr
  209,47: ,
  209,48: 170,80

54 NUM
  209,48: 170

217 , MoreThanOneExpr
  209,51: ,
  209,52: 80

54 NUM
  209,52: 80

238 )
  209,54: )

207 CR_token2
  209,55: 


68 ID . ID ( Exprs )
  210,12: GraphicsWindow
  210,26: .
  210,27: FillRectangle
  210,40: (
  210,41: 800,690,224,85
  210,55: )

184 . ID ( Exprs )
  210,26: .
  210,27: FillRectangle
  210,40: (
  210,41: 800,690,224,85
  210,55: )

255 ID ( Exprs )
  210,27: FillRectangle
  210,40: (
  210,41: 800,690,224,85
  210,55: )

221 ( Exprs )
  210,40: (
  210,41: 800,690,224,85
  210,55: )

27 NUM
  210,41: 800

217 , MoreThanOneExpr
  210,44: ,
  210,45: 690,224,85

54 NUM
  210,45: 690

217 , MoreThanOneExpr
  210,48: ,
  210,49: 224,85

54 NUM
  210,49: 224

217 , MoreThanOneExpr
  210,52: ,
  210,53: 85

54 NUM
  210,53: 85

238 )
  210,55: )

207 CR_token2
  210,56: 


68 ID = Expr
  211,12: status
  211,19: =
  211,21: "start"

184 = Expr
  211,19: =
  211,21: "start"

70 STR
  211,21: "start"

207 CR_token2
  211,28: 


68 ID ( )
  212,12: ResetStars
  212,22: (
  212,23: )

184 ( )
  212,22: (
  212,23: )

261 )
  212,23: )

207 CR_token2
  212,24: 


68 ID = Expr
  213,12: resettime
  213,22: =
  213,24: Clock.ElapsedMilliseconds

184 = Expr
  213,22: =
  213,24: Clock.ElapsedMilliseconds

70 ID . ID
  213,24: Clock
  213,29: .
  213,30: ElapsedMilliseconds

5 . ID
  213,29: .
  213,30: ElapsedMilliseconds

260 ID
  213,30: ElapsedMilliseconds

207 CR_token2
  213,58: 


122 OptionalElse_token1
  214,10: endif

207 CR_token2
  214,15: 


122 OptionalElse_token1
  215,8: EndIf

207 CR_token2
  215,13: 


122 CR_token2
  216,8: 


122 CRStmtCRs
  217,1:        ' show time and fps
       If Clock.ElapsedMilliseconds - endtime > 1000 And status = "game" Then
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
      

122 CR_token2
  217,27: 


67 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  218,8: If
  218,11: Clock.ElapsedMilliseconds - endtime > 1000 And status = "game"
  218,74: Then
  218,78: 
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0

  246,9: EndIf

86 ID . ID
  218,11: Clock
  218,16: .
  218,17: ElapsedMilliseconds

4 . ID
  218,16: .
  218,17: ElapsedMilliseconds

248 ID
  218,17: ElapsedMilliseconds

65 - MultiplicativeExpr
  218,37: -
  218,39: endtime

141 ID
  218,39: endtime

91 > AdditiveExpr
  218,47: >
  218,49: 1000

131 NUM
  218,49: 1000

167 AndExpr_token1 EqNeqExpr
  218,54: And
  218,58: status = "game"

102 ID
  218,58: status

134 = CompExpr
  218,65: =
  218,67: "game"

117 STR
  218,67: "game"

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  218,74: Then
  218,78: 
          gametime = Clock.ElapsedMilliseconds - starttime
          GraphicsWindow.BrushColor = "#3975e5"
          GraphicsWindow.FontName = "COMIC SANS MS"
          GraphicsWindow.FontSize = 25
          GraphicsWindow.FillRectangle(800,690,224,85)
          GraphicsWindow.BrushColor = "white"
          tsecgesamt = Math.Round(gametime/ 1000)  
          tsec       = Math.Remainder(tsecgesamt , 60)
          tmingesamt = Math.Floor(tsecgesamt/ 60) 
          tmin       = Math.Remainder(tmingesamt , 60)
          thour      = Math.Floor(tmingesamt / 60)
          If tsec < 10 then 
            strSec = Text.Append( ":0", tsec) 
          Else
            strSec = Text.Append( ":", tsec)   
          EndIf  
          If tmin < 10 then 
            strMin = Text.Append( "0", tmin) 
          Else
            strMin = Text.Append( "", tmin) 
          EndIf       
               
          GraphicsWindow.DrawText(800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec))
          GraphicsWindow.DrawText(800, 725, " fps "+ fps )
          GraphicsWindow.FontSize = 10
          endtime = Clock.ElapsedMilliseconds  
          fps = 0

  246,9: EndIf

124 CR_token2
  218,78: 


67 ID = Expr
  219,11: gametime
  219,20: =
  219,22: Clock.ElapsedMilliseconds - starttime

184 = Expr
  219,20: =
  219,22: Clock.ElapsedMilliseconds - starttime

70 ID . ID
  219,22: Clock
  219,27: .
  219,28: ElapsedMilliseconds

5 . ID
  219,27: .
  219,28: ElapsedMilliseconds

260 ID
  219,28: ElapsedMilliseconds

59 - MultiplicativeExpr
  219,48: -
  219,50: starttime

144 ID
  219,50: starttime

207 CR_token2
  219,59: 


68 ID . ID = Expr
  220,11: GraphicsWindow
  220,25: .
  220,26: BrushColor
  220,37: =
  220,39: "#3975e5"

184 . ID = Expr
  220,25: .
  220,26: BrushColor
  220,37: =
  220,39: "#3975e5"

255 ID = Expr
  220,26: BrushColor
  220,37: =
  220,39: "#3975e5"

221 = Expr
  220,37: =
  220,39: "#3975e5"

57 STR
  220,39: "#3975e5"

207 CR_token2
  220,48: 


68 ID . ID = Expr
  221,11: GraphicsWindow
  221,25: .
  221,26: FontName
  221,35: =
  221,37: "COMIC SANS MS"

184 . ID = Expr
  221,25: .
  221,26: FontName
  221,35: =
  221,37: "COMIC SANS MS"

255 ID = Expr
  221,26: FontName
  221,35: =
  221,37: "COMIC SANS MS"

221 = Expr
  221,35: =
  221,37: "COMIC SANS MS"

57 STR
  221,37: "COMIC SANS MS"

207 CR_token2
  221,52: 


68 ID . ID = Expr
  222,11: GraphicsWindow
  222,25: .
  222,26: FontSize
  222,35: =
  222,37: 25

184 . ID = Expr
  222,25: .
  222,26: FontSize
  222,35: =
  222,37: 25

255 ID = Expr
  222,26: FontSize
  222,35: =
  222,37: 25

221 = Expr
  222,35: =
  222,37: 25

57 NUM
  222,37: 25

207 CR_token2
  222,39: 


68 ID . ID ( Exprs )
  223,11: GraphicsWindow
  223,25: .
  223,26: FillRectangle
  223,39: (
  223,40: 800,690,224,85
  223,54: )

184 . ID ( Exprs )
  223,25: .
  223,26: FillRectangle
  223,39: (
  223,40: 800,690,224,85
  223,54: )

255 ID ( Exprs )
  223,26: FillRectangle
  223,39: (
  223,40: 800,690,224,85
  223,54: )

221 ( Exprs )
  223,39: (
  223,40: 800,690,224,85
  223,54: )

27 NUM
  223,40: 800

217 , MoreThanOneExpr
  223,43: ,
  223,44: 690,224,85

54 NUM
  223,44: 690

217 , MoreThanOneExpr
  223,47: ,
  223,48: 224,85

54 NUM
  223,48: 224

217 , MoreThanOneExpr
  223,51: ,
  223,52: 85

54 NUM
  223,52: 85

238 )
  223,54: )

207 CR_token2
  223,55: 


68 ID . ID = Expr
  224,11: GraphicsWindow
  224,25: .
  224,26: BrushColor
  224,37: =
  224,39: "white"

184 . ID = Expr
  224,25: .
  224,26: BrushColor
  224,37: =
  224,39: "white"

255 ID = Expr
  224,26: BrushColor
  224,37: =
  224,39: "white"

221 = Expr
  224,37: =
  224,39: "white"

57 STR
  224,39: "white"

207 CR_token2
  224,46: 


68 ID = Expr
  225,11: tsecgesamt
  225,22: =
  225,24: Math.Round(gametime/ 1000)

184 = Expr
  225,22: =
  225,24: Math.Round(gametime/ 1000)

70 ID . ID ( Exprs )
  225,24: Math
  225,28: .
  225,29: Round
  225,34: (
  225,35: gametime/ 1000
  225,49: )

5 . ID ( Exprs )
  225,28: .
  225,29: Round
  225,34: (
  225,35: gametime/ 1000
  225,49: )

260 ID ( Exprs )
  225,29: Round
  225,34: (
  225,35: gametime/ 1000
  225,49: )

24 ( Exprs )
  225,34: (
  225,35: gametime/ 1000
  225,49: )

26 ID
  225,35: gametime

50 / UnaryExpr
  225,43: /
  225,45: 1000

156 NUM
  225,45: 1000

249 )
  225,49: )

207 CR_token2
  225,52: 


68 ID = Expr
  226,11: tsec
  226,22: =
  226,24: Math.Remainder(tsecgesamt , 60)

184 = Expr
  226,22: =
  226,24: Math.Remainder(tsecgesamt , 60)

70 ID . ID ( Exprs )
  226,24: Math
  226,28: .
  226,29: Remainder
  226,38: (
  226,39: tsecgesamt , 60
  226,54: )

5 . ID ( Exprs )
  226,28: .
  226,29: Remainder
  226,38: (
  226,39: tsecgesamt , 60
  226,54: )

260 ID ( Exprs )
  226,29: Remainder
  226,38: (
  226,39: tsecgesamt , 60
  226,54: )

24 ( Exprs )
  226,38: (
  226,39: tsecgesamt , 60
  226,54: )

26 ID
  226,39: tsecgesamt

217 , MoreThanOneExpr
  226,50: ,
  226,52: 60

54 NUM
  226,52: 60

249 )
  226,54: )

207 CR_token2
  226,55: 


68 ID = Expr
  227,11: tmingesamt
  227,22: =
  227,24: Math.Floor(tsecgesamt/ 60)

184 = Expr
  227,22: =
  227,24: Math.Floor(tsecgesamt/ 60)

70 ID . ID ( Exprs )
  227,24: Math
  227,28: .
  227,29: Floor
  227,34: (
  227,35: tsecgesamt/ 60
  227,49: )

5 . ID ( Exprs )
  227,28: .
  227,29: Floor
  227,34: (
  227,35: tsecgesamt/ 60
  227,49: )

260 ID ( Exprs )
  227,29: Floor
  227,34: (
  227,35: tsecgesamt/ 60
  227,49: )

24 ( Exprs )
  227,34: (
  227,35: tsecgesamt/ 60
  227,49: )

26 ID
  227,35: tsecgesamt

50 / UnaryExpr
  227,45: /
  227,47: 60

156 NUM
  227,47: 60

249 )
  227,49: )

207 CR_token2
  227,51: 


68 ID = Expr
  228,11: tmin
  228,22: =
  228,24: Math.Remainder(tmingesamt , 60)

184 = Expr
  228,22: =
  228,24: Math.Remainder(tmingesamt , 60)

70 ID . ID ( Exprs )
  228,24: Math
  228,28: .
  228,29: Remainder
  228,38: (
  228,39: tmingesamt , 60
  228,54: )

5 . ID ( Exprs )
  228,28: .
  228,29: Remainder
  228,38: (
  228,39: tmingesamt , 60
  228,54: )

260 ID ( Exprs )
  228,29: Remainder
  228,38: (
  228,39: tmingesamt , 60
  228,54: )

24 ( Exprs )
  228,38: (
  228,39: tmingesamt , 60
  228,54: )

26 ID
  228,39: tmingesamt

217 , MoreThanOneExpr
  228,50: ,
  228,52: 60

54 NUM
  228,52: 60

249 )
  228,54: )

207 CR_token2
  228,55: 


68 ID = Expr
  229,11: thour
  229,22: =
  229,24: Math.Floor(tmingesamt / 60)

184 = Expr
  229,22: =
  229,24: Math.Floor(tmingesamt / 60)

70 ID . ID ( Exprs )
  229,24: Math
  229,28: .
  229,29: Floor
  229,34: (
  229,35: tmingesamt / 60
  229,50: )

5 . ID ( Exprs )
  229,28: .
  229,29: Floor
  229,34: (
  229,35: tmingesamt / 60
  229,50: )

260 ID ( Exprs )
  229,29: Floor
  229,34: (
  229,35: tmingesamt / 60
  229,50: )

24 ( Exprs )
  229,34: (
  229,35: tmingesamt / 60
  229,50: )

26 ID
  229,35: tmingesamt

50 / UnaryExpr
  229,46: /
  229,48: 60

156 NUM
  229,48: 60

249 )
  229,50: )

207 CR_token2
  229,51: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  230,11: If
  230,14: tsec < 10
  230,24: then
  230,29: 
            strSec = Text.Append( ":0", tsec) 

  232,11: Else
            strSec = Text.Append( ":", tsec)   
          EndIf

86 ID
  230,14: tsec

91 < AdditiveExpr
  230,19: <
  230,21: 10

131 NUM
  230,21: 10

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  230,24: then
  230,29: 
            strSec = Text.Append( ":0", tsec) 

  232,11: Else
            strSec = Text.Append( ":", tsec)   
          EndIf

124 CR_token2
  230,29: 


67 ID = Expr
  231,13: strSec
  231,20: =
  231,22: Text.Append( ":0", tsec)

184 = Expr
  231,20: =
  231,22: Text.Append( ":0", tsec)

70 ID . ID ( Exprs )
  231,22: Text
  231,26: .
  231,27: Append
  231,33: (
  231,35: ":0", tsec
  231,45: )

5 . ID ( Exprs )
  231,26: .
  231,27: Append
  231,33: (
  231,35: ":0", tsec
  231,45: )

260 ID ( Exprs )
  231,27: Append
  231,33: (
  231,35: ":0", tsec
  231,45: )

24 ( Exprs )
  231,33: (
  231,35: ":0", tsec
  231,45: )

26 STR
  231,35: ":0"

217 , MoreThanOneExpr
  231,39: ,
  231,41: tsec

54 ID
  231,41: tsec

249 )
  231,45: )

207 CR_token2
  231,47: 


122 OptionalElse_token2 CRStmtCRs OptionalElse_token1
  232,11: Else
  232,15: 
            strSec = Text.Append( ":", tsec)   

  234,11: EndIf

201 CR_token2
  232,15: 


113 ID = Expr
  233,13: strSec
  233,20: =
  233,22: Text.Append( ":", tsec)

184 = Expr
  233,20: =
  233,22: Text.Append( ":", tsec)

70 ID . ID ( Exprs )
  233,22: Text
  233,26: .
  233,27: Append
  233,33: (
  233,35: ":", tsec
  233,44: )

5 . ID ( Exprs )
  233,26: .
  233,27: Append
  233,33: (
  233,35: ":", tsec
  233,44: )

260 ID ( Exprs )
  233,27: Append
  233,33: (
  233,35: ":", tsec
  233,44: )

24 ( Exprs )
  233,33: (
  233,35: ":", tsec
  233,44: )

26 STR
  233,35: ":"

217 , MoreThanOneExpr
  233,38: ,
  233,40: tsec

54 ID
  233,40: tsec

249 )
  233,44: )

202 CR_token2
  233,48: 


237 OptionalElse_token1
  234,11: EndIf

207 CR_token2
  234,18: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  235,11: If
  235,14: tmin < 10
  235,24: then
  235,29: 
            strMin = Text.Append( "0", tmin) 

  237,11: Else
            strMin = Text.Append( "", tmin) 
          EndIf

86 ID
  235,14: tmin

91 < AdditiveExpr
  235,19: <
  235,21: 10

131 NUM
  235,21: 10

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  235,24: then
  235,29: 
            strMin = Text.Append( "0", tmin) 

  237,11: Else
            strMin = Text.Append( "", tmin) 
          EndIf

124 CR_token2
  235,29: 


67 ID = Expr
  236,13: strMin
  236,20: =
  236,22: Text.Append( "0", tmin)

184 = Expr
  236,20: =
  236,22: Text.Append( "0", tmin)

70 ID . ID ( Exprs )
  236,22: Text
  236,26: .
  236,27: Append
  236,33: (
  236,35: "0", tmin
  236,44: )

5 . ID ( Exprs )
  236,26: .
  236,27: Append
  236,33: (
  236,35: "0", tmin
  236,44: )

260 ID ( Exprs )
  236,27: Append
  236,33: (
  236,35: "0", tmin
  236,44: )

24 ( Exprs )
  236,33: (
  236,35: "0", tmin
  236,44: )

26 STR
  236,35: "0"

217 , MoreThanOneExpr
  236,38: ,
  236,40: tmin

54 ID
  236,40: tmin

249 )
  236,44: )

207 CR_token2
  236,46: 


122 OptionalElse_token2 CRStmtCRs OptionalElse_token1
  237,11: Else
  237,15: 
            strMin = Text.Append( "", tmin) 

  239,11: EndIf

201 CR_token2
  237,15: 


113 ID = Expr
  238,13: strMin
  238,20: =
  238,22: Text.Append( "", tmin)

184 = Expr
  238,20: =
  238,22: Text.Append( "", tmin)

70 ID . ID ( Exprs )
  238,22: Text
  238,26: .
  238,27: Append
  238,33: (
  238,35: "", tmin
  238,43: )

5 . ID ( Exprs )
  238,26: .
  238,27: Append
  238,33: (
  238,35: "", tmin
  238,43: )

260 ID ( Exprs )
  238,27: Append
  238,33: (
  238,35: "", tmin
  238,43: )

24 ( Exprs )
  238,33: (
  238,35: "", tmin
  238,43: )

26 STR
  238,35: ""

217 , MoreThanOneExpr
  238,37: ,
  238,39: tmin

54 ID
  238,39: tmin

249 )
  238,43: )

202 CR_token2
  238,45: 


237 OptionalElse_token1
  239,11: EndIf

207 CR_token2
  239,23: 


122 CR_token2
  240,16: 


67 ID . ID ( Exprs )
  241,11: GraphicsWindow
  241,25: .
  241,26: DrawText
  241,34: (
  241,35: 800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec)
  241,97: )

184 . ID ( Exprs )
  241,25: .
  241,26: DrawText
  241,34: (
  241,35: 800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec)
  241,97: )

255 ID ( Exprs )
  241,26: DrawText
  241,34: (
  241,35: 800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec)
  241,97: )

221 ( Exprs )
  241,34: (
  241,35: 800, 690, " time "+ thour + ":" + Text.Append( strMin, strSec)
  241,97: )

27 NUM
  241,35: 800

217 , MoreThanOneExpr
  241,38: ,
  241,40: 690, " time "+ thour + ":" + Text.Append( strMin, strSec)

54 NUM
  241,40: 690

217 , MoreThanOneExpr
  241,43: ,
  241,45: " time "+ thour + ":" + Text.Append( strMin, strSec)

54 STR
  241,45: " time "

65 + MultiplicativeExpr
  241,53: +
  241,55: thour

141 ID
  241,55: thour

65 + MultiplicativeExpr
  241,61: +
  241,63: ":"

141 STR
  241,63: ":"

65 + MultiplicativeExpr
  241,67: +
  241,69: Text.Append( strMin, strSec)

141 ID . ID ( Exprs )
  241,69: Text
  241,73: .
  241,74: Append
  241,80: (
  241,82: strMin, strSec
  241,96: )

4 . ID ( Exprs )
  241,73: .
  241,74: Append
  241,80: (
  241,82: strMin, strSec
  241,96: )

248 ID ( Exprs )
  241,74: Append
  241,80: (
  241,82: strMin, strSec
  241,96: )

23 ( Exprs )
  241,80: (
  241,82: strMin, strSec
  241,96: )

22 ID
  241,82: strMin

217 , MoreThanOneExpr
  241,88: ,
  241,90: strSec

54 ID
  241,90: strSec

239 )
  241,96: )

238 )
  241,97: )

207 CR_token2
  241,98: 


68 ID . ID ( Exprs )
  242,11: GraphicsWindow
  242,25: .
  242,26: DrawText
  242,34: (
  242,35: 800, 725, " fps "+ fps
  242,58: )

184 . ID ( Exprs )
  242,25: .
  242,26: DrawText
  242,34: (
  242,35: 800, 725, " fps "+ fps
  242,58: )

255 ID ( Exprs )
  242,26: DrawText
  242,34: (
  242,35: 800, 725, " fps "+ fps
  242,58: )

221 ( Exprs )
  242,34: (
  242,35: 800, 725, " fps "+ fps
  242,58: )

27 NUM
  242,35: 800

217 , MoreThanOneExpr
  242,38: ,
  242,40: 725, " fps "+ fps

54 NUM
  242,40: 725

217 , MoreThanOneExpr
  242,43: ,
  242,45: " fps "+ fps

54 STR
  242,45: " fps "

65 + MultiplicativeExpr
  242,52: +
  242,54: fps

141 ID
  242,54: fps

238 )
  242,58: )

207 CR_token2
  242,59: 


68 ID . ID = Expr
  243,11: GraphicsWindow
  243,25: .
  243,26: FontSize
  243,35: =
  243,37: 10

184 . ID = Expr
  243,25: .
  243,26: FontSize
  243,35: =
  243,37: 10

255 ID = Expr
  243,26: FontSize
  243,35: =
  243,37: 10

221 = Expr
  243,35: =
  243,37: 10

57 NUM
  243,37: 10

207 CR_token2
  243,39: 


68 ID = Expr
  244,11: endtime
  244,19: =
  244,21: Clock.ElapsedMilliseconds

184 = Expr
  244,19: =
  244,21: Clock.ElapsedMilliseconds

70 ID . ID
  244,21: Clock
  244,26: .
  244,27: ElapsedMilliseconds

5 . ID
  244,26: .
  244,27: ElapsedMilliseconds

260 ID
  244,27: ElapsedMilliseconds

207 CR_token2
  244,48: 


68 ID = Expr
  245,11: fps
  245,15: =
  245,17: 0

184 = Expr
  245,15: =
  245,17: 0

70 NUM
  245,17: 0

207 CR_token2
  245,18: 


122 OptionalElse_token1
  246,9: EndIf

207 CR_token2
  246,14: 


122 OptionalElse_token1
  247,5: EndIf

205 CR
  247,10:  

205 CR_token2
  247,29: 


187 CR_token2
  248,3: 


182 CRStmtCRs
  249,1:     'reset level after a short delay  
    If status ="reset" And (Clock.ElapsedMilliseconds - resettime > 2500) Then
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.FillRectangle(800,690,224,80)
      freecells = 1
      blink = 0
      LevelRelease()
      LevelLoad()
      wait1 = Clock.ElapsedMilliseconds
      While Clock.ElapsedMilliseconds - wait1 < 3000
      EndWhile  
      starttime = Clock.ElapsedMilliseconds   
      status = "game" 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FontName = "COMIC SANS MS"
      GraphicsWindow.FontSize = 25
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.BrushColor = "white"
      GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      GraphicsWindow.DrawText(70, 725, " level "+ (stage + 1) )
    EndIf
    If status = "start" then  

187 CR_token2
  249,39: 


93 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  250,5: If
  250,8: status ="reset" And (Clock.ElapsedMilliseconds - resettime > 2500)
  250,75: Then
  250,79: 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.FillRectangle(800,690,224,80)
      freecells = 1
      blink = 0
      LevelRelease()
      LevelLoad()
      wait1 = Clock.ElapsedMilliseconds
      While Clock.ElapsedMilliseconds - wait1 < 3000
      EndWhile  
      starttime = Clock.ElapsedMilliseconds   
      status = "game" 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FontName = "COMIC SANS MS"
      GraphicsWindow.FontSize = 25
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.BrushColor = "white"
      GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      GraphicsWindow.DrawText(70, 725, " level "+ (stage + 1) )

  270,5: EndIf

86 ID
  250,8: status

128 = CompExpr
  250,15: =
  250,16: "reset"

117 STR
  250,16: "reset"

167 AndExpr_token1 EqNeqExpr
  250,24: And
  250,28: (Clock.ElapsedMilliseconds - resettime > 2500)

102 ( Expr )
  250,28: (
  250,29: Clock.ElapsedMilliseconds - resettime > 2500
  250,73: )

80 ID . ID
  250,29: Clock
  250,34: .
  250,35: ElapsedMilliseconds

4 . ID
  250,34: .
  250,35: ElapsedMilliseconds

248 ID
  250,35: ElapsedMilliseconds

65 - MultiplicativeExpr
  250,55: -
  250,57: resettime

141 ID
  250,57: resettime

91 > AdditiveExpr
  250,67: >
  250,69: 2500

131 NUM
  250,69: 2500

265 )
  250,73: )

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  250,75: Then
  250,79: 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.FillRectangle(800,690,224,80)
      freecells = 1
      blink = 0
      LevelRelease()
      LevelLoad()
      wait1 = Clock.ElapsedMilliseconds
      While Clock.ElapsedMilliseconds - wait1 < 3000
      EndWhile  
      starttime = Clock.ElapsedMilliseconds   
      status = "game" 
      GraphicsWindow.BrushColor = "#3975e5"
      GraphicsWindow.FontName = "COMIC SANS MS"
      GraphicsWindow.FontSize = 25
      GraphicsWindow.FillRectangle(70,690,170,80)
      GraphicsWindow.BrushColor = "white"
      GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      GraphicsWindow.DrawText(70, 725, " level "+ (stage + 1) )

  270,5: EndIf

124 CR_token2
  250,79: 


67 ID . ID = Expr
  251,7: GraphicsWindow
  251,21: .
  251,22: BrushColor
  251,33: =
  251,35: "#3975e5"

184 . ID = Expr
  251,21: .
  251,22: BrushColor
  251,33: =
  251,35: "#3975e5"

255 ID = Expr
  251,22: BrushColor
  251,33: =
  251,35: "#3975e5"

221 = Expr
  251,33: =
  251,35: "#3975e5"

57 STR
  251,35: "#3975e5"

207 CR_token2
  251,44: 


68 ID . ID ( Exprs )
  252,7: GraphicsWindow
  252,21: .
  252,22: FillRectangle
  252,35: (
  252,36: 70,690,170,80
  252,49: )

184 . ID ( Exprs )
  252,21: .
  252,22: FillRectangle
  252,35: (
  252,36: 70,690,170,80
  252,49: )

255 ID ( Exprs )
  252,22: FillRectangle
  252,35: (
  252,36: 70,690,170,80
  252,49: )

221 ( Exprs )
  252,35: (
  252,36: 70,690,170,80
  252,49: )

27 NUM
  252,36: 70

217 , MoreThanOneExpr
  252,38: ,
  252,39: 690,170,80

54 NUM
  252,39: 690

217 , MoreThanOneExpr
  252,42: ,
  252,43: 170,80

54 NUM
  252,43: 170

217 , MoreThanOneExpr
  252,46: ,
  252,47: 80

54 NUM
  252,47: 80

238 )
  252,49: )

207 CR_token2
  252,50: 


68 ID . ID ( Exprs )
  253,7: GraphicsWindow
  253,21: .
  253,22: FillRectangle
  253,35: (
  253,36: 800,690,224,80
  253,50: )

184 . ID ( Exprs )
  253,21: .
  253,22: FillRectangle
  253,35: (
  253,36: 800,690,224,80
  253,50: )

255 ID ( Exprs )
  253,22: FillRectangle
  253,35: (
  253,36: 800,690,224,80
  253,50: )

221 ( Exprs )
  253,35: (
  253,36: 800,690,224,80
  253,50: )

27 NUM
  253,36: 800

217 , MoreThanOneExpr
  253,39: ,
  253,40: 690,224,80

54 NUM
  253,40: 690

217 , MoreThanOneExpr
  253,43: ,
  253,44: 224,80

54 NUM
  253,44: 224

217 , MoreThanOneExpr
  253,47: ,
  253,48: 80

54 NUM
  253,48: 80

238 )
  253,50: )

207 CR_token2
  253,51: 


68 ID = Expr
  254,7: freecells
  254,17: =
  254,19: 1

184 = Expr
  254,17: =
  254,19: 1

70 NUM
  254,19: 1

207 CR_token2
  254,20: 


68 ID = Expr
  255,7: blink
  255,13: =
  255,15: 0

184 = Expr
  255,13: =
  255,15: 0

70 NUM
  255,15: 0

207 CR_token2
  255,16: 


68 ID ( )
  256,7: LevelRelease
  256,19: (
  256,20: )

184 ( )
  256,19: (
  256,20: )

261 )
  256,20: )

207 CR_token2
  256,21: 


68 ID ( )
  257,7: LevelLoad
  257,16: (
  257,17: )

184 ( )
  257,16: (
  257,17: )

261 )
  257,17: )

207 CR_token2
  257,18: 


68 ID = Expr
  258,7: wait1
  258,13: =
  258,15: Clock.ElapsedMilliseconds

184 = Expr
  258,13: =
  258,15: Clock.ElapsedMilliseconds

70 ID . ID
  258,15: Clock
  258,20: .
  258,21: ElapsedMilliseconds

5 . ID
  258,20: .
  258,21: ElapsedMilliseconds

260 ID
  258,21: ElapsedMilliseconds

207 CR_token2
  258,40: 


68 Stmt_token1 Expr CRStmtCRs Stmt_token2
  259,7: While
  259,13: Clock.ElapsedMilliseconds - wait1 < 3000
  259,53: 

  260,7: EndWhile

79 ID . ID
  259,13: Clock
  259,18: .
  259,19: ElapsedMilliseconds

5 . ID
  259,18: .
  259,19: ElapsedMilliseconds

260 ID
  259,19: ElapsedMilliseconds

59 - MultiplicativeExpr
  259,39: -
  259,41: wait1

144 ID
  259,41: wait1

90 < AdditiveExpr
  259,47: <
  259,49: 3000

129 NUM
  259,49: 3000

186 CR_token2
  259,53: 


187 Stmt_token2
  260,7: EndWhile

207 CR_token2
  260,17: 


68 ID = Expr
  261,7: starttime
  261,17: =
  261,19: Clock.ElapsedMilliseconds

184 = Expr
  261,17: =
  261,19: Clock.ElapsedMilliseconds

70 ID . ID
  261,19: Clock
  261,24: .
  261,25: ElapsedMilliseconds

5 . ID
  261,24: .
  261,25: ElapsedMilliseconds

260 ID
  261,25: ElapsedMilliseconds

207 CR_token2
  261,47: 


68 ID = Expr
  262,7: status
  262,14: =
  262,16: "game"

184 = Expr
  262,14: =
  262,16: "game"

70 STR
  262,16: "game"

207 CR_token2
  262,23: 


68 ID . ID = Expr
  263,7: GraphicsWindow
  263,21: .
  263,22: BrushColor
  263,33: =
  263,35: "#3975e5"

184 . ID = Expr
  263,21: .
  263,22: BrushColor
  263,33: =
  263,35: "#3975e5"

255 ID = Expr
  263,22: BrushColor
  263,33: =
  263,35: "#3975e5"

221 = Expr
  263,33: =
  263,35: "#3975e5"

57 STR
  263,35: "#3975e5"

207 CR_token2
  263,44: 


68 ID . ID = Expr
  264,7: GraphicsWindow
  264,21: .
  264,22: FontName
  264,31: =
  264,33: "COMIC SANS MS"

184 . ID = Expr
  264,21: .
  264,22: FontName
  264,31: =
  264,33: "COMIC SANS MS"

255 ID = Expr
  264,22: FontName
  264,31: =
  264,33: "COMIC SANS MS"

221 = Expr
  264,31: =
  264,33: "COMIC SANS MS"

57 STR
  264,33: "COMIC SANS MS"

207 CR_token2
  264,48: 


68 ID . ID = Expr
  265,7: GraphicsWindow
  265,21: .
  265,22: FontSize
  265,31: =
  265,33: 25

184 . ID = Expr
  265,21: .
  265,22: FontSize
  265,31: =
  265,33: 25

255 ID = Expr
  265,22: FontSize
  265,31: =
  265,33: 25

221 = Expr
  265,31: =
  265,33: 25

57 NUM
  265,33: 25

207 CR_token2
  265,35: 


68 ID . ID ( Exprs )
  266,7: GraphicsWindow
  266,21: .
  266,22: FillRectangle
  266,35: (
  266,36: 70,690,170,80
  266,49: )

184 . ID ( Exprs )
  266,21: .
  266,22: FillRectangle
  266,35: (
  266,36: 70,690,170,80
  266,49: )

255 ID ( Exprs )
  266,22: FillRectangle
  266,35: (
  266,36: 70,690,170,80
  266,49: )

221 ( Exprs )
  266,35: (
  266,36: 70,690,170,80
  266,49: )

27 NUM
  266,36: 70

217 , MoreThanOneExpr
  266,38: ,
  266,39: 690,170,80

54 NUM
  266,39: 690

217 , MoreThanOneExpr
  266,42: ,
  266,43: 170,80

54 NUM
  266,43: 170

217 , MoreThanOneExpr
  266,46: ,
  266,47: 80

54 NUM
  266,47: 80

238 )
  266,49: )

207 CR_token2
  266,50: 


68 ID . ID = Expr
  267,7: GraphicsWindow
  267,21: .
  267,22: BrushColor
  267,33: =
  267,35: "white"

184 . ID = Expr
  267,21: .
  267,22: BrushColor
  267,33: =
  267,35: "white"

255 ID = Expr
  267,22: BrushColor
  267,33: =
  267,35: "white"

221 = Expr
  267,33: =
  267,35: "white"

57 STR
  267,35: "white"

207 CR_token2
  267,42: 


68 ID . ID ( Exprs )
  268,7: GraphicsWindow
  268,21: .
  268,22: DrawText
  268,30: (
  268,31: 70, 690, "moves "+ moves
  268,55: )

184 . ID ( Exprs )
  268,21: .
  268,22: DrawText
  268,30: (
  268,31: 70, 690, "moves "+ moves
  268,55: )

255 ID ( Exprs )
  268,22: DrawText
  268,30: (
  268,31: 70, 690, "moves "+ moves
  268,55: )

221 ( Exprs )
  268,30: (
  268,31: 70, 690, "moves "+ moves
  268,55: )

27 NUM
  268,31: 70

217 , MoreThanOneExpr
  268,33: ,
  268,35: 690, "moves "+ moves

54 NUM
  268,35: 690

217 , MoreThanOneExpr
  268,38: ,
  268,40: "moves "+ moves

54 STR
  268,40: "moves "

65 + MultiplicativeExpr
  268,48: +
  268,50: moves

141 ID
  268,50: moves

238 )
  268,55: )

207 CR_token2
  268,56: 


68 ID . ID ( Exprs )
  269,7: GraphicsWindow
  269,21: .
  269,22: DrawText
  269,30: (
  269,31: 70, 725, " level "+ (stage + 1)
  269,63: )

184 . ID ( Exprs )
  269,21: .
  269,22: DrawText
  269,30: (
  269,31: 70, 725, " level "+ (stage + 1)
  269,63: )

255 ID ( Exprs )
  269,22: DrawText
  269,30: (
  269,31: 70, 725, " level "+ (stage + 1)
  269,63: )

221 ( Exprs )
  269,30: (
  269,31: 70, 725, " level "+ (stage + 1)
  269,63: )

27 NUM
  269,31: 70

217 , MoreThanOneExpr
  269,33: ,
  269,35: 725, " level "+ (stage + 1)

54 NUM
  269,35: 725

217 , MoreThanOneExpr
  269,38: ,
  269,40: " level "+ (stage + 1)

54 STR
  269,40: " level "

65 + MultiplicativeExpr
  269,49: +
  269,51: (stage + 1)

141 ( Expr )
  269,51: (
  269,52: stage + 1
  269,61: )

80 ID
  269,52: stage

65 + MultiplicativeExpr
  269,58: +
  269,60: 1

141 NUM
  269,60: 1

265 )
  269,61: )

238 )
  269,63: )

207 CR_token2
  269,64: 


122 OptionalElse_token1
  270,5: EndIf

205 CR_token2
  270,10: 


95 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  271,5: If
  271,8: status = "start"
  271,25: then
  271,32: 
      MoveStars()        

  273,5: endif

86 ID
  271,8: status

128 = CompExpr
  271,15: =
  271,17: "start"

117 STR
  271,17: "start"

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  271,25: then
  271,32: 
      MoveStars()        

  273,5: endif

124 CR_token2
  271,32: 


67 ID ( )
  272,7: MoveStars
  272,16: (
  272,17: )

184 ( )
  272,16: (
  272,17: )

261 )
  272,17: )

207 CR_token2
  272,26: 


122 OptionalElse_token1
  273,5: endif

205 CR_token2
  273,10: 


187 CR_token2
  274,5: 


187 Stmt_token2
  275,3: EndWhile

206 CR_token2
  275,11: 


257 Stmt_token8
  276,1: EndSub

97 Stmt_token7 ID CRStmtCRs Stmt_token8
  279,1: Sub
  279,5: KeyDown
  279,12: 
  
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  bescapeKey  = false
  
  
  If GraphicsWindow.LastKey = leftKey then
    bleftKey = true
  elseif GraphicsWindow.LastKey = rightKey then
    brightKey = true   
  elseif GraphicsWindow.LastKey = forwardKey then
    bforwardKey = true
  elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif

  302,1: endSub

244 ID CRStmtCRs Stmt_token8
  279,5: KeyDown
  279,12: 
  
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  bescapeKey  = false
  
  
  If GraphicsWindow.LastKey = leftKey then
    bleftKey = true
  elseif GraphicsWindow.LastKey = rightKey then
    brightKey = true   
  elseif GraphicsWindow.LastKey = forwardKey then
    bforwardKey = true
  elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif

  302,1: endSub

199 CR_token2
  279,12: 


105 ID = Expr
  281,3: bleftKey
  281,15: =
  281,17: false

184 = Expr
  281,15: =
  281,17: false

70 ID
  281,17: false

206 CR_token2
  281,22: 


106 ID = Expr
  282,3: brightKey
  282,15: =
  282,17: false

184 = Expr
  282,15: =
  282,17: false

70 ID
  282,17: false

206 CR_token2
  282,22: 


106 ID = Expr
  283,3: bforwardKey
  283,15: =
  283,17: false

184 = Expr
  283,15: =
  283,17: false

70 ID
  283,17: false

206 CR_token2
  283,22: 


106 ID = Expr
  284,3: bbackKey
  284,15: =
  284,17: false

184 = Expr
  284,15: =
  284,17: false

70 ID
  284,17: false

206 CR_token2
  284,22: 


106 ID = Expr
  285,3: bescapeKey
  285,15: =
  285,17: false

184 = Expr
  285,15: =
  285,17: false

70 ID
  285,17: false

206 CR_token2
  285,22: 


106 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  288,3: If
  288,6: GraphicsWindow.LastKey = leftKey
  288,39: then
  288,43: 
    bleftKey = true

  290,3: elseif GraphicsWindow.LastKey = rightKey then
    brightKey = true   
  elseif GraphicsWindow.LastKey = forwardKey then
    bforwardKey = true
  elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif

86 ID . ID
  288,6: GraphicsWindow
  288,20: .
  288,21: LastKey

4 . ID
  288,20: .
  288,21: LastKey

248 ID
  288,21: LastKey

128 = CompExpr
  288,29: =
  288,31: leftKey

117 ID
  288,31: leftKey

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  288,39: then
  288,43: 
    bleftKey = true

  290,3: elseif GraphicsWindow.LastKey = rightKey then
    brightKey = true   
  elseif GraphicsWindow.LastKey = forwardKey then
    bforwardKey = true
  elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif

124 CR_token2
  288,43: 


67 ID = Expr
  289,5: bleftKey
  289,14: =
  289,16: true

184 = Expr
  289,14: =
  289,16: true

70 ID
  289,16: true

207 CR_token2
  289,20: 


122 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  290,3: elseif
  290,10: GraphicsWindow.LastKey = rightKey
  290,44: then
  290,48: 
    brightKey = true   

  292,3: elseif GraphicsWindow.LastKey = forwardKey then
    bforwardKey = true
  elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif

82 ID . ID
  290,10: GraphicsWindow
  290,24: .
  290,25: LastKey

4 . ID
  290,24: .
  290,25: LastKey

248 ID
  290,25: LastKey

128 = CompExpr
  290,33: =
  290,35: rightKey

117 ID
  290,35: rightKey

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  290,44: then
  290,48: 
    brightKey = true   

  292,3: elseif GraphicsWindow.LastKey = forwardKey then
    bforwardKey = true
  elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif

118 CR_token2
  290,48: 


67 ID = Expr
  291,5: brightKey
  291,15: =
  291,17: true

184 = Expr
  291,15: =
  291,17: true

70 ID
  291,17: true

207 CR_token2
  291,24: 


115 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  292,3: elseif
  292,10: GraphicsWindow.LastKey = forwardKey
  292,46: then
  292,50: 
    bforwardKey = true

  294,3: elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif

82 ID . ID
  292,10: GraphicsWindow
  292,24: .
  292,25: LastKey

4 . ID
  292,24: .
  292,25: LastKey

248 ID
  292,25: LastKey

128 = CompExpr
  292,33: =
  292,35: forwardKey

117 ID
  292,35: forwardKey

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  292,46: then
  292,50: 
    bforwardKey = true

  294,3: elseif GraphicsWindow.LastKey = backKey then
    bbackKey = true
  elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif

118 CR_token2
  292,50: 


67 ID = Expr
  293,5: bforwardKey
  293,17: =
  293,19: true

184 = Expr
  293,17: =
  293,19: true

70 ID
  293,19: true

207 CR_token2
  293,23: 


115 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  294,3: elseif
  294,10: GraphicsWindow.LastKey = backKey
  294,43: then
  294,47: 
    bbackKey = true

  296,3: elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif

82 ID . ID
  294,10: GraphicsWindow
  294,24: .
  294,25: LastKey

4 . ID
  294,24: .
  294,25: LastKey

248 ID
  294,25: LastKey

128 = CompExpr
  294,33: =
  294,35: backKey

117 ID
  294,35: backKey

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  294,43: then
  294,47: 
    bbackKey = true

  296,3: elseif GraphicsWindow.LastKey = returnKey then
    breturnKey = true
  elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif

118 CR_token2
  294,47: 


67 ID = Expr
  295,5: bbackKey
  295,14: =
  295,16: true

184 = Expr
  295,14: =
  295,16: true

70 ID
  295,16: true

207 CR_token2
  295,20: 


115 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  296,3: elseif
  296,10: GraphicsWindow.LastKey = returnKey
  296,45: then
  296,49: 
    breturnKey = true

  298,3: elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif

82 ID . ID
  296,10: GraphicsWindow
  296,24: .
  296,25: LastKey

4 . ID
  296,24: .
  296,25: LastKey

248 ID
  296,25: LastKey

128 = CompExpr
  296,33: =
  296,35: returnKey

117 ID
  296,35: returnKey

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  296,45: then
  296,49: 
    breturnKey = true

  298,3: elseif GraphicsWindow.LastKey = escapeKey then
    bescapeKey = true
  endif

118 CR_token2
  296,49: 


67 ID = Expr
  297,5: breturnKey
  297,16: =
  297,18: true

184 = Expr
  297,16: =
  297,18: true

70 ID
  297,18: true

207 CR_token2
  297,22: 


115 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  298,3: elseif
  298,10: GraphicsWindow.LastKey = escapeKey
  298,45: then
  298,49: 
    bescapeKey = true

  300,3: endif

82 ID . ID
  298,10: GraphicsWindow
  298,24: .
  298,25: LastKey

4 . ID
  298,24: .
  298,25: LastKey

248 ID
  298,25: LastKey

128 = CompExpr
  298,33: =
  298,35: escapeKey

117 ID
  298,35: escapeKey

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  298,45: then
  298,49: 
    bescapeKey = true

  300,3: endif

118 CR_token2
  298,49: 


67 ID = Expr
  299,5: bescapeKey
  299,16: =
  299,18: true

184 = Expr
  299,16: =
  299,18: true

70 ID
  299,18: true

207 CR_token2
  299,22: 


115 OptionalElse_token1
  300,3: endif

206 CR_token2
  300,8: 


257 Stmt_token8
  302,1: endSub

97 Stmt_token7 ID CRStmtCRs Stmt_token8
  304,1: Sub
  304,5: KeyUp
  304,10: 
  ' reset every key first
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  breturnKey  = false
  
  If GraphicsWindow.LastKey = pauseKey then 
    LevelExplosion()
  EndIf
 
 
  If GraphicsWindow.LastKey = escapeKey and status = "start" then
    Program.End()
  EndIf

  
  If GraphicsWindow.LastKey = escapeKey And status = "game" then 
    LevelExplosion()
    stage = 0
    Shapes.Animate(titleshape, 140,170, 2500)
    Shapes.Animate(txtstart, 305,420, 3000)
    GraphicsWindow.BrushColor = "#3975e5"
    GraphicsWindow.FillRectangle(70,690,170,80)
    GraphicsWindow.FillRectangle(800,690,224,85)
    status = "start"
    ResetStars()
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = resetKey then 
    LevelExplosion()
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = pluskey then 
    LevelExplosion()
    'stage = stage + 1   'uncomment this line to cheat with F1
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf

  If GraphicsWindow.LastKey = minuskey then 
    'KeyUp()
    LevelExplosion()
    'stage = stage - 1  'uncomment this line to cheat with F2
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  'reload title after <escape>
  If GraphicsWindow.LastKey = returnKey and status = "start" then 
    Shapes.Animate(titleshape, 140,-350, 2000)
    Shapes.Animate(txtstart, 305, 1220, 1600)
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf

  364,1: EndSub

244 ID CRStmtCRs Stmt_token8
  304,5: KeyUp
  304,10: 
  ' reset every key first
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  breturnKey  = false
  
  If GraphicsWindow.LastKey = pauseKey then 
    LevelExplosion()
  EndIf
 
 
  If GraphicsWindow.LastKey = escapeKey and status = "start" then
    Program.End()
  EndIf

  
  If GraphicsWindow.LastKey = escapeKey And status = "game" then 
    LevelExplosion()
    stage = 0
    Shapes.Animate(titleshape, 140,170, 2500)
    Shapes.Animate(txtstart, 305,420, 3000)
    GraphicsWindow.BrushColor = "#3975e5"
    GraphicsWindow.FillRectangle(70,690,170,80)
    GraphicsWindow.FillRectangle(800,690,224,85)
    status = "start"
    ResetStars()
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = resetKey then 
    LevelExplosion()
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = pluskey then 
    LevelExplosion()
    'stage = stage + 1   'uncomment this line to cheat with F1
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf

  If GraphicsWindow.LastKey = minuskey then 
    'KeyUp()
    LevelExplosion()
    'stage = stage - 1  'uncomment this line to cheat with F2
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  'reload title after <escape>
  If GraphicsWindow.LastKey = returnKey and status = "start" then 
    Shapes.Animate(titleshape, 140,-350, 2000)
    Shapes.Animate(txtstart, 305, 1220, 1600)
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf

  364,1: EndSub

199 CR_token2
  304,10: 


105 CRStmtCRs_repeat1
  306,3:  reset every key first
  bleftKey    = false
  brightKey   = false
  bforwardKey = false
  bbackKey    = false
  breturnKey  = false
  
  If GraphicsWindow.LastKey = pauseKey then 
    LevelExplosion()
  EndIf
 
 
  If GraphicsWindow.LastKey = escapeKey and status = "start" then
    Program.End()
  EndIf

  
  If GraphicsWindow.LastKey = escapeKey And status = "game" then 
    LevelExplosion()
    stage = 0
    Shapes.Animate(titleshape, 140,170, 2500)
    Shapes.Animate(txtstart, 305,420, 3000)
    GraphicsWindow.BrushColor = "#3975e5"
    GraphicsWindow.FillRectangle(70,690,170,80)
    GraphicsWindow.FillRectangle(800,690,224,85)
    status = "start"
    ResetStars()
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = resetKey then 
    LevelExplosion()
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  If GraphicsWindow.LastKey = pluskey then 
    LevelExplosion()
    'stage = stage + 1   'uncomment this line to cheat with F1
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf

  If GraphicsWindow.LastKey = minuskey then 
    'KeyUp()
    LevelExplosion()
    'stage = stage - 1  'uncomment this line to cheat with F2
    status = "reset"
    resettime = Clock.ElapsedMilliseconds
  EndIf
  
  'reload title after <escape>
  If GraphicsWindow.LastKey = returnKey and status = "start" then 
    Shapes.Animate(titleshape, 140,-350, 2000)
    Shapes.Animate(txtstart, 305, 1220, 1600)
    status = "reset"
    resettime = Clock.Ela

105 ID = Expr
  306,3: bleftKey
  306,15: =
  306,17: false

184 = Expr
  306,15: =
  306,17: false

70 ID
  306,17: false

206 CR_token2
  306,22: 


106 ID = Expr
  307,3: brightKey
  307,15: =
  307,17: false

184 = Expr
  307,15: =
  307,17: false

70 ID
  307,17: false

206 CR_token2
  307,22: 


106 ID = Expr
  308,3: bforwardKey
  308,15: =
  308,17: false

184 = Expr
  308,15: =
  308,17: false

70 ID
  308,17: false

206 CR_token2
  308,22: 


106 ID = Expr
  309,3: bbackKey
  309,15: =
  309,17: false

184 = Expr
  309,15: =
  309,17: false

70 ID
  309,17: false

206 CR_token2
  309,22: 


106 ID = Expr
  310,3: breturnKey
  310,15: =
  310,17: false

184 = Expr
  310,15: =
  310,17: false

70 ID
  310,17: false

206 CR_token2
  310,22: 


106 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  312,3: If
  312,6: GraphicsWindow.LastKey = pauseKey
  312,40: then
  312,45: 
    LevelExplosion()

  314,3: EndIf

86 ID . ID
  312,6: GraphicsWindow
  312,20: .
  312,21: LastKey

4 . ID
  312,20: .
  312,21: LastKey

248 ID
  312,21: LastKey

128 = CompExpr
  312,29: =
  312,31: pauseKey

117 ID
  312,31: pauseKey

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  312,40: then
  312,45: 
    LevelExplosion()

  314,3: EndIf

124 CR_token2
  312,45: 


67 ID ( )
  313,5: LevelExplosion
  313,19: (
  313,20: )

184 ( )
  313,19: (
  313,20: )

261 )
  313,20: )

207 CR_token2
  313,21: 


122 OptionalElse_token1
  314,3: EndIf

206 CR_token2
  314,8: 


106 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  317,3: If
  317,6: GraphicsWindow.LastKey = escapeKey and status = "start"
  317,62: then
  317,66: 
    Program.End()

  319,3: EndIf

86 ID . ID
  317,6: GraphicsWindow
  317,20: .
  317,21: LastKey

4 . ID
  317,20: .
  317,21: LastKey

248 ID
  317,21: LastKey

128 = CompExpr
  317,29: =
  317,31: escapeKey

117 ID
  317,31: escapeKey

167 AndExpr_token1 EqNeqExpr
  317,41: and
  317,45: status = "start"

102 ID
  317,45: status

134 = CompExpr
  317,52: =
  317,54: "start"

117 STR
  317,54: "start"

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  317,62: then
  317,66: 
    Program.End()

  319,3: EndIf

124 CR_token2
  317,66: 


67 ID . ID ( )
  318,5: Program
  318,12: .
  318,13: End
  318,16: (
  318,17: )

184 . ID ( )
  318,12: .
  318,13: End
  318,16: (
  318,17: )

255 ID ( )
  318,13: End
  318,16: (
  318,17: )

221 ( )
  318,16: (
  318,17: )

27 )
  318,17: )

207 CR_token2
  318,18: 


122 OptionalElse_token1
  319,3: EndIf

206 CR_token2
  319,8: 



106 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  322,3: If
  322,6: GraphicsWindow.LastKey = escapeKey And status = "game"
  322,61: then
  322,66: 
    LevelExplosion()
    stage = 0
    Shapes.Animate(titleshape, 140,170, 2500)
    Shapes.Animate(txtstart, 305,420, 3000)
    GraphicsWindow.BrushColor = "#3975e5"
    GraphicsWindow.FillRectangle(70,690,170,80)
    GraphicsWindow.FillRectangle(800,690,224,85)
    status = "start"
    ResetStars()
    resettime = Clock.ElapsedMilliseconds

  333,3: EndIf

86 ID . ID
  322,6: GraphicsWindow
  322,20: .
  322,21: LastKey

4 . ID
  322,20: .
  322,21: LastKey

248 ID
  322,21: LastKey

128 = CompExpr
  322,29: =
  322,31: escapeKey

117 ID
  322,31: escapeKey

167 AndExpr_token1 EqNeqExpr
  322,41: And
  322,45: status = "game"

102 ID
  322,45: status

134 = CompExpr
  322,52: =
  322,54: "game"

117 STR
  322,54: "game"

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  322,61: then
  322,66: 
    LevelExplosion()
    stage = 0
    Shapes.Animate(titleshape, 140,170, 2500)
    Shapes.Animate(txtstart, 305,420, 3000)
    GraphicsWindow.BrushColor = "#3975e5"
    GraphicsWindow.FillRectangle(70,690,170,80)
    GraphicsWindow.FillRectangle(800,690,224,85)
    status = "start"
    ResetStars()
    resettime = Clock.ElapsedMilliseconds

  333,3: EndIf

124 CR_token2
  322,66: 


67 ID ( )
  323,5: LevelExplosion
  323,19: (
  323,20: )

184 ( )
  323,19: (
  323,20: )

261 )
  323,20: )

207 CR_token2
  323,21: 


68 ID = Expr
  324,5: stage
  324,11: =
  324,13: 0

184 = Expr
  324,11: =
  324,13: 0

70 NUM
  324,13: 0

207 CR_token2
  324,14: 


68 ID . ID ( Exprs )
  325,5: Shapes
  325,11: .
  325,12: Animate
  325,19: (
  325,20: titleshape, 140,170, 2500
  325,45: )

184 . ID ( Exprs )
  325,11: .
  325,12: Animate
  325,19: (
  325,20: titleshape, 140,170, 2500
  325,45: )

255 ID ( Exprs )
  325,12: Animate
  325,19: (
  325,20: titleshape, 140,170, 2500
  325,45: )

221 ( Exprs )
  325,19: (
  325,20: titleshape, 140,170, 2500
  325,45: )

27 ID
  325,20: titleshape

217 , MoreThanOneExpr
  325,30: ,
  325,32: 140,170, 2500

54 NUM
  325,32: 140

217 , MoreThanOneExpr
  325,35: ,
  325,36: 170, 2500

54 NUM
  325,36: 170

217 , MoreThanOneExpr
  325,39: ,
  325,41: 2500

54 NUM
  325,41: 2500

238 )
  325,45: )

207 CR_token2
  325,46: 


68 ID . ID ( Exprs )
  326,5: Shapes
  326,11: .
  326,12: Animate
  326,19: (
  326,20: txtstart, 305,420, 3000
  326,43: )

184 . ID ( Exprs )
  326,11: .
  326,12: Animate
  326,19: (
  326,20: txtstart, 305,420, 3000
  326,43: )

255 ID ( Exprs )
  326,12: Animate
  326,19: (
  326,20: txtstart, 305,420, 3000
  326,43: )

221 ( Exprs )
  326,19: (
  326,20: txtstart, 305,420, 3000
  326,43: )

27 ID
  326,20: txtstart

217 , MoreThanOneExpr
  326,28: ,
  326,30: 305,420, 3000

54 NUM
  326,30: 305

217 , MoreThanOneExpr
  326,33: ,
  326,34: 420, 3000

54 NUM
  326,34: 420

217 , MoreThanOneExpr
  326,37: ,
  326,39: 3000

54 NUM
  326,39: 3000

238 )
  326,43: )

207 CR_token2
  326,44: 


68 ID . ID = Expr
  327,5: GraphicsWindow
  327,19: .
  327,20: BrushColor
  327,31: =
  327,33: "#3975e5"

184 . ID = Expr
  327,19: .
  327,20: BrushColor
  327,31: =
  327,33: "#3975e5"

255 ID = Expr
  327,20: BrushColor
  327,31: =
  327,33: "#3975e5"

221 = Expr
  327,31: =
  327,33: "#3975e5"

57 STR
  327,33: "#3975e5"

207 CR_token2
  327,42: 


68 ID . ID ( Exprs )
  328,5: GraphicsWindow
  328,19: .
  328,20: FillRectangle
  328,33: (
  328,34: 70,690,170,80
  328,47: )

184 . ID ( Exprs )
  328,19: .
  328,20: FillRectangle
  328,33: (
  328,34: 70,690,170,80
  328,47: )

255 ID ( Exprs )
  328,20: FillRectangle
  328,33: (
  328,34: 70,690,170,80
  328,47: )

221 ( Exprs )
  328,33: (
  328,34: 70,690,170,80
  328,47: )

27 NUM
  328,34: 70

217 , MoreThanOneExpr
  328,36: ,
  328,37: 690,170,80

54 NUM
  328,37: 690

217 , MoreThanOneExpr
  328,40: ,
  328,41: 170,80

54 NUM
  328,41: 170

217 , MoreThanOneExpr
  328,44: ,
  328,45: 80

54 NUM
  328,45: 80

238 )
  328,47: )

207 CR_token2
  328,48: 


68 ID . ID ( Exprs )
  329,5: GraphicsWindow
  329,19: .
  329,20: FillRectangle
  329,33: (
  329,34: 800,690,224,85
  329,48: )

184 . ID ( Exprs )
  329,19: .
  329,20: FillRectangle
  329,33: (
  329,34: 800,690,224,85
  329,48: )

255 ID ( Exprs )
  329,20: FillRectangle
  329,33: (
  329,34: 800,690,224,85
  329,48: )

221 ( Exprs )
  329,33: (
  329,34: 800,690,224,85
  329,48: )

27 NUM
  329,34: 800

217 , MoreThanOneExpr
  329,37: ,
  329,38: 690,224,85

54 NUM
  329,38: 690

217 , MoreThanOneExpr
  329,41: ,
  329,42: 224,85

54 NUM
  329,42: 224

217 , MoreThanOneExpr
  329,45: ,
  329,46: 85

54 NUM
  329,46: 85

238 )
  329,48: )

207 CR_token2
  329,49: 


68 ID = Expr
  330,5: status
  330,12: =
  330,14: "start"

184 = Expr
  330,12: =
  330,14: "start"

70 STR
  330,14: "start"

207 CR_token2
  330,21: 


68 ID ( )
  331,5: ResetStars
  331,15: (
  331,16: )

184 ( )
  331,15: (
  331,16: )

261 )
  331,16: )

207 CR_token2
  331,17: 


68 ID = Expr
  332,5: resettime
  332,15: =
  332,17: Clock.ElapsedMilliseconds

184 = Expr
  332,15: =
  332,17: Clock.ElapsedMilliseconds

70 ID . ID
  332,17: Clock
  332,22: .
  332,23: ElapsedMilliseconds

5 . ID
  332,22: .
  332,23: ElapsedMilliseconds

260 ID
  332,23: ElapsedMilliseconds

207 CR_token2
  332,42: 


122 OptionalElse_token1
  333,3: EndIf

206 CR_token2
  333,8: 


106 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  335,3: If
  335,6: GraphicsWindow.LastKey = resetKey
  335,40: then
  335,45: 
    LevelExplosion()
    status = "reset"
    resettime = Clock.ElapsedMilliseconds

  339,3: EndIf

86 ID . ID
  335,6: GraphicsWindow
  335,20: .
  335,21: LastKey

4 . ID
  335,20: .
  335,21: LastKey

248 ID
  335,21: LastKey

128 = CompExpr
  335,29: =
  335,31: resetKey

117 ID
  335,31: resetKey

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  335,40: then
  335,45: 
    LevelExplosion()
    status = "reset"
    resettime = Clock.ElapsedMilliseconds

  339,3: EndIf

124 CR_token2
  335,45: 


67 ID ( )
  336,5: LevelExplosion
  336,19: (
  336,20: )

184 ( )
  336,19: (
  336,20: )

261 )
  336,20: )

207 CR_token2
  336,21: 


68 ID = Expr
  337,5: status
  337,12: =
  337,14: "reset"

184 = Expr
  337,12: =
  337,14: "reset"

70 STR
  337,14: "reset"

207 CR_token2
  337,21: 


68 ID = Expr
  338,5: resettime
  338,15: =
  338,17: Clock.ElapsedMilliseconds

184 = Expr
  338,15: =
  338,17: Clock.ElapsedMilliseconds

70 ID . ID
  338,17: Clock
  338,22: .
  338,23: ElapsedMilliseconds

5 . ID
  338,22: .
  338,23: ElapsedMilliseconds

260 ID
  338,23: ElapsedMilliseconds

207 CR_token2
  338,42: 


122 OptionalElse_token1
  339,3: EndIf

206 CR_token2
  339,8: 


106 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  341,3: If
  341,6: GraphicsWindow.LastKey = pluskey
  341,39: then
  341,44: 
    LevelExplosion()
    'stage = stage + 1   'uncomment this line to cheat with F1
    status = "reset"
    resettime = Clock.ElapsedMilliseconds

  346,3: EndIf

86 ID . ID
  341,6: GraphicsWindow
  341,20: .
  341,21: LastKey

4 . ID
  341,20: .
  341,21: LastKey

248 ID
  341,21: LastKey

128 = CompExpr
  341,29: =
  341,31: pluskey

117 ID
  341,31: pluskey

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  341,39: then
  341,44: 
    LevelExplosion()
    'stage = stage + 1   'uncomment this line to cheat with F1
    status = "reset"
    resettime = Clock.ElapsedMilliseconds

  346,3: EndIf

124 CR_token2
  341,44: 


67 ID ( )
  342,5: LevelExplosion
  342,19: (
  342,20: )

184 ( )
  342,19: (
  342,20: )

261 )
  342,20: )

207 CR_token2
  342,21: 


122 CRStmtCRs
  343,1:     'stage = stage + 1   'uncomment this line to cheat with F1
 

122 CR_token2
  343,63: 


67 ID = Expr
  344,5: status
  344,12: =
  344,14: "reset"

184 = Expr
  344,12: =
  344,14: "reset"

70 STR
  344,14: "reset"

207 CR_token2
  344,21: 


68 ID = Expr
  345,5: resettime
  345,15: =
  345,17: Clock.ElapsedMilliseconds

184 = Expr
  345,15: =
  345,17: Clock.ElapsedMilliseconds

70 ID . ID
  345,17: Clock
  345,22: .
  345,23: ElapsedMilliseconds

5 . ID
  345,22: .
  345,23: ElapsedMilliseconds

260 ID
  345,23: ElapsedMilliseconds

207 CR_token2
  345,42: 


122 OptionalElse_token1
  346,3: EndIf

206 CR_token2
  346,8: 



106 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  348,3: If
  348,6: GraphicsWindow.LastKey = minuskey
  348,40: then
  348,45: 
    'KeyUp()
    LevelExplosion()
    'stage = stage - 1  'uncomment this line to cheat with F2
    status = "reset"
    resettime = Clock.ElapsedMilliseconds

  354,3: EndIf

86 ID . ID
  348,6: GraphicsWindow
  348,20: .
  348,21: LastKey

4 . ID
  348,20: .
  348,21: LastKey

248 ID
  348,21: LastKey

128 = CompExpr
  348,29: =
  348,31: minuskey

117 ID
  348,31: minuskey

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  348,40: then
  348,45: 
    'KeyUp()
    LevelExplosion()
    'stage = stage - 1  'uncomment this line to cheat with F2
    status = "reset"
    resettime = Clock.ElapsedMilliseconds

  354,3: EndIf

124 CR_token2
  348,45: 


122 CRStmtCRs
  349,1:     'KeyUp()
    Level

122 CR_token2
  349,13: 


67 ID ( )
  350,5: LevelExplosion
  350,19: (
  350,20: )

184 ( )
  350,19: (
  350,20: )

261 )
  350,20: )

207 CR_token2
  350,21: 


122 CRStmtCRs
  351,1:     'stage = stage - 1  'uncomment this line to cheat with F2
  

122 CR_token2
  351,62: 


67 ID = Expr
  352,5: status
  352,12: =
  352,14: "reset"

184 = Expr
  352,12: =
  352,14: "reset"

70 STR
  352,14: "reset"

207 CR_token2
  352,21: 


68 ID = Expr
  353,5: resettime
  353,15: =
  353,17: Clock.ElapsedMilliseconds

184 = Expr
  353,15: =
  353,17: Clock.ElapsedMilliseconds

70 ID . ID
  353,17: Clock
  353,22: .
  353,23: ElapsedMilliseconds

5 . ID
  353,22: .
  353,23: ElapsedMilliseconds

260 ID
  353,23: ElapsedMilliseconds

207 CR_token2
  353,42: 


122 OptionalElse_token1
  354,3: EndIf

206 CR_token2
  354,8: 


106 TheRest
  356,3:   'reload title after <escape>
  If GraphicsWindow.LastKey = returnKey and status = "start" then 
    Shapes.Animate(titleshape, 140,-350, 2000)
    Shapes.Animate(txtstart, 305, 1220, 1600)
    status = "reset"
    resettime = C

106 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  357,3: If
  357,6: GraphicsWindow.LastKey = returnKey and status = "start"
  357,62: then
  357,67: 
    Shapes.Animate(titleshape, 140,-350, 2000)
    Shapes.Animate(txtstart, 305, 1220, 1600)
    status = "reset"
    resettime = Clock.ElapsedMilliseconds

  362,3: EndIf

86 ID . ID
  357,6: GraphicsWindow
  357,20: .
  357,21: LastKey

4 . ID
  357,20: .
  357,21: LastKey

248 ID
  357,21: LastKey

128 = CompExpr
  357,29: =
  357,31: returnKey

117 ID
  357,31: returnKey

167 AndExpr_token1 EqNeqExpr
  357,41: and
  357,45: status = "start"

102 ID
  357,45: status

134 = CompExpr
  357,52: =
  357,54: "start"

117 STR
  357,54: "start"

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  357,62: then
  357,67: 
    Shapes.Animate(titleshape, 140,-350, 2000)
    Shapes.Animate(txtstart, 305, 1220, 1600)
    status = "reset"
    resettime = Clock.ElapsedMilliseconds

  362,3: EndIf

124 CR_token2
  357,67: 


67 ID . ID ( Exprs )
  358,5: Shapes
  358,11: .
  358,12: Animate
  358,19: (
  358,20: titleshape, 140,-350, 2000
  358,46: )

184 . ID ( Exprs )
  358,11: .
  358,12: Animate
  358,19: (
  358,20: titleshape, 140,-350, 2000
  358,46: )

255 ID ( Exprs )
  358,12: Animate
  358,19: (
  358,20: titleshape, 140,-350, 2000
  358,46: )

221 ( Exprs )
  358,19: (
  358,20: titleshape, 140,-350, 2000
  358,46: )

27 ID
  358,20: titleshape

217 , MoreThanOneExpr
  358,30: ,
  358,32: 140,-350, 2000

54 NUM
  358,32: 140

217 , MoreThanOneExpr
  358,35: ,
  358,36: -350, 2000

54 - Primary
  358,36: -
  358,37: 350

197 NUM
  358,37: 350

217 , MoreThanOneExpr
  358,40: ,
  358,42: 2000

54 NUM
  358,42: 2000

238 )
  358,46: )

207 CR_token2
  358,47: 


68 ID . ID ( Exprs )
  359,5: Shapes
  359,11: .
  359,12: Animate
  359,19: (
  359,20: txtstart, 305, 1220, 1600
  359,45: )

184 . ID ( Exprs )
  359,11: .
  359,12: Animate
  359,19: (
  359,20: txtstart, 305, 1220, 1600
  359,45: )

255 ID ( Exprs )
  359,12: Animate
  359,19: (
  359,20: txtstart, 305, 1220, 1600
  359,45: )

221 ( Exprs )
  359,19: (
  359,20: txtstart, 305, 1220, 1600
  359,45: )

27 ID
  359,20: txtstart

217 , MoreThanOneExpr
  359,28: ,
  359,30: 305, 1220, 1600

54 NUM
  359,30: 305

217 , MoreThanOneExpr
  359,33: ,
  359,35: 1220, 1600

54 NUM
  359,35: 1220

217 , MoreThanOneExpr
  359,39: ,
  359,41: 1600

54 NUM
  359,41: 1600

238 )
  359,45: )

207 CR_token2
  359,46: 


68 ID = Expr
  360,5: status
  360,12: =
  360,14: "reset"

184 = Expr
  360,12: =
  360,14: "reset"

70 STR
  360,14: "reset"

207 CR_token2
  360,21: 


68 ID = Expr
  361,5: resettime
  361,15: =
  361,17: Clock.ElapsedMilliseconds

184 = Expr
  361,15: =
  361,17: Clock.ElapsedMilliseconds

70 ID . ID
  361,17: Clock
  361,22: .
  361,23: ElapsedMilliseconds

5 . ID
  361,22: .
  361,23: ElapsedMilliseconds

260 ID
  361,23: ElapsedMilliseconds

207 CR_token2
  361,42: 


122 OptionalElse_token1
  362,3: EndIf

206 CR_token2
  362,8: 


257 Stmt_token8
  364,1: EndSub

97 Stmt_token7 ID CRStmtCRs Stmt_token8
  368,1: Sub
  368,5: Input
  368,10: 
   
  If newmove >= 25  and blink = 0 then   
  
    'move right  
    If(brightKey   = true) and (level[posy][posx+1] <= 2) Then   
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  
  ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf          
  EndIf

  558,1: EndSub

244 ID CRStmtCRs Stmt_token8
  368,5: Input
  368,10: 
   
  If newmove >= 25  and blink = 0 then   
  
    'move right  
    If(brightKey   = true) and (level[posy][posx+1] <= 2) Then   
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  
  ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf          
  EndIf

  558,1: EndSub

199 CR_token2
  368,10: 


105 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  370,3: If
  370,6: newmove >= 25  and blink = 0
  370,35: then
  370,42: 
  
    'move right  
    If(brightKey   = true) and (level[posy][posx+1] <= 2) Then   
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  
  ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf          

  557,3: EndIf

86 ID
  370,6: newmove

91 >= AdditiveExpr
  370,14: >=
  370,17: 25

131 NUM
  370,17: 25

167 AndExpr_token1 EqNeqExpr
  370,21: and
  370,25: blink = 0

102 ID
  370,25: blink

134 = CompExpr
  370,31: =
  370,33: 0

117 NUM
  370,33: 0

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  370,35: then
  370,42: 
  
    'move right  
    If(brightKey   = true) and (level[posy][posx+1] <= 2) Then   
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  
  ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf          

  557,3: EndIf

124 CR_token2
  370,42: 


122 CR_token2
  371,3: 


122 CRStmtCRs
  372,1:     'move right  
    If(brightKey   = true) and (level[posy][posx+1] <= 2) Then   
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  
  ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
   

122 CR_token2
  372,18: 


67 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  373,5: If
  373,7: (brightKey   = true) and (level[posy][posx+1] <= 2)
  373,59: Then
  373,66: 
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  

  419,3: ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf

86 ( Expr )
  373,7: (
  373,8: brightKey   = true
  373,26: )

80 ID
  373,8: brightKey

128 = CompExpr
  373,20: =
  373,22: true

117 ID
  373,22: true

265 )
  373,26: )

167 AndExpr_token1 EqNeqExpr
  373,28: and
  373,32: (level[posy][posx+1] <= 2)

102 ( Expr )
  373,32: (
  373,33: level[posy][posx+1] <= 2
  373,57: )

80 ID Idxs
  373,33: level
  373,38: [posy][posx+1]

4 [ Expr ] Idxs
  373,38: [
  373,39: posy
  373,43: ]
  373,44: [posx+1]

76 ID
  373,39: posy

245 ] Idxs
  373,43: ]
  373,44: [posx+1]

7 [ Expr ]
  373,44: [
  373,45: posx+1
  373,51: ]

76 ID
  373,45: posx

65 + MultiplicativeExpr
  373,49: +
  373,50: 1

141 NUM
  373,50: 1

245 ]
  373,51: ]

91 <= AdditiveExpr
  373,53: <=
  373,56: 2

131 NUM
  373,56: 2

265 )
  373,57: )

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  373,59: Then
  373,66: 
      'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    
      EndIf
      'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif
  'move left  

  419,3: ElseIf( bleftKey    = true) and (level[posy][posx-1]<= 2) Then
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  
    ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf

124 CR_token2
  373,66: 


122 CRStmtCRs
  374,1:       'move crystal
      if level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3) Then
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        end

122 CR_token2
  374,20: 


67 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  375,7: if
  375,10: level[posy][posx+1] = 2 and ground[posy][posx+1] <= 1 And (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3)
  375,123: Then
  375,127: 
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    

  402,7: EndIf

86 ID Idxs
  375,10: level
  375,15: [posy][posx+1]

4 [ Expr ] Idxs
  375,15: [
  375,16: posy
  375,20: ]
  375,21: [posx+1]

76 ID
  375,16: posy

245 ] Idxs
  375,20: ]
  375,21: [posx+1]

7 [ Expr ]
  375,21: [
  375,22: posx+1
  375,28: ]

76 ID
  375,22: posx

65 + MultiplicativeExpr
  375,26: +
  375,27: 1

141 NUM
  375,27: 1

245 ]
  375,28: ]

128 = CompExpr
  375,30: =
  375,32: 2

117 NUM
  375,32: 2

167 AndExpr_token1 EqNeqExpr
  375,34: and
  375,38: ground[posy][posx+1] <= 1

102 ID Idxs
  375,38: ground
  375,44: [posy][posx+1]

4 [ Expr ] Idxs
  375,44: [
  375,45: posy
  375,49: ]
  375,50: [posx+1]

76 ID
  375,45: posy

245 ] Idxs
  375,49: ]
  375,50: [posx+1]

7 [ Expr ]
  375,50: [
  375,51: posx+1
  375,57: ]

76 ID
  375,51: posx

65 + MultiplicativeExpr
  375,55: +
  375,56: 1

141 NUM
  375,56: 1

245 ]
  375,57: ]

91 <= AdditiveExpr
  375,59: <=
  375,62: 1

131 NUM
  375,62: 1

167 AndExpr_token1 EqNeqExpr
  375,64: And
  375,68: (level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3)

102 ( Expr )
  375,68: (
  375,69: level[posy][posx+2] <= 1 or ground[posy][posx+2] = 3
  375,121: )

80 ID Idxs
  375,69: level
  375,74: [posy][posx+2]

4 [ Expr ] Idxs
  375,74: [
  375,75: posy
  375,79: ]
  375,80: [posx+2]

76 ID
  375,75: posy

245 ] Idxs
  375,79: ]
  375,80: [posx+2]

7 [ Expr ]
  375,80: [
  375,81: posx+2
  375,87: ]

76 ID
  375,81: posx

65 + MultiplicativeExpr
  375,85: +
  375,86: 2

141 NUM
  375,86: 2

245 ]
  375,87: ]

91 <= AdditiveExpr
  375,89: <=
  375,92: 1

131 NUM
  375,92: 1

183 OrExpr_token1 AndExpr
  375,94: or
  375,97: ground[posy][posx+2] = 3

100 ID Idxs
  375,97: ground
  375,103: [posy][posx+2]

4 [ Expr ] Idxs
  375,103: [
  375,104: posy
  375,108: ]
  375,109: [posx+2]

76 ID
  375,104: posy

245 ] Idxs
  375,108: ]
  375,109: [posx+2]

7 [ Expr ]
  375,109: [
  375,110: posx+2
  375,116: ]

76 ID
  375,110: posx

65 + MultiplicativeExpr
  375,114: +
  375,115: 2

141 NUM
  375,115: 2

245 ]
  375,116: ]

128 = CompExpr
  375,118: =
  375,120: 3

117 NUM
  375,120: 3

265 )
  375,121: )

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  375,123: Then
  375,127: 
        chestarray[posy][posx+2] = chestarray[posy][posx+1]
        chestarray[posy][posx+1] = 99 
        level[posy][posx+1] = ground[posy][posx+1]
        level[posy][posx+2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2
        EndIf
        'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif    

  402,7: EndIf

124 CR_token2
  375,127: 


67 ID Idxs = Expr
  376,9: chestarray
  376,19: [posy][posx+2]
  376,34: =
  376,36: chestarray[posy][posx+1]

184 [ Expr ] Idxs
  376,19: [
  376,20: posy
  376,24: ]
  376,25: [posx+2]

76 ID
  376,20: posy

245 ] Idxs
  376,24: ]
  376,25: [posx+2]

7 [ Expr ]
  376,25: [
  376,26: posx+2
  376,32: ]

76 ID
  376,26: posx

65 + MultiplicativeExpr
  376,30: +
  376,31: 2

141 NUM
  376,31: 2

245 ]
  376,32: ]

263 = Expr
  376,34: =
  376,36: chestarray[posy][posx+1]

55 ID Idxs
  376,36: chestarray
  376,46: [posy][posx+1]

5 [ Expr ] Idxs
  376,46: [
  376,47: posy
  376,51: ]
  376,52: [posx+1]

81 ID
  376,47: posy

233 ] Idxs
  376,51: ]
  376,52: [posx+1]

8 [ Expr ]
  376,52: [
  376,53: posx+1
  376,59: ]

81 ID
  376,53: posx

65 + MultiplicativeExpr
  376,57: +
  376,58: 1

141 NUM
  376,58: 1

233 ]
  376,59: ]

207 CR_token2
  376,60: 


68 ID Idxs = Expr
  377,9: chestarray
  377,19: [posy][posx+1]
  377,34: =
  377,36: 99

184 [ Expr ] Idxs
  377,19: [
  377,20: posy
  377,24: ]
  377,25: [posx+1]

76 ID
  377,20: posy

245 ] Idxs
  377,24: ]
  377,25: [posx+1]

7 [ Expr ]
  377,25: [
  377,26: posx+1
  377,32: ]

76 ID
  377,26: posx

65 + MultiplicativeExpr
  377,30: +
  377,31: 1

141 NUM
  377,31: 1

245 ]
  377,32: ]

263 = Expr
  377,34: =
  377,36: 99

55 NUM
  377,36: 99

207 CR_token2
  377,39: 


68 ID Idxs = Expr
  378,9: level
  378,14: [posy][posx+1]
  378,29: =
  378,31: ground[posy][posx+1]

184 [ Expr ] Idxs
  378,14: [
  378,15: posy
  378,19: ]
  378,20: [posx+1]

76 ID
  378,15: posy

245 ] Idxs
  378,19: ]
  378,20: [posx+1]

7 [ Expr ]
  378,20: [
  378,21: posx+1
  378,27: ]

76 ID
  378,21: posx

65 + MultiplicativeExpr
  378,25: +
  378,26: 1

141 NUM
  378,26: 1

245 ]
  378,27: ]

263 = Expr
  378,29: =
  378,31: ground[posy][posx+1]

55 ID Idxs
  378,31: ground
  378,37: [posy][posx+1]

5 [ Expr ] Idxs
  378,37: [
  378,38: posy
  378,42: ]
  378,43: [posx+1]

81 ID
  378,38: posy

233 ] Idxs
  378,42: ]
  378,43: [posx+1]

8 [ Expr ]
  378,43: [
  378,44: posx+1
  378,50: ]

81 ID
  378,44: posx

65 + MultiplicativeExpr
  378,48: +
  378,49: 1

141 NUM
  378,49: 1

233 ]
  378,50: ]

207 CR_token2
  378,51: 


68 ID Idxs = Expr
  379,9: level
  379,14: [posy][posx+2]
  379,29: =
  379,31: 2

184 [ Expr ] Idxs
  379,14: [
  379,15: posy
  379,19: ]
  379,20: [posx+2]

76 ID
  379,15: posy

245 ] Idxs
  379,19: ]
  379,20: [posx+2]

7 [ Expr ]
  379,20: [
  379,21: posx+2
  379,27: ]

76 ID
  379,21: posx

65 + MultiplicativeExpr
  379,25: +
  379,26: 2

141 NUM
  379,26: 2

245 ]
  379,27: ]

263 = Expr
  379,29: =
  379,31: 2

55 NUM
  379,31: 2

207 CR_token2
  379,35: 


68 ID . ID ( Exprs )
  380,9: Sound
  380,14: .
  380,15: Stop
  380,19: (
  380,20: Path + "/sokocute01.wav"
  380,44: )

184 . ID ( Exprs )
  380,14: .
  380,15: Stop
  380,19: (
  380,20: Path + "/sokocute01.wav"
  380,44: )

255 ID ( Exprs )
  380,15: Stop
  380,19: (
  380,20: Path + "/sokocute01.wav"
  380,44: )

221 ( Exprs )
  380,19: (
  380,20: Path + "/sokocute01.wav"
  380,44: )

27 ID
  380,20: Path

65 + MultiplicativeExpr
  380,25: +
  380,27: "/sokocute01.wav"

141 STR
  380,27: "/sokocute01.wav"

238 )
  380,44: )

207 CR_token2
  380,45: 


68 ID . ID ( Exprs )
  381,9: Sound
  381,14: .
  381,15: Play
  381,19: (
  381,20: Path + "/sokocute01.wav"
  381,44: )

184 . ID ( Exprs )
  381,14: .
  381,15: Play
  381,19: (
  381,20: Path + "/sokocute01.wav"
  381,44: )

255 ID ( Exprs )
  381,15: Play
  381,19: (
  381,20: Path + "/sokocute01.wav"
  381,44: )

221 ( Exprs )
  381,19: (
  381,20: Path + "/sokocute01.wav"
  381,44: )

27 ID
  381,20: Path

65 + MultiplicativeExpr
  381,25: +
  381,27: "/sokocute01.wav"

141 STR
  381,27: "/sokocute01.wav"

238 )
  381,44: )

207 CR_token2
  381,45: 


122 CRStmtCRs
  382,1:         'move crystal into water
        If ground[posy][posx+2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
         

122 CR_token2
  382,33: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  383,9: If
  383,12: ground[posy][posx+2] = 3
  383,37: then
  383,41: 
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1

  387,9: EndIf

86 ID Idxs
  383,12: ground
  383,18: [posy][posx+2]

4 [ Expr ] Idxs
  383,18: [
  383,19: posy
  383,23: ]
  383,24: [posx+2]

76 ID
  383,19: posy

245 ] Idxs
  383,23: ]
  383,24: [posx+2]

7 [ Expr ]
  383,24: [
  383,25: posx+2
  383,31: ]

76 ID
  383,25: posx

65 + MultiplicativeExpr
  383,29: +
  383,30: 2

141 NUM
  383,30: 2

245 ]
  383,31: ]

128 = CompExpr
  383,33: =
  383,35: 3

117 NUM
  383,35: 3

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  383,37: then
  383,41: 
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx+2]
          gemzoom = 1

  387,9: EndIf

124 CR_token2
  383,41: 


67 ID = Expr
  384,11: watertime
  384,21: =
  384,23: Clock.ElapsedMilliseconds

184 = Expr
  384,21: =
  384,23: Clock.ElapsedMilliseconds

70 ID . ID
  384,23: Clock
  384,28: .
  384,29: ElapsedMilliseconds

5 . ID
  384,28: .
  384,29: ElapsedMilliseconds

260 ID
  384,29: ElapsedMilliseconds

207 CR_token2
  384,48: 


68 ID = Expr
  385,11: gemwater
  385,20: =
  385,22: chestarray[posy][posx+2]

184 = Expr
  385,20: =
  385,22: chestarray[posy][posx+2]

70 ID Idxs
  385,22: chestarray
  385,32: [posy][posx+2]

5 [ Expr ] Idxs
  385,32: [
  385,33: posy
  385,37: ]
  385,38: [posx+2]

81 ID
  385,33: posy

233 ] Idxs
  385,37: ]
  385,38: [posx+2]

8 [ Expr ]
  385,38: [
  385,39: posx+2
  385,45: ]

81 ID
  385,39: posx

65 + MultiplicativeExpr
  385,43: +
  385,44: 2

141 NUM
  385,44: 2

233 ]
  385,45: ]

207 CR_token2
  385,46: 


68 ID = Expr
  386,11: gemzoom
  386,19: =
  386,21: 1

184 = Expr
  386,19: =
  386,21: 1

70 NUM
  386,21: 1

207 CR_token2
  386,22: 


122 OptionalElse_token1
  387,9: EndIf

207 CR_token2
  387,14: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  388,9: If
  388,12: (ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0) Or (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1)
  388,129: then
  388,133: 
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2

  393,9: EndIf

86 ( Expr )
  388,12: (
  388,13: ground[posy][posx+2] = 1 and ground[posy][posx+1] <= 0
  388,67: )

80 ID Idxs
  388,13: ground
  388,19: [posy][posx+2]

4 [ Expr ] Idxs
  388,19: [
  388,20: posy
  388,24: ]
  388,25: [posx+2]

76 ID
  388,20: posy

245 ] Idxs
  388,24: ]
  388,25: [posx+2]

7 [ Expr ]
  388,25: [
  388,26: posx+2
  388,32: ]

76 ID
  388,26: posx

65 + MultiplicativeExpr
  388,30: +
  388,31: 2

141 NUM
  388,31: 2

245 ]
  388,32: ]

128 = CompExpr
  388,34: =
  388,36: 1

117 NUM
  388,36: 1

167 AndExpr_token1 EqNeqExpr
  388,38: and
  388,42: ground[posy][posx+1] <= 0

102 ID Idxs
  388,42: ground
  388,48: [posy][posx+1]

4 [ Expr ] Idxs
  388,48: [
  388,49: posy
  388,53: ]
  388,54: [posx+1]

76 ID
  388,49: posy

245 ] Idxs
  388,53: ]
  388,54: [posx+1]

7 [ Expr ]
  388,54: [
  388,55: posx+1
  388,61: ]

76 ID
  388,55: posx

65 + MultiplicativeExpr
  388,59: +
  388,60: 1

141 NUM
  388,60: 1

245 ]
  388,61: ]

91 <= AdditiveExpr
  388,63: <=
  388,66: 0

131 NUM
  388,66: 0

265 )
  388,67: )

183 OrExpr_token1 AndExpr
  388,69: Or
  388,72: (ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1)

100 ( Expr )
  388,72: (
  388,73: ground[posy][posx+2] <= 0 and ground[posy][posx+1] = 1
  388,127: )

80 ID Idxs
  388,73: ground
  388,79: [posy][posx+2]

4 [ Expr ] Idxs
  388,79: [
  388,80: posy
  388,84: ]
  388,85: [posx+2]

76 ID
  388,80: posy

245 ] Idxs
  388,84: ]
  388,85: [posx+2]

7 [ Expr ]
  388,85: [
  388,86: posx+2
  388,92: ]

76 ID
  388,86: posx

65 + MultiplicativeExpr
  388,90: +
  388,91: 2

141 NUM
  388,91: 2

245 ]
  388,92: ]

91 <= AdditiveExpr
  388,94: <=
  388,97: 0

131 NUM
  388,97: 0

167 AndExpr_token1 EqNeqExpr
  388,99: and
  388,103: ground[posy][posx+1] = 1

102 ID Idxs
  388,103: ground
  388,109: [posy][posx+1]

4 [ Expr ] Idxs
  388,109: [
  388,110: posy
  388,114: ]
  388,115: [posx+1]

76 ID
  388,110: posy

245 ] Idxs
  388,114: ]
  388,115: [posx+1]

7 [ Expr ]
  388,115: [
  388,116: posx+1
  388,122: ]

76 ID
  388,116: posx

65 + MultiplicativeExpr
  388,120: +
  388,121: 1

141 NUM
  388,121: 1

245 ]
  388,122: ]

134 = CompExpr
  388,124: =
  388,126: 1

117 NUM
  388,126: 1

265 )
  388,127: )

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  388,129: then
  388,133: 
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx+2]
          gemy    = posy
          gemx    = posx+2

  393,9: EndIf

124 CR_token2
  388,133: 


67 ID = Expr
  389,11: gemtime
  389,19: =
  389,21: Clock.ElapsedMilliseconds

184 = Expr
  389,19: =
  389,21: Clock.ElapsedMilliseconds

70 ID . ID
  389,21: Clock
  389,26: .
  389,27: ElapsedMilliseconds

5 . ID
  389,26: .
  389,27: ElapsedMilliseconds

260 ID
  389,27: ElapsedMilliseconds

207 CR_token2
  389,46: 


68 ID = Expr
  390,11: gemchng
  390,19: =
  390,21: chestarray[posy][posx+2]

184 = Expr
  390,19: =
  390,21: chestarray[posy][posx+2]

70 ID Idxs
  390,21: chestarray
  390,31: [posy][posx+2]

5 [ Expr ] Idxs
  390,31: [
  390,32: posy
  390,36: ]
  390,37: [posx+2]

81 ID
  390,32: posy

233 ] Idxs
  390,36: ]
  390,37: [posx+2]

8 [ Expr ]
  390,37: [
  390,38: posx+2
  390,44: ]

81 ID
  390,38: posx

65 + MultiplicativeExpr
  390,42: +
  390,43: 2

141 NUM
  390,43: 2

233 ]
  390,44: ]

207 CR_token2
  390,45: 


68 ID = Expr
  391,11: gemy
  391,19: =
  391,21: posy

184 = Expr
  391,19: =
  391,21: posy

70 ID
  391,21: posy

207 CR_token2
  391,25: 


68 ID = Expr
  392,11: gemx
  392,19: =
  392,21: posx+2

184 = Expr
  392,19: =
  392,21: posx+2

70 ID
  392,21: posx

59 + MultiplicativeExpr
  392,25: +
  392,26: 2

144 NUM
  392,26: 2

207 CR_token2
  392,27: 


122 OptionalElse_token1
  393,9: EndIf

207 CR_token2
  393,14: 


122 CRStmtCRs
  394,1:         'animate crystal
        if ground[posy][posx+1] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 4

122 CR_token2
  394,25: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  395,9: if
  395,12: ground[posy][posx+1] = 1
  395,37: then
  395,41: 
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  

  397,9: elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif

86 ID Idxs
  395,12: ground
  395,18: [posy][posx+1]

4 [ Expr ] Idxs
  395,18: [
  395,19: posy
  395,23: ]
  395,24: [posx+1]

76 ID
  395,19: posy

245 ] Idxs
  395,23: ]
  395,24: [posx+1]

7 [ Expr ]
  395,24: [
  395,25: posx+1
  395,31: ]

76 ID
  395,25: posx

65 + MultiplicativeExpr
  395,29: +
  395,30: 1

141 NUM
  395,30: 1

245 ]
  395,31: ]

128 = CompExpr
  395,33: =
  395,35: 1

117 NUM
  395,35: 1

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  395,37: then
  395,41: 
          Shapes.Animate(crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  

  397,9: elseif ground[posy][posx+2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif

124 CR_token2
  395,41: 


67 ID . ID ( Exprs )
  396,11: Shapes
  396,17: .
  396,18: Animate
  396,25: (
  396,26: crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400
  396,108: )

184 . ID ( Exprs )
  396,17: .
  396,18: Animate
  396,25: (
  396,26: crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400
  396,108: )

255 ID ( Exprs )
  396,18: Animate
  396,25: (
  396,26: crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400
  396,108: )

221 ( Exprs )
  396,25: (
  396,26: crystalbnk[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400
  396,108: )

27 ID Idxs
  396,26: crystalbnk
  396,36: [chestarray[posy][posx+2]]

4 [ Expr ]
  396,36: [
  396,37: chestarray[posy][posx+2]
  396,61: ]

76 ID Idxs
  396,37: chestarray
  396,47: [posy][posx+2]

4 [ Expr ] Idxs
  396,47: [
  396,48: posy
  396,52: ]
  396,53: [posx+2]

76 ID
  396,48: posy

245 ] Idxs
  396,52: ]
  396,53: [posx+2]

7 [ Expr ]
  396,53: [
  396,54: posx+2
  396,60: ]

76 ID
  396,54: posx

65 + MultiplicativeExpr
  396,58: +
  396,59: 2

141 NUM
  396,59: 2

245 ]
  396,60: ]

245 ]
  396,61: ]

217 , MoreThanOneExpr
  396,63: ,
  396,65: (posx+2) * 50 + korrx, (posy) * 40 - 0, 400

54 ( Expr )
  396,65: (
  396,66: posx+2
  396,72: )

80 ID
  396,66: posx

65 + MultiplicativeExpr
  396,70: +
  396,71: 2

141 NUM
  396,71: 2

265 )
  396,72: )

50 * UnaryExpr
  396,74: *
  396,76: 50

156 NUM
  396,76: 50

65 + MultiplicativeExpr
  396,79: +
  396,81: korrx

141 ID
  396,81: korrx

217 , MoreThanOneExpr
  396,86: ,
  396,88: (posy) * 40 - 0, 400

54 ( Expr )
  396,88: (
  396,89: posy
  396,93: )

80 ID
  396,89: posy

265 )
  396,93: )

50 * UnaryExpr
  396,95: *
  396,97: 40

156 NUM
  396,97: 40

65 - MultiplicativeExpr
  396,100: -
  396,102: 0

141 NUM
  396,102: 0

217 , MoreThanOneExpr
  396,103: ,
  396,105: 400

54 NUM
  396,105: 400

238 )
  396,108: )

207 CR_token2
  396,111: 


122 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  397,9: elseif
  397,16: ground[posy][posx+2] = 3
  397,41: then
  397,45: 
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  

  399,9: else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif

82 ID Idxs
  397,16: ground
  397,22: [posy][posx+2]

4 [ Expr ] Idxs
  397,22: [
  397,23: posy
  397,27: ]
  397,28: [posx+2]

76 ID
  397,23: posy

245 ] Idxs
  397,27: ]
  397,28: [posx+2]

7 [ Expr ]
  397,28: [
  397,29: posx+2
  397,35: ]

76 ID
  397,29: posx

65 + MultiplicativeExpr
  397,33: +
  397,34: 2

141 NUM
  397,34: 2

245 ]
  397,35: ]

128 = CompExpr
  397,37: =
  397,39: 3

117 NUM
  397,39: 3

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  397,41: then
  397,45: 
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  

  399,9: else
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif

118 CR_token2
  397,45: 


67 ID . ID ( Exprs )
  398,11: Shapes
  398,17: .
  398,18: Animate
  398,25: (
  398,26: crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400
  398,108: )

184 . ID ( Exprs )
  398,17: .
  398,18: Animate
  398,25: (
  398,26: crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400
  398,108: )

255 ID ( Exprs )
  398,18: Animate
  398,25: (
  398,26: crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400
  398,108: )

221 ( Exprs )
  398,25: (
  398,26: crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400
  398,108: )

27 ID Idxs
  398,26: crystalimg
  398,36: [chestarray[posy][posx+2]]

4 [ Expr ]
  398,36: [
  398,37: chestarray[posy][posx+2]
  398,61: ]

76 ID Idxs
  398,37: chestarray
  398,47: [posy][posx+2]

4 [ Expr ] Idxs
  398,47: [
  398,48: posy
  398,52: ]
  398,53: [posx+2]

76 ID
  398,48: posy

245 ] Idxs
  398,52: ]
  398,53: [posx+2]

7 [ Expr ]
  398,53: [
  398,54: posx+2
  398,60: ]

76 ID
  398,54: posx

65 + MultiplicativeExpr
  398,58: +
  398,59: 2

141 NUM
  398,59: 2

245 ]
  398,60: ]

245 ]
  398,61: ]

217 , MoreThanOneExpr
  398,63: ,
  398,65: (posx+2) * 50 + korrx, (posy) * 40 - 0, 400

54 ( Expr )
  398,65: (
  398,66: posx+2
  398,72: )

80 ID
  398,66: posx

65 + MultiplicativeExpr
  398,70: +
  398,71: 2

141 NUM
  398,71: 2

265 )
  398,72: )

50 * UnaryExpr
  398,74: *
  398,76: 50

156 NUM
  398,76: 50

65 + MultiplicativeExpr
  398,79: +
  398,81: korrx

141 ID
  398,81: korrx

217 , MoreThanOneExpr
  398,86: ,
  398,88: (posy) * 40 - 0, 400

54 ( Expr )
  398,88: (
  398,89: posy
  398,93: )

80 ID
  398,89: posy

265 )
  398,93: )

50 * UnaryExpr
  398,95: *
  398,97: 40

156 NUM
  398,97: 40

65 - MultiplicativeExpr
  398,100: -
  398,102: 0

141 NUM
  398,102: 0

217 , MoreThanOneExpr
  398,103: ,
  398,105: 400

54 NUM
  398,105: 400

238 )
  398,108: )

207 CR_token2
  398,111: 


115 OptionalElse_token2 CRStmtCRs OptionalElse_token1
  399,9: else
  399,13: 
          Shapes.Animate(crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400)  

  401,9: endif

201 CR_token2
  399,13: 


113 ID . ID ( Exprs )
  400,11: Shapes
  400,17: .
  400,18: Animate
  400,25: (
  400,26: crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400
  400,108: )

184 . ID ( Exprs )
  400,17: .
  400,18: Animate
  400,25: (
  400,26: crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400
  400,108: )

255 ID ( Exprs )
  400,18: Animate
  400,25: (
  400,26: crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400
  400,108: )

221 ( Exprs )
  400,25: (
  400,26: crystalimg[chestarray[posy][posx+2]] , (posx+2) * 50 + korrx, (posy) * 40 - 0, 400
  400,108: )

27 ID Idxs
  400,26: crystalimg
  400,36: [chestarray[posy][posx+2]]

4 [ Expr ]
  400,36: [
  400,37: chestarray[posy][posx+2]
  400,61: ]

76 ID Idxs
  400,37: chestarray
  400,47: [posy][posx+2]

4 [ Expr ] Idxs
  400,47: [
  400,48: posy
  400,52: ]
  400,53: [posx+2]

76 ID
  400,48: posy

245 ] Idxs
  400,52: ]
  400,53: [posx+2]

7 [ Expr ]
  400,53: [
  400,54: posx+2
  400,60: ]

76 ID
  400,54: posx

65 + MultiplicativeExpr
  400,58: +
  400,59: 2

141 NUM
  400,59: 2

245 ]
  400,60: ]

245 ]
  400,61: ]

217 , MoreThanOneExpr
  400,63: ,
  400,65: (posx+2) * 50 + korrx, (posy) * 40 - 0, 400

54 ( Expr )
  400,65: (
  400,66: posx+2
  400,72: )

80 ID
  400,66: posx

65 + MultiplicativeExpr
  400,70: +
  400,71: 2

141 NUM
  400,71: 2

265 )
  400,72: )

50 * UnaryExpr
  400,74: *
  400,76: 50

156 NUM
  400,76: 50

65 + MultiplicativeExpr
  400,79: +
  400,81: korrx

141 ID
  400,81: korrx

217 , MoreThanOneExpr
  400,86: ,
  400,88: (posy) * 40 - 0, 400

54 ( Expr )
  400,88: (
  400,89: posy
  400,93: )

80 ID
  400,89: posy

265 )
  400,93: )

50 * UnaryExpr
  400,95: *
  400,97: 40

156 NUM
  400,97: 40

65 - MultiplicativeExpr
  400,100: -
  400,102: 0

141 NUM
  400,102: 0

217 , MoreThanOneExpr
  400,103: ,
  400,105: 400

54 NUM
  400,105: 400

238 )
  400,108: )

202 CR_token2
  400,111: 


237 OptionalElse_token1
  401,9: endif

207 CR_token2
  401,18: 


122 OptionalElse_token1
  402,7: EndIf

207 CR_token2
  402,12: 


122 CRStmtCRs
  403,1:       'move player right      
      If level[posy][posx+1] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690,

122 CR_token2
  403,31: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  404,7: If
  404,10: level[posy][posx+1] <= 1
  404,35: then
  404,39: 
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)

  417,7: Endif

86 ID Idxs
  404,10: level
  404,15: [posy][posx+1]

4 [ Expr ] Idxs
  404,15: [
  404,16: posy
  404,20: ]
  404,21: [posx+1]

76 ID
  404,16: posy

245 ] Idxs
  404,20: ]
  404,21: [posx+1]

7 [ Expr ]
  404,21: [
  404,22: posx+1
  404,28: ]

76 ID
  404,22: posx

65 + MultiplicativeExpr
  404,26: +
  404,27: 1

141 NUM
  404,27: 1

245 ]
  404,28: ]

91 <= AdditiveExpr
  404,30: <=
  404,33: 1

131 NUM
  404,33: 1

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  404,35: then
  404,39: 
        moves   = moves + 1
        newmove = 0
        movex   = 2
        movey   = 0  
        posx = posx + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)

  417,7: Endif

124 CR_token2
  404,39: 


67 ID = Expr
  405,9: moves
  405,17: =
  405,19: moves + 1

184 = Expr
  405,17: =
  405,19: moves + 1

70 ID
  405,19: moves

59 + MultiplicativeExpr
  405,25: +
  405,27: 1

144 NUM
  405,27: 1

207 CR_token2
  405,28: 


68 ID = Expr
  406,9: newmove
  406,17: =
  406,19: 0

184 = Expr
  406,17: =
  406,19: 0

70 NUM
  406,19: 0

207 CR_token2
  406,20: 


68 ID = Expr
  407,9: movex
  407,17: =
  407,19: 2

184 = Expr
  407,17: =
  407,19: 2

70 NUM
  407,19: 2

207 CR_token2
  407,20: 


68 ID = Expr
  408,9: movey
  408,17: =
  408,19: 0

184 = Expr
  408,17: =
  408,19: 0

70 NUM
  408,19: 0

207 CR_token2
  408,22: 


68 ID = Expr
  409,9: posx
  409,14: =
  409,16: posx + 1

184 = Expr
  409,14: =
  409,16: posx + 1

70 ID
  409,16: posx

59 + MultiplicativeExpr
  409,21: +
  409,23: 1

144 NUM
  409,23: 1

207 CR_token2
  409,24: 


68 ID = Expr
  410,9: gametime
  410,18: =
  410,20: Clock.ElapsedMilliseconds

184 = Expr
  410,18: =
  410,20: Clock.ElapsedMilliseconds

70 ID . ID
  410,20: Clock
  410,25: .
  410,26: ElapsedMilliseconds

5 . ID
  410,25: .
  410,26: ElapsedMilliseconds

260 ID
  410,26: ElapsedMilliseconds

207 CR_token2
  410,45: 


68 ID . ID = Expr
  411,9: GraphicsWindow
  411,23: .
  411,24: BrushColor
  411,35: =
  411,37: "#3975e5"

184 . ID = Expr
  411,23: .
  411,24: BrushColor
  411,35: =
  411,37: "#3975e5"

255 ID = Expr
  411,24: BrushColor
  411,35: =
  411,37: "#3975e5"

221 = Expr
  411,35: =
  411,37: "#3975e5"

57 STR
  411,37: "#3975e5"

207 CR_token2
  411,46: 


68 ID . ID = Expr
  412,9: GraphicsWindow
  412,23: .
  412,24: FontName
  412,33: =
  412,35: "COMIC SANS MS"

184 . ID = Expr
  412,23: .
  412,24: FontName
  412,33: =
  412,35: "COMIC SANS MS"

255 ID = Expr
  412,24: FontName
  412,33: =
  412,35: "COMIC SANS MS"

221 = Expr
  412,33: =
  412,35: "COMIC SANS MS"

57 STR
  412,35: "COMIC SANS MS"

207 CR_token2
  412,50: 


68 ID . ID = Expr
  413,9: GraphicsWindow
  413,23: .
  413,24: FontSize
  413,33: =
  413,35: 25

184 . ID = Expr
  413,23: .
  413,24: FontSize
  413,33: =
  413,35: 25

255 ID = Expr
  413,24: FontSize
  413,33: =
  413,35: 25

221 = Expr
  413,33: =
  413,35: 25

57 NUM
  413,35: 25

207 CR_token2
  413,37: 


68 ID . ID ( Exprs )
  414,9: GraphicsWindow
  414,23: .
  414,24: FillRectangle
  414,37: (
  414,38: 70,690,170,40
  414,51: )

184 . ID ( Exprs )
  414,23: .
  414,24: FillRectangle
  414,37: (
  414,38: 70,690,170,40
  414,51: )

255 ID ( Exprs )
  414,24: FillRectangle
  414,37: (
  414,38: 70,690,170,40
  414,51: )

221 ( Exprs )
  414,37: (
  414,38: 70,690,170,40
  414,51: )

27 NUM
  414,38: 70

217 , MoreThanOneExpr
  414,40: ,
  414,41: 690,170,40

54 NUM
  414,41: 690

217 , MoreThanOneExpr
  414,44: ,
  414,45: 170,40

54 NUM
  414,45: 170

217 , MoreThanOneExpr
  414,48: ,
  414,49: 40

54 NUM
  414,49: 40

238 )
  414,51: )

207 CR_token2
  414,52: 


68 ID . ID = Expr
  415,9: GraphicsWindow
  415,23: .
  415,24: BrushColor
  415,35: =
  415,37: "white"

184 . ID = Expr
  415,23: .
  415,24: BrushColor
  415,35: =
  415,37: "white"

255 ID = Expr
  415,24: BrushColor
  415,35: =
  415,37: "white"

221 = Expr
  415,35: =
  415,37: "white"

57 STR
  415,37: "white"

207 CR_token2
  415,44: 


68 ID . ID ( Exprs )
  416,9: GraphicsWindow
  416,23: .
  416,24: DrawText
  416,32: (
  416,33: 70, 690, "moves "+ moves
  416,57: )

184 . ID ( Exprs )
  416,23: .
  416,24: DrawText
  416,32: (
  416,33: 70, 690, "moves "+ moves
  416,57: )

255 ID ( Exprs )
  416,24: DrawText
  416,32: (
  416,33: 70, 690, "moves "+ moves
  416,57: )

221 ( Exprs )
  416,32: (
  416,33: 70, 690, "moves "+ moves
  416,57: )

27 NUM
  416,33: 70

217 , MoreThanOneExpr
  416,35: ,
  416,37: 690, "moves "+ moves

54 NUM
  416,37: 690

217 , MoreThanOneExpr
  416,40: ,
  416,42: "moves "+ moves

54 STR
  416,42: "moves "

65 + MultiplicativeExpr
  416,50: +
  416,52: moves

141 ID
  416,52: moves

238 )
  416,57: )

207 CR_token2
  416,58: 


122 OptionalElse_token1
  417,7: Endif

207 CR_token2
  417,12: 


122 CRStmtCRs
  418,1:  

122 CR_token2
  418,15: 


122 MoreThanZeroElseIf_token1 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  419,3: ElseIf
  419,9: ( bleftKey    = true) and (level[posy][posx-1]<= 2)
  419,61: Then
  419,65: 
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  

  465,5: ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf

82 ( Expr )
  419,9: (
  419,11: bleftKey    = true
  419,29: )

80 ID
  419,11: bleftKey

128 = CompExpr
  419,23: =
  419,25: true

117 ID
  419,25: true

265 )
  419,29: )

167 AndExpr_token1 EqNeqExpr
  419,31: and
  419,35: (level[posy][posx-1]<= 2)

102 ( Expr )
  419,35: (
  419,36: level[posy][posx-1]<= 2
  419,59: )

80 ID Idxs
  419,36: level
  419,41: [posy][posx-1]

4 [ Expr ] Idxs
  419,41: [
  419,42: posy
  419,46: ]
  419,47: [posx-1]

76 ID
  419,42: posy

245 ] Idxs
  419,46: ]
  419,47: [posx-1]

7 [ Expr ]
  419,47: [
  419,48: posx-1
  419,54: ]

76 ID
  419,48: posx

65 - MultiplicativeExpr
  419,52: -
  419,53: 1

141 NUM
  419,53: 1

245 ]
  419,54: ]

91 <= AdditiveExpr
  419,55: <=
  419,58: 2

131 NUM
  419,58: 2

265 )
  419,59: )

236 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  419,61: Then
  419,65: 
      'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           
      EndIf
      'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)
      Endif 
    'move down  

  465,5: ElseIf(bbackKey    = true) and (level[posy+1][posx]<= 2) Then
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up
    ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf

118 CR_token2
  419,65: 


115 CRStmtCRs
  420,1:       'move crystal
      if level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3) Then
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif     

115 CR_token2
  420,20: 


67 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  421,7: if
  421,10: level[posy][posx-1] = 2 And ground[posy][posx-1] <= 1 and (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3)
  421,123: Then
  421,127: 
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           

  448,7: EndIf

86 ID Idxs
  421,10: level
  421,15: [posy][posx-1]

4 [ Expr ] Idxs
  421,15: [
  421,16: posy
  421,20: ]
  421,21: [posx-1]

76 ID
  421,16: posy

245 ] Idxs
  421,20: ]
  421,21: [posx-1]

7 [ Expr ]
  421,21: [
  421,22: posx-1
  421,28: ]

76 ID
  421,22: posx

65 - MultiplicativeExpr
  421,26: -
  421,27: 1

141 NUM
  421,27: 1

245 ]
  421,28: ]

128 = CompExpr
  421,30: =
  421,32: 2

117 NUM
  421,32: 2

167 AndExpr_token1 EqNeqExpr
  421,34: And
  421,38: ground[posy][posx-1] <= 1

102 ID Idxs
  421,38: ground
  421,44: [posy][posx-1]

4 [ Expr ] Idxs
  421,44: [
  421,45: posy
  421,49: ]
  421,50: [posx-1]

76 ID
  421,45: posy

245 ] Idxs
  421,49: ]
  421,50: [posx-1]

7 [ Expr ]
  421,50: [
  421,51: posx-1
  421,57: ]

76 ID
  421,51: posx

65 - MultiplicativeExpr
  421,55: -
  421,56: 1

141 NUM
  421,56: 1

245 ]
  421,57: ]

91 <= AdditiveExpr
  421,59: <=
  421,62: 1

131 NUM
  421,62: 1

167 AndExpr_token1 EqNeqExpr
  421,64: and
  421,68: (level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3)

102 ( Expr )
  421,68: (
  421,69: level[posy][posx-2] <= 1 or ground[posy][posx-2] = 3
  421,121: )

80 ID Idxs
  421,69: level
  421,74: [posy][posx-2]

4 [ Expr ] Idxs
  421,74: [
  421,75: posy
  421,79: ]
  421,80: [posx-2]

76 ID
  421,75: posy

245 ] Idxs
  421,79: ]
  421,80: [posx-2]

7 [ Expr ]
  421,80: [
  421,81: posx-2
  421,87: ]

76 ID
  421,81: posx

65 - MultiplicativeExpr
  421,85: -
  421,86: 2

141 NUM
  421,86: 2

245 ]
  421,87: ]

91 <= AdditiveExpr
  421,89: <=
  421,92: 1

131 NUM
  421,92: 1

183 OrExpr_token1 AndExpr
  421,94: or
  421,97: ground[posy][posx-2] = 3

100 ID Idxs
  421,97: ground
  421,103: [posy][posx-2]

4 [ Expr ] Idxs
  421,103: [
  421,104: posy
  421,108: ]
  421,109: [posx-2]

76 ID
  421,104: posy

245 ] Idxs
  421,108: ]
  421,109: [posx-2]

7 [ Expr ]
  421,109: [
  421,110: posx-2
  421,116: ]

76 ID
  421,110: posx

65 - MultiplicativeExpr
  421,114: -
  421,115: 2

141 NUM
  421,115: 2

245 ]
  421,116: ]

128 = CompExpr
  421,118: =
  421,120: 3

117 NUM
  421,120: 3

265 )
  421,121: )

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  421,123: Then
  421,127: 
        chestarray[posy][posx-2] = chestarray[posy][posx-1]
        chestarray[posy][posx-1] = 99 
        level[posy][posx-1] = ground[posy][posx-1]
        level[posy][posx-2] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2
        EndIf   
        'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif           

  448,7: EndIf

124 CR_token2
  421,127: 


67 ID Idxs = Expr
  422,9: chestarray
  422,19: [posy][posx-2]
  422,34: =
  422,36: chestarray[posy][posx-1]

184 [ Expr ] Idxs
  422,19: [
  422,20: posy
  422,24: ]
  422,25: [posx-2]

76 ID
  422,20: posy

245 ] Idxs
  422,24: ]
  422,25: [posx-2]

7 [ Expr ]
  422,25: [
  422,26: posx-2
  422,32: ]

76 ID
  422,26: posx

65 - MultiplicativeExpr
  422,30: -
  422,31: 2

141 NUM
  422,31: 2

245 ]
  422,32: ]

263 = Expr
  422,34: =
  422,36: chestarray[posy][posx-1]

55 ID Idxs
  422,36: chestarray
  422,46: [posy][posx-1]

5 [ Expr ] Idxs
  422,46: [
  422,47: posy
  422,51: ]
  422,52: [posx-1]

81 ID
  422,47: posy

233 ] Idxs
  422,51: ]
  422,52: [posx-1]

8 [ Expr ]
  422,52: [
  422,53: posx-1
  422,59: ]

81 ID
  422,53: posx

65 - MultiplicativeExpr
  422,57: -
  422,58: 1

141 NUM
  422,58: 1

233 ]
  422,59: ]

207 CR_token2
  422,60: 


68 ID Idxs = Expr
  423,9: chestarray
  423,19: [posy][posx-1]
  423,34: =
  423,36: 99

184 [ Expr ] Idxs
  423,19: [
  423,20: posy
  423,24: ]
  423,25: [posx-1]

76 ID
  423,20: posy

245 ] Idxs
  423,24: ]
  423,25: [posx-1]

7 [ Expr ]
  423,25: [
  423,26: posx-1
  423,32: ]

76 ID
  423,26: posx

65 - MultiplicativeExpr
  423,30: -
  423,31: 1

141 NUM
  423,31: 1

245 ]
  423,32: ]

263 = Expr
  423,34: =
  423,36: 99

55 NUM
  423,36: 99

207 CR_token2
  423,39: 


68 ID Idxs = Expr
  424,9: level
  424,14: [posy][posx-1]
  424,29: =
  424,31: ground[posy][posx-1]

184 [ Expr ] Idxs
  424,14: [
  424,15: posy
  424,19: ]
  424,20: [posx-1]

76 ID
  424,15: posy

245 ] Idxs
  424,19: ]
  424,20: [posx-1]

7 [ Expr ]
  424,20: [
  424,21: posx-1
  424,27: ]

76 ID
  424,21: posx

65 - MultiplicativeExpr
  424,25: -
  424,26: 1

141 NUM
  424,26: 1

245 ]
  424,27: ]

263 = Expr
  424,29: =
  424,31: ground[posy][posx-1]

55 ID Idxs
  424,31: ground
  424,37: [posy][posx-1]

5 [ Expr ] Idxs
  424,37: [
  424,38: posy
  424,42: ]
  424,43: [posx-1]

81 ID
  424,38: posy

233 ] Idxs
  424,42: ]
  424,43: [posx-1]

8 [ Expr ]
  424,43: [
  424,44: posx-1
  424,50: ]

81 ID
  424,44: posx

65 - MultiplicativeExpr
  424,48: -
  424,49: 1

141 NUM
  424,49: 1

233 ]
  424,50: ]

207 CR_token2
  424,51: 


68 ID Idxs = Expr
  425,9: level
  425,14: [posy][posx-2]
  425,29: =
  425,31: 2

184 [ Expr ] Idxs
  425,14: [
  425,15: posy
  425,19: ]
  425,20: [posx-2]

76 ID
  425,15: posy

245 ] Idxs
  425,19: ]
  425,20: [posx-2]

7 [ Expr ]
  425,20: [
  425,21: posx-2
  425,27: ]

76 ID
  425,21: posx

65 - MultiplicativeExpr
  425,25: -
  425,26: 2

141 NUM
  425,26: 2

245 ]
  425,27: ]

263 = Expr
  425,29: =
  425,31: 2

55 NUM
  425,31: 2

207 CR_token2
  425,35: 


68 ID . ID ( Exprs )
  426,9: Sound
  426,14: .
  426,15: Stop
  426,19: (
  426,20: Path + "/sokocute01.wav"
  426,44: )

184 . ID ( Exprs )
  426,14: .
  426,15: Stop
  426,19: (
  426,20: Path + "/sokocute01.wav"
  426,44: )

255 ID ( Exprs )
  426,15: Stop
  426,19: (
  426,20: Path + "/sokocute01.wav"
  426,44: )

221 ( Exprs )
  426,19: (
  426,20: Path + "/sokocute01.wav"
  426,44: )

27 ID
  426,20: Path

65 + MultiplicativeExpr
  426,25: +
  426,27: "/sokocute01.wav"

141 STR
  426,27: "/sokocute01.wav"

238 )
  426,44: )

207 CR_token2
  426,45: 


68 ID . ID ( Exprs )
  427,9: Sound
  427,14: .
  427,15: Play
  427,19: (
  427,20: Path + "/sokocute01.wav"
  427,44: )

184 . ID ( Exprs )
  427,14: .
  427,15: Play
  427,19: (
  427,20: Path + "/sokocute01.wav"
  427,44: )

255 ID ( Exprs )
  427,15: Play
  427,19: (
  427,20: Path + "/sokocute01.wav"
  427,44: )

221 ( Exprs )
  427,19: (
  427,20: Path + "/sokocute01.wav"
  427,44: )

27 ID
  427,20: Path

65 + MultiplicativeExpr
  427,25: +
  427,27: "/sokocute01.wav"

141 STR
  427,27: "/sokocute01.wav"

238 )
  427,44: )

207 CR_token2
  427,45: 


122 CRStmtCRs
  428,1:         'move crystal into water
        If ground[posy][posx-2] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1
        EndIf
        If (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          ge

122 CR_token2
  428,33: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  429,9: If
  429,12: ground[posy][posx-2] = 3
  429,37: then
  429,41: 
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1

  433,9: EndIf

86 ID Idxs
  429,12: ground
  429,18: [posy][posx-2]

4 [ Expr ] Idxs
  429,18: [
  429,19: posy
  429,23: ]
  429,24: [posx-2]

76 ID
  429,19: posy

245 ] Idxs
  429,23: ]
  429,24: [posx-2]

7 [ Expr ]
  429,24: [
  429,25: posx-2
  429,31: ]

76 ID
  429,25: posx

65 - MultiplicativeExpr
  429,29: -
  429,30: 2

141 NUM
  429,30: 2

245 ]
  429,31: ]

128 = CompExpr
  429,33: =
  429,35: 3

117 NUM
  429,35: 3

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  429,37: then
  429,41: 
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy][posx-2]
          gemzoom = 1

  433,9: EndIf

124 CR_token2
  429,41: 


67 ID = Expr
  430,11: watertime
  430,21: =
  430,23: Clock.ElapsedMilliseconds

184 = Expr
  430,21: =
  430,23: Clock.ElapsedMilliseconds

70 ID . ID
  430,23: Clock
  430,28: .
  430,29: ElapsedMilliseconds

5 . ID
  430,28: .
  430,29: ElapsedMilliseconds

260 ID
  430,29: ElapsedMilliseconds

207 CR_token2
  430,48: 


68 ID = Expr
  431,11: gemwater
  431,20: =
  431,22: chestarray[posy][posx-2]

184 = Expr
  431,20: =
  431,22: chestarray[posy][posx-2]

70 ID Idxs
  431,22: chestarray
  431,32: [posy][posx-2]

5 [ Expr ] Idxs
  431,32: [
  431,33: posy
  431,37: ]
  431,38: [posx-2]

81 ID
  431,33: posy

233 ] Idxs
  431,37: ]
  431,38: [posx-2]

8 [ Expr ]
  431,38: [
  431,39: posx-2
  431,45: ]

81 ID
  431,39: posx

65 - MultiplicativeExpr
  431,43: -
  431,44: 2

141 NUM
  431,44: 2

233 ]
  431,45: ]

207 CR_token2
  431,46: 


68 ID = Expr
  432,11: gemzoom
  432,19: =
  432,21: 1

184 = Expr
  432,19: =
  432,21: 1

70 NUM
  432,21: 1

207 CR_token2
  432,22: 


122 OptionalElse_token1
  433,9: EndIf

207 CR_token2
  433,14: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  434,9: If
  434,12: (ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0) Or (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1)
  434,129: then
  434,133: 
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2

  439,9: EndIf

86 ( Expr )
  434,12: (
  434,13: ground[posy][posx-2] = 1 and ground[posy][posx-1] <= 0
  434,67: )

80 ID Idxs
  434,13: ground
  434,19: [posy][posx-2]

4 [ Expr ] Idxs
  434,19: [
  434,20: posy
  434,24: ]
  434,25: [posx-2]

76 ID
  434,20: posy

245 ] Idxs
  434,24: ]
  434,25: [posx-2]

7 [ Expr ]
  434,25: [
  434,26: posx-2
  434,32: ]

76 ID
  434,26: posx

65 - MultiplicativeExpr
  434,30: -
  434,31: 2

141 NUM
  434,31: 2

245 ]
  434,32: ]

128 = CompExpr
  434,34: =
  434,36: 1

117 NUM
  434,36: 1

167 AndExpr_token1 EqNeqExpr
  434,38: and
  434,42: ground[posy][posx-1] <= 0

102 ID Idxs
  434,42: ground
  434,48: [posy][posx-1]

4 [ Expr ] Idxs
  434,48: [
  434,49: posy
  434,53: ]
  434,54: [posx-1]

76 ID
  434,49: posy

245 ] Idxs
  434,53: ]
  434,54: [posx-1]

7 [ Expr ]
  434,54: [
  434,55: posx-1
  434,61: ]

76 ID
  434,55: posx

65 - MultiplicativeExpr
  434,59: -
  434,60: 1

141 NUM
  434,60: 1

245 ]
  434,61: ]

91 <= AdditiveExpr
  434,63: <=
  434,66: 0

131 NUM
  434,66: 0

265 )
  434,67: )

183 OrExpr_token1 AndExpr
  434,69: Or
  434,72: (ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1)

100 ( Expr )
  434,72: (
  434,73: ground[posy][posx-2] <= 0 and ground[posy][posx-1] = 1
  434,127: )

80 ID Idxs
  434,73: ground
  434,79: [posy][posx-2]

4 [ Expr ] Idxs
  434,79: [
  434,80: posy
  434,84: ]
  434,85: [posx-2]

76 ID
  434,80: posy

245 ] Idxs
  434,84: ]
  434,85: [posx-2]

7 [ Expr ]
  434,85: [
  434,86: posx-2
  434,92: ]

76 ID
  434,86: posx

65 - MultiplicativeExpr
  434,90: -
  434,91: 2

141 NUM
  434,91: 2

245 ]
  434,92: ]

91 <= AdditiveExpr
  434,94: <=
  434,97: 0

131 NUM
  434,97: 0

167 AndExpr_token1 EqNeqExpr
  434,99: and
  434,103: ground[posy][posx-1] = 1

102 ID Idxs
  434,103: ground
  434,109: [posy][posx-1]

4 [ Expr ] Idxs
  434,109: [
  434,110: posy
  434,114: ]
  434,115: [posx-1]

76 ID
  434,110: posy

245 ] Idxs
  434,114: ]
  434,115: [posx-1]

7 [ Expr ]
  434,115: [
  434,116: posx-1
  434,122: ]

76 ID
  434,116: posx

65 - MultiplicativeExpr
  434,120: -
  434,121: 1

141 NUM
  434,121: 1

245 ]
  434,122: ]

134 = CompExpr
  434,124: =
  434,126: 1

117 NUM
  434,126: 1

265 )
  434,127: )

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  434,129: then
  434,133: 
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy][posx-2]
          gemy    = posy
          gemx    = posx-2

  439,9: EndIf

124 CR_token2
  434,133: 


67 ID = Expr
  435,11: gemtime
  435,19: =
  435,21: Clock.ElapsedMilliseconds

184 = Expr
  435,19: =
  435,21: Clock.ElapsedMilliseconds

70 ID . ID
  435,21: Clock
  435,26: .
  435,27: ElapsedMilliseconds

5 . ID
  435,26: .
  435,27: ElapsedMilliseconds

260 ID
  435,27: ElapsedMilliseconds

207 CR_token2
  435,46: 


68 ID = Expr
  436,11: gemchng
  436,19: =
  436,21: chestarray[posy][posx-2]

184 = Expr
  436,19: =
  436,21: chestarray[posy][posx-2]

70 ID Idxs
  436,21: chestarray
  436,31: [posy][posx-2]

5 [ Expr ] Idxs
  436,31: [
  436,32: posy
  436,36: ]
  436,37: [posx-2]

81 ID
  436,32: posy

233 ] Idxs
  436,36: ]
  436,37: [posx-2]

8 [ Expr ]
  436,37: [
  436,38: posx-2
  436,44: ]

81 ID
  436,38: posx

65 - MultiplicativeExpr
  436,42: -
  436,43: 2

141 NUM
  436,43: 2

233 ]
  436,44: ]

207 CR_token2
  436,45: 


68 ID = Expr
  437,11: gemy
  437,19: =
  437,21: posy

184 = Expr
  437,19: =
  437,21: posy

70 ID
  437,21: posy

207 CR_token2
  437,25: 


68 ID = Expr
  438,11: gemx
  438,19: =
  438,21: posx-2

184 = Expr
  438,19: =
  438,21: posx-2

70 ID
  438,21: posx

59 - MultiplicativeExpr
  438,25: -
  438,26: 2

144 NUM
  438,26: 2

207 CR_token2
  438,27: 


122 OptionalElse_token1
  439,9: EndIf

207 CR_token2
  439,17: 


122 CRStmtCRs
  440,1:         'animate crystal     
        If ground[posy][posx-1] = 1 then   
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400

122 CR_token2
  440,30: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  441,9: If
  441,12: ground[posy][posx-1] = 1
  441,37: then
  441,44: 
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  

  443,9: elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif

86 ID Idxs
  441,12: ground
  441,18: [posy][posx-1]

4 [ Expr ] Idxs
  441,18: [
  441,19: posy
  441,23: ]
  441,24: [posx-1]

76 ID
  441,19: posy

245 ] Idxs
  441,23: ]
  441,24: [posx-1]

7 [ Expr ]
  441,24: [
  441,25: posx-1
  441,31: ]

76 ID
  441,25: posx

65 - MultiplicativeExpr
  441,29: -
  441,30: 1

141 NUM
  441,30: 1

245 ]
  441,31: ]

128 = CompExpr
  441,33: =
  441,35: 1

117 NUM
  441,35: 1

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  441,37: then
  441,44: 
          Shapes.Animate(crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  

  443,9: elseif ground[posy][posx-2] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif

124 CR_token2
  441,44: 


67 ID . ID ( Exprs )
  442,11: Shapes
  442,17: .
  442,18: Animate
  442,25: (
  442,26: crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400
  442,108: )

184 . ID ( Exprs )
  442,17: .
  442,18: Animate
  442,25: (
  442,26: crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400
  442,108: )

255 ID ( Exprs )
  442,18: Animate
  442,25: (
  442,26: crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400
  442,108: )

221 ( Exprs )
  442,25: (
  442,26: crystalbnk[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400
  442,108: )

27 ID Idxs
  442,26: crystalbnk
  442,36: [chestarray[posy][posx-2]]

4 [ Expr ]
  442,36: [
  442,37: chestarray[posy][posx-2]
  442,61: ]

76 ID Idxs
  442,37: chestarray
  442,47: [posy][posx-2]

4 [ Expr ] Idxs
  442,47: [
  442,48: posy
  442,52: ]
  442,53: [posx-2]

76 ID
  442,48: posy

245 ] Idxs
  442,52: ]
  442,53: [posx-2]

7 [ Expr ]
  442,53: [
  442,54: posx-2
  442,60: ]

76 ID
  442,54: posx

65 - MultiplicativeExpr
  442,58: -
  442,59: 2

141 NUM
  442,59: 2

245 ]
  442,60: ]

245 ]
  442,61: ]

217 , MoreThanOneExpr
  442,63: ,
  442,65: (posx-2) * 50 + korrx, (posy) * 40 - 0, 400

54 ( Expr )
  442,65: (
  442,66: posx-2
  442,72: )

80 ID
  442,66: posx

65 - MultiplicativeExpr
  442,70: -
  442,71: 2

141 NUM
  442,71: 2

265 )
  442,72: )

50 * UnaryExpr
  442,74: *
  442,76: 50

156 NUM
  442,76: 50

65 + MultiplicativeExpr
  442,79: +
  442,81: korrx

141 ID
  442,81: korrx

217 , MoreThanOneExpr
  442,86: ,
  442,88: (posy) * 40 - 0, 400

54 ( Expr )
  442,88: (
  442,89: posy
  442,93: )

80 ID
  442,89: posy

265 )
  442,93: )

50 * UnaryExpr
  442,95: *
  442,97: 40

156 NUM
  442,97: 40

65 - MultiplicativeExpr
  442,100: -
  442,102: 0

141 NUM
  442,102: 0

217 , MoreThanOneExpr
  442,103: ,
  442,105: 400

54 NUM
  442,105: 400

238 )
  442,108: )

207 CR_token2
  442,111: 


122 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  443,9: elseif
  443,16: ground[posy][posx-2] = 3
  443,41: then
  443,45: 
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  

  445,9: else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif

82 ID Idxs
  443,16: ground
  443,22: [posy][posx-2]

4 [ Expr ] Idxs
  443,22: [
  443,23: posy
  443,27: ]
  443,28: [posx-2]

76 ID
  443,23: posy

245 ] Idxs
  443,27: ]
  443,28: [posx-2]

7 [ Expr ]
  443,28: [
  443,29: posx-2
  443,35: ]

76 ID
  443,29: posx

65 - MultiplicativeExpr
  443,33: -
  443,34: 2

141 NUM
  443,34: 2

245 ]
  443,35: ]

128 = CompExpr
  443,37: =
  443,39: 3

117 NUM
  443,39: 3

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  443,41: then
  443,45: 
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400)  

  445,9: else
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  
        endif

118 CR_token2
  443,45: 


67 ID . ID ( Exprs )
  444,11: Shapes
  444,17: .
  444,18: Animate
  444,25: (
  444,26: crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400
  444,108: )

184 . ID ( Exprs )
  444,17: .
  444,18: Animate
  444,25: (
  444,26: crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400
  444,108: )

255 ID ( Exprs )
  444,18: Animate
  444,25: (
  444,26: crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400
  444,108: )

221 ( Exprs )
  444,25: (
  444,26: crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 + 0, 400
  444,108: )

27 ID Idxs
  444,26: crystalimg
  444,36: [chestarray[posy][posx-2]]

4 [ Expr ]
  444,36: [
  444,37: chestarray[posy][posx-2]
  444,61: ]

76 ID Idxs
  444,37: chestarray
  444,47: [posy][posx-2]

4 [ Expr ] Idxs
  444,47: [
  444,48: posy
  444,52: ]
  444,53: [posx-2]

76 ID
  444,48: posy

245 ] Idxs
  444,52: ]
  444,53: [posx-2]

7 [ Expr ]
  444,53: [
  444,54: posx-2
  444,60: ]

76 ID
  444,54: posx

65 - MultiplicativeExpr
  444,58: -
  444,59: 2

141 NUM
  444,59: 2

245 ]
  444,60: ]

245 ]
  444,61: ]

217 , MoreThanOneExpr
  444,63: ,
  444,65: (posx-2) * 50 + korrx, (posy) * 40 + 0, 400

54 ( Expr )
  444,65: (
  444,66: posx-2
  444,72: )

80 ID
  444,66: posx

65 - MultiplicativeExpr
  444,70: -
  444,71: 2

141 NUM
  444,71: 2

265 )
  444,72: )

50 * UnaryExpr
  444,74: *
  444,76: 50

156 NUM
  444,76: 50

65 + MultiplicativeExpr
  444,79: +
  444,81: korrx

141 ID
  444,81: korrx

217 , MoreThanOneExpr
  444,86: ,
  444,88: (posy) * 40 + 0, 400

54 ( Expr )
  444,88: (
  444,89: posy
  444,93: )

80 ID
  444,89: posy

265 )
  444,93: )

50 * UnaryExpr
  444,95: *
  444,97: 40

156 NUM
  444,97: 40

65 + MultiplicativeExpr
  444,100: +
  444,102: 0

141 NUM
  444,102: 0

217 , MoreThanOneExpr
  444,103: ,
  444,105: 400

54 NUM
  444,105: 400

238 )
  444,108: )

207 CR_token2
  444,111: 


115 OptionalElse_token2 CRStmtCRs OptionalElse_token1
  445,9: else
  445,13: 
          Shapes.Animate(crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400)  

  447,9: endif

201 CR_token2
  445,13: 


113 ID . ID ( Exprs )
  446,11: Shapes
  446,17: .
  446,18: Animate
  446,25: (
  446,26: crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400
  446,108: )

184 . ID ( Exprs )
  446,17: .
  446,18: Animate
  446,25: (
  446,26: crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400
  446,108: )

255 ID ( Exprs )
  446,18: Animate
  446,25: (
  446,26: crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400
  446,108: )

221 ( Exprs )
  446,25: (
  446,26: crystalimg[chestarray[posy][posx-2]] , (posx-2) * 50 + korrx, (posy) * 40 - 0, 400
  446,108: )

27 ID Idxs
  446,26: crystalimg
  446,36: [chestarray[posy][posx-2]]

4 [ Expr ]
  446,36: [
  446,37: chestarray[posy][posx-2]
  446,61: ]

76 ID Idxs
  446,37: chestarray
  446,47: [posy][posx-2]

4 [ Expr ] Idxs
  446,47: [
  446,48: posy
  446,52: ]
  446,53: [posx-2]

76 ID
  446,48: posy

245 ] Idxs
  446,52: ]
  446,53: [posx-2]

7 [ Expr ]
  446,53: [
  446,54: posx-2
  446,60: ]

76 ID
  446,54: posx

65 - MultiplicativeExpr
  446,58: -
  446,59: 2

141 NUM
  446,59: 2

245 ]
  446,60: ]

245 ]
  446,61: ]

217 , MoreThanOneExpr
  446,63: ,
  446,65: (posx-2) * 50 + korrx, (posy) * 40 - 0, 400

54 ( Expr )
  446,65: (
  446,66: posx-2
  446,72: )

80 ID
  446,66: posx

65 - MultiplicativeExpr
  446,70: -
  446,71: 2

141 NUM
  446,71: 2

265 )
  446,72: )

50 * UnaryExpr
  446,74: *
  446,76: 50

156 NUM
  446,76: 50

65 + MultiplicativeExpr
  446,79: +
  446,81: korrx

141 ID
  446,81: korrx

217 , MoreThanOneExpr
  446,86: ,
  446,88: (posy) * 40 - 0, 400

54 ( Expr )
  446,88: (
  446,89: posy
  446,93: )

80 ID
  446,89: posy

265 )
  446,93: )

50 * UnaryExpr
  446,95: *
  446,97: 40

156 NUM
  446,97: 40

65 - MultiplicativeExpr
  446,100: -
  446,102: 0

141 NUM
  446,102: 0

217 , MoreThanOneExpr
  446,103: ,
  446,105: 400

54 NUM
  446,105: 400

238 )
  446,108: )

202 CR_token2
  446,111: 


237 OptionalElse_token1
  447,9: endif

207 CR_token2
  447,25: 


122 OptionalElse_token1
  448,7: EndIf

207 CR_token2
  448,12: 


115 CRStmtCRs
  449,1:       'move player left      
      If level[posy][posx-1] <= 1 then
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "

115 CR_token2
  449,30: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  450,7: If
  450,10: level[posy][posx-1] <= 1
  450,35: then
  450,39: 
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)

  463,7: Endif

86 ID Idxs
  450,10: level
  450,15: [posy][posx-1]

4 [ Expr ] Idxs
  450,15: [
  450,16: posy
  450,20: ]
  450,21: [posx-1]

76 ID
  450,16: posy

245 ] Idxs
  450,20: ]
  450,21: [posx-1]

7 [ Expr ]
  450,21: [
  450,22: posx-1
  450,28: ]

76 ID
  450,22: posx

65 - MultiplicativeExpr
  450,26: -
  450,27: 1

141 NUM
  450,27: 1

245 ]
  450,28: ]

91 <= AdditiveExpr
  450,30: <=
  450,33: 1

131 NUM
  450,33: 1

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  450,35: then
  450,39: 
        moves   = moves + 1        
        newmove = 0
        movex   =-2
        movey   = 0
        posx = posx - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)

  463,7: Endif

124 CR_token2
  450,39: 


67 ID = Expr
  451,9: moves
  451,17: =
  451,19: moves + 1

184 = Expr
  451,17: =
  451,19: moves + 1

70 ID
  451,19: moves

59 + MultiplicativeExpr
  451,25: +
  451,27: 1

144 NUM
  451,27: 1

207 CR_token2
  451,36: 


68 ID = Expr
  452,9: newmove
  452,17: =
  452,19: 0

184 = Expr
  452,17: =
  452,19: 0

70 NUM
  452,19: 0

207 CR_token2
  452,20: 


68 ID = Expr
  453,9: movex
  453,17: =
  453,18: -2

184 = Expr
  453,17: =
  453,18: -2

70 - Primary
  453,18: -
  453,19: 2

193 NUM
  453,19: 2

207 CR_token2
  453,20: 


68 ID = Expr
  454,9: movey
  454,17: =
  454,19: 0

184 = Expr
  454,17: =
  454,19: 0

70 NUM
  454,19: 0

207 CR_token2
  454,20: 


68 ID = Expr
  455,9: posx
  455,14: =
  455,16: posx - 1

184 = Expr
  455,14: =
  455,16: posx - 1

70 ID
  455,16: posx

59 - MultiplicativeExpr
  455,21: -
  455,23: 1

144 NUM
  455,23: 1

207 CR_token2
  455,24: 


68 ID = Expr
  456,9: gametime
  456,18: =
  456,20: Clock.ElapsedMilliseconds

184 = Expr
  456,18: =
  456,20: Clock.ElapsedMilliseconds

70 ID . ID
  456,20: Clock
  456,25: .
  456,26: ElapsedMilliseconds

5 . ID
  456,25: .
  456,26: ElapsedMilliseconds

260 ID
  456,26: ElapsedMilliseconds

207 CR_token2
  456,45: 


68 ID . ID = Expr
  457,9: GraphicsWindow
  457,23: .
  457,24: BrushColor
  457,35: =
  457,37: "#3975e5"

184 . ID = Expr
  457,23: .
  457,24: BrushColor
  457,35: =
  457,37: "#3975e5"

255 ID = Expr
  457,24: BrushColor
  457,35: =
  457,37: "#3975e5"

221 = Expr
  457,35: =
  457,37: "#3975e5"

57 STR
  457,37: "#3975e5"

207 CR_token2
  457,46: 


68 ID . ID = Expr
  458,9: GraphicsWindow
  458,23: .
  458,24: FontName
  458,33: =
  458,35: "COMIC SANS MS"

184 . ID = Expr
  458,23: .
  458,24: FontName
  458,33: =
  458,35: "COMIC SANS MS"

255 ID = Expr
  458,24: FontName
  458,33: =
  458,35: "COMIC SANS MS"

221 = Expr
  458,33: =
  458,35: "COMIC SANS MS"

57 STR
  458,35: "COMIC SANS MS"

207 CR_token2
  458,50: 


68 ID . ID = Expr
  459,9: GraphicsWindow
  459,23: .
  459,24: FontSize
  459,33: =
  459,35: 25

184 . ID = Expr
  459,23: .
  459,24: FontSize
  459,33: =
  459,35: 25

255 ID = Expr
  459,24: FontSize
  459,33: =
  459,35: 25

221 = Expr
  459,33: =
  459,35: 25

57 NUM
  459,35: 25

207 CR_token2
  459,37: 


68 ID . ID ( Exprs )
  460,9: GraphicsWindow
  460,23: .
  460,24: FillRectangle
  460,37: (
  460,38: 70,690,170,40
  460,51: )

184 . ID ( Exprs )
  460,23: .
  460,24: FillRectangle
  460,37: (
  460,38: 70,690,170,40
  460,51: )

255 ID ( Exprs )
  460,24: FillRectangle
  460,37: (
  460,38: 70,690,170,40
  460,51: )

221 ( Exprs )
  460,37: (
  460,38: 70,690,170,40
  460,51: )

27 NUM
  460,38: 70

217 , MoreThanOneExpr
  460,40: ,
  460,41: 690,170,40

54 NUM
  460,41: 690

217 , MoreThanOneExpr
  460,44: ,
  460,45: 170,40

54 NUM
  460,45: 170

217 , MoreThanOneExpr
  460,48: ,
  460,49: 40

54 NUM
  460,49: 40

238 )
  460,51: )

207 CR_token2
  460,52: 


68 ID . ID = Expr
  461,9: GraphicsWindow
  461,23: .
  461,24: BrushColor
  461,35: =
  461,37: "white"

184 . ID = Expr
  461,23: .
  461,24: BrushColor
  461,35: =
  461,37: "white"

255 ID = Expr
  461,24: BrushColor
  461,35: =
  461,37: "white"

221 = Expr
  461,35: =
  461,37: "white"

57 STR
  461,37: "white"

207 CR_token2
  461,44: 


68 ID . ID ( Exprs )
  462,9: GraphicsWindow
  462,23: .
  462,24: DrawText
  462,32: (
  462,33: 70, 690, "moves "+ moves
  462,57: )

184 . ID ( Exprs )
  462,23: .
  462,24: DrawText
  462,32: (
  462,33: 70, 690, "moves "+ moves
  462,57: )

255 ID ( Exprs )
  462,24: DrawText
  462,32: (
  462,33: 70, 690, "moves "+ moves
  462,57: )

221 ( Exprs )
  462,32: (
  462,33: 70, 690, "moves "+ moves
  462,57: )

27 NUM
  462,33: 70

217 , MoreThanOneExpr
  462,35: ,
  462,37: 690, "moves "+ moves

54 NUM
  462,37: 690

217 , MoreThanOneExpr
  462,40: ,
  462,42: "moves "+ moves

54 STR
  462,42: "moves "

65 + MultiplicativeExpr
  462,50: +
  462,52: moves

141 ID
  462,52: moves

238 )
  462,57: )

207 CR_token2
  462,58: 


122 OptionalElse_token1
  463,7: Endif

207 CR_token2
  463,13: 


115 CRStmtCRs
  464,1:  

115 CR_token2
  464,17: 


115 MoreThanZeroElseIf_token1 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  465,5: ElseIf
  465,11: (bbackKey    = true) and (level[posy+1][posx]<= 2)
  465,62: Then
  465,66: 
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up

  511,5: ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf

82 ( Expr )
  465,11: (
  465,12: bbackKey    = true
  465,30: )

80 ID
  465,12: bbackKey

128 = CompExpr
  465,24: =
  465,26: true

117 ID
  465,26: true

265 )
  465,30: )

167 AndExpr_token1 EqNeqExpr
  465,32: and
  465,36: (level[posy+1][posx]<= 2)

102 ( Expr )
  465,36: (
  465,37: level[posy+1][posx]<= 2
  465,60: )

80 ID Idxs
  465,37: level
  465,42: [posy+1][posx]

4 [ Expr ] Idxs
  465,42: [
  465,43: posy+1
  465,49: ]
  465,50: [posx]

76 ID
  465,43: posy

65 + MultiplicativeExpr
  465,47: +
  465,48: 1

141 NUM
  465,48: 1

245 ] Idxs
  465,49: ]
  465,50: [posx]

7 [ Expr ]
  465,50: [
  465,51: posx
  465,55: ]

76 ID
  465,51: posx

245 ]
  465,55: ]

91 <= AdditiveExpr
  465,56: <=
  465,59: 2

131 NUM
  465,59: 2

265 )
  465,60: )

236 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  465,62: Then
  465,66: 
      'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        
      EndIf
      'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    
      Endif
    'move up

  511,5: ElseIf(bforwardKey = true) and (level[posy-1][posx]<= 2) Then
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 
    EndIf

118 CR_token2
  465,66: 


115 CRStmtCRs
  466,1:       'move crystal
      if level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3) Then
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif  

115 CR_token2
  466,20: 


67 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  467,7: if
  467,10: level[posy+1][posx] = 2 And ground[posy+1][posx] <= 1 and (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3)
  467,123: Then
  467,127: 
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        

  494,7: EndIf

86 ID Idxs
  467,10: level
  467,15: [posy+1][posx]

4 [ Expr ] Idxs
  467,15: [
  467,16: posy+1
  467,22: ]
  467,23: [posx]

76 ID
  467,16: posy

65 + MultiplicativeExpr
  467,20: +
  467,21: 1

141 NUM
  467,21: 1

245 ] Idxs
  467,22: ]
  467,23: [posx]

7 [ Expr ]
  467,23: [
  467,24: posx
  467,28: ]

76 ID
  467,24: posx

245 ]
  467,28: ]

128 = CompExpr
  467,30: =
  467,32: 2

117 NUM
  467,32: 2

167 AndExpr_token1 EqNeqExpr
  467,34: And
  467,38: ground[posy+1][posx] <= 1

102 ID Idxs
  467,38: ground
  467,44: [posy+1][posx]

4 [ Expr ] Idxs
  467,44: [
  467,45: posy+1
  467,51: ]
  467,52: [posx]

76 ID
  467,45: posy

65 + MultiplicativeExpr
  467,49: +
  467,50: 1

141 NUM
  467,50: 1

245 ] Idxs
  467,51: ]
  467,52: [posx]

7 [ Expr ]
  467,52: [
  467,53: posx
  467,57: ]

76 ID
  467,53: posx

245 ]
  467,57: ]

91 <= AdditiveExpr
  467,59: <=
  467,62: 1

131 NUM
  467,62: 1

167 AndExpr_token1 EqNeqExpr
  467,64: and
  467,68: (level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3)

102 ( Expr )
  467,68: (
  467,69: level[posy+2][posx] <= 1 or ground[posy+2][posx] = 3
  467,121: )

80 ID Idxs
  467,69: level
  467,74: [posy+2][posx]

4 [ Expr ] Idxs
  467,74: [
  467,75: posy+2
  467,81: ]
  467,82: [posx]

76 ID
  467,75: posy

65 + MultiplicativeExpr
  467,79: +
  467,80: 2

141 NUM
  467,80: 2

245 ] Idxs
  467,81: ]
  467,82: [posx]

7 [ Expr ]
  467,82: [
  467,83: posx
  467,87: ]

76 ID
  467,83: posx

245 ]
  467,87: ]

91 <= AdditiveExpr
  467,89: <=
  467,92: 1

131 NUM
  467,92: 1

183 OrExpr_token1 AndExpr
  467,94: or
  467,97: ground[posy+2][posx] = 3

100 ID Idxs
  467,97: ground
  467,103: [posy+2][posx]

4 [ Expr ] Idxs
  467,103: [
  467,104: posy+2
  467,110: ]
  467,111: [posx]

76 ID
  467,104: posy

65 + MultiplicativeExpr
  467,108: +
  467,109: 2

141 NUM
  467,109: 2

245 ] Idxs
  467,110: ]
  467,111: [posx]

7 [ Expr ]
  467,111: [
  467,112: posx
  467,116: ]

76 ID
  467,112: posx

245 ]
  467,116: ]

128 = CompExpr
  467,118: =
  467,120: 3

117 NUM
  467,120: 3

265 )
  467,121: )

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  467,123: Then
  467,127: 
        chestarray[posy+2][posx] = chestarray[posy+1][posx]
        chestarray[posy+1][posx] = 99 
        level[posy+1][posx] = ground[posy+1][posx]
        level[posy+2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif        

  494,7: EndIf

124 CR_token2
  467,127: 


67 ID Idxs = Expr
  468,9: chestarray
  468,19: [posy+2][posx]
  468,34: =
  468,36: chestarray[posy+1][posx]

184 [ Expr ] Idxs
  468,19: [
  468,20: posy+2
  468,26: ]
  468,27: [posx]

76 ID
  468,20: posy

65 + MultiplicativeExpr
  468,24: +
  468,25: 2

141 NUM
  468,25: 2

245 ] Idxs
  468,26: ]
  468,27: [posx]

7 [ Expr ]
  468,27: [
  468,28: posx
  468,32: ]

76 ID
  468,28: posx

245 ]
  468,32: ]

263 = Expr
  468,34: =
  468,36: chestarray[posy+1][posx]

55 ID Idxs
  468,36: chestarray
  468,46: [posy+1][posx]

5 [ Expr ] Idxs
  468,46: [
  468,47: posy+1
  468,53: ]
  468,54: [posx]

81 ID
  468,47: posy

65 + MultiplicativeExpr
  468,51: +
  468,52: 1

141 NUM
  468,52: 1

233 ] Idxs
  468,53: ]
  468,54: [posx]

8 [ Expr ]
  468,54: [
  468,55: posx
  468,59: ]

81 ID
  468,55: posx

233 ]
  468,59: ]

207 CR_token2
  468,60: 


68 ID Idxs = Expr
  469,9: chestarray
  469,19: [posy+1][posx]
  469,34: =
  469,36: 99

184 [ Expr ] Idxs
  469,19: [
  469,20: posy+1
  469,26: ]
  469,27: [posx]

76 ID
  469,20: posy

65 + MultiplicativeExpr
  469,24: +
  469,25: 1

141 NUM
  469,25: 1

245 ] Idxs
  469,26: ]
  469,27: [posx]

7 [ Expr ]
  469,27: [
  469,28: posx
  469,32: ]

76 ID
  469,28: posx

245 ]
  469,32: ]

263 = Expr
  469,34: =
  469,36: 99

55 NUM
  469,36: 99

207 CR_token2
  469,39: 


68 ID Idxs = Expr
  470,9: level
  470,14: [posy+1][posx]
  470,29: =
  470,31: ground[posy+1][posx]

184 [ Expr ] Idxs
  470,14: [
  470,15: posy+1
  470,21: ]
  470,22: [posx]

76 ID
  470,15: posy

65 + MultiplicativeExpr
  470,19: +
  470,20: 1

141 NUM
  470,20: 1

245 ] Idxs
  470,21: ]
  470,22: [posx]

7 [ Expr ]
  470,22: [
  470,23: posx
  470,27: ]

76 ID
  470,23: posx

245 ]
  470,27: ]

263 = Expr
  470,29: =
  470,31: ground[posy+1][posx]

55 ID Idxs
  470,31: ground
  470,37: [posy+1][posx]

5 [ Expr ] Idxs
  470,37: [
  470,38: posy+1
  470,44: ]
  470,45: [posx]

81 ID
  470,38: posy

65 + MultiplicativeExpr
  470,42: +
  470,43: 1

141 NUM
  470,43: 1

233 ] Idxs
  470,44: ]
  470,45: [posx]

8 [ Expr ]
  470,45: [
  470,46: posx
  470,50: ]

81 ID
  470,46: posx

233 ]
  470,50: ]

207 CR_token2
  470,51: 


68 ID Idxs = Expr
  471,9: level
  471,14: [posy+2][posx]
  471,29: =
  471,31: 2

184 [ Expr ] Idxs
  471,14: [
  471,15: posy+2
  471,21: ]
  471,22: [posx]

76 ID
  471,15: posy

65 + MultiplicativeExpr
  471,19: +
  471,20: 2

141 NUM
  471,20: 2

245 ] Idxs
  471,21: ]
  471,22: [posx]

7 [ Expr ]
  471,22: [
  471,23: posx
  471,27: ]

76 ID
  471,23: posx

245 ]
  471,27: ]

263 = Expr
  471,29: =
  471,31: 2

55 NUM
  471,31: 2

207 CR_token2
  471,35: 


68 ID . ID ( Exprs )
  472,9: Sound
  472,14: .
  472,15: Stop
  472,19: (
  472,20: Path + "/sokocute01.wav"
  472,44: )

184 . ID ( Exprs )
  472,14: .
  472,15: Stop
  472,19: (
  472,20: Path + "/sokocute01.wav"
  472,44: )

255 ID ( Exprs )
  472,15: Stop
  472,19: (
  472,20: Path + "/sokocute01.wav"
  472,44: )

221 ( Exprs )
  472,19: (
  472,20: Path + "/sokocute01.wav"
  472,44: )

27 ID
  472,20: Path

65 + MultiplicativeExpr
  472,25: +
  472,27: "/sokocute01.wav"

141 STR
  472,27: "/sokocute01.wav"

238 )
  472,44: )

207 CR_token2
  472,45: 


68 ID . ID ( Exprs )
  473,9: Sound
  473,14: .
  473,15: Play
  473,19: (
  473,20: Path + "/sokocute01.wav"
  473,44: )

184 . ID ( Exprs )
  473,14: .
  473,15: Play
  473,19: (
  473,20: Path + "/sokocute01.wav"
  473,44: )

255 ID ( Exprs )
  473,15: Play
  473,19: (
  473,20: Path + "/sokocute01.wav"
  473,44: )

221 ( Exprs )
  473,19: (
  473,20: Path + "/sokocute01.wav"
  473,44: )

27 ID
  473,20: Path

65 + MultiplicativeExpr
  473,25: +
  473,27: "/sokocute01.wav"

141 STR
  473,27: "/sokocute01.wav"

238 )
  473,44: )

207 CR_token2
  473,45: 


122 CRStmtCRs
  474,1:         'move crystal into water
        If ground[posy+2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
       

122 CR_token2
  474,33: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  475,9: If
  475,12: ground[posy+2][posx] = 3
  475,37: then
  475,41: 
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1

  479,9: EndIf

86 ID Idxs
  475,12: ground
  475,18: [posy+2][posx]

4 [ Expr ] Idxs
  475,18: [
  475,19: posy+2
  475,25: ]
  475,26: [posx]

76 ID
  475,19: posy

65 + MultiplicativeExpr
  475,23: +
  475,24: 2

141 NUM
  475,24: 2

245 ] Idxs
  475,25: ]
  475,26: [posx]

7 [ Expr ]
  475,26: [
  475,27: posx
  475,31: ]

76 ID
  475,27: posx

245 ]
  475,31: ]

128 = CompExpr
  475,33: =
  475,35: 3

117 NUM
  475,35: 3

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  475,37: then
  475,41: 
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy+2][posx]
          gemzoom = 1

  479,9: EndIf

124 CR_token2
  475,41: 


67 ID = Expr
  476,11: watertime
  476,21: =
  476,23: Clock.ElapsedMilliseconds

184 = Expr
  476,21: =
  476,23: Clock.ElapsedMilliseconds

70 ID . ID
  476,23: Clock
  476,28: .
  476,29: ElapsedMilliseconds

5 . ID
  476,28: .
  476,29: ElapsedMilliseconds

260 ID
  476,29: ElapsedMilliseconds

207 CR_token2
  476,48: 


68 ID = Expr
  477,11: gemwater
  477,20: =
  477,22: chestarray[posy+2][posx]

184 = Expr
  477,20: =
  477,22: chestarray[posy+2][posx]

70 ID Idxs
  477,22: chestarray
  477,32: [posy+2][posx]

5 [ Expr ] Idxs
  477,32: [
  477,33: posy+2
  477,39: ]
  477,40: [posx]

81 ID
  477,33: posy

65 + MultiplicativeExpr
  477,37: +
  477,38: 2

141 NUM
  477,38: 2

233 ] Idxs
  477,39: ]
  477,40: [posx]

8 [ Expr ]
  477,40: [
  477,41: posx
  477,45: ]

81 ID
  477,41: posx

233 ]
  477,45: ]

207 CR_token2
  477,46: 


68 ID = Expr
  478,11: gemzoom
  478,19: =
  478,21: 1

184 = Expr
  478,19: =
  478,21: 1

70 NUM
  478,21: 1

207 CR_token2
  478,22: 


122 OptionalElse_token1
  479,9: EndIf

207 CR_token2
  479,14: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  480,9: If
  480,12: (ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0) Or (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1)
  480,129: then
  480,133: 
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx

  485,9: EndIf

86 ( Expr )
  480,12: (
  480,13: ground[posy+2][posx] = 1 and ground[posy+1][posx] <= 0
  480,67: )

80 ID Idxs
  480,13: ground
  480,19: [posy+2][posx]

4 [ Expr ] Idxs
  480,19: [
  480,20: posy+2
  480,26: ]
  480,27: [posx]

76 ID
  480,20: posy

65 + MultiplicativeExpr
  480,24: +
  480,25: 2

141 NUM
  480,25: 2

245 ] Idxs
  480,26: ]
  480,27: [posx]

7 [ Expr ]
  480,27: [
  480,28: posx
  480,32: ]

76 ID
  480,28: posx

245 ]
  480,32: ]

128 = CompExpr
  480,34: =
  480,36: 1

117 NUM
  480,36: 1

167 AndExpr_token1 EqNeqExpr
  480,38: and
  480,42: ground[posy+1][posx] <= 0

102 ID Idxs
  480,42: ground
  480,48: [posy+1][posx]

4 [ Expr ] Idxs
  480,48: [
  480,49: posy+1
  480,55: ]
  480,56: [posx]

76 ID
  480,49: posy

65 + MultiplicativeExpr
  480,53: +
  480,54: 1

141 NUM
  480,54: 1

245 ] Idxs
  480,55: ]
  480,56: [posx]

7 [ Expr ]
  480,56: [
  480,57: posx
  480,61: ]

76 ID
  480,57: posx

245 ]
  480,61: ]

91 <= AdditiveExpr
  480,63: <=
  480,66: 0

131 NUM
  480,66: 0

265 )
  480,67: )

183 OrExpr_token1 AndExpr
  480,69: Or
  480,72: (ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1)

100 ( Expr )
  480,72: (
  480,73: ground[posy+2][posx] <= 0 and ground[posy+1][posx] = 1
  480,127: )

80 ID Idxs
  480,73: ground
  480,79: [posy+2][posx]

4 [ Expr ] Idxs
  480,79: [
  480,80: posy+2
  480,86: ]
  480,87: [posx]

76 ID
  480,80: posy

65 + MultiplicativeExpr
  480,84: +
  480,85: 2

141 NUM
  480,85: 2

245 ] Idxs
  480,86: ]
  480,87: [posx]

7 [ Expr ]
  480,87: [
  480,88: posx
  480,92: ]

76 ID
  480,88: posx

245 ]
  480,92: ]

91 <= AdditiveExpr
  480,94: <=
  480,97: 0

131 NUM
  480,97: 0

167 AndExpr_token1 EqNeqExpr
  480,99: and
  480,103: ground[posy+1][posx] = 1

102 ID Idxs
  480,103: ground
  480,109: [posy+1][posx]

4 [ Expr ] Idxs
  480,109: [
  480,110: posy+1
  480,116: ]
  480,117: [posx]

76 ID
  480,110: posy

65 + MultiplicativeExpr
  480,114: +
  480,115: 1

141 NUM
  480,115: 1

245 ] Idxs
  480,116: ]
  480,117: [posx]

7 [ Expr ]
  480,117: [
  480,118: posx
  480,122: ]

76 ID
  480,118: posx

245 ]
  480,122: ]

134 = CompExpr
  480,124: =
  480,126: 1

117 NUM
  480,126: 1

265 )
  480,127: )

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  480,129: then
  480,133: 
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy+2][posx]
          gemy    = posy+2
          gemx    = posx

  485,9: EndIf

124 CR_token2
  480,133: 


67 ID = Expr
  481,11: gemtime
  481,19: =
  481,21: Clock.ElapsedMilliseconds

184 = Expr
  481,19: =
  481,21: Clock.ElapsedMilliseconds

70 ID . ID
  481,21: Clock
  481,26: .
  481,27: ElapsedMilliseconds

5 . ID
  481,26: .
  481,27: ElapsedMilliseconds

260 ID
  481,27: ElapsedMilliseconds

207 CR_token2
  481,46: 


68 ID = Expr
  482,11: gemchng
  482,19: =
  482,21: chestarray[posy+2][posx]

184 = Expr
  482,19: =
  482,21: chestarray[posy+2][posx]

70 ID Idxs
  482,21: chestarray
  482,31: [posy+2][posx]

5 [ Expr ] Idxs
  482,31: [
  482,32: posy+2
  482,38: ]
  482,39: [posx]

81 ID
  482,32: posy

65 + MultiplicativeExpr
  482,36: +
  482,37: 2

141 NUM
  482,37: 2

233 ] Idxs
  482,38: ]
  482,39: [posx]

8 [ Expr ]
  482,39: [
  482,40: posx
  482,44: ]

81 ID
  482,40: posx

233 ]
  482,44: ]

207 CR_token2
  482,45: 


68 ID = Expr
  483,11: gemy
  483,19: =
  483,21: posy+2

184 = Expr
  483,19: =
  483,21: posy+2

70 ID
  483,21: posy

59 + MultiplicativeExpr
  483,25: +
  483,26: 2

144 NUM
  483,26: 2

207 CR_token2
  483,27: 


68 ID = Expr
  484,11: gemx
  484,19: =
  484,21: posx

184 = Expr
  484,19: =
  484,21: posx

70 ID
  484,21: posx

207 CR_token2
  484,25: 


122 OptionalElse_token1
  485,9: EndIf

207 CR_token2
  485,14: 


122 CRStmtCRs
  486,1:         'animate crystal
        if ground[posy+1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400) 

122 CR_token2
  486,25: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  487,9: if
  487,12: ground[posy+1][posx] = 1
  487,37: then
  487,41: 
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  

  489,9: elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif

86 ID Idxs
  487,12: ground
  487,18: [posy+1][posx]

4 [ Expr ] Idxs
  487,18: [
  487,19: posy+1
  487,25: ]
  487,26: [posx]

76 ID
  487,19: posy

65 + MultiplicativeExpr
  487,23: +
  487,24: 1

141 NUM
  487,24: 1

245 ] Idxs
  487,25: ]
  487,26: [posx]

7 [ Expr ]
  487,26: [
  487,27: posx
  487,31: ]

76 ID
  487,27: posx

245 ]
  487,31: ]

128 = CompExpr
  487,33: =
  487,35: 1

117 NUM
  487,35: 1

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  487,37: then
  487,41: 
          Shapes.Animate(crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  

  489,9: elseif ground[posy+2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  
        else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif

124 CR_token2
  487,41: 


67 ID . ID ( Exprs )
  488,11: Shapes
  488,17: .
  488,18: Animate
  488,25: (
  488,26: crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400
  488,108: )

184 . ID ( Exprs )
  488,17: .
  488,18: Animate
  488,25: (
  488,26: crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400
  488,108: )

255 ID ( Exprs )
  488,18: Animate
  488,25: (
  488,26: crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400
  488,108: )

221 ( Exprs )
  488,25: (
  488,26: crystalbnk[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400
  488,108: )

27 ID Idxs
  488,26: crystalbnk
  488,36: [chestarray[posy+2][posx]]

4 [ Expr ]
  488,36: [
  488,37: chestarray[posy+2][posx]
  488,61: ]

76 ID Idxs
  488,37: chestarray
  488,47: [posy+2][posx]

4 [ Expr ] Idxs
  488,47: [
  488,48: posy+2
  488,54: ]
  488,55: [posx]

76 ID
  488,48: posy

65 + MultiplicativeExpr
  488,52: +
  488,53: 2

141 NUM
  488,53: 2

245 ] Idxs
  488,54: ]
  488,55: [posx]

7 [ Expr ]
  488,55: [
  488,56: posx
  488,60: ]

76 ID
  488,56: posx

245 ]
  488,60: ]

245 ]
  488,61: ]

217 , MoreThanOneExpr
  488,63: ,
  488,65: (posx) * 50 + korrx, (posy+2) * 40 - 0, 400

54 ( Expr )
  488,65: (
  488,66: posx
  488,70: )

80 ID
  488,66: posx

265 )
  488,70: )

50 * UnaryExpr
  488,72: *
  488,74: 50

156 NUM
  488,74: 50

65 + MultiplicativeExpr
  488,77: +
  488,79: korrx

141 ID
  488,79: korrx

217 , MoreThanOneExpr
  488,84: ,
  488,86: (posy+2) * 40 - 0, 400

54 ( Expr )
  488,86: (
  488,87: posy+2
  488,93: )

80 ID
  488,87: posy

65 + MultiplicativeExpr
  488,91: +
  488,92: 2

141 NUM
  488,92: 2

265 )
  488,93: )

50 * UnaryExpr
  488,95: *
  488,97: 40

156 NUM
  488,97: 40

65 - MultiplicativeExpr
  488,100: -
  488,102: 0

141 NUM
  488,102: 0

217 , MoreThanOneExpr
  488,103: ,
  488,105: 400

54 NUM
  488,105: 400

238 )
  488,108: )

207 CR_token2
  488,111: 


122 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  489,9: elseif
  489,16: ground[posy+2][posx] = 3
  489,41: then
  489,45: 
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  

  491,9: else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif

82 ID Idxs
  489,16: ground
  489,22: [posy+2][posx]

4 [ Expr ] Idxs
  489,22: [
  489,23: posy+2
  489,29: ]
  489,30: [posx]

76 ID
  489,23: posy

65 + MultiplicativeExpr
  489,27: +
  489,28: 2

141 NUM
  489,28: 2

245 ] Idxs
  489,29: ]
  489,30: [posx]

7 [ Expr ]
  489,30: [
  489,31: posx
  489,35: ]

76 ID
  489,31: posx

245 ]
  489,35: ]

128 = CompExpr
  489,37: =
  489,39: 3

117 NUM
  489,39: 3

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  489,41: then
  489,45: 
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400)  

  491,9: else
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  
        endif

118 CR_token2
  489,45: 


67 ID . ID ( Exprs )
  490,11: Shapes
  490,17: .
  490,18: Animate
  490,25: (
  490,26: crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400
  490,108: )

184 . ID ( Exprs )
  490,17: .
  490,18: Animate
  490,25: (
  490,26: crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400
  490,108: )

255 ID ( Exprs )
  490,18: Animate
  490,25: (
  490,26: crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400
  490,108: )

221 ( Exprs )
  490,25: (
  490,26: crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 + 0, 400
  490,108: )

27 ID Idxs
  490,26: crystalimg
  490,36: [chestarray[posy+2][posx]]

4 [ Expr ]
  490,36: [
  490,37: chestarray[posy+2][posx]
  490,61: ]

76 ID Idxs
  490,37: chestarray
  490,47: [posy+2][posx]

4 [ Expr ] Idxs
  490,47: [
  490,48: posy+2
  490,54: ]
  490,55: [posx]

76 ID
  490,48: posy

65 + MultiplicativeExpr
  490,52: +
  490,53: 2

141 NUM
  490,53: 2

245 ] Idxs
  490,54: ]
  490,55: [posx]

7 [ Expr ]
  490,55: [
  490,56: posx
  490,60: ]

76 ID
  490,56: posx

245 ]
  490,60: ]

245 ]
  490,61: ]

217 , MoreThanOneExpr
  490,63: ,
  490,65: (posx) * 50 + korrx, (posy+2) * 40 + 0, 400

54 ( Expr )
  490,65: (
  490,66: posx
  490,70: )

80 ID
  490,66: posx

265 )
  490,70: )

50 * UnaryExpr
  490,72: *
  490,74: 50

156 NUM
  490,74: 50

65 + MultiplicativeExpr
  490,77: +
  490,79: korrx

141 ID
  490,79: korrx

217 , MoreThanOneExpr
  490,84: ,
  490,86: (posy+2) * 40 + 0, 400

54 ( Expr )
  490,86: (
  490,87: posy+2
  490,93: )

80 ID
  490,87: posy

65 + MultiplicativeExpr
  490,91: +
  490,92: 2

141 NUM
  490,92: 2

265 )
  490,93: )

50 * UnaryExpr
  490,95: *
  490,97: 40

156 NUM
  490,97: 40

65 + MultiplicativeExpr
  490,100: +
  490,102: 0

141 NUM
  490,102: 0

217 , MoreThanOneExpr
  490,103: ,
  490,105: 400

54 NUM
  490,105: 400

238 )
  490,108: )

207 CR_token2
  490,111: 


115 OptionalElse_token2 CRStmtCRs OptionalElse_token1
  491,9: else
  491,13: 
          Shapes.Animate(crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400)  

  493,9: endif

201 CR_token2
  491,13: 


113 ID . ID ( Exprs )
  492,11: Shapes
  492,17: .
  492,18: Animate
  492,25: (
  492,26: crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400
  492,108: )

184 . ID ( Exprs )
  492,17: .
  492,18: Animate
  492,25: (
  492,26: crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400
  492,108: )

255 ID ( Exprs )
  492,18: Animate
  492,25: (
  492,26: crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400
  492,108: )

221 ( Exprs )
  492,25: (
  492,26: crystalimg[chestarray[posy+2][posx]] , (posx) * 50 + korrx, (posy+2) * 40 - 0, 400
  492,108: )

27 ID Idxs
  492,26: crystalimg
  492,36: [chestarray[posy+2][posx]]

4 [ Expr ]
  492,36: [
  492,37: chestarray[posy+2][posx]
  492,61: ]

76 ID Idxs
  492,37: chestarray
  492,47: [posy+2][posx]

4 [ Expr ] Idxs
  492,47: [
  492,48: posy+2
  492,54: ]
  492,55: [posx]

76 ID
  492,48: posy

65 + MultiplicativeExpr
  492,52: +
  492,53: 2

141 NUM
  492,53: 2

245 ] Idxs
  492,54: ]
  492,55: [posx]

7 [ Expr ]
  492,55: [
  492,56: posx
  492,60: ]

76 ID
  492,56: posx

245 ]
  492,60: ]

245 ]
  492,61: ]

217 , MoreThanOneExpr
  492,63: ,
  492,65: (posx) * 50 + korrx, (posy+2) * 40 - 0, 400

54 ( Expr )
  492,65: (
  492,66: posx
  492,70: )

80 ID
  492,66: posx

265 )
  492,70: )

50 * UnaryExpr
  492,72: *
  492,74: 50

156 NUM
  492,74: 50

65 + MultiplicativeExpr
  492,77: +
  492,79: korrx

141 ID
  492,79: korrx

217 , MoreThanOneExpr
  492,84: ,
  492,86: (posy+2) * 40 - 0, 400

54 ( Expr )
  492,86: (
  492,87: posy+2
  492,93: )

80 ID
  492,87: posy

65 + MultiplicativeExpr
  492,91: +
  492,92: 2

141 NUM
  492,92: 2

265 )
  492,93: )

50 * UnaryExpr
  492,95: *
  492,97: 40

156 NUM
  492,97: 40

65 - MultiplicativeExpr
  492,100: -
  492,102: 0

141 NUM
  492,102: 0

217 , MoreThanOneExpr
  492,103: ,
  492,105: 400

54 NUM
  492,105: 400

238 )
  492,108: )

202 CR_token2
  492,111: 


237 OptionalElse_token1
  493,9: endif

207 CR_token2
  493,22: 


122 OptionalElse_token1
  494,7: EndIf

207 CR_token2
  494,12: 


115 CRStmtCRs
  495,1:       'move player down      
      If level[posy+1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "mov

115 CR_token2
  495,30: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  496,7: If
  496,10: level[posy+1][posx] <= 1
  496,35: then
  496,39: 
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    

  509,7: Endif

86 ID Idxs
  496,10: level
  496,15: [posy+1][posx]

4 [ Expr ] Idxs
  496,15: [
  496,16: posy+1
  496,22: ]
  496,23: [posx]

76 ID
  496,16: posy

65 + MultiplicativeExpr
  496,20: +
  496,21: 1

141 NUM
  496,21: 1

245 ] Idxs
  496,22: ]
  496,23: [posx]

7 [ Expr ]
  496,23: [
  496,24: posx
  496,28: ]

76 ID
  496,24: posx

245 ]
  496,28: ]

91 <= AdditiveExpr
  496,30: <=
  496,33: 1

131 NUM
  496,33: 1

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  496,35: then
  496,39: 
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   = 1.6
        posy = posy + 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)    

  509,7: Endif

124 CR_token2
  496,39: 


67 ID = Expr
  497,9: moves
  497,17: =
  497,19: moves + 1

184 = Expr
  497,17: =
  497,19: moves + 1

70 ID
  497,19: moves

59 + MultiplicativeExpr
  497,25: +
  497,27: 1

144 NUM
  497,27: 1

207 CR_token2
  497,28: 


68 ID = Expr
  498,9: newmove
  498,17: =
  498,19: 0

184 = Expr
  498,17: =
  498,19: 0

70 NUM
  498,19: 0

207 CR_token2
  498,20: 


68 ID = Expr
  499,9: movex
  499,17: =
  499,19: 0

184 = Expr
  499,17: =
  499,19: 0

70 NUM
  499,19: 0

207 CR_token2
  499,20: 


68 ID = Expr
  500,9: movey
  500,17: =
  500,19: 1.6

184 = Expr
  500,17: =
  500,19: 1.6

70 NUM
  500,19: 1.6

207 CR_token2
  500,22: 


68 ID = Expr
  501,9: posy
  501,14: =
  501,16: posy + 1

184 = Expr
  501,14: =
  501,16: posy + 1

70 ID
  501,16: posy

59 + MultiplicativeExpr
  501,21: +
  501,23: 1

144 NUM
  501,23: 1

207 CR_token2
  501,24: 


68 ID = Expr
  502,9: gametime
  502,18: =
  502,20: Clock.ElapsedMilliseconds

184 = Expr
  502,18: =
  502,20: Clock.ElapsedMilliseconds

70 ID . ID
  502,20: Clock
  502,25: .
  502,26: ElapsedMilliseconds

5 . ID
  502,25: .
  502,26: ElapsedMilliseconds

260 ID
  502,26: ElapsedMilliseconds

207 CR_token2
  502,45: 


68 ID . ID = Expr
  503,9: GraphicsWindow
  503,23: .
  503,24: BrushColor
  503,35: =
  503,37: "#3975e5"

184 . ID = Expr
  503,23: .
  503,24: BrushColor
  503,35: =
  503,37: "#3975e5"

255 ID = Expr
  503,24: BrushColor
  503,35: =
  503,37: "#3975e5"

221 = Expr
  503,35: =
  503,37: "#3975e5"

57 STR
  503,37: "#3975e5"

207 CR_token2
  503,46: 


68 ID . ID = Expr
  504,9: GraphicsWindow
  504,23: .
  504,24: FontName
  504,33: =
  504,35: "COMIC SANS MS"

184 . ID = Expr
  504,23: .
  504,24: FontName
  504,33: =
  504,35: "COMIC SANS MS"

255 ID = Expr
  504,24: FontName
  504,33: =
  504,35: "COMIC SANS MS"

221 = Expr
  504,33: =
  504,35: "COMIC SANS MS"

57 STR
  504,35: "COMIC SANS MS"

207 CR_token2
  504,50: 


68 ID . ID = Expr
  505,9: GraphicsWindow
  505,23: .
  505,24: FontSize
  505,33: =
  505,35: 25

184 . ID = Expr
  505,23: .
  505,24: FontSize
  505,33: =
  505,35: 25

255 ID = Expr
  505,24: FontSize
  505,33: =
  505,35: 25

221 = Expr
  505,33: =
  505,35: 25

57 NUM
  505,35: 25

207 CR_token2
  505,37: 


68 ID . ID ( Exprs )
  506,9: GraphicsWindow
  506,23: .
  506,24: FillRectangle
  506,37: (
  506,38: 70,690,170,40
  506,51: )

184 . ID ( Exprs )
  506,23: .
  506,24: FillRectangle
  506,37: (
  506,38: 70,690,170,40
  506,51: )

255 ID ( Exprs )
  506,24: FillRectangle
  506,37: (
  506,38: 70,690,170,40
  506,51: )

221 ( Exprs )
  506,37: (
  506,38: 70,690,170,40
  506,51: )

27 NUM
  506,38: 70

217 , MoreThanOneExpr
  506,40: ,
  506,41: 690,170,40

54 NUM
  506,41: 690

217 , MoreThanOneExpr
  506,44: ,
  506,45: 170,40

54 NUM
  506,45: 170

217 , MoreThanOneExpr
  506,48: ,
  506,49: 40

54 NUM
  506,49: 40

238 )
  506,51: )

207 CR_token2
  506,52: 


68 ID . ID = Expr
  507,9: GraphicsWindow
  507,23: .
  507,24: BrushColor
  507,35: =
  507,37: "white"

184 . ID = Expr
  507,23: .
  507,24: BrushColor
  507,35: =
  507,37: "white"

255 ID = Expr
  507,24: BrushColor
  507,35: =
  507,37: "white"

221 = Expr
  507,35: =
  507,37: "white"

57 STR
  507,37: "white"

207 CR_token2
  507,44: 


68 ID . ID ( Exprs )
  508,9: GraphicsWindow
  508,23: .
  508,24: DrawText
  508,32: (
  508,33: 70, 690, "moves "+ moves
  508,57: )

184 . ID ( Exprs )
  508,23: .
  508,24: DrawText
  508,32: (
  508,33: 70, 690, "moves "+ moves
  508,57: )

255 ID ( Exprs )
  508,24: DrawText
  508,32: (
  508,33: 70, 690, "moves "+ moves
  508,57: )

221 ( Exprs )
  508,32: (
  508,33: 70, 690, "moves "+ moves
  508,57: )

27 NUM
  508,33: 70

217 , MoreThanOneExpr
  508,35: ,
  508,37: 690, "moves "+ moves

54 NUM
  508,37: 690

217 , MoreThanOneExpr
  508,40: ,
  508,42: "moves "+ moves

54 STR
  508,42: "moves "

65 + MultiplicativeExpr
  508,50: +
  508,52: moves

141 ID
  508,52: moves

238 )
  508,57: )

207 CR_token2
  508,62: 


122 OptionalElse_token1
  509,7: Endif

207 CR_token2
  509,12: 


115 CRStmtCRs
  510,1:  

115 CR_token2
  510,13: 


115 MoreThanZeroElseIf_token1 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  511,5: ElseIf
  511,11: (bforwardKey = true) and (level[posy-1][posx]<= 2)
  511,62: Then
  511,66: 
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 

  556,5: EndIf

82 ( Expr )
  511,11: (
  511,12: bforwardKey = true
  511,30: )

80 ID
  511,12: bforwardKey

128 = CompExpr
  511,24: =
  511,26: true

117 ID
  511,26: true

265 )
  511,30: )

167 AndExpr_token1 EqNeqExpr
  511,32: and
  511,36: (level[posy-1][posx]<= 2)

102 ( Expr )
  511,36: (
  511,37: level[posy-1][posx]<= 2
  511,60: )

80 ID Idxs
  511,37: level
  511,42: [posy-1][posx]

4 [ Expr ] Idxs
  511,42: [
  511,43: posy-1
  511,49: ]
  511,50: [posx]

76 ID
  511,43: posy

65 - MultiplicativeExpr
  511,47: -
  511,48: 1

141 NUM
  511,48: 1

245 ] Idxs
  511,49: ]
  511,50: [posx]

7 [ Expr ]
  511,50: [
  511,51: posx
  511,55: ]

76 ID
  511,51: posx

245 ]
  511,55: ]

91 <= AdditiveExpr
  511,56: <=
  511,59: 2

131 NUM
  511,59: 2

265 )
  511,60: )

236 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  511,62: Then
  511,66: 
      'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             
      EndIf
      'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     
      EndIf 

  556,5: EndIf

118 CR_token2
  511,66: 


115 CRStmtCRs
  512,1:       'move crystal
      if level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3) Then
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif       

115 CR_token2
  512,20: 


67 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  513,7: if
  513,10: level[posy-1][posx] = 2 And ground[posy-1][posx] <= 1 And (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3)
  513,123: Then
  513,127: 
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             

  540,7: EndIf

86 ID Idxs
  513,10: level
  513,15: [posy-1][posx]

4 [ Expr ] Idxs
  513,15: [
  513,16: posy-1
  513,22: ]
  513,23: [posx]

76 ID
  513,16: posy

65 - MultiplicativeExpr
  513,20: -
  513,21: 1

141 NUM
  513,21: 1

245 ] Idxs
  513,22: ]
  513,23: [posx]

7 [ Expr ]
  513,23: [
  513,24: posx
  513,28: ]

76 ID
  513,24: posx

245 ]
  513,28: ]

128 = CompExpr
  513,30: =
  513,32: 2

117 NUM
  513,32: 2

167 AndExpr_token1 EqNeqExpr
  513,34: And
  513,38: ground[posy-1][posx] <= 1

102 ID Idxs
  513,38: ground
  513,44: [posy-1][posx]

4 [ Expr ] Idxs
  513,44: [
  513,45: posy-1
  513,51: ]
  513,52: [posx]

76 ID
  513,45: posy

65 - MultiplicativeExpr
  513,49: -
  513,50: 1

141 NUM
  513,50: 1

245 ] Idxs
  513,51: ]
  513,52: [posx]

7 [ Expr ]
  513,52: [
  513,53: posx
  513,57: ]

76 ID
  513,53: posx

245 ]
  513,57: ]

91 <= AdditiveExpr
  513,59: <=
  513,62: 1

131 NUM
  513,62: 1

167 AndExpr_token1 EqNeqExpr
  513,64: And
  513,68: (level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3)

102 ( Expr )
  513,68: (
  513,69: level[posy-2][posx] <= 1 or ground[posy-2][posx] = 3
  513,121: )

80 ID Idxs
  513,69: level
  513,74: [posy-2][posx]

4 [ Expr ] Idxs
  513,74: [
  513,75: posy-2
  513,81: ]
  513,82: [posx]

76 ID
  513,75: posy

65 - MultiplicativeExpr
  513,79: -
  513,80: 2

141 NUM
  513,80: 2

245 ] Idxs
  513,81: ]
  513,82: [posx]

7 [ Expr ]
  513,82: [
  513,83: posx
  513,87: ]

76 ID
  513,83: posx

245 ]
  513,87: ]

91 <= AdditiveExpr
  513,89: <=
  513,92: 1

131 NUM
  513,92: 1

183 OrExpr_token1 AndExpr
  513,94: or
  513,97: ground[posy-2][posx] = 3

100 ID Idxs
  513,97: ground
  513,103: [posy-2][posx]

4 [ Expr ] Idxs
  513,103: [
  513,104: posy-2
  513,110: ]
  513,111: [posx]

76 ID
  513,104: posy

65 - MultiplicativeExpr
  513,108: -
  513,109: 2

141 NUM
  513,109: 2

245 ] Idxs
  513,110: ]
  513,111: [posx]

7 [ Expr ]
  513,111: [
  513,112: posx
  513,116: ]

76 ID
  513,112: posx

245 ]
  513,116: ]

128 = CompExpr
  513,118: =
  513,120: 3

117 NUM
  513,120: 3

265 )
  513,121: )

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  513,123: Then
  513,127: 
        chestarray[posy-2][posx] = chestarray[posy-1][posx]
        chestarray[posy-1][posx] = 99 
        level[posy-1][posx] = ground[posy-1][posx]
        level[posy-2][posx] = 2   
        Sound.Stop(Path + "/sokocute01.wav")
        Sound.Play(Path + "/sokocute01.wav")
        'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx
        EndIf
        'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif             

  540,7: EndIf

124 CR_token2
  513,127: 


67 ID Idxs = Expr
  514,9: chestarray
  514,19: [posy-2][posx]
  514,34: =
  514,36: chestarray[posy-1][posx]

184 [ Expr ] Idxs
  514,19: [
  514,20: posy-2
  514,26: ]
  514,27: [posx]

76 ID
  514,20: posy

65 - MultiplicativeExpr
  514,24: -
  514,25: 2

141 NUM
  514,25: 2

245 ] Idxs
  514,26: ]
  514,27: [posx]

7 [ Expr ]
  514,27: [
  514,28: posx
  514,32: ]

76 ID
  514,28: posx

245 ]
  514,32: ]

263 = Expr
  514,34: =
  514,36: chestarray[posy-1][posx]

55 ID Idxs
  514,36: chestarray
  514,46: [posy-1][posx]

5 [ Expr ] Idxs
  514,46: [
  514,47: posy-1
  514,53: ]
  514,54: [posx]

81 ID
  514,47: posy

65 - MultiplicativeExpr
  514,51: -
  514,52: 1

141 NUM
  514,52: 1

233 ] Idxs
  514,53: ]
  514,54: [posx]

8 [ Expr ]
  514,54: [
  514,55: posx
  514,59: ]

81 ID
  514,55: posx

233 ]
  514,59: ]

207 CR_token2
  514,60: 


68 ID Idxs = Expr
  515,9: chestarray
  515,19: [posy-1][posx]
  515,34: =
  515,36: 99

184 [ Expr ] Idxs
  515,19: [
  515,20: posy-1
  515,26: ]
  515,27: [posx]

76 ID
  515,20: posy

65 - MultiplicativeExpr
  515,24: -
  515,25: 1

141 NUM
  515,25: 1

245 ] Idxs
  515,26: ]
  515,27: [posx]

7 [ Expr ]
  515,27: [
  515,28: posx
  515,32: ]

76 ID
  515,28: posx

245 ]
  515,32: ]

263 = Expr
  515,34: =
  515,36: 99

55 NUM
  515,36: 99

207 CR_token2
  515,39: 


68 ID Idxs = Expr
  516,9: level
  516,14: [posy-1][posx]
  516,29: =
  516,31: ground[posy-1][posx]

184 [ Expr ] Idxs
  516,14: [
  516,15: posy-1
  516,21: ]
  516,22: [posx]

76 ID
  516,15: posy

65 - MultiplicativeExpr
  516,19: -
  516,20: 1

141 NUM
  516,20: 1

245 ] Idxs
  516,21: ]
  516,22: [posx]

7 [ Expr ]
  516,22: [
  516,23: posx
  516,27: ]

76 ID
  516,23: posx

245 ]
  516,27: ]

263 = Expr
  516,29: =
  516,31: ground[posy-1][posx]

55 ID Idxs
  516,31: ground
  516,37: [posy-1][posx]

5 [ Expr ] Idxs
  516,37: [
  516,38: posy-1
  516,44: ]
  516,45: [posx]

81 ID
  516,38: posy

65 - MultiplicativeExpr
  516,42: -
  516,43: 1

141 NUM
  516,43: 1

233 ] Idxs
  516,44: ]
  516,45: [posx]

8 [ Expr ]
  516,45: [
  516,46: posx
  516,50: ]

81 ID
  516,46: posx

233 ]
  516,50: ]

207 CR_token2
  516,51: 


68 ID Idxs = Expr
  517,9: level
  517,14: [posy-2][posx]
  517,29: =
  517,31: 2

184 [ Expr ] Idxs
  517,14: [
  517,15: posy-2
  517,21: ]
  517,22: [posx]

76 ID
  517,15: posy

65 - MultiplicativeExpr
  517,19: -
  517,20: 2

141 NUM
  517,20: 2

245 ] Idxs
  517,21: ]
  517,22: [posx]

7 [ Expr ]
  517,22: [
  517,23: posx
  517,27: ]

76 ID
  517,23: posx

245 ]
  517,27: ]

263 = Expr
  517,29: =
  517,31: 2

55 NUM
  517,31: 2

207 CR_token2
  517,35: 


68 ID . ID ( Exprs )
  518,9: Sound
  518,14: .
  518,15: Stop
  518,19: (
  518,20: Path + "/sokocute01.wav"
  518,44: )

184 . ID ( Exprs )
  518,14: .
  518,15: Stop
  518,19: (
  518,20: Path + "/sokocute01.wav"
  518,44: )

255 ID ( Exprs )
  518,15: Stop
  518,19: (
  518,20: Path + "/sokocute01.wav"
  518,44: )

221 ( Exprs )
  518,19: (
  518,20: Path + "/sokocute01.wav"
  518,44: )

27 ID
  518,20: Path

65 + MultiplicativeExpr
  518,25: +
  518,27: "/sokocute01.wav"

141 STR
  518,27: "/sokocute01.wav"

238 )
  518,44: )

207 CR_token2
  518,45: 


68 ID . ID ( Exprs )
  519,9: Sound
  519,14: .
  519,15: Play
  519,19: (
  519,20: Path + "/sokocute01.wav"
  519,44: )

184 . ID ( Exprs )
  519,14: .
  519,15: Play
  519,19: (
  519,20: Path + "/sokocute01.wav"
  519,44: )

255 ID ( Exprs )
  519,15: Play
  519,19: (
  519,20: Path + "/sokocute01.wav"
  519,44: )

221 ( Exprs )
  519,19: (
  519,20: Path + "/sokocute01.wav"
  519,44: )

27 ID
  519,20: Path

65 + MultiplicativeExpr
  519,25: +
  519,27: "/sokocute01.wav"

141 STR
  519,27: "/sokocute01.wav"

238 )
  519,44: )

207 CR_token2
  519,45: 


122 CRStmtCRs
  520,1:         'move crystal into water
        If ground[posy-2][posx] = 3 then
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1
        EndIf
        If (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1) then
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
       

122 CR_token2
  520,33: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  521,9: If
  521,12: ground[posy-2][posx] = 3
  521,37: then
  521,41: 
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1

  525,9: EndIf

86 ID Idxs
  521,12: ground
  521,18: [posy-2][posx]

4 [ Expr ] Idxs
  521,18: [
  521,19: posy-2
  521,25: ]
  521,26: [posx]

76 ID
  521,19: posy

65 - MultiplicativeExpr
  521,23: -
  521,24: 2

141 NUM
  521,24: 2

245 ] Idxs
  521,25: ]
  521,26: [posx]

7 [ Expr ]
  521,26: [
  521,27: posx
  521,31: ]

76 ID
  521,27: posx

245 ]
  521,31: ]

128 = CompExpr
  521,33: =
  521,35: 3

117 NUM
  521,35: 3

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  521,37: then
  521,41: 
          watertime = Clock.ElapsedMilliseconds
          gemwater = chestarray[posy-2][posx]
          gemzoom = 1

  525,9: EndIf

124 CR_token2
  521,41: 


67 ID = Expr
  522,11: watertime
  522,21: =
  522,23: Clock.ElapsedMilliseconds

184 = Expr
  522,21: =
  522,23: Clock.ElapsedMilliseconds

70 ID . ID
  522,23: Clock
  522,28: .
  522,29: ElapsedMilliseconds

5 . ID
  522,28: .
  522,29: ElapsedMilliseconds

260 ID
  522,29: ElapsedMilliseconds

207 CR_token2
  522,48: 


68 ID = Expr
  523,11: gemwater
  523,20: =
  523,22: chestarray[posy-2][posx]

184 = Expr
  523,20: =
  523,22: chestarray[posy-2][posx]

70 ID Idxs
  523,22: chestarray
  523,32: [posy-2][posx]

5 [ Expr ] Idxs
  523,32: [
  523,33: posy-2
  523,39: ]
  523,40: [posx]

81 ID
  523,33: posy

65 - MultiplicativeExpr
  523,37: -
  523,38: 2

141 NUM
  523,38: 2

233 ] Idxs
  523,39: ]
  523,40: [posx]

8 [ Expr ]
  523,40: [
  523,41: posx
  523,45: ]

81 ID
  523,41: posx

233 ]
  523,45: ]

207 CR_token2
  523,46: 


68 ID = Expr
  524,11: gemzoom
  524,19: =
  524,21: 1

184 = Expr
  524,19: =
  524,21: 1

70 NUM
  524,21: 1

207 CR_token2
  524,22: 


122 OptionalElse_token1
  525,9: EndIf

207 CR_token2
  525,14: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  526,9: If
  526,12: (ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0) Or (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1)
  526,129: then
  526,133: 
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx

  531,9: EndIf

86 ( Expr )
  526,12: (
  526,13: ground[posy-2][posx] = 1 and ground[posy-1][posx] <= 0
  526,67: )

80 ID Idxs
  526,13: ground
  526,19: [posy-2][posx]

4 [ Expr ] Idxs
  526,19: [
  526,20: posy-2
  526,26: ]
  526,27: [posx]

76 ID
  526,20: posy

65 - MultiplicativeExpr
  526,24: -
  526,25: 2

141 NUM
  526,25: 2

245 ] Idxs
  526,26: ]
  526,27: [posx]

7 [ Expr ]
  526,27: [
  526,28: posx
  526,32: ]

76 ID
  526,28: posx

245 ]
  526,32: ]

128 = CompExpr
  526,34: =
  526,36: 1

117 NUM
  526,36: 1

167 AndExpr_token1 EqNeqExpr
  526,38: and
  526,42: ground[posy-1][posx] <= 0

102 ID Idxs
  526,42: ground
  526,48: [posy-1][posx]

4 [ Expr ] Idxs
  526,48: [
  526,49: posy-1
  526,55: ]
  526,56: [posx]

76 ID
  526,49: posy

65 - MultiplicativeExpr
  526,53: -
  526,54: 1

141 NUM
  526,54: 1

245 ] Idxs
  526,55: ]
  526,56: [posx]

7 [ Expr ]
  526,56: [
  526,57: posx
  526,61: ]

76 ID
  526,57: posx

245 ]
  526,61: ]

91 <= AdditiveExpr
  526,63: <=
  526,66: 0

131 NUM
  526,66: 0

265 )
  526,67: )

183 OrExpr_token1 AndExpr
  526,69: Or
  526,72: (ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1)

100 ( Expr )
  526,72: (
  526,73: ground[posy-2][posx] <= 0 and ground[posy-1][posx] = 1
  526,127: )

80 ID Idxs
  526,73: ground
  526,79: [posy-2][posx]

4 [ Expr ] Idxs
  526,79: [
  526,80: posy-2
  526,86: ]
  526,87: [posx]

76 ID
  526,80: posy

65 - MultiplicativeExpr
  526,84: -
  526,85: 2

141 NUM
  526,85: 2

245 ] Idxs
  526,86: ]
  526,87: [posx]

7 [ Expr ]
  526,87: [
  526,88: posx
  526,92: ]

76 ID
  526,88: posx

245 ]
  526,92: ]

91 <= AdditiveExpr
  526,94: <=
  526,97: 0

131 NUM
  526,97: 0

167 AndExpr_token1 EqNeqExpr
  526,99: and
  526,103: ground[posy-1][posx] = 1

102 ID Idxs
  526,103: ground
  526,109: [posy-1][posx]

4 [ Expr ] Idxs
  526,109: [
  526,110: posy-1
  526,116: ]
  526,117: [posx]

76 ID
  526,110: posy

65 - MultiplicativeExpr
  526,114: -
  526,115: 1

141 NUM
  526,115: 1

245 ] Idxs
  526,116: ]
  526,117: [posx]

7 [ Expr ]
  526,117: [
  526,118: posx
  526,122: ]

76 ID
  526,118: posx

245 ]
  526,122: ]

134 = CompExpr
  526,124: =
  526,126: 1

117 NUM
  526,126: 1

265 )
  526,127: )

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  526,129: then
  526,133: 
          gemtime = Clock.ElapsedMilliseconds
          gemchng = chestarray[posy-2][posx]
          gemy    = posy-2
          gemx    = posx

  531,9: EndIf

124 CR_token2
  526,133: 


67 ID = Expr
  527,11: gemtime
  527,19: =
  527,21: Clock.ElapsedMilliseconds

184 = Expr
  527,19: =
  527,21: Clock.ElapsedMilliseconds

70 ID . ID
  527,21: Clock
  527,26: .
  527,27: ElapsedMilliseconds

5 . ID
  527,26: .
  527,27: ElapsedMilliseconds

260 ID
  527,27: ElapsedMilliseconds

207 CR_token2
  527,46: 


68 ID = Expr
  528,11: gemchng
  528,19: =
  528,21: chestarray[posy-2][posx]

184 = Expr
  528,19: =
  528,21: chestarray[posy-2][posx]

70 ID Idxs
  528,21: chestarray
  528,31: [posy-2][posx]

5 [ Expr ] Idxs
  528,31: [
  528,32: posy-2
  528,38: ]
  528,39: [posx]

81 ID
  528,32: posy

65 - MultiplicativeExpr
  528,36: -
  528,37: 2

141 NUM
  528,37: 2

233 ] Idxs
  528,38: ]
  528,39: [posx]

8 [ Expr ]
  528,39: [
  528,40: posx
  528,44: ]

81 ID
  528,40: posx

233 ]
  528,44: ]

207 CR_token2
  528,45: 


68 ID = Expr
  529,11: gemy
  529,19: =
  529,21: posy-2

184 = Expr
  529,19: =
  529,21: posy-2

70 ID
  529,21: posy

59 - MultiplicativeExpr
  529,25: -
  529,26: 2

144 NUM
  529,26: 2

207 CR_token2
  529,27: 


68 ID = Expr
  530,11: gemx
  530,19: =
  530,21: posx

184 = Expr
  530,19: =
  530,21: posx

70 ID
  530,21: posx

207 CR_token2
  530,25: 


122 OptionalElse_token1
  531,9: EndIf

207 CR_token2
  531,14: 


122 CRStmtCRs
  532,1:         'animate crystal
        if ground[posy-1][posx] = 1 then
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
   

122 CR_token2
  532,25: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  533,9: if
  533,12: ground[posy-1][posx] = 1
  533,37: then
  533,41: 
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  

  535,9: elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif

86 ID Idxs
  533,12: ground
  533,18: [posy-1][posx]

4 [ Expr ] Idxs
  533,18: [
  533,19: posy-1
  533,25: ]
  533,26: [posx]

76 ID
  533,19: posy

65 - MultiplicativeExpr
  533,23: -
  533,24: 1

141 NUM
  533,24: 1

245 ] Idxs
  533,25: ]
  533,26: [posx]

7 [ Expr ]
  533,26: [
  533,27: posx
  533,31: ]

76 ID
  533,27: posx

245 ]
  533,31: ]

128 = CompExpr
  533,33: =
  533,35: 1

117 NUM
  533,35: 1

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  533,37: then
  533,41: 
          Shapes.Animate(crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  

  535,9: elseif ground[posy-2][posx] = 3 then
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            
        else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif

124 CR_token2
  533,41: 


67 ID . ID ( Exprs )
  534,11: Shapes
  534,17: .
  534,18: Animate
  534,25: (
  534,26: crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400
  534,108: )

184 . ID ( Exprs )
  534,17: .
  534,18: Animate
  534,25: (
  534,26: crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400
  534,108: )

255 ID ( Exprs )
  534,18: Animate
  534,25: (
  534,26: crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400
  534,108: )

221 ( Exprs )
  534,25: (
  534,26: crystalbnk[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400
  534,108: )

27 ID Idxs
  534,26: crystalbnk
  534,36: [chestarray[posy-2][posx]]

4 [ Expr ]
  534,36: [
  534,37: chestarray[posy-2][posx]
  534,61: ]

76 ID Idxs
  534,37: chestarray
  534,47: [posy-2][posx]

4 [ Expr ] Idxs
  534,47: [
  534,48: posy-2
  534,54: ]
  534,55: [posx]

76 ID
  534,48: posy

65 - MultiplicativeExpr
  534,52: -
  534,53: 2

141 NUM
  534,53: 2

245 ] Idxs
  534,54: ]
  534,55: [posx]

7 [ Expr ]
  534,55: [
  534,56: posx
  534,60: ]

76 ID
  534,56: posx

245 ]
  534,60: ]

245 ]
  534,61: ]

217 , MoreThanOneExpr
  534,63: ,
  534,65: (posx) * 50 + korrx, (posy-2) * 40 - 0, 400

54 ( Expr )
  534,65: (
  534,66: posx
  534,70: )

80 ID
  534,66: posx

265 )
  534,70: )

50 * UnaryExpr
  534,72: *
  534,74: 50

156 NUM
  534,74: 50

65 + MultiplicativeExpr
  534,77: +
  534,79: korrx

141 ID
  534,79: korrx

217 , MoreThanOneExpr
  534,84: ,
  534,86: (posy-2) * 40 - 0, 400

54 ( Expr )
  534,86: (
  534,87: posy-2
  534,93: )

80 ID
  534,87: posy

65 - MultiplicativeExpr
  534,91: -
  534,92: 2

141 NUM
  534,92: 2

265 )
  534,93: )

50 * UnaryExpr
  534,95: *
  534,97: 40

156 NUM
  534,97: 40

65 - MultiplicativeExpr
  534,100: -
  534,102: 0

141 NUM
  534,102: 0

217 , MoreThanOneExpr
  534,103: ,
  534,105: 400

54 NUM
  534,105: 400

238 )
  534,108: )

207 CR_token2
  534,111: 


122 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  535,9: elseif
  535,16: ground[posy-2][posx] = 3
  535,41: then
  535,45: 
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            

  537,9: else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif

82 ID Idxs
  535,16: ground
  535,22: [posy-2][posx]

4 [ Expr ] Idxs
  535,22: [
  535,23: posy-2
  535,29: ]
  535,30: [posx]

76 ID
  535,23: posy

65 - MultiplicativeExpr
  535,27: -
  535,28: 2

141 NUM
  535,28: 2

245 ] Idxs
  535,29: ]
  535,30: [posx]

7 [ Expr ]
  535,30: [
  535,31: posx
  535,35: ]

76 ID
  535,31: posx

245 ]
  535,35: ]

128 = CompExpr
  535,37: =
  535,39: 3

117 NUM
  535,39: 3

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  535,41: then
  535,45: 
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400)            

  537,9: else
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  
        endif

118 CR_token2
  535,45: 


67 ID . ID ( Exprs )
  536,11: Shapes
  536,17: .
  536,18: Animate
  536,25: (
  536,26: crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400
  536,108: )

184 . ID ( Exprs )
  536,17: .
  536,18: Animate
  536,25: (
  536,26: crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400
  536,108: )

255 ID ( Exprs )
  536,18: Animate
  536,25: (
  536,26: crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400
  536,108: )

221 ( Exprs )
  536,25: (
  536,26: crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 + 0, 400
  536,108: )

27 ID Idxs
  536,26: crystalimg
  536,36: [chestarray[posy-2][posx]]

4 [ Expr ]
  536,36: [
  536,37: chestarray[posy-2][posx]
  536,61: ]

76 ID Idxs
  536,37: chestarray
  536,47: [posy-2][posx]

4 [ Expr ] Idxs
  536,47: [
  536,48: posy-2
  536,54: ]
  536,55: [posx]

76 ID
  536,48: posy

65 - MultiplicativeExpr
  536,52: -
  536,53: 2

141 NUM
  536,53: 2

245 ] Idxs
  536,54: ]
  536,55: [posx]

7 [ Expr ]
  536,55: [
  536,56: posx
  536,60: ]

76 ID
  536,56: posx

245 ]
  536,60: ]

245 ]
  536,61: ]

217 , MoreThanOneExpr
  536,63: ,
  536,65: (posx) * 50 + korrx, (posy-2) * 40 + 0, 400

54 ( Expr )
  536,65: (
  536,66: posx
  536,70: )

80 ID
  536,66: posx

265 )
  536,70: )

50 * UnaryExpr
  536,72: *
  536,74: 50

156 NUM
  536,74: 50

65 + MultiplicativeExpr
  536,77: +
  536,79: korrx

141 ID
  536,79: korrx

217 , MoreThanOneExpr
  536,84: ,
  536,86: (posy-2) * 40 + 0, 400

54 ( Expr )
  536,86: (
  536,87: posy-2
  536,93: )

80 ID
  536,87: posy

65 - MultiplicativeExpr
  536,91: -
  536,92: 2

141 NUM
  536,92: 2

265 )
  536,93: )

50 * UnaryExpr
  536,95: *
  536,97: 40

156 NUM
  536,97: 40

65 + MultiplicativeExpr
  536,100: +
  536,102: 0

141 NUM
  536,102: 0

217 , MoreThanOneExpr
  536,103: ,
  536,105: 400

54 NUM
  536,105: 400

238 )
  536,108: )

207 CR_token2
  536,121: 


115 OptionalElse_token2 CRStmtCRs OptionalElse_token1
  537,9: else
  537,13: 
          Shapes.Animate(crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400)  

  539,9: endif

201 CR_token2
  537,13: 


113 ID . ID ( Exprs )
  538,11: Shapes
  538,17: .
  538,18: Animate
  538,25: (
  538,26: crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400
  538,108: )

184 . ID ( Exprs )
  538,17: .
  538,18: Animate
  538,25: (
  538,26: crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400
  538,108: )

255 ID ( Exprs )
  538,18: Animate
  538,25: (
  538,26: crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400
  538,108: )

221 ( Exprs )
  538,25: (
  538,26: crystalimg[chestarray[posy-2][posx]] , (posx) * 50 + korrx, (posy-2) * 40 - 0, 400
  538,108: )

27 ID Idxs
  538,26: crystalimg
  538,36: [chestarray[posy-2][posx]]

4 [ Expr ]
  538,36: [
  538,37: chestarray[posy-2][posx]
  538,61: ]

76 ID Idxs
  538,37: chestarray
  538,47: [posy-2][posx]

4 [ Expr ] Idxs
  538,47: [
  538,48: posy-2
  538,54: ]
  538,55: [posx]

76 ID
  538,48: posy

65 - MultiplicativeExpr
  538,52: -
  538,53: 2

141 NUM
  538,53: 2

245 ] Idxs
  538,54: ]
  538,55: [posx]

7 [ Expr ]
  538,55: [
  538,56: posx
  538,60: ]

76 ID
  538,56: posx

245 ]
  538,60: ]

245 ]
  538,61: ]

217 , MoreThanOneExpr
  538,63: ,
  538,65: (posx) * 50 + korrx, (posy-2) * 40 - 0, 400

54 ( Expr )
  538,65: (
  538,66: posx
  538,70: )

80 ID
  538,66: posx

265 )
  538,70: )

50 * UnaryExpr
  538,72: *
  538,74: 50

156 NUM
  538,74: 50

65 + MultiplicativeExpr
  538,77: +
  538,79: korrx

141 ID
  538,79: korrx

217 , MoreThanOneExpr
  538,84: ,
  538,86: (posy-2) * 40 - 0, 400

54 ( Expr )
  538,86: (
  538,87: posy-2
  538,93: )

80 ID
  538,87: posy

65 - MultiplicativeExpr
  538,91: -
  538,92: 2

141 NUM
  538,92: 2

265 )
  538,93: )

50 * UnaryExpr
  538,95: *
  538,97: 40

156 NUM
  538,97: 40

65 - MultiplicativeExpr
  538,100: -
  538,102: 0

141 NUM
  538,102: 0

217 , MoreThanOneExpr
  538,103: ,
  538,105: 400

54 NUM
  538,105: 400

238 )
  538,108: )

202 CR_token2
  538,111: 


237 OptionalElse_token1
  539,9: endif

207 CR_token2
  539,27: 


122 OptionalElse_token1
  540,7: EndIf

207 CR_token2
  540,12: 


115 CRStmtCRs
  541,1:       'move player up
      if level[posy-1][posx] <= 1 then
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ move

115 CR_token2
  541,22: 


67 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  542,7: if
  542,10: level[posy-1][posx] <= 1
  542,35: then
  542,39: 
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     

  555,7: EndIf

86 ID Idxs
  542,10: level
  542,15: [posy-1][posx]

4 [ Expr ] Idxs
  542,15: [
  542,16: posy-1
  542,22: ]
  542,23: [posx]

76 ID
  542,16: posy

65 - MultiplicativeExpr
  542,20: -
  542,21: 1

141 NUM
  542,21: 1

245 ] Idxs
  542,22: ]
  542,23: [posx]

7 [ Expr ]
  542,23: [
  542,24: posx
  542,28: ]

76 ID
  542,24: posx

245 ]
  542,28: ]

91 <= AdditiveExpr
  542,30: <=
  542,33: 1

131 NUM
  542,33: 1

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  542,35: then
  542,39: 
        moves   = moves + 1
        newmove = 0
        movex   = 0
        movey   =-1.6
        posy = posy - 1
        gametime = Clock.ElapsedMilliseconds
        GraphicsWindow.BrushColor = "#3975e5"
        GraphicsWindow.FontName = "COMIC SANS MS"
        GraphicsWindow.FontSize = 25
        GraphicsWindow.FillRectangle(70,690,170,40)
        GraphicsWindow.BrushColor = "white"
        GraphicsWindow.DrawText(70, 690, "moves "+ moves)     

  555,7: EndIf

124 CR_token2
  542,39: 


67 ID = Expr
  543,9: moves
  543,17: =
  543,19: moves + 1

184 = Expr
  543,17: =
  543,19: moves + 1

70 ID
  543,19: moves

59 + MultiplicativeExpr
  543,25: +
  543,27: 1

144 NUM
  543,27: 1

207 CR_token2
  543,28: 


68 ID = Expr
  544,9: newmove
  544,17: =
  544,19: 0

184 = Expr
  544,17: =
  544,19: 0

70 NUM
  544,19: 0

207 CR_token2
  544,20: 


68 ID = Expr
  545,9: movex
  545,17: =
  545,19: 0

184 = Expr
  545,17: =
  545,19: 0

70 NUM
  545,19: 0

207 CR_token2
  545,20: 


68 ID = Expr
  546,9: movey
  546,17: =
  546,18: -1.6

184 = Expr
  546,17: =
  546,18: -1.6

70 - Primary
  546,18: -
  546,19: 1.6

193 NUM
  546,19: 1.6

207 CR_token2
  546,22: 


68 ID = Expr
  547,9: posy
  547,14: =
  547,16: posy - 1

184 = Expr
  547,14: =
  547,16: posy - 1

70 ID
  547,16: posy

59 - MultiplicativeExpr
  547,21: -
  547,23: 1

144 NUM
  547,23: 1

207 CR_token2
  547,24: 


68 ID = Expr
  548,9: gametime
  548,18: =
  548,20: Clock.ElapsedMilliseconds

184 = Expr
  548,18: =
  548,20: Clock.ElapsedMilliseconds

70 ID . ID
  548,20: Clock
  548,25: .
  548,26: ElapsedMilliseconds

5 . ID
  548,25: .
  548,26: ElapsedMilliseconds

260 ID
  548,26: ElapsedMilliseconds

207 CR_token2
  548,45: 


68 ID . ID = Expr
  549,9: GraphicsWindow
  549,23: .
  549,24: BrushColor
  549,35: =
  549,37: "#3975e5"

184 . ID = Expr
  549,23: .
  549,24: BrushColor
  549,35: =
  549,37: "#3975e5"

255 ID = Expr
  549,24: BrushColor
  549,35: =
  549,37: "#3975e5"

221 = Expr
  549,35: =
  549,37: "#3975e5"

57 STR
  549,37: "#3975e5"

207 CR_token2
  549,46: 


68 ID . ID = Expr
  550,9: GraphicsWindow
  550,23: .
  550,24: FontName
  550,33: =
  550,35: "COMIC SANS MS"

184 . ID = Expr
  550,23: .
  550,24: FontName
  550,33: =
  550,35: "COMIC SANS MS"

255 ID = Expr
  550,24: FontName
  550,33: =
  550,35: "COMIC SANS MS"

221 = Expr
  550,33: =
  550,35: "COMIC SANS MS"

57 STR
  550,35: "COMIC SANS MS"

207 CR_token2
  550,50: 


68 ID . ID = Expr
  551,9: GraphicsWindow
  551,23: .
  551,24: FontSize
  551,33: =
  551,35: 25

184 . ID = Expr
  551,23: .
  551,24: FontSize
  551,33: =
  551,35: 25

255 ID = Expr
  551,24: FontSize
  551,33: =
  551,35: 25

221 = Expr
  551,33: =
  551,35: 25

57 NUM
  551,35: 25

207 CR_token2
  551,37: 


68 ID . ID ( Exprs )
  552,9: GraphicsWindow
  552,23: .
  552,24: FillRectangle
  552,37: (
  552,38: 70,690,170,40
  552,51: )

184 . ID ( Exprs )
  552,23: .
  552,24: FillRectangle
  552,37: (
  552,38: 70,690,170,40
  552,51: )

255 ID ( Exprs )
  552,24: FillRectangle
  552,37: (
  552,38: 70,690,170,40
  552,51: )

221 ( Exprs )
  552,37: (
  552,38: 70,690,170,40
  552,51: )

27 NUM
  552,38: 70

217 , MoreThanOneExpr
  552,40: ,
  552,41: 690,170,40

54 NUM
  552,41: 690

217 , MoreThanOneExpr
  552,44: ,
  552,45: 170,40

54 NUM
  552,45: 170

217 , MoreThanOneExpr
  552,48: ,
  552,49: 40

54 NUM
  552,49: 40

238 )
  552,51: )

207 CR_token2
  552,52: 


68 ID . ID = Expr
  553,9: GraphicsWindow
  553,23: .
  553,24: BrushColor
  553,35: =
  553,37: "white"

184 . ID = Expr
  553,23: .
  553,24: BrushColor
  553,35: =
  553,37: "white"

255 ID = Expr
  553,24: BrushColor
  553,35: =
  553,37: "white"

221 = Expr
  553,35: =
  553,37: "white"

57 STR
  553,37: "white"

207 CR_token2
  553,44: 


68 ID . ID ( Exprs )
  554,9: GraphicsWindow
  554,23: .
  554,24: DrawText
  554,32: (
  554,33: 70, 690, "moves "+ moves
  554,57: )

184 . ID ( Exprs )
  554,23: .
  554,24: DrawText
  554,32: (
  554,33: 70, 690, "moves "+ moves
  554,57: )

255 ID ( Exprs )
  554,24: DrawText
  554,32: (
  554,33: 70, 690, "moves "+ moves
  554,57: )

221 ( Exprs )
  554,32: (
  554,33: 70, 690, "moves "+ moves
  554,57: )

27 NUM
  554,33: 70

217 , MoreThanOneExpr
  554,35: ,
  554,37: 690, "moves "+ moves

54 NUM
  554,37: 690

217 , MoreThanOneExpr
  554,40: ,
  554,42: "moves "+ moves

54 STR
  554,42: "moves "

65 + MultiplicativeExpr
  554,50: +
  554,52: moves

141 ID
  554,52: moves

238 )
  554,57: )

207 CR_token2
  554,63: 


122 OptionalElse_token1
  555,7: EndIf

207 CR_token2
  555,13: 


115 OptionalElse_token1
  556,5: EndIf

207 CR_token2
  556,20: 


122 OptionalElse_token1
  557,3: EndIf

206 CR_token2
  557,8: 


257 Stmt_token8
  558,1: EndSub

97 Stmt_token7 ID CRStmtCRs Stmt_token8
  563,1: Sub
  563,5: Sort
  563,11: 
   For y = 0 To 15
     For x = 0 To 15
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])
    EndFor
  EndFor  

  574,1: EndSub

244 ID CRStmtCRs Stmt_token8
  563,5: Sort
  563,11: 
   For y = 0 To 15
     For x = 0 To 15
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])
    EndFor
  EndFor  

  574,1: EndSub

199 CR_token2
  563,11: 


105 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  564,4: For
  564,8: y
  564,10: =
  564,12: 0
  564,14: To
  564,17: 15
  564,19: 
     For x = 0 To 15
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])
    EndFor

  573,3: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  564,8: y
  564,10: =
  564,12: 0
  564,14: To
  564,17: 15
  564,19: 
     For x = 0 To 15
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])
    EndFor

  573,3: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  564,10: =
  564,12: 0
  564,14: To
  564,17: 15
  564,19: 
     For x = 0 To 15
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])
    EndFor

  573,3: EndFor

56 NUM
  564,12: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  564,14: To
  564,17: 15
  564,19: 
     For x = 0 To 15
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])
    EndFor

  573,3: EndFor

83 NUM
  564,17: 15

145 CR_token2
  564,19: 


88 Stmt_token4 ID = Expr Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  565,6: For
  565,10: x
  565,12: =
  565,14: 0
  565,16: To
  565,19: 15
  565,21: 
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])

  572,5: EndFor

267 ID = Expr Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  565,10: x
  565,12: =
  565,14: 0
  565,16: To
  565,19: 15
  565,21: 
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])

  572,5: EndFor

266 = Expr Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  565,12: =
  565,14: 0
  565,16: To
  565,19: 15
  565,21: 
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])

  572,5: EndFor

56 NUM
  565,14: 0

264 Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  565,16: To
  565,19: 15
  565,21: 
       If level[y][x] = 3 Then
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   
       endif
      'GraphicsWindow.DrawText(11*i+520,11*p+30,level[p][i])

  572,5: EndFor

83 NUM
  565,19: 15

145 CR_token2
  565,21: 


88 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  566,8: If
  566,11: level[y][x] = 3
  566,27: Then
  566,31: 
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   

  570,8: endif

86 ID Idxs
  566,11: level
  566,16: [y][x]

4 [ Expr ] Idxs
  566,16: [
  566,17: y
  566,18: ]
  566,19: [x]

76 ID
  566,17: y

245 ] Idxs
  566,18: ]
  566,19: [x]

7 [ Expr ]
  566,19: [
  566,20: x
  566,21: ]

76 ID
  566,20: x

245 ]
  566,21: ]

128 = CompExpr
  566,23: =
  566,25: 3

117 NUM
  566,25: 3

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  566,27: Then
  566,31: 
          Shapes.Remove(levelshapes[y][x])
          levelshapes[y][x] = Shapes.AddImage(image["3"])
          Shapes.Move(levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0)   

  570,8: endif

124 CR_token2
  566,31: 


67 ID . ID ( Exprs )
  567,11: Shapes
  567,17: .
  567,18: Remove
  567,24: (
  567,25: levelshapes[y][x]
  567,42: )

184 . ID ( Exprs )
  567,17: .
  567,18: Remove
  567,24: (
  567,25: levelshapes[y][x]
  567,42: )

255 ID ( Exprs )
  567,18: Remove
  567,24: (
  567,25: levelshapes[y][x]
  567,42: )

221 ( Exprs )
  567,24: (
  567,25: levelshapes[y][x]
  567,42: )

27 ID Idxs
  567,25: levelshapes
  567,36: [y][x]

4 [ Expr ] Idxs
  567,36: [
  567,37: y
  567,38: ]
  567,39: [x]

76 ID
  567,37: y

245 ] Idxs
  567,38: ]
  567,39: [x]

7 [ Expr ]
  567,39: [
  567,40: x
  567,41: ]

76 ID
  567,40: x

245 ]
  567,41: ]

238 )
  567,42: )

207 CR_token2
  567,43: 


68 ID Idxs = Expr
  568,11: levelshapes
  568,22: [y][x]
  568,29: =
  568,31: Shapes.AddImage(image["3"])

184 [ Expr ] Idxs
  568,22: [
  568,23: y
  568,24: ]
  568,25: [x]

76 ID
  568,23: y

245 ] Idxs
  568,24: ]
  568,25: [x]

7 [ Expr ]
  568,25: [
  568,26: x
  568,27: ]

76 ID
  568,26: x

245 ]
  568,27: ]

263 = Expr
  568,29: =
  568,31: Shapes.AddImage(image["3"])

55 ID . ID ( Exprs )
  568,31: Shapes
  568,37: .
  568,38: AddImage
  568,46: (
  568,47: image["3"]
  568,57: )

5 . ID ( Exprs )
  568,37: .
  568,38: AddImage
  568,46: (
  568,47: image["3"]
  568,57: )

260 ID ( Exprs )
  568,38: AddImage
  568,46: (
  568,47: image["3"]
  568,57: )

24 ( Exprs )
  568,46: (
  568,47: image["3"]
  568,57: )

26 ID Idxs
  568,47: image
  568,52: ["3"]

4 [ Expr ]
  568,52: [
  568,53: "3"
  568,56: ]

76 STR
  568,53: "3"

245 ]
  568,56: ]

249 )
  568,57: )

207 CR_token2
  568,58: 


68 ID . ID ( Exprs )
  569,11: Shapes
  569,17: .
  569,18: Move
  569,22: (
  569,23: levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0
  569,72: )

184 . ID ( Exprs )
  569,17: .
  569,18: Move
  569,22: (
  569,23: levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0
  569,72: )

255 ID ( Exprs )
  569,18: Move
  569,22: (
  569,23: levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0
  569,72: )

221 ( Exprs )
  569,22: (
  569,23: levelshapes[y][x], (x) * 50 + korrx, (y) * 40 - 0
  569,72: )

27 ID Idxs
  569,23: levelshapes
  569,34: [y][x]

4 [ Expr ] Idxs
  569,34: [
  569,35: y
  569,36: ]
  569,37: [x]

76 ID
  569,35: y

245 ] Idxs
  569,36: ]
  569,37: [x]

7 [ Expr ]
  569,37: [
  569,38: x
  569,39: ]

76 ID
  569,38: x

245 ]
  569,39: ]

217 , MoreThanOneExpr
  569,40: ,
  569,42: (x) * 50 + korrx, (y) * 40 - 0

54 ( Expr )
  569,42: (
  569,43: x
  569,44: )

80 ID
  569,43: x

265 )
  569,44: )

50 * UnaryExpr
  569,46: *
  569,48: 50

156 NUM
  569,48: 50

65 + MultiplicativeExpr
  569,51: +
  569,53: korrx

141 ID
  569,53: korrx

217 , MoreThanOneExpr
  569,58: ,
  569,60: (y) * 40 - 0

54 ( Expr )
  569,60: (
  569,61: y
  569,62: )

80 ID
  569,61: y

265 )
  569,62: )

50 * UnaryExpr
  569,64: *
  569,66: 40

156 NUM
  569,66: 40

65 - MultiplicativeExpr
  569,69: -
  569,71: 0

141 NUM
  569,71: 0

238 )
  569,72: )

207 CR_token2
  569,76: 


122 OptionalElse_token1
  570,8: endif

203 CR_token2
  570,13: 


177 CRStmtCRs
  571,1:  

177 CR_token2
  571,61: 


177 Stmt_token6
  572,5: EndFor

203 CR_token2
  572,11: 


177 Stmt_token6
  573,3: EndFor

206 CR_token2
  573,11: 


257 Stmt_token8
  574,1: EndSub

97 Stmt_token7 ID CRStmtCRs Stmt_token8
  577,1: Sub
  577,5: LevelExplosion
  577,21: 
  
  Shapes.Animate(player1, Shapes.GetLeft(player1), 1500, 4000)
  Shapes.Animate(player2, Shapes.GetLeft(player2), 1500, 4000)  

  For i = 0 To shade
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      Shapes.Animate(Shadow[i], xv + 512, yv + 350, 1500)
  EndFor  
  
  For i = 0 To cryst
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      If Shapes.GetTop(crystalimg[i]) > 0 then
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)
      EndIf
      If Shapes.GetTop(crystalbnk[i]) > 0 then
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)
      EndIf
    EndFor  
  
    For y = 0 To 15
     For x = 0 To 19
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)
    EndFor
  EndFor      

  609,1: EndSub

244 ID CRStmtCRs Stmt_token8
  577,5: LevelExplosion
  577,21: 
  
  Shapes.Animate(player1, Shapes.GetLeft(player1), 1500, 4000)
  Shapes.Animate(player2, Shapes.GetLeft(player2), 1500, 4000)  

  For i = 0 To shade
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      Shapes.Animate(Shadow[i], xv + 512, yv + 350, 1500)
  EndFor  
  
  For i = 0 To cryst
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      If Shapes.GetTop(crystalimg[i]) > 0 then
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)
      EndIf
      If Shapes.GetTop(crystalbnk[i]) > 0 then
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)
      EndIf
    EndFor  
  
    For y = 0 To 15
     For x = 0 To 19
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)
    EndFor
  EndFor      

  609,1: EndSub

199 CR_token2
  577,21: 


105 ID . ID ( Exprs )
  579,3: Shapes
  579,9: .
  579,10: Animate
  579,17: (
  579,18: player1, Shapes.GetLeft(player1), 1500, 4000
  579,62: )

184 . ID ( Exprs )
  579,9: .
  579,10: Animate
  579,17: (
  579,18: player1, Shapes.GetLeft(player1), 1500, 4000
  579,62: )

255 ID ( Exprs )
  579,10: Animate
  579,17: (
  579,18: player1, Shapes.GetLeft(player1), 1500, 4000
  579,62: )

221 ( Exprs )
  579,17: (
  579,18: player1, Shapes.GetLeft(player1), 1500, 4000
  579,62: )

27 ID
  579,18: player1

217 , MoreThanOneExpr
  579,25: ,
  579,27: Shapes.GetLeft(player1), 1500, 4000

54 ID . ID ( Exprs )
  579,27: Shapes
  579,33: .
  579,34: GetLeft
  579,41: (
  579,42: player1
  579,49: )

4 . ID ( Exprs )
  579,33: .
  579,34: GetLeft
  579,41: (
  579,42: player1
  579,49: )

248 ID ( Exprs )
  579,34: GetLeft
  579,41: (
  579,42: player1
  579,49: )

23 ( Exprs )
  579,41: (
  579,42: player1
  579,49: )

22 ID
  579,42: player1

239 )
  579,49: )

217 , MoreThanOneExpr
  579,50: ,
  579,52: 1500, 4000

54 NUM
  579,52: 1500

217 , MoreThanOneExpr
  579,56: ,
  579,58: 4000

54 NUM
  579,58: 4000

238 )
  579,62: )

206 CR_token2
  579,63: 


106 ID . ID ( Exprs )
  580,3: Shapes
  580,9: .
  580,10: Animate
  580,17: (
  580,18: player2, Shapes.GetLeft(player2), 1500, 4000
  580,62: )

184 . ID ( Exprs )
  580,9: .
  580,10: Animate
  580,17: (
  580,18: player2, Shapes.GetLeft(player2), 1500, 4000
  580,62: )

255 ID ( Exprs )
  580,10: Animate
  580,17: (
  580,18: player2, Shapes.GetLeft(player2), 1500, 4000
  580,62: )

221 ( Exprs )
  580,17: (
  580,18: player2, Shapes.GetLeft(player2), 1500, 4000
  580,62: )

27 ID
  580,18: player2

217 , MoreThanOneExpr
  580,25: ,
  580,27: Shapes.GetLeft(player2), 1500, 4000

54 ID . ID ( Exprs )
  580,27: Shapes
  580,33: .
  580,34: GetLeft
  580,41: (
  580,42: player2
  580,49: )

4 . ID ( Exprs )
  580,33: .
  580,34: GetLeft
  580,41: (
  580,42: player2
  580,49: )

248 ID ( Exprs )
  580,34: GetLeft
  580,41: (
  580,42: player2
  580,49: )

23 ( Exprs )
  580,41: (
  580,42: player2
  580,49: )

22 ID
  580,42: player2

239 )
  580,49: )

217 , MoreThanOneExpr
  580,50: ,
  580,52: 1500, 4000

54 NUM
  580,52: 1500

217 , MoreThanOneExpr
  580,56: ,
  580,58: 4000

54 NUM
  580,58: 4000

238 )
  580,62: )

206 CR_token2
  580,65: 



106 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  582,3: For
  582,7: i
  582,9: =
  582,11: 0
  582,13: To
  582,16: shade
  582,21: 
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      Shapes.Animate(Shadow[i], xv + 512, yv + 350, 1500)

  587,3: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  582,7: i
  582,9: =
  582,11: 0
  582,13: To
  582,16: shade
  582,21: 
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      Shapes.Animate(Shadow[i], xv + 512, yv + 350, 1500)

  587,3: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  582,9: =
  582,11: 0
  582,13: To
  582,16: shade
  582,21: 
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      Shapes.Animate(Shadow[i], xv + 512, yv + 350, 1500)

  587,3: EndFor

56 NUM
  582,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  582,13: To
  582,16: shade
  582,21: 
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      Shapes.Animate(Shadow[i], xv + 512, yv + 350, 1500)

  587,3: EndFor

83 ID
  582,16: shade

145 CR_token2
  582,21: 


88 ID = Expr
  583,7: angle
  583,13: =
  583,15: Math.GetRandomNumber(360)

184 = Expr
  583,13: =
  583,15: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  583,15: Math
  583,19: .
  583,20: GetRandomNumber
  583,35: (
  583,36: 360
  583,39: )

5 . ID ( Exprs )
  583,19: .
  583,20: GetRandomNumber
  583,35: (
  583,36: 360
  583,39: )

260 ID ( Exprs )
  583,20: GetRandomNumber
  583,35: (
  583,36: 360
  583,39: )

24 ( Exprs )
  583,35: (
  583,36: 360
  583,39: )

26 NUM
  583,36: 360

249 )
  583,39: )

203 CR_token2
  583,41: 


96 ID = Expr
  584,7: xv
  584,10: =
  584,12: Math.Cos(angle * 0.0174) * 1200

184 = Expr
  584,10: =
  584,12: Math.Cos(angle * 0.0174) * 1200

70 ID . ID ( Exprs )
  584,12: Math
  584,16: .
  584,17: Cos
  584,20: (
  584,21: angle * 0.0174
  584,35: )

5 . ID ( Exprs )
  584,16: .
  584,17: Cos
  584,20: (
  584,21: angle * 0.0174
  584,35: )

260 ID ( Exprs )
  584,17: Cos
  584,20: (
  584,21: angle * 0.0174
  584,35: )

24 ( Exprs )
  584,20: (
  584,21: angle * 0.0174
  584,35: )

26 ID
  584,21: angle

50 * UnaryExpr
  584,27: *
  584,29: 0.0174

156 NUM
  584,29: 0.0174

249 )
  584,35: )

48 * UnaryExpr
  584,37: *
  584,39: 1200

157 NUM
  584,39: 1200

203 CR_token2
  584,43: 


96 ID = Expr
  585,7: yv
  585,10: =
  585,12: Math.Sin(angle * 0.0174) * 600

184 = Expr
  585,10: =
  585,12: Math.Sin(angle * 0.0174) * 600

70 ID . ID ( Exprs )
  585,12: Math
  585,16: .
  585,17: Sin
  585,20: (
  585,21: angle * 0.0174
  585,35: )

5 . ID ( Exprs )
  585,16: .
  585,17: Sin
  585,20: (
  585,21: angle * 0.0174
  585,35: )

260 ID ( Exprs )
  585,17: Sin
  585,20: (
  585,21: angle * 0.0174
  585,35: )

24 ( Exprs )
  585,20: (
  585,21: angle * 0.0174
  585,35: )

26 ID
  585,21: angle

50 * UnaryExpr
  585,27: *
  585,29: 0.0174

156 NUM
  585,29: 0.0174

249 )
  585,35: )

48 * UnaryExpr
  585,37: *
  585,39: 600

157 NUM
  585,39: 600

203 CR_token2
  585,54: 


96 ID . ID ( Exprs )
  586,7: Shapes
  586,13: .
  586,14: Animate
  586,21: (
  586,22: Shadow[i], xv + 512, yv + 350, 1500
  586,57: )

184 . ID ( Exprs )
  586,13: .
  586,14: Animate
  586,21: (
  586,22: Shadow[i], xv + 512, yv + 350, 1500
  586,57: )

255 ID ( Exprs )
  586,14: Animate
  586,21: (
  586,22: Shadow[i], xv + 512, yv + 350, 1500
  586,57: )

221 ( Exprs )
  586,21: (
  586,22: Shadow[i], xv + 512, yv + 350, 1500
  586,57: )

27 ID Idxs
  586,22: Shadow
  586,28: [i]

4 [ Expr ]
  586,28: [
  586,29: i
  586,30: ]

76 ID
  586,29: i

245 ]
  586,30: ]

217 , MoreThanOneExpr
  586,31: ,
  586,33: xv + 512, yv + 350, 1500

54 ID
  586,33: xv

65 + MultiplicativeExpr
  586,36: +
  586,38: 512

141 NUM
  586,38: 512

217 , MoreThanOneExpr
  586,41: ,
  586,43: yv + 350, 1500

54 ID
  586,43: yv

65 + MultiplicativeExpr
  586,46: +
  586,48: 350

141 NUM
  586,48: 350

217 , MoreThanOneExpr
  586,51: ,
  586,53: 1500

54 NUM
  586,53: 1500

238 )
  586,57: )

203 CR_token2
  586,58: 


177 Stmt_token6
  587,3: EndFor

206 CR_token2
  587,11: 


106 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  589,3: For
  589,7: i
  589,9: =
  589,11: 0
  589,13: To
  589,16: cryst
  589,21: 
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      If Shapes.GetTop(crystalimg[i]) > 0 then
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)
      EndIf
      If Shapes.GetTop(crystalbnk[i]) > 0 then
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)
      EndIf

  599,5: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  589,7: i
  589,9: =
  589,11: 0
  589,13: To
  589,16: cryst
  589,21: 
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      If Shapes.GetTop(crystalimg[i]) > 0 then
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)
      EndIf
      If Shapes.GetTop(crystalbnk[i]) > 0 then
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)
      EndIf

  599,5: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  589,9: =
  589,11: 0
  589,13: To
  589,16: cryst
  589,21: 
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      If Shapes.GetTop(crystalimg[i]) > 0 then
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)
      EndIf
      If Shapes.GetTop(crystalbnk[i]) > 0 then
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)
      EndIf

  599,5: EndFor

56 NUM
  589,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  589,13: To
  589,16: cryst
  589,21: 
      angle = Math.GetRandomNumber(360) 
      xv = Math.Cos(angle * 0.0174) * 1200
      yv = Math.Sin(angle * 0.0174) * 600            
      If Shapes.GetTop(crystalimg[i]) > 0 then
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)
      EndIf
      If Shapes.GetTop(crystalbnk[i]) > 0 then
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)
      EndIf

  599,5: EndFor

83 ID
  589,16: cryst

145 CR_token2
  589,21: 


88 ID = Expr
  590,7: angle
  590,13: =
  590,15: Math.GetRandomNumber(360)

184 = Expr
  590,13: =
  590,15: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  590,15: Math
  590,19: .
  590,20: GetRandomNumber
  590,35: (
  590,36: 360
  590,39: )

5 . ID ( Exprs )
  590,19: .
  590,20: GetRandomNumber
  590,35: (
  590,36: 360
  590,39: )

260 ID ( Exprs )
  590,20: GetRandomNumber
  590,35: (
  590,36: 360
  590,39: )

24 ( Exprs )
  590,35: (
  590,36: 360
  590,39: )

26 NUM
  590,36: 360

249 )
  590,39: )

203 CR_token2
  590,41: 


96 ID = Expr
  591,7: xv
  591,10: =
  591,12: Math.Cos(angle * 0.0174) * 1200

184 = Expr
  591,10: =
  591,12: Math.Cos(angle * 0.0174) * 1200

70 ID . ID ( Exprs )
  591,12: Math
  591,16: .
  591,17: Cos
  591,20: (
  591,21: angle * 0.0174
  591,35: )

5 . ID ( Exprs )
  591,16: .
  591,17: Cos
  591,20: (
  591,21: angle * 0.0174
  591,35: )

260 ID ( Exprs )
  591,17: Cos
  591,20: (
  591,21: angle * 0.0174
  591,35: )

24 ( Exprs )
  591,20: (
  591,21: angle * 0.0174
  591,35: )

26 ID
  591,21: angle

50 * UnaryExpr
  591,27: *
  591,29: 0.0174

156 NUM
  591,29: 0.0174

249 )
  591,35: )

48 * UnaryExpr
  591,37: *
  591,39: 1200

157 NUM
  591,39: 1200

203 CR_token2
  591,43: 


96 ID = Expr
  592,7: yv
  592,10: =
  592,12: Math.Sin(angle * 0.0174) * 600

184 = Expr
  592,10: =
  592,12: Math.Sin(angle * 0.0174) * 600

70 ID . ID ( Exprs )
  592,12: Math
  592,16: .
  592,17: Sin
  592,20: (
  592,21: angle * 0.0174
  592,35: )

5 . ID ( Exprs )
  592,16: .
  592,17: Sin
  592,20: (
  592,21: angle * 0.0174
  592,35: )

260 ID ( Exprs )
  592,17: Sin
  592,20: (
  592,21: angle * 0.0174
  592,35: )

24 ( Exprs )
  592,20: (
  592,21: angle * 0.0174
  592,35: )

26 ID
  592,21: angle

50 * UnaryExpr
  592,27: *
  592,29: 0.0174

156 NUM
  592,29: 0.0174

249 )
  592,35: )

48 * UnaryExpr
  592,37: *
  592,39: 600

157 NUM
  592,39: 600

203 CR_token2
  592,54: 


96 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  593,7: If
  593,10: Shapes.GetTop(crystalimg[i]) > 0
  593,43: then
  593,47: 
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)

  595,7: EndIf

86 ID . ID ( Exprs )
  593,10: Shapes
  593,16: .
  593,17: GetTop
  593,23: (
  593,24: crystalimg[i]
  593,37: )

4 . ID ( Exprs )
  593,16: .
  593,17: GetTop
  593,23: (
  593,24: crystalimg[i]
  593,37: )

248 ID ( Exprs )
  593,17: GetTop
  593,23: (
  593,24: crystalimg[i]
  593,37: )

23 ( Exprs )
  593,23: (
  593,24: crystalimg[i]
  593,37: )

22 ID Idxs
  593,24: crystalimg
  593,34: [i]

4 [ Expr ]
  593,34: [
  593,35: i
  593,36: ]

76 ID
  593,35: i

245 ]
  593,36: ]

239 )
  593,37: )

91 > AdditiveExpr
  593,39: >
  593,41: 0

131 NUM
  593,41: 0

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  593,43: then
  593,47: 
        Shapes.Animate(crystalimg[i], xv + 512, yv + 350, 1500)

  595,7: EndIf

124 CR_token2
  593,47: 


67 ID . ID ( Exprs )
  594,9: Shapes
  594,15: .
  594,16: Animate
  594,23: (
  594,24: crystalimg[i], xv + 512, yv + 350, 1500
  594,63: )

184 . ID ( Exprs )
  594,15: .
  594,16: Animate
  594,23: (
  594,24: crystalimg[i], xv + 512, yv + 350, 1500
  594,63: )

255 ID ( Exprs )
  594,16: Animate
  594,23: (
  594,24: crystalimg[i], xv + 512, yv + 350, 1500
  594,63: )

221 ( Exprs )
  594,23: (
  594,24: crystalimg[i], xv + 512, yv + 350, 1500
  594,63: )

27 ID Idxs
  594,24: crystalimg
  594,34: [i]

4 [ Expr ]
  594,34: [
  594,35: i
  594,36: ]

76 ID
  594,35: i

245 ]
  594,36: ]

217 , MoreThanOneExpr
  594,37: ,
  594,39: xv + 512, yv + 350, 1500

54 ID
  594,39: xv

65 + MultiplicativeExpr
  594,42: +
  594,44: 512

141 NUM
  594,44: 512

217 , MoreThanOneExpr
  594,47: ,
  594,49: yv + 350, 1500

54 ID
  594,49: yv

65 + MultiplicativeExpr
  594,52: +
  594,54: 350

141 NUM
  594,54: 350

217 , MoreThanOneExpr
  594,57: ,
  594,59: 1500

54 NUM
  594,59: 1500

238 )
  594,63: )

207 CR_token2
  594,64: 


122 OptionalElse_token1
  595,7: EndIf

203 CR_token2
  595,12: 


96 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  596,7: If
  596,10: Shapes.GetTop(crystalbnk[i]) > 0
  596,43: then
  596,47: 
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)

  598,7: EndIf

86 ID . ID ( Exprs )
  596,10: Shapes
  596,16: .
  596,17: GetTop
  596,23: (
  596,24: crystalbnk[i]
  596,37: )

4 . ID ( Exprs )
  596,16: .
  596,17: GetTop
  596,23: (
  596,24: crystalbnk[i]
  596,37: )

248 ID ( Exprs )
  596,17: GetTop
  596,23: (
  596,24: crystalbnk[i]
  596,37: )

23 ( Exprs )
  596,23: (
  596,24: crystalbnk[i]
  596,37: )

22 ID Idxs
  596,24: crystalbnk
  596,34: [i]

4 [ Expr ]
  596,34: [
  596,35: i
  596,36: ]

76 ID
  596,35: i

245 ]
  596,36: ]

239 )
  596,37: )

91 > AdditiveExpr
  596,39: >
  596,41: 0

131 NUM
  596,41: 0

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  596,43: then
  596,47: 
        Shapes.Animate(crystalbnk[i], xv + 512, yv + 350, 1500)

  598,7: EndIf

124 CR_token2
  596,47: 


67 ID . ID ( Exprs )
  597,9: Shapes
  597,15: .
  597,16: Animate
  597,23: (
  597,24: crystalbnk[i], xv + 512, yv + 350, 1500
  597,63: )

184 . ID ( Exprs )
  597,15: .
  597,16: Animate
  597,23: (
  597,24: crystalbnk[i], xv + 512, yv + 350, 1500
  597,63: )

255 ID ( Exprs )
  597,16: Animate
  597,23: (
  597,24: crystalbnk[i], xv + 512, yv + 350, 1500
  597,63: )

221 ( Exprs )
  597,23: (
  597,24: crystalbnk[i], xv + 512, yv + 350, 1500
  597,63: )

27 ID Idxs
  597,24: crystalbnk
  597,34: [i]

4 [ Expr ]
  597,34: [
  597,35: i
  597,36: ]

76 ID
  597,35: i

245 ]
  597,36: ]

217 , MoreThanOneExpr
  597,37: ,
  597,39: xv + 512, yv + 350, 1500

54 ID
  597,39: xv

65 + MultiplicativeExpr
  597,42: +
  597,44: 512

141 NUM
  597,44: 512

217 , MoreThanOneExpr
  597,47: ,
  597,49: yv + 350, 1500

54 ID
  597,49: yv

65 + MultiplicativeExpr
  597,52: +
  597,54: 350

141 NUM
  597,54: 350

217 , MoreThanOneExpr
  597,57: ,
  597,59: 1500

54 NUM
  597,59: 1500

238 )
  597,63: )

207 CR_token2
  597,64: 


122 OptionalElse_token1
  598,7: EndIf

203 CR_token2
  598,12: 


177 Stmt_token6
  599,5: EndFor

206 CR_token2
  599,13: 


106 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  601,5: For
  601,9: y
  601,11: =
  601,13: 0
  601,15: To
  601,18: 15
  601,20: 
     For x = 0 To 19
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)
    EndFor

  608,3: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  601,9: y
  601,11: =
  601,13: 0
  601,15: To
  601,18: 15
  601,20: 
     For x = 0 To 19
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)
    EndFor

  608,3: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  601,11: =
  601,13: 0
  601,15: To
  601,18: 15
  601,20: 
     For x = 0 To 19
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)
    EndFor

  608,3: EndFor

56 NUM
  601,13: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  601,15: To
  601,18: 15
  601,20: 
     For x = 0 To 19
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)
    EndFor

  608,3: EndFor

83 NUM
  601,18: 15

145 CR_token2
  601,20: 


88 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  602,6: For
  602,10: x
  602,12: =
  602,14: 0
  602,16: To
  602,19: 19
  602,21: 
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)

  607,5: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  602,10: x
  602,12: =
  602,14: 0
  602,16: To
  602,19: 19
  602,21: 
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)

  607,5: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  602,12: =
  602,14: 0
  602,16: To
  602,19: 19
  602,21: 
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)

  607,5: EndFor

56 NUM
  602,14: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  602,16: To
  602,19: 19
  602,21: 
         angle = Math.GetRandomNumber(360) 
         xv = Math.Cos(angle * 0.0174) * 1200
         yv = Math.Sin(angle * 0.0174) * 600            
         Shapes.Animate(levelshapes[y][x], xv + 512, yv + 350, 1500)

  607,5: EndFor

83 NUM
  602,19: 19

145 CR_token2
  602,21: 


88 ID = Expr
  603,10: angle
  603,16: =
  603,18: Math.GetRandomNumber(360)

184 = Expr
  603,16: =
  603,18: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  603,18: Math
  603,22: .
  603,23: GetRandomNumber
  603,38: (
  603,39: 360
  603,42: )

5 . ID ( Exprs )
  603,22: .
  603,23: GetRandomNumber
  603,38: (
  603,39: 360
  603,42: )

260 ID ( Exprs )
  603,23: GetRandomNumber
  603,38: (
  603,39: 360
  603,42: )

24 ( Exprs )
  603,38: (
  603,39: 360
  603,42: )

26 NUM
  603,39: 360

249 )
  603,42: )

203 CR_token2
  603,44: 


96 ID = Expr
  604,10: xv
  604,13: =
  604,15: Math.Cos(angle * 0.0174) * 1200

184 = Expr
  604,13: =
  604,15: Math.Cos(angle * 0.0174) * 1200

70 ID . ID ( Exprs )
  604,15: Math
  604,19: .
  604,20: Cos
  604,23: (
  604,24: angle * 0.0174
  604,38: )

5 . ID ( Exprs )
  604,19: .
  604,20: Cos
  604,23: (
  604,24: angle * 0.0174
  604,38: )

260 ID ( Exprs )
  604,20: Cos
  604,23: (
  604,24: angle * 0.0174
  604,38: )

24 ( Exprs )
  604,23: (
  604,24: angle * 0.0174
  604,38: )

26 ID
  604,24: angle

50 * UnaryExpr
  604,30: *
  604,32: 0.0174

156 NUM
  604,32: 0.0174

249 )
  604,38: )

48 * UnaryExpr
  604,40: *
  604,42: 1200

157 NUM
  604,42: 1200

203 CR_token2
  604,46: 


96 ID = Expr
  605,10: yv
  605,13: =
  605,15: Math.Sin(angle * 0.0174) * 600

184 = Expr
  605,13: =
  605,15: Math.Sin(angle * 0.0174) * 600

70 ID . ID ( Exprs )
  605,15: Math
  605,19: .
  605,20: Sin
  605,23: (
  605,24: angle * 0.0174
  605,38: )

5 . ID ( Exprs )
  605,19: .
  605,20: Sin
  605,23: (
  605,24: angle * 0.0174
  605,38: )

260 ID ( Exprs )
  605,20: Sin
  605,23: (
  605,24: angle * 0.0174
  605,38: )

24 ( Exprs )
  605,23: (
  605,24: angle * 0.0174
  605,38: )

26 ID
  605,24: angle

50 * UnaryExpr
  605,30: *
  605,32: 0.0174

156 NUM
  605,32: 0.0174

249 )
  605,38: )

48 * UnaryExpr
  605,40: *
  605,42: 600

157 NUM
  605,42: 600

203 CR_token2
  605,57: 


96 ID . ID ( Exprs )
  606,10: Shapes
  606,16: .
  606,17: Animate
  606,24: (
  606,25: levelshapes[y][x], xv + 512, yv + 350, 1500
  606,68: )

184 . ID ( Exprs )
  606,16: .
  606,17: Animate
  606,24: (
  606,25: levelshapes[y][x], xv + 512, yv + 350, 1500
  606,68: )

255 ID ( Exprs )
  606,17: Animate
  606,24: (
  606,25: levelshapes[y][x], xv + 512, yv + 350, 1500
  606,68: )

221 ( Exprs )
  606,24: (
  606,25: levelshapes[y][x], xv + 512, yv + 350, 1500
  606,68: )

27 ID Idxs
  606,25: levelshapes
  606,36: [y][x]

4 [ Expr ] Idxs
  606,36: [
  606,37: y
  606,38: ]
  606,39: [x]

76 ID
  606,37: y

245 ] Idxs
  606,38: ]
  606,39: [x]

7 [ Expr ]
  606,39: [
  606,40: x
  606,41: ]

76 ID
  606,40: x

245 ]
  606,41: ]

217 , MoreThanOneExpr
  606,42: ,
  606,44: xv + 512, yv + 350, 1500

54 ID
  606,44: xv

65 + MultiplicativeExpr
  606,47: +
  606,49: 512

141 NUM
  606,49: 512

217 , MoreThanOneExpr
  606,52: ,
  606,54: yv + 350, 1500

54 ID
  606,54: yv

65 + MultiplicativeExpr
  606,57: +
  606,59: 350

141 NUM
  606,59: 350

217 , MoreThanOneExpr
  606,62: ,
  606,64: 1500

54 NUM
  606,64: 1500

238 )
  606,68: )

203 CR_token2
  606,69: 


177 Stmt_token6
  607,5: EndFor

203 CR_token2
  607,11: 


177 Stmt_token6
  608,3: EndFor

206 CR_token2
  608,15: 


257 Stmt_token8
  609,1: EndSub

97 Stmt_token7 ID CRStmtCRs Stmt_token8
  612,1: Sub
  612,5: LevelRelease
  612,19: 
   For y = 0 To 15
     For x = 0 To 19         
       Shapes.Remove(levelshapes[y][x])
    EndFor
  EndFor  
  For i = 0 To shade         
      Shapes.Remove(Shadow[i])
  EndFor  
  
  For i = 0 To cryst
        Shapes.Remove(crystalimg[i])
        Shapes.Remove(crystalbnk[i])
  EndFor   
  For i = 0 To 20
    Shapes.Remove(star)  
  endFor

  629,1: EndSub

244 ID CRStmtCRs Stmt_token8
  612,5: LevelRelease
  612,19: 
   For y = 0 To 15
     For x = 0 To 19         
       Shapes.Remove(levelshapes[y][x])
    EndFor
  EndFor  
  For i = 0 To shade         
      Shapes.Remove(Shadow[i])
  EndFor  
  
  For i = 0 To cryst
        Shapes.Remove(crystalimg[i])
        Shapes.Remove(crystalbnk[i])
  EndFor   
  For i = 0 To 20
    Shapes.Remove(star)  
  endFor

  629,1: EndSub

199 CR_token2
  612,19: 


105 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  613,4: For
  613,8: y
  613,10: =
  613,12: 0
  613,14: To
  613,17: 15
  613,19: 
     For x = 0 To 19         
       Shapes.Remove(levelshapes[y][x])
    EndFor

  617,3: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  613,8: y
  613,10: =
  613,12: 0
  613,14: To
  613,17: 15
  613,19: 
     For x = 0 To 19         
       Shapes.Remove(levelshapes[y][x])
    EndFor

  617,3: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  613,10: =
  613,12: 0
  613,14: To
  613,17: 15
  613,19: 
     For x = 0 To 19         
       Shapes.Remove(levelshapes[y][x])
    EndFor

  617,3: EndFor

56 NUM
  613,12: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  613,14: To
  613,17: 15
  613,19: 
     For x = 0 To 19         
       Shapes.Remove(levelshapes[y][x])
    EndFor

  617,3: EndFor

83 NUM
  613,17: 15

145 CR_token2
  613,19: 


88 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  614,6: For
  614,10: x
  614,12: =
  614,14: 0
  614,16: To
  614,19: 19
  614,30: 
       Shapes.Remove(levelshapes[y][x])

  616,5: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  614,10: x
  614,12: =
  614,14: 0
  614,16: To
  614,19: 19
  614,30: 
       Shapes.Remove(levelshapes[y][x])

  616,5: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  614,12: =
  614,14: 0
  614,16: To
  614,19: 19
  614,30: 
       Shapes.Remove(levelshapes[y][x])

  616,5: EndFor

56 NUM
  614,14: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  614,16: To
  614,19: 19
  614,30: 
       Shapes.Remove(levelshapes[y][x])

  616,5: EndFor

83 NUM
  614,19: 19

145 CR_token2
  614,30: 


88 ID . ID ( Exprs )
  615,8: Shapes
  615,14: .
  615,15: Remove
  615,21: (
  615,22: levelshapes[y][x]
  615,39: )

184 . ID ( Exprs )
  615,14: .
  615,15: Remove
  615,21: (
  615,22: levelshapes[y][x]
  615,39: )

255 ID ( Exprs )
  615,15: Remove
  615,21: (
  615,22: levelshapes[y][x]
  615,39: )

221 ( Exprs )
  615,21: (
  615,22: levelshapes[y][x]
  615,39: )

27 ID Idxs
  615,22: levelshapes
  615,33: [y][x]

4 [ Expr ] Idxs
  615,33: [
  615,34: y
  615,35: ]
  615,36: [x]

76 ID
  615,34: y

245 ] Idxs
  615,35: ]
  615,36: [x]

7 [ Expr ]
  615,36: [
  615,37: x
  615,38: ]

76 ID
  615,37: x

245 ]
  615,38: ]

238 )
  615,39: )

203 CR_token2
  615,40: 


177 Stmt_token6
  616,5: EndFor

203 CR_token2
  616,11: 


177 Stmt_token6
  617,3: EndFor

206 CR_token2
  617,11: 


106 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  618,3: For
  618,7: i
  618,9: =
  618,11: 0
  618,13: To
  618,16: shade
  618,30: 
      Shapes.Remove(Shadow[i])

  620,3: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  618,7: i
  618,9: =
  618,11: 0
  618,13: To
  618,16: shade
  618,30: 
      Shapes.Remove(Shadow[i])

  620,3: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  618,9: =
  618,11: 0
  618,13: To
  618,16: shade
  618,30: 
      Shapes.Remove(Shadow[i])

  620,3: EndFor

56 NUM
  618,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  618,13: To
  618,16: shade
  618,30: 
      Shapes.Remove(Shadow[i])

  620,3: EndFor

83 ID
  618,16: shade

145 CR_token2
  618,30: 


88 ID . ID ( Exprs )
  619,7: Shapes
  619,13: .
  619,14: Remove
  619,20: (
  619,21: Shadow[i]
  619,30: )

184 . ID ( Exprs )
  619,13: .
  619,14: Remove
  619,20: (
  619,21: Shadow[i]
  619,30: )

255 ID ( Exprs )
  619,14: Remove
  619,20: (
  619,21: Shadow[i]
  619,30: )

221 ( Exprs )
  619,20: (
  619,21: Shadow[i]
  619,30: )

27 ID Idxs
  619,21: Shadow
  619,27: [i]

4 [ Expr ]
  619,27: [
  619,28: i
  619,29: ]

76 ID
  619,28: i

245 ]
  619,29: ]

238 )
  619,30: )

203 CR_token2
  619,31: 


177 Stmt_token6
  620,3: EndFor

206 CR_token2
  620,11: 


106 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  622,3: For
  622,7: i
  622,9: =
  622,11: 0
  622,13: To
  622,16: cryst
  622,21: 
        Shapes.Remove(crystalimg[i])
        Shapes.Remove(crystalbnk[i])

  625,3: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  622,7: i
  622,9: =
  622,11: 0
  622,13: To
  622,16: cryst
  622,21: 
        Shapes.Remove(crystalimg[i])
        Shapes.Remove(crystalbnk[i])

  625,3: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  622,9: =
  622,11: 0
  622,13: To
  622,16: cryst
  622,21: 
        Shapes.Remove(crystalimg[i])
        Shapes.Remove(crystalbnk[i])

  625,3: EndFor

56 NUM
  622,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  622,13: To
  622,16: cryst
  622,21: 
        Shapes.Remove(crystalimg[i])
        Shapes.Remove(crystalbnk[i])

  625,3: EndFor

83 ID
  622,16: cryst

145 CR_token2
  622,21: 


88 ID . ID ( Exprs )
  623,9: Shapes
  623,15: .
  623,16: Remove
  623,22: (
  623,23: crystalimg[i]
  623,36: )

184 . ID ( Exprs )
  623,15: .
  623,16: Remove
  623,22: (
  623,23: crystalimg[i]
  623,36: )

255 ID ( Exprs )
  623,16: Remove
  623,22: (
  623,23: crystalimg[i]
  623,36: )

221 ( Exprs )
  623,22: (
  623,23: crystalimg[i]
  623,36: )

27 ID Idxs
  623,23: crystalimg
  623,33: [i]

4 [ Expr ]
  623,33: [
  623,34: i
  623,35: ]

76 ID
  623,34: i

245 ]
  623,35: ]

238 )
  623,36: )

203 CR_token2
  623,37: 


96 ID . ID ( Exprs )
  624,9: Shapes
  624,15: .
  624,16: Remove
  624,22: (
  624,23: crystalbnk[i]
  624,36: )

184 . ID ( Exprs )
  624,15: .
  624,16: Remove
  624,22: (
  624,23: crystalbnk[i]
  624,36: )

255 ID ( Exprs )
  624,16: Remove
  624,22: (
  624,23: crystalbnk[i]
  624,36: )

221 ( Exprs )
  624,22: (
  624,23: crystalbnk[i]
  624,36: )

27 ID Idxs
  624,23: crystalbnk
  624,33: [i]

4 [ Expr ]
  624,33: [
  624,34: i
  624,35: ]

76 ID
  624,34: i

245 ]
  624,35: ]

238 )
  624,36: )

203 CR_token2
  624,37: 


177 Stmt_token6
  625,3: EndFor

206 CR_token2
  625,12: 


106 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  626,3: For
  626,7: i
  626,9: =
  626,11: 0
  626,13: To
  626,16: 20
  626,18: 
    Shapes.Remove(star)  

  628,3: endFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  626,7: i
  626,9: =
  626,11: 0
  626,13: To
  626,16: 20
  626,18: 
    Shapes.Remove(star)  

  628,3: endFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  626,9: =
  626,11: 0
  626,13: To
  626,16: 20
  626,18: 
    Shapes.Remove(star)  

  628,3: endFor

56 NUM
  626,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  626,13: To
  626,16: 20
  626,18: 
    Shapes.Remove(star)  

  628,3: endFor

83 NUM
  626,16: 20

145 CR_token2
  626,18: 


88 ID . ID ( Exprs )
  627,5: Shapes
  627,11: .
  627,12: Remove
  627,18: (
  627,19: star
  627,23: )

184 . ID ( Exprs )
  627,11: .
  627,12: Remove
  627,18: (
  627,19: star
  627,23: )

255 ID ( Exprs )
  627,12: Remove
  627,18: (
  627,19: star
  627,23: )

221 ( Exprs )
  627,18: (
  627,19: star
  627,23: )

27 ID
  627,19: star

238 )
  627,23: )

203 CR_token2
  627,26: 


177 Stmt_token6
  628,3: endFor

206 CR_token2
  628,9: 


257 Stmt_token8
  629,1: EndSub

97 Stmt_token7 ID CRStmtCRs Stmt_token8
  631,1: Sub
  631,5: LevelLoad
  631,14: 
  cryst = 0
  posx  = 4
  posy  = 4
  moves = 0
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      
    EndFor
  EndFor
         
  
  'load the water first
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      
    EndFor  
  EndFor
  
  'shadows for the water
  LoadShadowWater()
  
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   
    EndFor  
  EndFor   
  
  'tried to fix strange Shapes.Animate behaviors if there are too many shapes flying around - no real  success... 
  loopdelay = (1600) * loopmssec 
   num = 0
   While(num < loopdelay)
    num = num + 1
  endwhile
  
  'load blocks
  f = 0
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      
    EndFor  
  EndFor
  player1 = Shapes.AddImage(Path + "/sokocutep2.png")
 
  'load lower player shape first. it has to be behind the walls 
  Shapes.Move(player1, (posx) * 50 + korrx, (posy) * 40 - 0) 

  LoadShadow()
  '------------------------------------------------------------
  'load the walls
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  
  EndFor
  
  'load players face at last. It has always to be in front of the walls
  player2 = Shapes.AddImage(Path + "/sokocutep1.png")
  Shapes.Move(player2, (posx) * 50 + korrx, (posy) * 40 - 0)  
  xplayer = Shapes.GetLeft(player1)
  yplayer = Shapes.GetTop(player1)  


  802,1: EndSub

244 ID CRStmtCRs Stmt_token8
  631,5: LevelLoad
  631,14: 
  cryst = 0
  posx  = 4
  posy  = 4
  moves = 0
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      
    EndFor
  EndFor
         
  
  'load the water first
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      
    EndFor  
  EndFor
  
  'shadows for the water
  LoadShadowWater()
  
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   
    EndFor  
  EndFor   
  
  'tried to fix strange Shapes.Animate behaviors if there are too many shapes flying around - no real  success... 
  loopdelay = (1600) * loopmssec 
   num = 0
   While(num < loopdelay)
    num = num + 1
  endwhile
  
  'load blocks
  f = 0
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      
    EndFor  
  EndFor
  player1 = Shapes.AddImage(Path + "/sokocutep2.png")
 
  'load lower player shape first. it has to be behind the walls 
  Shapes.Move(player1, (posx) * 50 + korrx, (posy) * 40 - 0) 

  LoadShadow()
  '------------------------------------------------------------
  'load the walls
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  
  EndFor
  
  'load players face at last. It has always to be in front of the walls
  player2 = Shapes.AddImage(Path + "/sokocutep1.png")
  Shapes.Move(player2, (posx) * 50 + korrx, (posy) * 40 - 0)  
  xplayer = Shapes.GetLeft(player1)
  yplayer = Shapes.GetTop(player1)  


  802,1: EndSub

199 CR_token2
  631,14: 


105 ID = Expr
  632,3: cryst
  632,9: =
  632,11: 0

184 = Expr
  632,9: =
  632,11: 0

70 NUM
  632,11: 0

206 CR_token2
  632,12: 


106 ID = Expr
  633,3: posx
  633,9: =
  633,11: 4

184 = Expr
  633,9: =
  633,11: 4

70 NUM
  633,11: 4

206 CR_token2
  633,12: 


106 ID = Expr
  634,3: posy
  634,9: =
  634,11: 4

184 = Expr
  634,9: =
  634,11: 4

70 NUM
  634,11: 4

206 CR_token2
  634,12: 


106 ID = Expr
  635,3: moves
  635,9: =
  635,11: 0

184 = Expr
  635,9: =
  635,11: 0

70 NUM
  635,11: 0

206 CR_token2
  635,12: 


106 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  637,3: For
  637,7: i
  637,9: =
  637,11: 0
  637,13: To
  637,16: 15
  637,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      
    EndFor

  659,3: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  637,7: i
  637,9: =
  637,11: 0
  637,13: To
  637,16: 15
  637,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      
    EndFor

  659,3: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  637,9: =
  637,11: 0
  637,13: To
  637,16: 15
  637,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      
    EndFor

  659,3: EndFor

56 NUM
  637,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  637,13: To
  637,16: 15
  637,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      
    EndFor

  659,3: EndFor

83 NUM
  637,16: 15

145 CR_token2
  637,18: 


88 Stmt_token4 ID = Expr Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  638,5: For
  638,9: p
  638,11: =
  638,13: 1
  638,15: To
  638,18: Text.GetLength(block[stage][i])
  638,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      

  658,5: EndFor

267 ID = Expr Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  638,9: p
  638,11: =
  638,13: 1
  638,15: To
  638,18: Text.GetLength(block[stage][i])
  638,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      

  658,5: EndFor

266 = Expr Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  638,11: =
  638,13: 1
  638,15: To
  638,18: Text.GetLength(block[stage][i])
  638,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      

  658,5: EndFor

56 NUM
  638,13: 1

264 Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  638,15: To
  638,18: Text.GetLength(block[stage][i])
  638,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif
  
      
      

  658,5: EndFor

83 ID . ID ( Exprs )
  638,18: Text
  638,22: .
  638,23: GetLength
  638,32: (
  638,33: block[stage][i]
  638,48: )

5 . ID ( Exprs )
  638,22: .
  638,23: GetLength
  638,32: (
  638,33: block[stage][i]
  638,48: )

260 ID ( Exprs )
  638,23: GetLength
  638,32: (
  638,33: block[stage][i]
  638,48: )

24 ( Exprs )
  638,32: (
  638,33: block[stage][i]
  638,48: )

26 ID Idxs
  638,33: block
  638,38: [stage][i]

4 [ Expr ] Idxs
  638,38: [
  638,39: stage
  638,44: ]
  638,45: [i]

76 ID
  638,39: stage

245 ] Idxs
  638,44: ]
  638,45: [i]

7 [ Expr ]
  638,45: [
  638,46: i
  638,47: ]

76 ID
  638,46: i

245 ]
  638,47: ]

249 )
  638,48: )

145 CR_token2
  638,49: 


88 ID = Expr
  639,7: blockcode
  639,17: =
  639,19: Text.GetSubText(block[stage][i], p, 1)

184 = Expr
  639,17: =
  639,19: Text.GetSubText(block[stage][i], p, 1)

70 ID . ID ( Exprs )
  639,19: Text
  639,23: .
  639,24: GetSubText
  639,34: (
  639,35: block[stage][i], p, 1
  639,56: )

5 . ID ( Exprs )
  639,23: .
  639,24: GetSubText
  639,34: (
  639,35: block[stage][i], p, 1
  639,56: )

260 ID ( Exprs )
  639,24: GetSubText
  639,34: (
  639,35: block[stage][i], p, 1
  639,56: )

24 ( Exprs )
  639,34: (
  639,35: block[stage][i], p, 1
  639,56: )

26 ID Idxs
  639,35: block
  639,40: [stage][i]

4 [ Expr ] Idxs
  639,40: [
  639,41: stage
  639,46: ]
  639,47: [i]

76 ID
  639,41: stage

245 ] Idxs
  639,46: ]
  639,47: [i]

7 [ Expr ]
  639,47: [
  639,48: i
  639,49: ]

76 ID
  639,48: i

245 ]
  639,49: ]

217 , MoreThanOneExpr
  639,50: ,
  639,52: p, 1

54 ID
  639,52: p

217 , MoreThanOneExpr
  639,53: ,
  639,55: 1

54 NUM
  639,55: 1

249 )
  639,56: )

203 CR_token2
  639,58: 


96 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  640,7: If
  640,10: blockcode = "X"
  640,26: then
  640,31: 
        posy = i  
        posx = p-1
        blockcode = 0

  644,7: EndIf

86 ID
  640,10: blockcode

128 = CompExpr
  640,20: =
  640,22: "X"

117 STR
  640,22: "X"

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  640,26: then
  640,31: 
        posy = i  
        posx = p-1
        blockcode = 0

  644,7: EndIf

124 CR_token2
  640,31: 


67 ID = Expr
  641,9: posy
  641,14: =
  641,16: i

184 = Expr
  641,14: =
  641,16: i

70 ID
  641,16: i

207 CR_token2
  641,19: 


68 ID = Expr
  642,9: posx
  642,14: =
  642,16: p-1

184 = Expr
  642,14: =
  642,16: p-1

70 ID
  642,16: p

59 - MultiplicativeExpr
  642,17: -
  642,18: 1

144 NUM
  642,18: 1

207 CR_token2
  642,19: 


68 ID = Expr
  643,9: blockcode
  643,19: =
  643,21: 0

184 = Expr
  643,19: =
  643,21: 0

70 NUM
  643,21: 0

207 CR_token2
  643,22: 


122 OptionalElse_token1
  644,7: EndIf

203 CR_token2
  644,12: 


177 CR_token2
  645,9: 


88 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  646,7: if
  646,10: blockcode = 2
  646,24: then
  646,29: 
        ground[i][p-1] = 0

  648,7: elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif

86 ID
  646,10: blockcode

128 = CompExpr
  646,20: =
  646,22: 2

117 NUM
  646,22: 2

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  646,24: then
  646,29: 
        ground[i][p-1] = 0

  648,7: elseif blockcode = "C" then 'crystal on gras
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = blockcode
      endif

124 CR_token2
  646,29: 


67 ID Idxs = Expr
  647,9: ground
  647,15: [i][p-1]
  647,24: =
  647,26: 0

184 [ Expr ] Idxs
  647,15: [
  647,16: i
  647,17: ]
  647,18: [p-1]

76 ID
  647,16: i

245 ] Idxs
  647,17: ]
  647,18: [p-1]

7 [ Expr ]
  647,18: [
  647,19: p-1
  647,22: ]

76 ID
  647,19: p

65 - MultiplicativeExpr
  647,20: -
  647,21: 1

141 NUM
  647,21: 1

245 ]
  647,22: ]

263 = Expr
  647,24: =
  647,26: 0

55 NUM
  647,26: 0

207 CR_token2
  647,27: 


122 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  648,7: elseif
  648,14: blockcode = "C"
  648,30: then
  648,34:  'crystal on gras
        grou
  650,7: p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = bloc

82 ID
  648,14: blockcode

128 = CompExpr
  648,24: =
  648,26: "C"

117 STR
  648,26: "C"

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  648,30: then
  648,34:  'crystal on gras
        grou
  650,7: p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = bloc

118 CRStmtCRs MoreThanZeroElseIf
  648,34:  'crystal on gras
        grou
  650,7: p-1] = "A"
      elseif blockcode = "D" then 'crystal on wood 
        ground[i][p-1] = "B"        
      else 
        ground[i][p-1] = bloc

118 CR_token2
  648,51: 


67 ID Idxs = Expr
  649,9: ground
  649,15: [i][p-1]
  649,24: =
  649,26: "A"

184 [ Expr ] Idxs
  649,15: [
  649,16: i
  649,17: ]
  649,18: [p-1]

76 ID
  649,16: i

245 ] Idxs
  649,17: ]
  649,18: [p-1]

7 [ Expr ]
  649,18: [
  649,19: p-1
  649,22: ]

76 ID
  649,19: p

65 - MultiplicativeExpr
  649,20: -
  649,21: 1

141 NUM
  649,21: 1

245 ]
  649,22: ]

263 = Expr
  649,24: =
  649,26: "A"

55 STR
  649,26: "A"

207 CR_token2
  649,29: 


115 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  650,7: elseif
  650,14: blockcode = "D"
  650,30: then
  650,34:  'crystal on wood 
        ground[i][p
  652,7: "B"        
      else 
        ground[i][p-1] = blo

82 ID
  650,14: blockcode

128 = CompExpr
  650,24: =
  650,26: "D"

117 STR
  650,26: "D"

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  650,30: then
  650,34:  'crystal on wood 
        ground[i][p
  652,7: "B"        
      else 
        ground[i][p-1] = blo

118 CRStmtCRs MoreThanZeroElseIf
  650,34:  'crystal on wood 
        ground[i][p
  652,7: "B"        
      else 
        ground[i][p-1] = blo

118 CR_token2
  650,52: 


67 ID Idxs = Expr
  651,9: ground
  651,15: [i][p-1]
  651,24: =
  651,26: "B"

184 [ Expr ] Idxs
  651,15: [
  651,16: i
  651,17: ]
  651,18: [p-1]

76 ID
  651,16: i

245 ] Idxs
  651,17: ]
  651,18: [p-1]

7 [ Expr ]
  651,18: [
  651,19: p-1
  651,22: ]

76 ID
  651,19: p

65 - MultiplicativeExpr
  651,20: -
  651,21: 1

141 NUM
  651,21: 1

245 ]
  651,22: ]

263 = Expr
  651,24: =
  651,26: "B"

55 STR
  651,26: "B"

207 CR_token2
  651,37: 


115 OptionalElse_token2 CRStmtCRs OptionalElse_token1
  652,7: else
  652,12: 
        ground[i][p-1] = blockcode

  654,7: endif

201 CR_token2
  652,12: 


113 ID Idxs = Expr
  653,9: ground
  653,15: [i][p-1]
  653,24: =
  653,26: blockcode

184 [ Expr ] Idxs
  653,15: [
  653,16: i
  653,17: ]
  653,18: [p-1]

76 ID
  653,16: i

245 ] Idxs
  653,17: ]
  653,18: [p-1]

7 [ Expr ]
  653,18: [
  653,19: p-1
  653,22: ]

76 ID
  653,19: p

65 - MultiplicativeExpr
  653,20: -
  653,21: 1

141 NUM
  653,21: 1

245 ]
  653,22: ]

263 = Expr
  653,24: =
  653,26: blockcode

55 ID
  653,26: blockcode

202 CR_token2
  653,35: 


237 OptionalElse_token1
  654,7: endif

203 CR_token2
  654,12: 


177 CR_token2
  655,3: 


177 CR_token2
  656,7: 


177 CR_token2
  657,7: 


177 Stmt_token6
  658,5: EndFor

203 CR_token2
  658,11: 


177 Stmt_token6
  659,3: EndFor

206 CR_token2
  659,9: 


107 TheRest
  661,3:       
  
  'load the water first
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
    

106 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  663,3: For
  663,7: i
  663,9: =
  663,11: 0
  663,13: To
  663,16: 15
  663,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      
    EndFor  

  675,3: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  663,7: i
  663,9: =
  663,11: 0
  663,13: To
  663,16: 15
  663,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      
    EndFor  

  675,3: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  663,9: =
  663,11: 0
  663,13: To
  663,16: 15
  663,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      
    EndFor  

  675,3: EndFor

56 NUM
  663,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  663,13: To
  663,16: 15
  663,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      
    EndFor  

  675,3: EndFor

83 NUM
  663,16: 15

145 CR_token2
  663,18: 


88 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  664,5: For
  664,9: p
  664,11: =
  664,13: 1
  664,15: To
  664,18: Text.GetLength(block[stage][i])
  664,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      

  674,5: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  664,9: p
  664,11: =
  664,13: 1
  664,15: To
  664,18: Text.GetLength(block[stage][i])
  664,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      

  674,5: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  664,11: =
  664,13: 1
  664,15: To
  664,18: Text.GetLength(block[stage][i])
  664,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      

  674,5: EndFor

56 NUM
  664,13: 1

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  664,15: To
  664,18: Text.GetLength(block[stage][i])
  664,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 3 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    
      Endif      

  674,5: EndFor

83 ID . ID ( Exprs )
  664,18: Text
  664,22: .
  664,23: GetLength
  664,32: (
  664,33: block[stage][i]
  664,48: )

5 . ID ( Exprs )
  664,22: .
  664,23: GetLength
  664,32: (
  664,33: block[stage][i]
  664,48: )

260 ID ( Exprs )
  664,23: GetLength
  664,32: (
  664,33: block[stage][i]
  664,48: )

24 ( Exprs )
  664,32: (
  664,33: block[stage][i]
  664,48: )

26 ID Idxs
  664,33: block
  664,38: [stage][i]

4 [ Expr ] Idxs
  664,38: [
  664,39: stage
  664,44: ]
  664,45: [i]

76 ID
  664,39: stage

245 ] Idxs
  664,44: ]
  664,45: [i]

7 [ Expr ]
  664,45: [
  664,46: i
  664,47: ]

76 ID
  664,46: i

245 ]
  664,47: ]

249 )
  664,48: )

145 CR_token2
  664,49: 


88 ID = Expr
  665,7: blockcode
  665,17: =
  665,19: Text.GetSubText(block[stage][i], p, 1)

184 = Expr
  665,17: =
  665,19: Text.GetSubText(block[stage][i], p, 1)

70 ID . ID ( Exprs )
  665,19: Text
  665,23: .
  665,24: GetSubText
  665,34: (
  665,35: block[stage][i], p, 1
  665,56: )

5 . ID ( Exprs )
  665,23: .
  665,24: GetSubText
  665,34: (
  665,35: block[stage][i], p, 1
  665,56: )

260 ID ( Exprs )
  665,24: GetSubText
  665,34: (
  665,35: block[stage][i], p, 1
  665,56: )

24 ( Exprs )
  665,34: (
  665,35: block[stage][i], p, 1
  665,56: )

26 ID Idxs
  665,35: block
  665,40: [stage][i]

4 [ Expr ] Idxs
  665,40: [
  665,41: stage
  665,46: ]
  665,47: [i]

76 ID
  665,41: stage

245 ] Idxs
  665,46: ]
  665,47: [i]

7 [ Expr ]
  665,47: [
  665,48: i
  665,49: ]

76 ID
  665,48: i

245 ]
  665,49: ]

217 , MoreThanOneExpr
  665,50: ,
  665,52: p, 1

54 ID
  665,52: p

217 , MoreThanOneExpr
  665,53: ,
  665,55: 1

54 NUM
  665,55: 1

249 )
  665,56: )

203 CR_token2
  665,58: 


96 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  666,7: If
  666,10: blockcode = 3
  666,24: Then
  666,28: 
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    

  673,7: Endif

86 ID
  666,10: blockcode

128 = CompExpr
  666,20: =
  666,22: 3

117 NUM
  666,22: 3

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  666,24: Then
  666,28: 
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])  
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)    

  673,7: Endif

124 CR_token2
  666,28: 


67 ID Idxs = Expr
  667,9: levelshapes
  667,20: [i][p-1]
  667,29: =
  667,31: Shapes.AddImage(image[blockcode])

184 [ Expr ] Idxs
  667,20: [
  667,21: i
  667,22: ]
  667,23: [p-1]

76 ID
  667,21: i

245 ] Idxs
  667,22: ]
  667,23: [p-1]

7 [ Expr ]
  667,23: [
  667,24: p-1
  667,27: ]

76 ID
  667,24: p

65 - MultiplicativeExpr
  667,25: -
  667,26: 1

141 NUM
  667,26: 1

245 ]
  667,27: ]

263 = Expr
  667,29: =
  667,31: Shapes.AddImage(image[blockcode])

55 ID . ID ( Exprs )
  667,31: Shapes
  667,37: .
  667,38: AddImage
  667,46: (
  667,47: image[blockcode]
  667,63: )

5 . ID ( Exprs )
  667,37: .
  667,38: AddImage
  667,46: (
  667,47: image[blockcode]
  667,63: )

260 ID ( Exprs )
  667,38: AddImage
  667,46: (
  667,47: image[blockcode]
  667,63: )

24 ( Exprs )
  667,46: (
  667,47: image[blockcode]
  667,63: )

26 ID Idxs
  667,47: image
  667,52: [blockcode]

4 [ Expr ]
  667,52: [
  667,53: blockcode
  667,62: ]

76 ID
  667,53: blockcode

245 ]
  667,62: ]

249 )
  667,63: )

207 CR_token2
  667,66: 


68 ID = Expr
  668,9: angle
  668,15: =
  668,17: Math.GetRandomNumber(360)

184 = Expr
  668,15: =
  668,17: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  668,17: Math
  668,21: .
  668,22: GetRandomNumber
  668,37: (
  668,38: 360
  668,41: )

5 . ID ( Exprs )
  668,21: .
  668,22: GetRandomNumber
  668,37: (
  668,38: 360
  668,41: )

260 ID ( Exprs )
  668,22: GetRandomNumber
  668,37: (
  668,38: 360
  668,41: )

24 ( Exprs )
  668,37: (
  668,38: 360
  668,41: )

26 NUM
  668,38: 360

249 )
  668,41: )

207 CR_token2
  668,42: 


68 ID = Expr
  669,9: xv
  669,12: =
  669,14: Math.Cos(angle * 0.0174) * 1000

184 = Expr
  669,12: =
  669,14: Math.Cos(angle * 0.0174) * 1000

70 ID . ID ( Exprs )
  669,14: Math
  669,18: .
  669,19: Cos
  669,22: (
  669,23: angle * 0.0174
  669,37: )

5 . ID ( Exprs )
  669,18: .
  669,19: Cos
  669,22: (
  669,23: angle * 0.0174
  669,37: )

260 ID ( Exprs )
  669,19: Cos
  669,22: (
  669,23: angle * 0.0174
  669,37: )

24 ( Exprs )
  669,22: (
  669,23: angle * 0.0174
  669,37: )

26 ID
  669,23: angle

50 * UnaryExpr
  669,29: *
  669,31: 0.0174

156 NUM
  669,31: 0.0174

249 )
  669,37: )

48 * UnaryExpr
  669,39: *
  669,41: 1000

157 NUM
  669,41: 1000

207 CR_token2
  669,45: 


68 ID = Expr
  670,9: yv
  670,12: =
  670,14: Math.Sin(angle * 0.0174) * 550

184 = Expr
  670,12: =
  670,14: Math.Sin(angle * 0.0174) * 550

70 ID . ID ( Exprs )
  670,14: Math
  670,18: .
  670,19: Sin
  670,22: (
  670,23: angle * 0.0174
  670,37: )

5 . ID ( Exprs )
  670,18: .
  670,19: Sin
  670,22: (
  670,23: angle * 0.0174
  670,37: )

260 ID ( Exprs )
  670,19: Sin
  670,22: (
  670,23: angle * 0.0174
  670,37: )

24 ( Exprs )
  670,22: (
  670,23: angle * 0.0174
  670,37: )

26 ID
  670,23: angle

50 * UnaryExpr
  670,29: *
  670,31: 0.0174

156 NUM
  670,31: 0.0174

249 )
  670,37: )

48 * UnaryExpr
  670,39: *
  670,41: 550

157 NUM
  670,41: 550

207 CR_token2
  670,46: 


68 ID . ID ( Exprs )
  671,9: Shapes
  671,15: .
  671,16: Move
  671,20: (
  671,21: levelshapes[i][p-1], xv + 512, yv + 350
  671,60: )

184 . ID ( Exprs )
  671,15: .
  671,16: Move
  671,20: (
  671,21: levelshapes[i][p-1], xv + 512, yv + 350
  671,60: )

255 ID ( Exprs )
  671,16: Move
  671,20: (
  671,21: levelshapes[i][p-1], xv + 512, yv + 350
  671,60: )

221 ( Exprs )
  671,20: (
  671,21: levelshapes[i][p-1], xv + 512, yv + 350
  671,60: )

27 ID Idxs
  671,21: levelshapes
  671,32: [i][p-1]

4 [ Expr ] Idxs
  671,32: [
  671,33: i
  671,34: ]
  671,35: [p-1]

76 ID
  671,33: i

245 ] Idxs
  671,34: ]
  671,35: [p-1]

7 [ Expr ]
  671,35: [
  671,36: p-1
  671,39: ]

76 ID
  671,36: p

65 - MultiplicativeExpr
  671,37: -
  671,38: 1

141 NUM
  671,38: 1

245 ]
  671,39: ]

217 , MoreThanOneExpr
  671,40: ,
  671,42: xv + 512, yv + 350

54 ID
  671,42: xv

65 + MultiplicativeExpr
  671,45: +
  671,47: 512

141 NUM
  671,47: 512

217 , MoreThanOneExpr
  671,50: ,
  671,52: yv + 350

54 ID
  671,52: yv

65 + MultiplicativeExpr
  671,55: +
  671,57: 350

141 NUM
  671,57: 350

238 )
  671,60: )

207 CR_token2
  671,61: 


68 ID . ID ( Exprs )
  672,9: Shapes
  672,15: .
  672,16: Animate
  672,23: (
  672,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  672,87: )

184 . ID ( Exprs )
  672,15: .
  672,16: Animate
  672,23: (
  672,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  672,87: )

255 ID ( Exprs )
  672,16: Animate
  672,23: (
  672,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  672,87: )

221 ( Exprs )
  672,23: (
  672,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  672,87: )

27 ID Idxs
  672,24: levelshapes
  672,35: [i][p-1]

4 [ Expr ] Idxs
  672,35: [
  672,36: i
  672,37: ]
  672,38: [p-1]

76 ID
  672,36: i

245 ] Idxs
  672,37: ]
  672,38: [p-1]

7 [ Expr ]
  672,38: [
  672,39: p-1
  672,42: ]

76 ID
  672,39: p

65 - MultiplicativeExpr
  672,40: -
  672,41: 1

141 NUM
  672,41: 1

245 ]
  672,42: ]

217 , MoreThanOneExpr
  672,43: ,
  672,45: (p-1) * 50 + korrx, (i) * 40 - 0, animtime

54 ( Expr )
  672,45: (
  672,46: p-1
  672,49: )

80 ID
  672,46: p

65 - MultiplicativeExpr
  672,47: -
  672,48: 1

141 NUM
  672,48: 1

265 )
  672,49: )

50 * UnaryExpr
  672,51: *
  672,53: 50

156 NUM
  672,53: 50

65 + MultiplicativeExpr
  672,56: +
  672,58: korrx

141 ID
  672,58: korrx

217 , MoreThanOneExpr
  672,63: ,
  672,65: (i) * 40 - 0, animtime

54 ( Expr )
  672,65: (
  672,66: i
  672,67: )

80 ID
  672,66: i

265 )
  672,67: )

50 * UnaryExpr
  672,69: *
  672,71: 40

156 NUM
  672,71: 40

65 - MultiplicativeExpr
  672,74: -
  672,76: 0

141 NUM
  672,76: 0

217 , MoreThanOneExpr
  672,77: ,
  672,79: animtime

54 ID
  672,79: animtime

238 )
  672,87: )

207 CR_token2
  672,92: 


122 OptionalElse_token1
  673,7: Endif

203 CR_token2
  673,18: 


177 Stmt_token6
  674,5: EndFor

203 CR_token2
  674,13: 


177 Stmt_token6
  675,3: EndFor

206 CR_token2
  675,9: 


107 CRStmtCRs_repeat1
  677,3:   'shadows for the water
  LoadShadowWater()
  
  
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif  

106 ID ( )
  678,3: LoadShadowWater
  678,18: (
  678,19: )

184 ( )
  678,18: (
  678,19: )

261 )
  678,19: )

206 CR_token2
  678,20: 


106 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  681,3: For
  681,7: i
  681,9: =
  681,11: 0
  681,13: To
  681,16: 15
  681,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   
    EndFor  

  745,3: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  681,7: i
  681,9: =
  681,11: 0
  681,13: To
  681,16: 15
  681,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   
    EndFor  

  745,3: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  681,9: =
  681,11: 0
  681,13: To
  681,16: 15
  681,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   
    EndFor  

  745,3: EndFor

56 NUM
  681,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  681,13: To
  681,16: 15
  681,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   
    EndFor  

  745,3: EndFor

83 NUM
  681,16: 15

145 CR_token2
  681,18: 


88 Stmt_token4 ID = Expr Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  682,5: For
  682,9: p
  682,11: =
  682,13: 1
  682,15: To
  682,18: Text.GetLength(block[stage][i])
  682,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   

  744,5: EndFor

267 ID = Expr Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  682,9: p
  682,11: =
  682,13: 1
  682,15: To
  682,18: Text.GetLength(block[stage][i])
  682,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   

  744,5: EndFor

266 = Expr Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  682,11: =
  682,13: 1
  682,15: To
  682,18: Text.GetLength(block[stage][i])
  682,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   

  744,5: EndFor

56 NUM
  682,13: 1

264 Stmt_token5 Expr Stmt_repeat1 Stmt_token6
  682,15: To
  682,18: Text.GetLength(block[stage][i])
  682,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = "X" then 
        posy = i  
        posx = p-1
        blockcode = 0
      elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf
        
      if blockcode = 2 then 
        ground[i][p-1] = 0
      elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif
        
      if blockcode = "C" then
        level[i][p-1] = 2  
      elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif   
      If blockcode = "C" Then 'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif   

  744,5: EndFor

83 ID . ID ( Exprs )
  682,18: Text
  682,22: .
  682,23: GetLength
  682,32: (
  682,33: block[stage][i]
  682,48: )

5 . ID ( Exprs )
  682,22: .
  682,23: GetLength
  682,32: (
  682,33: block[stage][i]
  682,48: )

260 ID ( Exprs )
  682,23: GetLength
  682,32: (
  682,33: block[stage][i]
  682,48: )

24 ( Exprs )
  682,32: (
  682,33: block[stage][i]
  682,48: )

26 ID Idxs
  682,33: block
  682,38: [stage][i]

4 [ Expr ] Idxs
  682,38: [
  682,39: stage
  682,44: ]
  682,45: [i]

76 ID
  682,39: stage

245 ] Idxs
  682,44: ]
  682,45: [i]

7 [ Expr ]
  682,45: [
  682,46: i
  682,47: ]

76 ID
  682,46: i

245 ]
  682,47: ]

249 )
  682,48: )

145 CR_token2
  682,49: 


88 ID = Expr
  683,7: blockcode
  683,17: =
  683,19: Text.GetSubText(block[stage][i], p, 1)

184 = Expr
  683,17: =
  683,19: Text.GetSubText(block[stage][i], p, 1)

70 ID . ID ( Exprs )
  683,19: Text
  683,23: .
  683,24: GetSubText
  683,34: (
  683,35: block[stage][i], p, 1
  683,56: )

5 . ID ( Exprs )
  683,23: .
  683,24: GetSubText
  683,34: (
  683,35: block[stage][i], p, 1
  683,56: )

260 ID ( Exprs )
  683,24: GetSubText
  683,34: (
  683,35: block[stage][i], p, 1
  683,56: )

24 ( Exprs )
  683,34: (
  683,35: block[stage][i], p, 1
  683,56: )

26 ID Idxs
  683,35: block
  683,40: [stage][i]

4 [ Expr ] Idxs
  683,40: [
  683,41: stage
  683,46: ]
  683,47: [i]

76 ID
  683,41: stage

245 ] Idxs
  683,46: ]
  683,47: [i]

7 [ Expr ]
  683,47: [
  683,48: i
  683,49: ]

76 ID
  683,48: i

245 ]
  683,49: ]

217 , MoreThanOneExpr
  683,50: ,
  683,52: p, 1

54 ID
  683,52: p

217 , MoreThanOneExpr
  683,53: ,
  683,55: 1

54 NUM
  683,55: 1

249 )
  683,56: )

203 CR_token2
  683,58: 


96 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  684,7: If
  684,10: blockcode = "X"
  684,26: then
  684,31: 
        posy = i  
        posx = p-1
        blockcode = 0

  688,7: elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf

86 ID
  684,10: blockcode

128 = CompExpr
  684,20: =
  684,22: "X"

117 STR
  684,22: "X"

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  684,26: then
  684,31: 
        posy = i  
        posx = p-1
        blockcode = 0

  688,7: elseIf blockcode = "Y" then 
        posy = i  
        posx = p-1
        blockcode = "A"     
      elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf

124 CR_token2
  684,31: 


67 ID = Expr
  685,9: posy
  685,14: =
  685,16: i

184 = Expr
  685,14: =
  685,16: i

70 ID
  685,16: i

207 CR_token2
  685,19: 


68 ID = Expr
  686,9: posx
  686,14: =
  686,16: p-1

184 = Expr
  686,14: =
  686,16: p-1

70 ID
  686,16: p

59 - MultiplicativeExpr
  686,17: -
  686,18: 1

144 NUM
  686,18: 1

207 CR_token2
  686,19: 


68 ID = Expr
  687,9: blockcode
  687,19: =
  687,21: 0

184 = Expr
  687,19: =
  687,21: 0

70 NUM
  687,21: 0

207 CR_token2
  687,22: 


122 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  688,7: elseIf
  688,14: blockcode = "Y"
  688,30: then
  688,35: 
        posy = i  
        posx = p-1
        blockcode = "A"     

  692,7: elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf

82 ID
  688,14: blockcode

128 = CompExpr
  688,24: =
  688,26: "Y"

117 STR
  688,26: "Y"

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  688,30: then
  688,35: 
        posy = i  
        posx = p-1
        blockcode = "A"     

  692,7: elseIf blockcode = "Z" then 
        posy = i  
        posx = p-1
        blockcode = "B"
      EndIf

118 CR_token2
  688,35: 


67 ID = Expr
  689,9: posy
  689,14: =
  689,16: i

184 = Expr
  689,14: =
  689,16: i

70 ID
  689,16: i

207 CR_token2
  689,19: 


68 ID = Expr
  690,9: posx
  690,14: =
  690,16: p-1

184 = Expr
  690,14: =
  690,16: p-1

70 ID
  690,16: p

59 - MultiplicativeExpr
  690,17: -
  690,18: 1

144 NUM
  690,18: 1

207 CR_token2
  690,19: 


68 ID = Expr
  691,9: blockcode
  691,19: =
  691,21: "A"

184 = Expr
  691,19: =
  691,21: "A"

70 STR
  691,21: "A"

207 CR_token2
  691,29: 


115 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  692,7: elseIf
  692,14: blockcode = "Z"
  692,30: then
  692,35: 
        posy = i  
        posx = p-1
        blockcode = "B"

  696,7: EndIf

82 ID
  692,14: blockcode

128 = CompExpr
  692,24: =
  692,26: "Z"

117 STR
  692,26: "Z"

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  692,30: then
  692,35: 
        posy = i  
        posx = p-1
        blockcode = "B"

  696,7: EndIf

118 CR_token2
  692,35: 


67 ID = Expr
  693,9: posy
  693,14: =
  693,16: i

184 = Expr
  693,14: =
  693,16: i

70 ID
  693,16: i

207 CR_token2
  693,19: 


68 ID = Expr
  694,9: posx
  694,14: =
  694,16: p-1

184 = Expr
  694,14: =
  694,16: p-1

70 ID
  694,16: p

59 - MultiplicativeExpr
  694,17: -
  694,18: 1

144 NUM
  694,18: 1

207 CR_token2
  694,19: 


68 ID = Expr
  695,9: blockcode
  695,19: =
  695,21: "B"

184 = Expr
  695,19: =
  695,21: "B"

70 STR
  695,21: "B"

207 CR_token2
  695,24: 


115 OptionalElse_token1
  696,7: EndIf

203 CR_token2
  696,12: 


177 CR_token2
  697,9: 


88 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  698,7: if
  698,10: blockcode = 2
  698,24: then
  698,29: 
        ground[i][p-1] = 0

  700,7: elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif

86 ID
  698,10: blockcode

128 = CompExpr
  698,20: =
  698,22: 2

117 NUM
  698,22: 2

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  698,24: then
  698,29: 
        ground[i][p-1] = 0

  700,7: elseif blockcode = "C" then 
        ground[i][p-1] = "A"
      elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif

124 CR_token2
  698,29: 


67 ID Idxs = Expr
  699,9: ground
  699,15: [i][p-1]
  699,24: =
  699,26: 0

184 [ Expr ] Idxs
  699,15: [
  699,16: i
  699,17: ]
  699,18: [p-1]

76 ID
  699,16: i

245 ] Idxs
  699,17: ]
  699,18: [p-1]

7 [ Expr ]
  699,18: [
  699,19: p-1
  699,22: ]

76 ID
  699,19: p

65 - MultiplicativeExpr
  699,20: -
  699,21: 1

141 NUM
  699,21: 1

245 ]
  699,22: ]

263 = Expr
  699,24: =
  699,26: 0

55 NUM
  699,26: 0

207 CR_token2
  699,27: 


122 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  700,7: elseif
  700,14: blockcode = "C"
  700,30: then
  700,35: 
        ground[i][p-1] = "A"

  702,7: elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif

82 ID
  700,14: blockcode

128 = CompExpr
  700,24: =
  700,26: "C"

117 STR
  700,26: "C"

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  700,30: then
  700,35: 
        ground[i][p-1] = "A"

  702,7: elseif blockcode = "D" then 
        ground[i][p-1] = "B"
      else  
        ground[i][p-1] = blockcode
      endif

118 CR_token2
  700,35: 


67 ID Idxs = Expr
  701,9: ground
  701,15: [i][p-1]
  701,24: =
  701,26: "A"

184 [ Expr ] Idxs
  701,15: [
  701,16: i
  701,17: ]
  701,18: [p-1]

76 ID
  701,16: i

245 ] Idxs
  701,17: ]
  701,18: [p-1]

7 [ Expr ]
  701,18: [
  701,19: p-1
  701,22: ]

76 ID
  701,19: p

65 - MultiplicativeExpr
  701,20: -
  701,21: 1

141 NUM
  701,21: 1

245 ]
  701,22: ]

263 = Expr
  701,24: =
  701,26: "A"

55 STR
  701,26: "A"

207 CR_token2
  701,29: 


115 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  702,7: elseif
  702,14: blockcode = "D"
  702,30: then
  702,35: 
        ground[i][p-1] = "B"

  704,7: else  
        ground[i][p-1] = blockcode
      endif

82 ID
  702,14: blockcode

128 = CompExpr
  702,24: =
  702,26: "D"

117 STR
  702,26: "D"

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  702,30: then
  702,35: 
        ground[i][p-1] = "B"

  704,7: else  
        ground[i][p-1] = blockcode
      endif

118 CR_token2
  702,35: 


67 ID Idxs = Expr
  703,9: ground
  703,15: [i][p-1]
  703,24: =
  703,26: "B"

184 [ Expr ] Idxs
  703,15: [
  703,16: i
  703,17: ]
  703,18: [p-1]

76 ID
  703,16: i

245 ] Idxs
  703,17: ]
  703,18: [p-1]

7 [ Expr ]
  703,18: [
  703,19: p-1
  703,22: ]

76 ID
  703,19: p

65 - MultiplicativeExpr
  703,20: -
  703,21: 1

141 NUM
  703,21: 1

245 ]
  703,22: ]

263 = Expr
  703,24: =
  703,26: "B"

55 STR
  703,26: "B"

207 CR_token2
  703,29: 


115 OptionalElse_token2 CRStmtCRs OptionalElse_token1
  704,7: else
  704,13: 
        ground[i][p-1] = blockcode

  706,7: endif

201 CR_token2
  704,13: 


113 ID Idxs = Expr
  705,9: ground
  705,15: [i][p-1]
  705,24: =
  705,26: blockcode

184 [ Expr ] Idxs
  705,15: [
  705,16: i
  705,17: ]
  705,18: [p-1]

76 ID
  705,16: i

245 ] Idxs
  705,17: ]
  705,18: [p-1]

7 [ Expr ]
  705,18: [
  705,19: p-1
  705,22: ]

76 ID
  705,19: p

65 - MultiplicativeExpr
  705,20: -
  705,21: 1

141 NUM
  705,21: 1

245 ]
  705,22: ]

263 = Expr
  705,24: =
  705,26: blockcode

55 ID
  705,26: blockcode

202 CR_token2
  705,35: 


237 OptionalElse_token1
  706,7: endif

203 CR_token2
  706,12: 


177 CR_token2
  707,9: 


88 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  708,7: if
  708,10: blockcode = "C"
  708,26: then
  708,30: 
        level[i][p-1] = 2  

  710,7: elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif

86 ID
  708,10: blockcode

128 = CompExpr
  708,20: =
  708,22: "C"

117 STR
  708,22: "C"

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  708,26: then
  708,30: 
        level[i][p-1] = 2  

  710,7: elseif blockcode = "D" then
        level[i][p-1] = 2  
      else
         level[i][p-1] = blockcode      
      endif

124 CR_token2
  708,30: 


67 ID Idxs = Expr
  709,9: level
  709,14: [i][p-1]
  709,23: =
  709,25: 2

184 [ Expr ] Idxs
  709,14: [
  709,15: i
  709,16: ]
  709,17: [p-1]

76 ID
  709,15: i

245 ] Idxs
  709,16: ]
  709,17: [p-1]

7 [ Expr ]
  709,17: [
  709,18: p-1
  709,21: ]

76 ID
  709,18: p

65 - MultiplicativeExpr
  709,19: -
  709,20: 1

141 NUM
  709,20: 1

245 ]
  709,21: ]

263 = Expr
  709,23: =
  709,25: 2

55 NUM
  709,25: 2

207 CR_token2
  709,28: 


122 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  710,7: elseif
  710,14: blockcode = "D"
  710,30: then
  710,34: 
        level[i][p-1] = 2  

  712,7: else
         level[i][p-1] = blockcode      
      endif

82 ID
  710,14: blockcode

128 = CompExpr
  710,24: =
  710,26: "D"

117 STR
  710,26: "D"

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  710,30: then
  710,34: 
        level[i][p-1] = 2  

  712,7: else
         level[i][p-1] = blockcode      
      endif

118 CR_token2
  710,34: 


67 ID Idxs = Expr
  711,9: level
  711,14: [i][p-1]
  711,23: =
  711,25: 2

184 [ Expr ] Idxs
  711,14: [
  711,15: i
  711,16: ]
  711,17: [p-1]

76 ID
  711,15: i

245 ] Idxs
  711,16: ]
  711,17: [p-1]

7 [ Expr ]
  711,17: [
  711,18: p-1
  711,21: ]

76 ID
  711,18: p

65 - MultiplicativeExpr
  711,19: -
  711,20: 1

141 NUM
  711,20: 1

245 ]
  711,21: ]

263 = Expr
  711,23: =
  711,25: 2

55 NUM
  711,25: 2

207 CR_token2
  711,28: 


115 OptionalElse_token2 CRStmtCRs OptionalElse_token1
  712,7: else
  712,11: 
         level[i][p-1] = blockcode      

  714,7: endif

201 CR_token2
  712,11: 


113 ID Idxs = Expr
  713,10: level
  713,15: [i][p-1]
  713,24: =
  713,26: blockcode

184 [ Expr ] Idxs
  713,15: [
  713,16: i
  713,17: ]
  713,18: [p-1]

76 ID
  713,16: i

245 ] Idxs
  713,17: ]
  713,18: [p-1]

7 [ Expr ]
  713,18: [
  713,19: p-1
  713,22: ]

76 ID
  713,19: p

65 - MultiplicativeExpr
  713,20: -
  713,21: 1

141 NUM
  713,21: 1

245 ]
  713,22: ]

263 = Expr
  713,24: =
  713,26: blockcode

55 ID
  713,26: blockcode

202 CR_token2
  713,41: 


237 OptionalElse_token1
  714,7: endif

203 CR_token2
  714,15: 


96 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  715,7: If
  715,10: blockcode = "C"
  715,26: Then
  715,30:  'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 -
  722,7: imtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, anim

86 ID
  715,10: blockcode

128 = CompExpr
  715,20: =
  715,22: "C"

117 STR
  715,22: "C"

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  715,26: Then
  715,30:  'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 -
  722,7: imtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, anim

124 CRStmtCRs MoreThanZeroElseIf
  715,30:  'crystal on gras
        levelshapes[i][p-1] = Shapes.AddImage(image["A"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 -
  722,7: imtime)   
      elseIf blockcode = "D" Then 'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, anim

124 CR_token2
  715,47: 


67 ID Idxs = Expr
  716,9: levelshapes
  716,20: [i][p-1]
  716,29: =
  716,31: Shapes.AddImage(image["A"])

184 [ Expr ] Idxs
  716,20: [
  716,21: i
  716,22: ]
  716,23: [p-1]

76 ID
  716,21: i

245 ] Idxs
  716,22: ]
  716,23: [p-1]

7 [ Expr ]
  716,23: [
  716,24: p-1
  716,27: ]

76 ID
  716,24: p

65 - MultiplicativeExpr
  716,25: -
  716,26: 1

141 NUM
  716,26: 1

245 ]
  716,27: ]

263 = Expr
  716,29: =
  716,31: Shapes.AddImage(image["A"])

55 ID . ID ( Exprs )
  716,31: Shapes
  716,37: .
  716,38: AddImage
  716,46: (
  716,47: image["A"]
  716,57: )

5 . ID ( Exprs )
  716,37: .
  716,38: AddImage
  716,46: (
  716,47: image["A"]
  716,57: )

260 ID ( Exprs )
  716,38: AddImage
  716,46: (
  716,47: image["A"]
  716,57: )

24 ( Exprs )
  716,46: (
  716,47: image["A"]
  716,57: )

26 ID Idxs
  716,47: image
  716,52: ["A"]

4 [ Expr ]
  716,52: [
  716,53: "A"
  716,56: ]

76 STR
  716,53: "A"

245 ]
  716,56: ]

249 )
  716,57: )

207 CR_token2
  716,58: 


68 ID = Expr
  717,9: angle
  717,15: =
  717,17: Math.GetRandomNumber(360)

184 = Expr
  717,15: =
  717,17: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  717,17: Math
  717,21: .
  717,22: GetRandomNumber
  717,37: (
  717,38: 360
  717,41: )

5 . ID ( Exprs )
  717,21: .
  717,22: GetRandomNumber
  717,37: (
  717,38: 360
  717,41: )

260 ID ( Exprs )
  717,22: GetRandomNumber
  717,37: (
  717,38: 360
  717,41: )

24 ( Exprs )
  717,37: (
  717,38: 360
  717,41: )

26 NUM
  717,38: 360

249 )
  717,41: )

207 CR_token2
  717,42: 


68 ID = Expr
  718,9: xv
  718,12: =
  718,14: Math.Cos(angle * 0.0174) * 1200

184 = Expr
  718,12: =
  718,14: Math.Cos(angle * 0.0174) * 1200

70 ID . ID ( Exprs )
  718,14: Math
  718,18: .
  718,19: Cos
  718,22: (
  718,23: angle * 0.0174
  718,37: )

5 . ID ( Exprs )
  718,18: .
  718,19: Cos
  718,22: (
  718,23: angle * 0.0174
  718,37: )

260 ID ( Exprs )
  718,19: Cos
  718,22: (
  718,23: angle * 0.0174
  718,37: )

24 ( Exprs )
  718,22: (
  718,23: angle * 0.0174
  718,37: )

26 ID
  718,23: angle

50 * UnaryExpr
  718,29: *
  718,31: 0.0174

156 NUM
  718,31: 0.0174

249 )
  718,37: )

48 * UnaryExpr
  718,39: *
  718,41: 1200

157 NUM
  718,41: 1200

207 CR_token2
  718,45: 


68 ID = Expr
  719,9: yv
  719,12: =
  719,14: Math.Sin(angle * 0.0174) * 600

184 = Expr
  719,12: =
  719,14: Math.Sin(angle * 0.0174) * 600

70 ID . ID ( Exprs )
  719,14: Math
  719,18: .
  719,19: Sin
  719,22: (
  719,23: angle * 0.0174
  719,37: )

5 . ID ( Exprs )
  719,18: .
  719,19: Sin
  719,22: (
  719,23: angle * 0.0174
  719,37: )

260 ID ( Exprs )
  719,19: Sin
  719,22: (
  719,23: angle * 0.0174
  719,37: )

24 ( Exprs )
  719,22: (
  719,23: angle * 0.0174
  719,37: )

26 ID
  719,23: angle

50 * UnaryExpr
  719,29: *
  719,31: 0.0174

156 NUM
  719,31: 0.0174

249 )
  719,37: )

48 * UnaryExpr
  719,39: *
  719,41: 600

157 NUM
  719,41: 600

207 CR_token2
  719,46: 


68 ID . ID ( Exprs )
  720,9: Shapes
  720,15: .
  720,16: Move
  720,20: (
  720,21: levelshapes[i][p-1], xv + 512, yv + 350
  720,60: )

184 . ID ( Exprs )
  720,15: .
  720,16: Move
  720,20: (
  720,21: levelshapes[i][p-1], xv + 512, yv + 350
  720,60: )

255 ID ( Exprs )
  720,16: Move
  720,20: (
  720,21: levelshapes[i][p-1], xv + 512, yv + 350
  720,60: )

221 ( Exprs )
  720,20: (
  720,21: levelshapes[i][p-1], xv + 512, yv + 350
  720,60: )

27 ID Idxs
  720,21: levelshapes
  720,32: [i][p-1]

4 [ Expr ] Idxs
  720,32: [
  720,33: i
  720,34: ]
  720,35: [p-1]

76 ID
  720,33: i

245 ] Idxs
  720,34: ]
  720,35: [p-1]

7 [ Expr ]
  720,35: [
  720,36: p-1
  720,39: ]

76 ID
  720,36: p

65 - MultiplicativeExpr
  720,37: -
  720,38: 1

141 NUM
  720,38: 1

245 ]
  720,39: ]

217 , MoreThanOneExpr
  720,40: ,
  720,42: xv + 512, yv + 350

54 ID
  720,42: xv

65 + MultiplicativeExpr
  720,45: +
  720,47: 512

141 NUM
  720,47: 512

217 , MoreThanOneExpr
  720,50: ,
  720,52: yv + 350

54 ID
  720,52: yv

65 + MultiplicativeExpr
  720,55: +
  720,57: 350

141 NUM
  720,57: 350

238 )
  720,60: )

207 CR_token2
  720,61: 


68 ID . ID ( Exprs )
  721,9: Shapes
  721,15: .
  721,16: Animate
  721,23: (
  721,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  721,87: )

184 . ID ( Exprs )
  721,15: .
  721,16: Animate
  721,23: (
  721,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  721,87: )

255 ID ( Exprs )
  721,16: Animate
  721,23: (
  721,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  721,87: )

221 ( Exprs )
  721,23: (
  721,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  721,87: )

27 ID Idxs
  721,24: levelshapes
  721,35: [i][p-1]

4 [ Expr ] Idxs
  721,35: [
  721,36: i
  721,37: ]
  721,38: [p-1]

76 ID
  721,36: i

245 ] Idxs
  721,37: ]
  721,38: [p-1]

7 [ Expr ]
  721,38: [
  721,39: p-1
  721,42: ]

76 ID
  721,39: p

65 - MultiplicativeExpr
  721,40: -
  721,41: 1

141 NUM
  721,41: 1

245 ]
  721,42: ]

217 , MoreThanOneExpr
  721,43: ,
  721,45: (p-1) * 50 + korrx, (i) * 40 - 0, animtime

54 ( Expr )
  721,45: (
  721,46: p-1
  721,49: )

80 ID
  721,46: p

65 - MultiplicativeExpr
  721,47: -
  721,48: 1

141 NUM
  721,48: 1

265 )
  721,49: )

50 * UnaryExpr
  721,51: *
  721,53: 50

156 NUM
  721,53: 50

65 + MultiplicativeExpr
  721,56: +
  721,58: korrx

141 ID
  721,58: korrx

217 , MoreThanOneExpr
  721,63: ,
  721,65: (i) * 40 - 0, animtime

54 ( Expr )
  721,65: (
  721,66: i
  721,67: )

80 ID
  721,66: i

265 )
  721,67: )

50 * UnaryExpr
  721,69: *
  721,71: 40

156 NUM
  721,71: 40

65 - MultiplicativeExpr
  721,74: -
  721,76: 0

141 NUM
  721,76: 0

217 , MoreThanOneExpr
  721,77: ,
  721,79: animtime

54 ID
  721,79: animtime

238 )
  721,87: )

207 CR_token2
  721,91: 


122 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  722,7: elseIf
  722,14: blockcode = "D"
  722,30: Then
  722,34:  'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animt
  729,6:            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, anim

82 ID
  722,14: blockcode

128 = CompExpr
  722,24: =
  722,26: "D"

117 STR
  722,26: "D"

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  722,30: Then
  722,34:  'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animt
  729,6:            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, anim

118 CRStmtCRs MoreThanZeroElseIf
  722,34:  'crystal on wood
        levelshapes[i][p-1] = Shapes.AddImage(image["B"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animt
  729,6:            
     elseIf blockcode < 2  Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 
      ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, anim

118 CR_token2
  722,51: 


67 ID Idxs = Expr
  723,9: levelshapes
  723,20: [i][p-1]
  723,29: =
  723,31: Shapes.AddImage(image["B"])

184 [ Expr ] Idxs
  723,20: [
  723,21: i
  723,22: ]
  723,23: [p-1]

76 ID
  723,21: i

245 ] Idxs
  723,22: ]
  723,23: [p-1]

7 [ Expr ]
  723,23: [
  723,24: p-1
  723,27: ]

76 ID
  723,24: p

65 - MultiplicativeExpr
  723,25: -
  723,26: 1

141 NUM
  723,26: 1

245 ]
  723,27: ]

263 = Expr
  723,29: =
  723,31: Shapes.AddImage(image["B"])

55 ID . ID ( Exprs )
  723,31: Shapes
  723,37: .
  723,38: AddImage
  723,46: (
  723,47: image["B"]
  723,57: )

5 . ID ( Exprs )
  723,37: .
  723,38: AddImage
  723,46: (
  723,47: image["B"]
  723,57: )

260 ID ( Exprs )
  723,38: AddImage
  723,46: (
  723,47: image["B"]
  723,57: )

24 ( Exprs )
  723,46: (
  723,47: image["B"]
  723,57: )

26 ID Idxs
  723,47: image
  723,52: ["B"]

4 [ Expr ]
  723,52: [
  723,53: "B"
  723,56: ]

76 STR
  723,53: "B"

245 ]
  723,56: ]

249 )
  723,57: )

207 CR_token2
  723,58: 


68 ID = Expr
  724,9: angle
  724,15: =
  724,17: Math.GetRandomNumber(360)

184 = Expr
  724,15: =
  724,17: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  724,17: Math
  724,21: .
  724,22: GetRandomNumber
  724,37: (
  724,38: 360
  724,41: )

5 . ID ( Exprs )
  724,21: .
  724,22: GetRandomNumber
  724,37: (
  724,38: 360
  724,41: )

260 ID ( Exprs )
  724,22: GetRandomNumber
  724,37: (
  724,38: 360
  724,41: )

24 ( Exprs )
  724,37: (
  724,38: 360
  724,41: )

26 NUM
  724,38: 360

249 )
  724,41: )

207 CR_token2
  724,42: 


68 ID = Expr
  725,9: xv
  725,12: =
  725,14: Math.Cos(angle * 0.0174) * 1200

184 = Expr
  725,12: =
  725,14: Math.Cos(angle * 0.0174) * 1200

70 ID . ID ( Exprs )
  725,14: Math
  725,18: .
  725,19: Cos
  725,22: (
  725,23: angle * 0.0174
  725,37: )

5 . ID ( Exprs )
  725,18: .
  725,19: Cos
  725,22: (
  725,23: angle * 0.0174
  725,37: )

260 ID ( Exprs )
  725,19: Cos
  725,22: (
  725,23: angle * 0.0174
  725,37: )

24 ( Exprs )
  725,22: (
  725,23: angle * 0.0174
  725,37: )

26 ID
  725,23: angle

50 * UnaryExpr
  725,29: *
  725,31: 0.0174

156 NUM
  725,31: 0.0174

249 )
  725,37: )

48 * UnaryExpr
  725,39: *
  725,41: 1200

157 NUM
  725,41: 1200

207 CR_token2
  725,45: 


68 ID = Expr
  726,9: yv
  726,12: =
  726,14: Math.Sin(angle * 0.0174) * 600

184 = Expr
  726,12: =
  726,14: Math.Sin(angle * 0.0174) * 600

70 ID . ID ( Exprs )
  726,14: Math
  726,18: .
  726,19: Sin
  726,22: (
  726,23: angle * 0.0174
  726,37: )

5 . ID ( Exprs )
  726,18: .
  726,19: Sin
  726,22: (
  726,23: angle * 0.0174
  726,37: )

260 ID ( Exprs )
  726,19: Sin
  726,22: (
  726,23: angle * 0.0174
  726,37: )

24 ( Exprs )
  726,22: (
  726,23: angle * 0.0174
  726,37: )

26 ID
  726,23: angle

50 * UnaryExpr
  726,29: *
  726,31: 0.0174

156 NUM
  726,31: 0.0174

249 )
  726,37: )

48 * UnaryExpr
  726,39: *
  726,41: 600

157 NUM
  726,41: 600

207 CR_token2
  726,46: 


68 ID . ID ( Exprs )
  727,9: Shapes
  727,15: .
  727,16: Move
  727,20: (
  727,21: levelshapes[i][p-1], xv + 512, yv + 350
  727,60: )

184 . ID ( Exprs )
  727,15: .
  727,16: Move
  727,20: (
  727,21: levelshapes[i][p-1], xv + 512, yv + 350
  727,60: )

255 ID ( Exprs )
  727,16: Move
  727,20: (
  727,21: levelshapes[i][p-1], xv + 512, yv + 350
  727,60: )

221 ( Exprs )
  727,20: (
  727,21: levelshapes[i][p-1], xv + 512, yv + 350
  727,60: )

27 ID Idxs
  727,21: levelshapes
  727,32: [i][p-1]

4 [ Expr ] Idxs
  727,32: [
  727,33: i
  727,34: ]
  727,35: [p-1]

76 ID
  727,33: i

245 ] Idxs
  727,34: ]
  727,35: [p-1]

7 [ Expr ]
  727,35: [
  727,36: p-1
  727,39: ]

76 ID
  727,36: p

65 - MultiplicativeExpr
  727,37: -
  727,38: 1

141 NUM
  727,38: 1

245 ]
  727,39: ]

217 , MoreThanOneExpr
  727,40: ,
  727,42: xv + 512, yv + 350

54 ID
  727,42: xv

65 + MultiplicativeExpr
  727,45: +
  727,47: 512

141 NUM
  727,47: 512

217 , MoreThanOneExpr
  727,50: ,
  727,52: yv + 350

54 ID
  727,52: yv

65 + MultiplicativeExpr
  727,55: +
  727,57: 350

141 NUM
  727,57: 350

238 )
  727,60: )

207 CR_token2
  727,61: 


68 ID . ID ( Exprs )
  728,9: Shapes
  728,15: .
  728,16: Animate
  728,23: (
  728,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  728,87: )

184 . ID ( Exprs )
  728,15: .
  728,16: Animate
  728,23: (
  728,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  728,87: )

255 ID ( Exprs )
  728,16: Animate
  728,23: (
  728,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  728,87: )

221 ( Exprs )
  728,23: (
  728,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  728,87: )

27 ID Idxs
  728,24: levelshapes
  728,35: [i][p-1]

4 [ Expr ] Idxs
  728,35: [
  728,36: i
  728,37: ]
  728,38: [p-1]

76 ID
  728,36: i

245 ] Idxs
  728,37: ]
  728,38: [p-1]

7 [ Expr ]
  728,38: [
  728,39: p-1
  728,42: ]

76 ID
  728,39: p

65 - MultiplicativeExpr
  728,40: -
  728,41: 1

141 NUM
  728,41: 1

245 ]
  728,42: ]

217 , MoreThanOneExpr
  728,43: ,
  728,45: (p-1) * 50 + korrx, (i) * 40 - 0, animtime

54 ( Expr )
  728,45: (
  728,46: p-1
  728,49: )

80 ID
  728,46: p

65 - MultiplicativeExpr
  728,47: -
  728,48: 1

141 NUM
  728,48: 1

265 )
  728,49: )

50 * UnaryExpr
  728,51: *
  728,53: 50

156 NUM
  728,53: 50

65 + MultiplicativeExpr
  728,56: +
  728,58: korrx

141 ID
  728,58: korrx

217 , MoreThanOneExpr
  728,63: ,
  728,65: (i) * 40 - 0, animtime

54 ( Expr )
  728,65: (
  728,66: i
  728,67: )

80 ID
  728,66: i

265 )
  728,67: )

50 * UnaryExpr
  728,69: *
  728,71: 40

156 NUM
  728,71: 40

65 - MultiplicativeExpr
  728,74: -
  728,76: 0

141 NUM
  728,76: 0

217 , MoreThanOneExpr
  728,77: ,
  728,79: animtime

54 ID
  728,79: animtime

238 )
  728,87: )

207 CR_token2
  728,100: 


115 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  729,6: elseIf
  729,13: blockcode < 2
  729,28: Then
  729,32: 
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 

  736,7: ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif

82 ID
  729,13: blockcode

91 < AdditiveExpr
  729,23: <
  729,25: 2

131 NUM
  729,25: 2

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  729,28: Then
  729,32: 
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600              
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime) 

  736,7: ElseIf blockcode = 2 Then
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)
      endif

118 CR_token2
  729,32: 


67 ID Idxs = Expr
  730,9: levelshapes
  730,20: [i][p-1]
  730,29: =
  730,31: Shapes.AddImage(image[blockcode])

184 [ Expr ] Idxs
  730,20: [
  730,21: i
  730,22: ]
  730,23: [p-1]

76 ID
  730,21: i

245 ] Idxs
  730,22: ]
  730,23: [p-1]

7 [ Expr ]
  730,23: [
  730,24: p-1
  730,27: ]

76 ID
  730,24: p

65 - MultiplicativeExpr
  730,25: -
  730,26: 1

141 NUM
  730,26: 1

245 ]
  730,27: ]

263 = Expr
  730,29: =
  730,31: Shapes.AddImage(image[blockcode])

55 ID . ID ( Exprs )
  730,31: Shapes
  730,37: .
  730,38: AddImage
  730,46: (
  730,47: image[blockcode]
  730,63: )

5 . ID ( Exprs )
  730,37: .
  730,38: AddImage
  730,46: (
  730,47: image[blockcode]
  730,63: )

260 ID ( Exprs )
  730,38: AddImage
  730,46: (
  730,47: image[blockcode]
  730,63: )

24 ( Exprs )
  730,46: (
  730,47: image[blockcode]
  730,63: )

26 ID Idxs
  730,47: image
  730,52: [blockcode]

4 [ Expr ]
  730,52: [
  730,53: blockcode
  730,62: ]

76 ID
  730,53: blockcode

245 ]
  730,62: ]

249 )
  730,63: )

207 CR_token2
  730,64: 


68 ID = Expr
  731,9: angle
  731,15: =
  731,17: Math.GetRandomNumber(360)

184 = Expr
  731,15: =
  731,17: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  731,17: Math
  731,21: .
  731,22: GetRandomNumber
  731,37: (
  731,38: 360
  731,41: )

5 . ID ( Exprs )
  731,21: .
  731,22: GetRandomNumber
  731,37: (
  731,38: 360
  731,41: )

260 ID ( Exprs )
  731,22: GetRandomNumber
  731,37: (
  731,38: 360
  731,41: )

24 ( Exprs )
  731,37: (
  731,38: 360
  731,41: )

26 NUM
  731,38: 360

249 )
  731,41: )

207 CR_token2
  731,42: 


68 ID = Expr
  732,9: xv
  732,12: =
  732,14: Math.Cos(angle * 0.0174) * 1200

184 = Expr
  732,12: =
  732,14: Math.Cos(angle * 0.0174) * 1200

70 ID . ID ( Exprs )
  732,14: Math
  732,18: .
  732,19: Cos
  732,22: (
  732,23: angle * 0.0174
  732,37: )

5 . ID ( Exprs )
  732,18: .
  732,19: Cos
  732,22: (
  732,23: angle * 0.0174
  732,37: )

260 ID ( Exprs )
  732,19: Cos
  732,22: (
  732,23: angle * 0.0174
  732,37: )

24 ( Exprs )
  732,22: (
  732,23: angle * 0.0174
  732,37: )

26 ID
  732,23: angle

50 * UnaryExpr
  732,29: *
  732,31: 0.0174

156 NUM
  732,31: 0.0174

249 )
  732,37: )

48 * UnaryExpr
  732,39: *
  732,41: 1200

157 NUM
  732,41: 1200

207 CR_token2
  732,45: 


68 ID = Expr
  733,9: yv
  733,12: =
  733,14: Math.Sin(angle * 0.0174) * 600

184 = Expr
  733,12: =
  733,14: Math.Sin(angle * 0.0174) * 600

70 ID . ID ( Exprs )
  733,14: Math
  733,18: .
  733,19: Sin
  733,22: (
  733,23: angle * 0.0174
  733,37: )

5 . ID ( Exprs )
  733,18: .
  733,19: Sin
  733,22: (
  733,23: angle * 0.0174
  733,37: )

260 ID ( Exprs )
  733,19: Sin
  733,22: (
  733,23: angle * 0.0174
  733,37: )

24 ( Exprs )
  733,22: (
  733,23: angle * 0.0174
  733,37: )

26 ID
  733,23: angle

50 * UnaryExpr
  733,29: *
  733,31: 0.0174

156 NUM
  733,31: 0.0174

249 )
  733,37: )

48 * UnaryExpr
  733,39: *
  733,41: 600

157 NUM
  733,41: 600

207 CR_token2
  733,58: 


68 ID . ID ( Exprs )
  734,9: Shapes
  734,15: .
  734,16: Move
  734,20: (
  734,21: levelshapes[i][p-1], xv + 512, yv + 350
  734,60: )

184 . ID ( Exprs )
  734,15: .
  734,16: Move
  734,20: (
  734,21: levelshapes[i][p-1], xv + 512, yv + 350
  734,60: )

255 ID ( Exprs )
  734,16: Move
  734,20: (
  734,21: levelshapes[i][p-1], xv + 512, yv + 350
  734,60: )

221 ( Exprs )
  734,20: (
  734,21: levelshapes[i][p-1], xv + 512, yv + 350
  734,60: )

27 ID Idxs
  734,21: levelshapes
  734,32: [i][p-1]

4 [ Expr ] Idxs
  734,32: [
  734,33: i
  734,34: ]
  734,35: [p-1]

76 ID
  734,33: i

245 ] Idxs
  734,34: ]
  734,35: [p-1]

7 [ Expr ]
  734,35: [
  734,36: p-1
  734,39: ]

76 ID
  734,36: p

65 - MultiplicativeExpr
  734,37: -
  734,38: 1

141 NUM
  734,38: 1

245 ]
  734,39: ]

217 , MoreThanOneExpr
  734,40: ,
  734,42: xv + 512, yv + 350

54 ID
  734,42: xv

65 + MultiplicativeExpr
  734,45: +
  734,47: 512

141 NUM
  734,47: 512

217 , MoreThanOneExpr
  734,50: ,
  734,52: yv + 350

54 ID
  734,52: yv

65 + MultiplicativeExpr
  734,55: +
  734,57: 350

141 NUM
  734,57: 350

238 )
  734,60: )

207 CR_token2
  734,61: 


68 ID . ID ( Exprs )
  735,9: Shapes
  735,15: .
  735,16: Animate
  735,23: (
  735,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  735,87: )

184 . ID ( Exprs )
  735,15: .
  735,16: Animate
  735,23: (
  735,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  735,87: )

255 ID ( Exprs )
  735,16: Animate
  735,23: (
  735,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  735,87: )

221 ( Exprs )
  735,23: (
  735,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  735,87: )

27 ID Idxs
  735,24: levelshapes
  735,35: [i][p-1]

4 [ Expr ] Idxs
  735,35: [
  735,36: i
  735,37: ]
  735,38: [p-1]

76 ID
  735,36: i

245 ] Idxs
  735,37: ]
  735,38: [p-1]

7 [ Expr ]
  735,38: [
  735,39: p-1
  735,42: ]

76 ID
  735,39: p

65 - MultiplicativeExpr
  735,40: -
  735,41: 1

141 NUM
  735,41: 1

245 ]
  735,42: ]

217 , MoreThanOneExpr
  735,43: ,
  735,45: (p-1) * 50 + korrx, (i) * 40 - 0, animtime

54 ( Expr )
  735,45: (
  735,46: p-1
  735,49: )

80 ID
  735,46: p

65 - MultiplicativeExpr
  735,47: -
  735,48: 1

141 NUM
  735,48: 1

265 )
  735,49: )

50 * UnaryExpr
  735,51: *
  735,53: 50

156 NUM
  735,53: 50

65 + MultiplicativeExpr
  735,56: +
  735,58: korrx

141 ID
  735,58: korrx

217 , MoreThanOneExpr
  735,63: ,
  735,65: (i) * 40 - 0, animtime

54 ( Expr )
  735,65: (
  735,66: i
  735,67: )

80 ID
  735,66: i

265 )
  735,67: )

50 * UnaryExpr
  735,69: *
  735,71: 40

156 NUM
  735,71: 40

65 - MultiplicativeExpr
  735,74: -
  735,76: 0

141 NUM
  735,76: 0

217 , MoreThanOneExpr
  735,77: ,
  735,79: animtime

54 ID
  735,79: animtime

238 )
  735,87: )

207 CR_token2
  735,89: 


115 MoreThanZeroElseIf_token1 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  736,7: ElseIf
  736,14: blockcode = 2
  736,28: Then
  736,32: 
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)

  743,7: endif

82 ID
  736,14: blockcode

128 = CompExpr
  736,24: =
  736,26: 2

117 NUM
  736,26: 2

236 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  736,28: Then
  736,32: 
        levelshapes[i][p-1] = Shapes.AddImage(image["0"])
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)

  743,7: endif

118 CR_token2
  736,32: 


67 ID Idxs = Expr
  737,9: levelshapes
  737,20: [i][p-1]
  737,29: =
  737,31: Shapes.AddImage(image["0"])

184 [ Expr ] Idxs
  737,20: [
  737,21: i
  737,22: ]
  737,23: [p-1]

76 ID
  737,21: i

245 ] Idxs
  737,22: ]
  737,23: [p-1]

7 [ Expr ]
  737,23: [
  737,24: p-1
  737,27: ]

76 ID
  737,24: p

65 - MultiplicativeExpr
  737,25: -
  737,26: 1

141 NUM
  737,26: 1

245 ]
  737,27: ]

263 = Expr
  737,29: =
  737,31: Shapes.AddImage(image["0"])

55 ID . ID ( Exprs )
  737,31: Shapes
  737,37: .
  737,38: AddImage
  737,46: (
  737,47: image["0"]
  737,57: )

5 . ID ( Exprs )
  737,37: .
  737,38: AddImage
  737,46: (
  737,47: image["0"]
  737,57: )

260 ID ( Exprs )
  737,38: AddImage
  737,46: (
  737,47: image["0"]
  737,57: )

24 ( Exprs )
  737,46: (
  737,47: image["0"]
  737,57: )

26 ID Idxs
  737,47: image
  737,52: ["0"]

4 [ Expr ]
  737,52: [
  737,53: "0"
  737,56: ]

76 STR
  737,53: "0"

245 ]
  737,56: ]

249 )
  737,57: )

207 CR_token2
  737,58: 


68 ID = Expr
  738,9: angle
  738,15: =
  738,17: Math.GetRandomNumber(360)

184 = Expr
  738,15: =
  738,17: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  738,17: Math
  738,21: .
  738,22: GetRandomNumber
  738,37: (
  738,38: 360
  738,41: )

5 . ID ( Exprs )
  738,21: .
  738,22: GetRandomNumber
  738,37: (
  738,38: 360
  738,41: )

260 ID ( Exprs )
  738,22: GetRandomNumber
  738,37: (
  738,38: 360
  738,41: )

24 ( Exprs )
  738,37: (
  738,38: 360
  738,41: )

26 NUM
  738,38: 360

249 )
  738,41: )

207 CR_token2
  738,42: 


68 ID = Expr
  739,9: xv
  739,12: =
  739,14: Math.Cos(angle * 0.0174) * 1200

184 = Expr
  739,12: =
  739,14: Math.Cos(angle * 0.0174) * 1200

70 ID . ID ( Exprs )
  739,14: Math
  739,18: .
  739,19: Cos
  739,22: (
  739,23: angle * 0.0174
  739,37: )

5 . ID ( Exprs )
  739,18: .
  739,19: Cos
  739,22: (
  739,23: angle * 0.0174
  739,37: )

260 ID ( Exprs )
  739,19: Cos
  739,22: (
  739,23: angle * 0.0174
  739,37: )

24 ( Exprs )
  739,22: (
  739,23: angle * 0.0174
  739,37: )

26 ID
  739,23: angle

50 * UnaryExpr
  739,29: *
  739,31: 0.0174

156 NUM
  739,31: 0.0174

249 )
  739,37: )

48 * UnaryExpr
  739,39: *
  739,41: 1200

157 NUM
  739,41: 1200

207 CR_token2
  739,45: 


68 ID = Expr
  740,9: yv
  740,12: =
  740,14: Math.Sin(angle * 0.0174) * 600

184 = Expr
  740,12: =
  740,14: Math.Sin(angle * 0.0174) * 600

70 ID . ID ( Exprs )
  740,14: Math
  740,18: .
  740,19: Sin
  740,22: (
  740,23: angle * 0.0174
  740,37: )

5 . ID ( Exprs )
  740,18: .
  740,19: Sin
  740,22: (
  740,23: angle * 0.0174
  740,37: )

260 ID ( Exprs )
  740,19: Sin
  740,22: (
  740,23: angle * 0.0174
  740,37: )

24 ( Exprs )
  740,22: (
  740,23: angle * 0.0174
  740,37: )

26 ID
  740,23: angle

50 * UnaryExpr
  740,29: *
  740,31: 0.0174

156 NUM
  740,31: 0.0174

249 )
  740,37: )

48 * UnaryExpr
  740,39: *
  740,41: 600

157 NUM
  740,41: 600

207 CR_token2
  740,46: 


68 ID . ID ( Exprs )
  741,9: Shapes
  741,15: .
  741,16: Move
  741,20: (
  741,21: levelshapes[i][p-1], xv + 512, yv + 350
  741,60: )

184 . ID ( Exprs )
  741,15: .
  741,16: Move
  741,20: (
  741,21: levelshapes[i][p-1], xv + 512, yv + 350
  741,60: )

255 ID ( Exprs )
  741,16: Move
  741,20: (
  741,21: levelshapes[i][p-1], xv + 512, yv + 350
  741,60: )

221 ( Exprs )
  741,20: (
  741,21: levelshapes[i][p-1], xv + 512, yv + 350
  741,60: )

27 ID Idxs
  741,21: levelshapes
  741,32: [i][p-1]

4 [ Expr ] Idxs
  741,32: [
  741,33: i
  741,34: ]
  741,35: [p-1]

76 ID
  741,33: i

245 ] Idxs
  741,34: ]
  741,35: [p-1]

7 [ Expr ]
  741,35: [
  741,36: p-1
  741,39: ]

76 ID
  741,36: p

65 - MultiplicativeExpr
  741,37: -
  741,38: 1

141 NUM
  741,38: 1

245 ]
  741,39: ]

217 , MoreThanOneExpr
  741,40: ,
  741,42: xv + 512, yv + 350

54 ID
  741,42: xv

65 + MultiplicativeExpr
  741,45: +
  741,47: 512

141 NUM
  741,47: 512

217 , MoreThanOneExpr
  741,50: ,
  741,52: yv + 350

54 ID
  741,52: yv

65 + MultiplicativeExpr
  741,55: +
  741,57: 350

141 NUM
  741,57: 350

238 )
  741,60: )

207 CR_token2
  741,61: 


68 ID . ID ( Exprs )
  742,9: Shapes
  742,15: .
  742,16: Animate
  742,23: (
  742,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  742,87: )

184 . ID ( Exprs )
  742,15: .
  742,16: Animate
  742,23: (
  742,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  742,87: )

255 ID ( Exprs )
  742,16: Animate
  742,23: (
  742,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  742,87: )

221 ( Exprs )
  742,23: (
  742,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  742,87: )

27 ID Idxs
  742,24: levelshapes
  742,35: [i][p-1]

4 [ Expr ] Idxs
  742,35: [
  742,36: i
  742,37: ]
  742,38: [p-1]

76 ID
  742,36: i

245 ] Idxs
  742,37: ]
  742,38: [p-1]

7 [ Expr ]
  742,38: [
  742,39: p-1
  742,42: ]

76 ID
  742,39: p

65 - MultiplicativeExpr
  742,40: -
  742,41: 1

141 NUM
  742,41: 1

245 ]
  742,42: ]

217 , MoreThanOneExpr
  742,43: ,
  742,45: (p-1) * 50 + korrx, (i) * 40 - 0, animtime

54 ( Expr )
  742,45: (
  742,46: p-1
  742,49: )

80 ID
  742,46: p

65 - MultiplicativeExpr
  742,47: -
  742,48: 1

141 NUM
  742,48: 1

265 )
  742,49: )

50 * UnaryExpr
  742,51: *
  742,53: 50

156 NUM
  742,53: 50

65 + MultiplicativeExpr
  742,56: +
  742,58: korrx

141 ID
  742,58: korrx

217 , MoreThanOneExpr
  742,63: ,
  742,65: (i) * 40 - 0, animtime

54 ( Expr )
  742,65: (
  742,66: i
  742,67: )

80 ID
  742,66: i

265 )
  742,67: )

50 * UnaryExpr
  742,69: *
  742,71: 40

156 NUM
  742,71: 40

65 - MultiplicativeExpr
  742,74: -
  742,76: 0

141 NUM
  742,76: 0

217 , MoreThanOneExpr
  742,77: ,
  742,79: animtime

54 ID
  742,79: animtime

238 )
  742,87: )

207 CR_token2
  742,88: 


115 OptionalElse_token1
  743,7: endif

203 CR_token2
  743,15: 


177 Stmt_token6
  744,5: EndFor

203 CR_token2
  744,13: 


177 Stmt_token6
  745,3: EndFor

206 CR_token2
  745,12: 


107 CRStmtCRs_repeat1
  747,3:   'tried to fix strange Shapes.Animate behaviors if there are too many shapes flying around - no real  success... 
  loopdel

106 ID = Expr
  748,3: loopdelay
  748,13: =
  748,15: (1600) * loopmssec

184 = Expr
  748,13: =
  748,15: (1600) * loopmssec

70 ( Expr )
  748,15: (
  748,16: 1600
  748,20: )

64 NUM
  748,16: 1600

235 )
  748,20: )

48 * UnaryExpr
  748,22: *
  748,24: loopmssec

157 ID
  748,24: loopmssec

206 CR_token2
  748,34: 


106 ID = Expr
  749,4: num
  749,8: =
  749,10: 0

184 = Expr
  749,8: =
  749,10: 0

70 NUM
  749,10: 0

206 CR_token2
  749,11: 


106 Stmt_token1 Expr CRStmtCRs Stmt_token2
  750,4: While
  750,9: (num < loopdelay)
  750,26: 
    num = num + 1

  752,3: endwhile

79 ( Expr )
  750,9: (
  750,10: num < loopdelay
  750,25: )

64 ID
  750,10: num

91 < AdditiveExpr
  750,14: <
  750,16: loopdelay

131 ID
  750,16: loopdelay

235 )
  750,25: )

186 CR_token2
  750,26: 


93 ID = Expr
  751,5: num
  751,9: =
  751,11: num + 1

184 = Expr
  751,9: =
  751,11: num + 1

70 ID
  751,11: num

59 + MultiplicativeExpr
  751,15: +
  751,17: 1

144 NUM
  751,17: 1

205 CR_token2
  751,18: 


187 Stmt_token2
  752,3: endwhile

206 CR_token2
  752,11: 


107 TheRest
  754,3:   'loa

106 ID = Expr
  755,3: f
  755,5: =
  755,7: 0

184 = Expr
  755,5: =
  755,7: 0

70 NUM
  755,7: 0

206 CR_token2
  755,8: 


106 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  756,3: For
  756,7: i
  756,9: =
  756,11: 0
  756,13: To
  756,16: 15
  756,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      
    EndFor  

  773,3: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  756,7: i
  756,9: =
  756,11: 0
  756,13: To
  756,16: 15
  756,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      
    EndFor  

  773,3: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  756,9: =
  756,11: 0
  756,13: To
  756,16: 15
  756,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      
    EndFor  

  773,3: EndFor

56 NUM
  756,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  756,13: To
  756,16: 15
  756,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      
    EndFor  

  773,3: EndFor

83 NUM
  756,16: 15

145 CR_token2
  756,18: 


88 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  757,5: For
  757,9: p
  757,11: =
  757,13: 1
  757,15: To
  757,18: Text.GetLength(block[stage][i])
  757,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      

  772,5: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  757,9: p
  757,11: =
  757,13: 1
  757,15: To
  757,18: Text.GetLength(block[stage][i])
  757,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      

  772,5: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  757,11: =
  757,13: 1
  757,15: To
  757,18: Text.GetLength(block[stage][i])
  757,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      

  772,5: EndFor

56 NUM
  757,13: 1

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  757,15: To
  757,18: Text.GetLength(block[stage][i])
  757,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode = 2 or blockcode = "C" or blockcode = "D" Then
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    
      Endif      

  772,5: EndFor

83 ID . ID ( Exprs )
  757,18: Text
  757,22: .
  757,23: GetLength
  757,32: (
  757,33: block[stage][i]
  757,48: )

5 . ID ( Exprs )
  757,22: .
  757,23: GetLength
  757,32: (
  757,33: block[stage][i]
  757,48: )

260 ID ( Exprs )
  757,23: GetLength
  757,32: (
  757,33: block[stage][i]
  757,48: )

24 ( Exprs )
  757,32: (
  757,33: block[stage][i]
  757,48: )

26 ID Idxs
  757,33: block
  757,38: [stage][i]

4 [ Expr ] Idxs
  757,38: [
  757,39: stage
  757,44: ]
  757,45: [i]

76 ID
  757,39: stage

245 ] Idxs
  757,44: ]
  757,45: [i]

7 [ Expr ]
  757,45: [
  757,46: i
  757,47: ]

76 ID
  757,46: i

245 ]
  757,47: ]

249 )
  757,48: )

145 CR_token2
  757,49: 


88 ID = Expr
  758,7: blockcode
  758,17: =
  758,19: Text.GetSubText(block[stage][i], p, 1)

184 = Expr
  758,17: =
  758,19: Text.GetSubText(block[stage][i], p, 1)

70 ID . ID ( Exprs )
  758,19: Text
  758,23: .
  758,24: GetSubText
  758,34: (
  758,35: block[stage][i], p, 1
  758,56: )

5 . ID ( Exprs )
  758,23: .
  758,24: GetSubText
  758,34: (
  758,35: block[stage][i], p, 1
  758,56: )

260 ID ( Exprs )
  758,24: GetSubText
  758,34: (
  758,35: block[stage][i], p, 1
  758,56: )

24 ( Exprs )
  758,34: (
  758,35: block[stage][i], p, 1
  758,56: )

26 ID Idxs
  758,35: block
  758,40: [stage][i]

4 [ Expr ] Idxs
  758,40: [
  758,41: stage
  758,46: ]
  758,47: [i]

76 ID
  758,41: stage

245 ] Idxs
  758,46: ]
  758,47: [i]

7 [ Expr ]
  758,47: [
  758,48: i
  758,49: ]

76 ID
  758,48: i

245 ]
  758,49: ]

217 , MoreThanOneExpr
  758,50: ,
  758,52: p, 1

54 ID
  758,52: p

217 , MoreThanOneExpr
  758,53: ,
  758,55: 1

54 NUM
  758,55: 1

249 )
  758,56: )

203 CR_token2
  758,58: 


96 Stmt_token9 Expr Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  759,7: If
  759,10: blockcode = 2 or blockcode = "C" or blockcode = "D"
  759,62: Then
  759,66: 
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    

  771,7: Endif

86 ID
  759,10: blockcode

128 = CompExpr
  759,20: =
  759,22: 2

117 NUM
  759,22: 2

183 OrExpr_token1 AndExpr
  759,24: or
  759,27: blockcode = "C"

100 ID
  759,27: blockcode

128 = CompExpr
  759,37: =
  759,39: "C"

117 STR
  759,39: "C"

183 OrExpr_token1 AndExpr
  759,43: or
  759,46: blockcode = "D"

100 ID
  759,46: blockcode

128 = CompExpr
  759,56: =
  759,58: "D"

117 STR
  759,58: "D"

254 Stmt_token10 Stmt_repeat1 MoreThanZeroElseIf
  759,62: Then
  759,66: 
        crystalimg[cryst] = Shapes.AddImage(image[2])
        crystalbnk[cryst] = Shapes.AddImage(Path + "/sokocuteg2.png")
        chestarray[i][p-1] = cryst     
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1200
        yv = Math.Sin(angle * 0.0174) * 600  
        Shapes.Move(crystalimg[cryst], xv + 512, yv + 350)
        Shapes.Animate(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5) 
        'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.Move(crystalbnk[cryst] , cryst * 52 , -100) 
        cryst = cryst + 1    

  771,7: Endif

124 CR_token2
  759,66: 


67 ID Idxs = Expr
  760,9: crystalimg
  760,19: [cryst]
  760,27: =
  760,29: Shapes.AddImage(image[2])

184 [ Expr ]
  760,19: [
  760,20: cryst
  760,25: ]

76 ID
  760,20: cryst

245 ]
  760,25: ]

263 = Expr
  760,27: =
  760,29: Shapes.AddImage(image[2])

55 ID . ID ( Exprs )
  760,29: Shapes
  760,35: .
  760,36: AddImage
  760,44: (
  760,45: image[2]
  760,53: )

5 . ID ( Exprs )
  760,35: .
  760,36: AddImage
  760,44: (
  760,45: image[2]
  760,53: )

260 ID ( Exprs )
  760,36: AddImage
  760,44: (
  760,45: image[2]
  760,53: )

24 ( Exprs )
  760,44: (
  760,45: image[2]
  760,53: )

26 ID Idxs
  760,45: image
  760,50: [2]

4 [ Expr ]
  760,50: [
  760,51: 2
  760,52: ]

76 NUM
  760,51: 2

245 ]
  760,52: ]

249 )
  760,53: )

207 CR_token2
  760,54: 


68 ID Idxs = Expr
  761,9: crystalbnk
  761,19: [cryst]
  761,27: =
  761,29: Shapes.AddImage(Path + "/sokocuteg2.png")

184 [ Expr ]
  761,19: [
  761,20: cryst
  761,25: ]

76 ID
  761,20: cryst

245 ]
  761,25: ]

263 = Expr
  761,27: =
  761,29: Shapes.AddImage(Path + "/sokocuteg2.png")

55 ID . ID ( Exprs )
  761,29: Shapes
  761,35: .
  761,36: AddImage
  761,44: (
  761,45: Path + "/sokocuteg2.png"
  761,69: )

5 . ID ( Exprs )
  761,35: .
  761,36: AddImage
  761,44: (
  761,45: Path + "/sokocuteg2.png"
  761,69: )

260 ID ( Exprs )
  761,36: AddImage
  761,44: (
  761,45: Path + "/sokocuteg2.png"
  761,69: )

24 ( Exprs )
  761,44: (
  761,45: Path + "/sokocuteg2.png"
  761,69: )

26 ID
  761,45: Path

65 + MultiplicativeExpr
  761,50: +
  761,52: "/sokocuteg2.png"

141 STR
  761,52: "/sokocuteg2.png"

249 )
  761,69: )

207 CR_token2
  761,70: 


68 ID Idxs = Expr
  762,9: chestarray
  762,19: [i][p-1]
  762,28: =
  762,30: cryst

184 [ Expr ] Idxs
  762,19: [
  762,20: i
  762,21: ]
  762,22: [p-1]

76 ID
  762,20: i

245 ] Idxs
  762,21: ]
  762,22: [p-1]

7 [ Expr ]
  762,22: [
  762,23: p-1
  762,26: ]

76 ID
  762,23: p

65 - MultiplicativeExpr
  762,24: -
  762,25: 1

141 NUM
  762,25: 1

245 ]
  762,26: ]

263 = Expr
  762,28: =
  762,30: cryst

55 ID
  762,30: cryst

207 CR_token2
  762,40: 


68 ID = Expr
  763,9: angle
  763,15: =
  763,17: Math.GetRandomNumber(360)

184 = Expr
  763,15: =
  763,17: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  763,17: Math
  763,21: .
  763,22: GetRandomNumber
  763,37: (
  763,38: 360
  763,41: )

5 . ID ( Exprs )
  763,21: .
  763,22: GetRandomNumber
  763,37: (
  763,38: 360
  763,41: )

260 ID ( Exprs )
  763,22: GetRandomNumber
  763,37: (
  763,38: 360
  763,41: )

24 ( Exprs )
  763,37: (
  763,38: 360
  763,41: )

26 NUM
  763,38: 360

249 )
  763,41: )

207 CR_token2
  763,42: 


68 ID = Expr
  764,9: xv
  764,12: =
  764,14: Math.Cos(angle * 0.0174) * 1200

184 = Expr
  764,12: =
  764,14: Math.Cos(angle * 0.0174) * 1200

70 ID . ID ( Exprs )
  764,14: Math
  764,18: .
  764,19: Cos
  764,22: (
  764,23: angle * 0.0174
  764,37: )

5 . ID ( Exprs )
  764,18: .
  764,19: Cos
  764,22: (
  764,23: angle * 0.0174
  764,37: )

260 ID ( Exprs )
  764,19: Cos
  764,22: (
  764,23: angle * 0.0174
  764,37: )

24 ( Exprs )
  764,22: (
  764,23: angle * 0.0174
  764,37: )

26 ID
  764,23: angle

50 * UnaryExpr
  764,29: *
  764,31: 0.0174

156 NUM
  764,31: 0.0174

249 )
  764,37: )

48 * UnaryExpr
  764,39: *
  764,41: 1200

157 NUM
  764,41: 1200

207 CR_token2
  764,45: 


68 ID = Expr
  765,9: yv
  765,12: =
  765,14: Math.Sin(angle * 0.0174) * 600

184 = Expr
  765,12: =
  765,14: Math.Sin(angle * 0.0174) * 600

70 ID . ID ( Exprs )
  765,14: Math
  765,18: .
  765,19: Sin
  765,22: (
  765,23: angle * 0.0174
  765,37: )

5 . ID ( Exprs )
  765,18: .
  765,19: Sin
  765,22: (
  765,23: angle * 0.0174
  765,37: )

260 ID ( Exprs )
  765,19: Sin
  765,22: (
  765,23: angle * 0.0174
  765,37: )

24 ( Exprs )
  765,22: (
  765,23: angle * 0.0174
  765,37: )

26 ID
  765,23: angle

50 * UnaryExpr
  765,29: *
  765,31: 0.0174

156 NUM
  765,31: 0.0174

249 )
  765,37: )

48 * UnaryExpr
  765,39: *
  765,41: 600

157 NUM
  765,41: 600

207 CR_token2
  765,46: 


68 ID . ID ( Exprs )
  766,9: Shapes
  766,15: .
  766,16: Move
  766,20: (
  766,21: crystalimg[cryst], xv + 512, yv + 350
  766,58: )

184 . ID ( Exprs )
  766,15: .
  766,16: Move
  766,20: (
  766,21: crystalimg[cryst], xv + 512, yv + 350
  766,58: )

255 ID ( Exprs )
  766,16: Move
  766,20: (
  766,21: crystalimg[cryst], xv + 512, yv + 350
  766,58: )

221 ( Exprs )
  766,20: (
  766,21: crystalimg[cryst], xv + 512, yv + 350
  766,58: )

27 ID Idxs
  766,21: crystalimg
  766,31: [cryst]

4 [ Expr ]
  766,31: [
  766,32: cryst
  766,37: ]

76 ID
  766,32: cryst

245 ]
  766,37: ]

217 , MoreThanOneExpr
  766,38: ,
  766,40: xv + 512, yv + 350

54 ID
  766,40: xv

65 + MultiplicativeExpr
  766,43: +
  766,45: 512

141 NUM
  766,45: 512

217 , MoreThanOneExpr
  766,48: ,
  766,50: yv + 350

54 ID
  766,50: yv

65 + MultiplicativeExpr
  766,53: +
  766,55: 350

141 NUM
  766,55: 350

238 )
  766,58: )

207 CR_token2
  766,59: 


68 ID . ID ( Exprs )
  767,9: Shapes
  767,15: .
  767,16: Animate
  767,23: (
  767,24: crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5
  767,90: )

184 . ID ( Exprs )
  767,15: .
  767,16: Animate
  767,23: (
  767,24: crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5
  767,90: )

255 ID ( Exprs )
  767,16: Animate
  767,23: (
  767,24: crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5
  767,90: )

221 ( Exprs )
  767,23: (
  767,24: crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5
  767,90: )

27 ID Idxs
  767,24: crystalimg
  767,34: [cryst]

4 [ Expr ]
  767,34: [
  767,35: cryst
  767,40: ]

76 ID
  767,35: cryst

245 ]
  767,40: ]

217 , MoreThanOneExpr
  767,42: ,
  767,44: (p-1) * 50 + korrx, (i) * 40 - 0, animtime*1.5

54 ( Expr )
  767,44: (
  767,45: p-1
  767,48: )

80 ID
  767,45: p

65 - MultiplicativeExpr
  767,46: -
  767,47: 1

141 NUM
  767,47: 1

265 )
  767,48: )

50 * UnaryExpr
  767,50: *
  767,52: 50

156 NUM
  767,52: 50

65 + MultiplicativeExpr
  767,55: +
  767,57: korrx

141 ID
  767,57: korrx

217 , MoreThanOneExpr
  767,62: ,
  767,64: (i) * 40 - 0, animtime*1.5

54 ( Expr )
  767,64: (
  767,65: i
  767,66: )

80 ID
  767,65: i

265 )
  767,66: )

50 * UnaryExpr
  767,68: *
  767,70: 40

156 NUM
  767,70: 40

65 - MultiplicativeExpr
  767,73: -
  767,75: 0

141 NUM
  767,75: 0

217 , MoreThanOneExpr
  767,76: ,
  767,78: animtime*1.5

54 ID
  767,78: animtime

50 * UnaryExpr
  767,86: *
  767,87: 1.5

156 NUM
  767,87: 1.5

238 )
  767,90: )

207 CR_token2
  767,92: 


122 CRStmtCRs
  768,1:         'Shapes.Move(crystalimg[cryst] , (p-1) * 50 + korrx, (i) * 40 - 0) 
        Shapes.

122 CR_token2
  768,76: 


67 ID . ID ( Exprs )
  769,9: Shapes
  769,15: .
  769,16: Move
  769,20: (
  769,21: crystalbnk[cryst] , cryst * 52 , -100
  769,58: )

184 . ID ( Exprs )
  769,15: .
  769,16: Move
  769,20: (
  769,21: crystalbnk[cryst] , cryst * 52 , -100
  769,58: )

255 ID ( Exprs )
  769,16: Move
  769,20: (
  769,21: crystalbnk[cryst] , cryst * 52 , -100
  769,58: )

221 ( Exprs )
  769,20: (
  769,21: crystalbnk[cryst] , cryst * 52 , -100
  769,58: )

27 ID Idxs
  769,21: crystalbnk
  769,31: [cryst]

4 [ Expr ]
  769,31: [
  769,32: cryst
  769,37: ]

76 ID
  769,32: cryst

245 ]
  769,37: ]

217 , MoreThanOneExpr
  769,39: ,
  769,41: cryst * 52 , -100

54 ID
  769,41: cryst

50 * UnaryExpr
  769,47: *
  769,49: 52

156 NUM
  769,49: 52

217 , MoreThanOneExpr
  769,52: ,
  769,54: -100

54 - Primary
  769,54: -
  769,55: 100

197 NUM
  769,55: 100

238 )
  769,58: )

207 CR_token2
  769,60: 


68 ID = Expr
  770,9: cryst
  770,15: =
  770,17: cryst + 1

184 = Expr
  770,15: =
  770,17: cryst + 1

70 ID
  770,17: cryst

59 + MultiplicativeExpr
  770,23: +
  770,25: 1

144 NUM
  770,25: 1

207 CR_token2
  770,30: 


122 OptionalElse_token1
  771,7: Endif

203 CR_token2
  771,18: 


177 Stmt_token6
  772,5: EndFor

203 CR_token2
  772,13: 


177 Stmt_token6
  773,3: EndFor

206 CR_token2
  773,9: 


106 ID = Expr
  774,3: player1
  774,11: =
  774,13: Shapes.AddImage(Path + "/sokocutep2.png")

184 = Expr
  774,11: =
  774,13: Shapes.AddImage(Path + "/sokocutep2.png")

70 ID . ID ( Exprs )
  774,13: Shapes
  774,19: .
  774,20: AddImage
  774,28: (
  774,29: Path + "/sokocutep2.png"
  774,53: )

5 . ID ( Exprs )
  774,19: .
  774,20: AddImage
  774,28: (
  774,29: Path + "/sokocutep2.png"
  774,53: )

260 ID ( Exprs )
  774,20: AddImage
  774,28: (
  774,29: Path + "/sokocutep2.png"
  774,53: )

24 ( Exprs )
  774,28: (
  774,29: Path + "/sokocutep2.png"
  774,53: )

26 ID
  774,29: Path

65 + MultiplicativeExpr
  774,34: +
  774,36: "/sokocutep2.png"

141 STR
  774,36: "/sokocutep2.png"

249 )
  774,53: )

206 CR_token2
  774,54: 


107 CRStmtCRs_repeat1
  776,3:  'load lower player shape first. it has to be behind the walls 
  Shapes.Mov

106 ID . ID ( Exprs )
  777,3: Shapes
  777,9: .
  777,10: Move
  777,14: (
  777,15: player1, (posx) * 50 + korrx, (posy) * 40 - 0
  777,60: )

184 . ID ( Exprs )
  777,9: .
  777,10: Move
  777,14: (
  777,15: player1, (posx) * 50 + korrx, (posy) * 40 - 0
  777,60: )

255 ID ( Exprs )
  777,10: Move
  777,14: (
  777,15: player1, (posx) * 50 + korrx, (posy) * 40 - 0
  777,60: )

221 ( Exprs )
  777,14: (
  777,15: player1, (posx) * 50 + korrx, (posy) * 40 - 0
  777,60: )

27 ID
  777,15: player1

217 , MoreThanOneExpr
  777,22: ,
  777,24: (posx) * 50 + korrx, (posy) * 40 - 0

54 ( Expr )
  777,24: (
  777,25: posx
  777,29: )

80 ID
  777,25: posx

265 )
  777,29: )

50 * UnaryExpr
  777,31: *
  777,33: 50

156 NUM
  777,33: 50

65 + MultiplicativeExpr
  777,36: +
  777,38: korrx

141 ID
  777,38: korrx

217 , MoreThanOneExpr
  777,43: ,
  777,45: (posy) * 40 - 0

54 ( Expr )
  777,45: (
  777,46: posy
  777,50: )

80 ID
  777,46: posy

265 )
  777,50: )

50 * UnaryExpr
  777,52: *
  777,54: 40

156 NUM
  777,54: 40

65 - MultiplicativeExpr
  777,57: -
  777,59: 0

141 NUM
  777,59: 0

238 )
  777,60: )

206 CR_token2
  777,62: 



106 ID ( )
  779,3: LoadShadow
  779,13: (
  779,14: )

184 ( )
  779,13: (
  779,14: )

261 )
  779,14: )

206 CR_token2
  779,15: 


107 CRStmtCRs_repeat1
  781,3: ------------------------------------------------------------
  'load the walls
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  
  EndFor
  
  'load players face at last. It has always to be in front of the walls
  player2 = Shapes.AddImage(Path + "/sokocutep1.png")
  Shapes.Move(play

107 CRStmtCRs_repeat1
  781,3: 'load the walls
  For i = 0 To 15
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  
  EndFor
  
  'load players face at last. It has always to be in front of the walls
  player2 = Shapes.AddImage(Path + "/sokocutep1.png")
  Shapes.Move(player2, (posx) * 50 + korrx, (posy) * 40 - 0)  
  xplayer = Shapes

106 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  782,3: For
  782,7: i
  782,9: =
  782,11: 0
  782,13: To
  782,16: 15
  782,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  

  794,3: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  782,7: i
  782,9: =
  782,11: 0
  782,13: To
  782,16: 15
  782,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  

  794,3: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  782,9: =
  782,11: 0
  782,13: To
  782,16: 15
  782,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  

  794,3: EndFor

56 NUM
  782,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  782,13: To
  782,16: 15
  782,18: 
    For p = 1 To Text.GetLength(block[stage][i])
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      
    EndFor  

  794,3: EndFor

83 NUM
  782,16: 15

145 CR_token2
  782,18: 


88 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  783,5: For
  783,9: p
  783,11: =
  783,13: 1
  783,15: To
  783,18: Text.GetLength(block[stage][i])
  783,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      

  793,5: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  783,9: p
  783,11: =
  783,13: 1
  783,15: To
  783,18: Text.GetLength(block[stage][i])
  783,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      

  793,5: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  783,11: =
  783,13: 1
  783,15: To
  783,18: Text.GetLength(block[stage][i])
  783,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      

  793,5: EndFor

56 NUM
  783,13: 1

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  783,15: To
  783,18: Text.GetLength(block[stage][i])
  783,49: 
      blockcode = Text.GetSubText(block[stage][i], p, 1) 
      If blockcode >= 4 Then
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  
      Endif      

  793,5: EndFor

83 ID . ID ( Exprs )
  783,18: Text
  783,22: .
  783,23: GetLength
  783,32: (
  783,33: block[stage][i]
  783,48: )

5 . ID ( Exprs )
  783,22: .
  783,23: GetLength
  783,32: (
  783,33: block[stage][i]
  783,48: )

260 ID ( Exprs )
  783,23: GetLength
  783,32: (
  783,33: block[stage][i]
  783,48: )

24 ( Exprs )
  783,32: (
  783,33: block[stage][i]
  783,48: )

26 ID Idxs
  783,33: block
  783,38: [stage][i]

4 [ Expr ] Idxs
  783,38: [
  783,39: stage
  783,44: ]
  783,45: [i]

76 ID
  783,39: stage

245 ] Idxs
  783,44: ]
  783,45: [i]

7 [ Expr ]
  783,45: [
  783,46: i
  783,47: ]

76 ID
  783,46: i

245 ]
  783,47: ]

249 )
  783,48: )

145 CR_token2
  783,49: 


88 ID = Expr
  784,7: blockcode
  784,17: =
  784,19: Text.GetSubText(block[stage][i], p, 1)

184 = Expr
  784,17: =
  784,19: Text.GetSubText(block[stage][i], p, 1)

70 ID . ID ( Exprs )
  784,19: Text
  784,23: .
  784,24: GetSubText
  784,34: (
  784,35: block[stage][i], p, 1
  784,56: )

5 . ID ( Exprs )
  784,23: .
  784,24: GetSubText
  784,34: (
  784,35: block[stage][i], p, 1
  784,56: )

260 ID ( Exprs )
  784,24: GetSubText
  784,34: (
  784,35: block[stage][i], p, 1
  784,56: )

24 ( Exprs )
  784,34: (
  784,35: block[stage][i], p, 1
  784,56: )

26 ID Idxs
  784,35: block
  784,40: [stage][i]

4 [ Expr ] Idxs
  784,40: [
  784,41: stage
  784,46: ]
  784,47: [i]

76 ID
  784,41: stage

245 ] Idxs
  784,46: ]
  784,47: [i]

7 [ Expr ]
  784,47: [
  784,48: i
  784,49: ]

76 ID
  784,48: i

245 ]
  784,49: ]

217 , MoreThanOneExpr
  784,50: ,
  784,52: p, 1

54 ID
  784,52: p

217 , MoreThanOneExpr
  784,53: ,
  784,55: 1

54 NUM
  784,55: 1

249 )
  784,56: )

203 CR_token2
  784,58: 


96 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  785,7: If
  785,10: blockcode >= 4
  785,25: Then
  785,29: 
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  

  792,7: Endif

86 ID
  785,10: blockcode

91 >= AdditiveExpr
  785,20: >=
  785,23: 4

131 NUM
  785,23: 4

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  785,25: Then
  785,29: 
        levelshapes[i][p-1] = Shapes.AddImage(image[blockcode])      
        angle = Math.GetRandomNumber(360)
        xv = Math.Cos(angle * 0.0174) * 1000
        yv = Math.Sin(angle * 0.0174) * 550  
        Shapes.Move(levelshapes[i][p-1], xv + 512, yv + 350)
        Shapes.Animate(levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime)  

  792,7: Endif

124 CR_token2
  785,29: 


67 ID Idxs = Expr
  786,9: levelshapes
  786,20: [i][p-1]
  786,29: =
  786,31: Shapes.AddImage(image[blockcode])

184 [ Expr ] Idxs
  786,20: [
  786,21: i
  786,22: ]
  786,23: [p-1]

76 ID
  786,21: i

245 ] Idxs
  786,22: ]
  786,23: [p-1]

7 [ Expr ]
  786,23: [
  786,24: p-1
  786,27: ]

76 ID
  786,24: p

65 - MultiplicativeExpr
  786,25: -
  786,26: 1

141 NUM
  786,26: 1

245 ]
  786,27: ]

263 = Expr
  786,29: =
  786,31: Shapes.AddImage(image[blockcode])

55 ID . ID ( Exprs )
  786,31: Shapes
  786,37: .
  786,38: AddImage
  786,46: (
  786,47: image[blockcode]
  786,63: )

5 . ID ( Exprs )
  786,37: .
  786,38: AddImage
  786,46: (
  786,47: image[blockcode]
  786,63: )

260 ID ( Exprs )
  786,38: AddImage
  786,46: (
  786,47: image[blockcode]
  786,63: )

24 ( Exprs )
  786,46: (
  786,47: image[blockcode]
  786,63: )

26 ID Idxs
  786,47: image
  786,52: [blockcode]

4 [ Expr ]
  786,52: [
  786,53: blockcode
  786,62: ]

76 ID
  786,53: blockcode

245 ]
  786,62: ]

249 )
  786,63: )

207 CR_token2
  786,70: 


68 ID = Expr
  787,9: angle
  787,15: =
  787,17: Math.GetRandomNumber(360)

184 = Expr
  787,15: =
  787,17: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  787,17: Math
  787,21: .
  787,22: GetRandomNumber
  787,37: (
  787,38: 360
  787,41: )

5 . ID ( Exprs )
  787,21: .
  787,22: GetRandomNumber
  787,37: (
  787,38: 360
  787,41: )

260 ID ( Exprs )
  787,22: GetRandomNumber
  787,37: (
  787,38: 360
  787,41: )

24 ( Exprs )
  787,37: (
  787,38: 360
  787,41: )

26 NUM
  787,38: 360

249 )
  787,41: )

207 CR_token2
  787,42: 


68 ID = Expr
  788,9: xv
  788,12: =
  788,14: Math.Cos(angle * 0.0174) * 1000

184 = Expr
  788,12: =
  788,14: Math.Cos(angle * 0.0174) * 1000

70 ID . ID ( Exprs )
  788,14: Math
  788,18: .
  788,19: Cos
  788,22: (
  788,23: angle * 0.0174
  788,37: )

5 . ID ( Exprs )
  788,18: .
  788,19: Cos
  788,22: (
  788,23: angle * 0.0174
  788,37: )

260 ID ( Exprs )
  788,19: Cos
  788,22: (
  788,23: angle * 0.0174
  788,37: )

24 ( Exprs )
  788,22: (
  788,23: angle * 0.0174
  788,37: )

26 ID
  788,23: angle

50 * UnaryExpr
  788,29: *
  788,31: 0.0174

156 NUM
  788,31: 0.0174

249 )
  788,37: )

48 * UnaryExpr
  788,39: *
  788,41: 1000

157 NUM
  788,41: 1000

207 CR_token2
  788,45: 


68 ID = Expr
  789,9: yv
  789,12: =
  789,14: Math.Sin(angle * 0.0174) * 550

184 = Expr
  789,12: =
  789,14: Math.Sin(angle * 0.0174) * 550

70 ID . ID ( Exprs )
  789,14: Math
  789,18: .
  789,19: Sin
  789,22: (
  789,23: angle * 0.0174
  789,37: )

5 . ID ( Exprs )
  789,18: .
  789,19: Sin
  789,22: (
  789,23: angle * 0.0174
  789,37: )

260 ID ( Exprs )
  789,19: Sin
  789,22: (
  789,23: angle * 0.0174
  789,37: )

24 ( Exprs )
  789,22: (
  789,23: angle * 0.0174
  789,37: )

26 ID
  789,23: angle

50 * UnaryExpr
  789,29: *
  789,31: 0.0174

156 NUM
  789,31: 0.0174

249 )
  789,37: )

48 * UnaryExpr
  789,39: *
  789,41: 550

157 NUM
  789,41: 550

207 CR_token2
  789,46: 


68 ID . ID ( Exprs )
  790,9: Shapes
  790,15: .
  790,16: Move
  790,20: (
  790,21: levelshapes[i][p-1], xv + 512, yv + 350
  790,60: )

184 . ID ( Exprs )
  790,15: .
  790,16: Move
  790,20: (
  790,21: levelshapes[i][p-1], xv + 512, yv + 350
  790,60: )

255 ID ( Exprs )
  790,16: Move
  790,20: (
  790,21: levelshapes[i][p-1], xv + 512, yv + 350
  790,60: )

221 ( Exprs )
  790,20: (
  790,21: levelshapes[i][p-1], xv + 512, yv + 350
  790,60: )

27 ID Idxs
  790,21: levelshapes
  790,32: [i][p-1]

4 [ Expr ] Idxs
  790,32: [
  790,33: i
  790,34: ]
  790,35: [p-1]

76 ID
  790,33: i

245 ] Idxs
  790,34: ]
  790,35: [p-1]

7 [ Expr ]
  790,35: [
  790,36: p-1
  790,39: ]

76 ID
  790,36: p

65 - MultiplicativeExpr
  790,37: -
  790,38: 1

141 NUM
  790,38: 1

245 ]
  790,39: ]

217 , MoreThanOneExpr
  790,40: ,
  790,42: xv + 512, yv + 350

54 ID
  790,42: xv

65 + MultiplicativeExpr
  790,45: +
  790,47: 512

141 NUM
  790,47: 512

217 , MoreThanOneExpr
  790,50: ,
  790,52: yv + 350

54 ID
  790,52: yv

65 + MultiplicativeExpr
  790,55: +
  790,57: 350

141 NUM
  790,57: 350

238 )
  790,60: )

207 CR_token2
  790,61: 


68 ID . ID ( Exprs )
  791,9: Shapes
  791,15: .
  791,16: Animate
  791,23: (
  791,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  791,87: )

184 . ID ( Exprs )
  791,15: .
  791,16: Animate
  791,23: (
  791,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  791,87: )

255 ID ( Exprs )
  791,16: Animate
  791,23: (
  791,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  791,87: )

221 ( Exprs )
  791,23: (
  791,24: levelshapes[i][p-1], (p-1) * 50 + korrx, (i) * 40 - 0, animtime
  791,87: )

27 ID Idxs
  791,24: levelshapes
  791,35: [i][p-1]

4 [ Expr ] Idxs
  791,35: [
  791,36: i
  791,37: ]
  791,38: [p-1]

76 ID
  791,36: i

245 ] Idxs
  791,37: ]
  791,38: [p-1]

7 [ Expr ]
  791,38: [
  791,39: p-1
  791,42: ]

76 ID
  791,39: p

65 - MultiplicativeExpr
  791,40: -
  791,41: 1

141 NUM
  791,41: 1

245 ]
  791,42: ]

217 , MoreThanOneExpr
  791,43: ,
  791,45: (p-1) * 50 + korrx, (i) * 40 - 0, animtime

54 ( Expr )
  791,45: (
  791,46: p-1
  791,49: )

80 ID
  791,46: p

65 - MultiplicativeExpr
  791,47: -
  791,48: 1

141 NUM
  791,48: 1

265 )
  791,49: )

50 * UnaryExpr
  791,51: *
  791,53: 50

156 NUM
  791,53: 50

65 + MultiplicativeExpr
  791,56: +
  791,58: korrx

141 ID
  791,58: korrx

217 , MoreThanOneExpr
  791,63: ,
  791,65: (i) * 40 - 0, animtime

54 ( Expr )
  791,65: (
  791,66: i
  791,67: )

80 ID
  791,66: i

265 )
  791,67: )

50 * UnaryExpr
  791,69: *
  791,71: 40

156 NUM
  791,71: 40

65 - MultiplicativeExpr
  791,74: -
  791,76: 0

141 NUM
  791,76: 0

217 , MoreThanOneExpr
  791,77: ,
  791,79: animtime

54 ID
  791,79: animtime

238 )
  791,87: )

207 CR_token2
  791,90: 


122 OptionalElse_token1
  792,7: Endif

203 CR_token2
  792,18: 


177 Stmt_token6
  793,5: EndFor

203 CR_token2
  793,13: 


177 Stmt_token6
  794,3: EndFor

206 CR_token2
  794,9: 


107 TheRest
  796,3:   'load players face at last. It has always to be in

106 ID = Expr
  797,3: player2
  797,11: =
  797,13: Shapes.AddImage(Path + "/sokocutep1.png")

184 = Expr
  797,11: =
  797,13: Shapes.AddImage(Path + "/sokocutep1.png")

70 ID . ID ( Exprs )
  797,13: Shapes
  797,19: .
  797,20: AddImage
  797,28: (
  797,29: Path + "/sokocutep1.png"
  797,53: )

5 . ID ( Exprs )
  797,19: .
  797,20: AddImage
  797,28: (
  797,29: Path + "/sokocutep1.png"
  797,53: )

260 ID ( Exprs )
  797,20: AddImage
  797,28: (
  797,29: Path + "/sokocutep1.png"
  797,53: )

24 ( Exprs )
  797,28: (
  797,29: Path + "/sokocutep1.png"
  797,53: )

26 ID
  797,29: Path

65 + MultiplicativeExpr
  797,34: +
  797,36: "/sokocutep1.png"

141 STR
  797,36: "/sokocutep1.png"

249 )
  797,53: )

206 CR_token2
  797,54: 


106 ID . ID ( Exprs )
  798,3: Shapes
  798,9: .
  798,10: Move
  798,14: (
  798,15: player2, (posx) * 50 + korrx, (posy) * 40 - 0
  798,60: )

184 . ID ( Exprs )
  798,9: .
  798,10: Move
  798,14: (
  798,15: player2, (posx) * 50 + korrx, (posy) * 40 - 0
  798,60: )

255 ID ( Exprs )
  798,10: Move
  798,14: (
  798,15: player2, (posx) * 50 + korrx, (posy) * 40 - 0
  798,60: )

221 ( Exprs )
  798,14: (
  798,15: player2, (posx) * 50 + korrx, (posy) * 40 - 0
  798,60: )

27 ID
  798,15: player2

217 , MoreThanOneExpr
  798,22: ,
  798,24: (posx) * 50 + korrx, (posy) * 40 - 0

54 ( Expr )
  798,24: (
  798,25: posx
  798,29: )

80 ID
  798,25: posx

265 )
  798,29: )

50 * UnaryExpr
  798,31: *
  798,33: 50

156 NUM
  798,33: 50

65 + MultiplicativeExpr
  798,36: +
  798,38: korrx

141 ID
  798,38: korrx

217 , MoreThanOneExpr
  798,43: ,
  798,45: (posy) * 40 - 0

54 ( Expr )
  798,45: (
  798,46: posy
  798,50: )

80 ID
  798,46: posy

265 )
  798,50: )

50 * UnaryExpr
  798,52: *
  798,54: 40

156 NUM
  798,54: 40

65 - MultiplicativeExpr
  798,57: -
  798,59: 0

141 NUM
  798,59: 0

238 )
  798,60: )

206 CR_token2
  798,63: 


106 ID = Expr
  799,3: xplayer
  799,11: =
  799,13: Shapes.GetLeft(player1)

184 = Expr
  799,11: =
  799,13: Shapes.GetLeft(player1)

70 ID . ID ( Exprs )
  799,13: Shapes
  799,19: .
  799,20: GetLeft
  799,27: (
  799,28: player1
  799,35: )

5 . ID ( Exprs )
  799,19: .
  799,20: GetLeft
  799,27: (
  799,28: player1
  799,35: )

260 ID ( Exprs )
  799,20: GetLeft
  799,27: (
  799,28: player1
  799,35: )

24 ( Exprs )
  799,27: (
  799,28: player1
  799,35: )

26 ID
  799,28: player1

249 )
  799,35: )

206 CR_token2
  799,36: 


106 ID = Expr
  800,3: yplayer
  800,11: =
  800,13: Shapes.GetTop(player1)

184 = Expr
  800,11: =
  800,13: Shapes.GetTop(player1)

70 ID . ID ( Exprs )
  800,13: Shapes
  800,19: .
  800,20: GetTop
  800,26: (
  800,27: player1
  800,34: )

5 . ID ( Exprs )
  800,19: .
  800,20: GetTop
  800,26: (
  800,27: player1
  800,34: )

260 ID ( Exprs )
  800,20: GetTop
  800,26: (
  800,27: player1
  800,34: )

24 ( Exprs )
  800,26: (
  800,27: player1
  800,34: )

26 ID
  800,27: player1

249 )
  800,34: )

206 CR_token2
  800,37: 



257 Stmt_token8
  802,1: EndSub

97 Stmt_token7 ID CRStmtCRs Stmt_token8
  804,1: sub
  804,5: LoadShadow
  804,15: 
  

  For y = 0 To 15
     For x = 0 To 19
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   

  859,1: EndSub

244 ID CRStmtCRs Stmt_token8
  804,5: LoadShadow
  804,15: 
  

  For y = 0 To 15
     For x = 0 To 19
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   

  859,1: EndSub

199 CR_token2
  804,15: 


105 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  807,3: For
  807,7: y
  807,9: =
  807,11: 0
  807,13: To
  807,16: 15
  807,18: 
     For x = 0 To 19
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor

  857,3: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  807,7: y
  807,9: =
  807,11: 0
  807,13: To
  807,16: 15
  807,18: 
     For x = 0 To 19
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor

  857,3: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  807,9: =
  807,11: 0
  807,13: To
  807,16: 15
  807,18: 
     For x = 0 To 19
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor

  857,3: EndFor

56 NUM
  807,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  807,13: To
  807,16: 15
  807,18: 
     For x = 0 To 19
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor

  857,3: EndFor

83 NUM
  807,16: 15

145 CR_token2
  807,18: 


88 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  808,6: For
  808,10: x
  808,12: =
  808,14: 0
  808,16: To
  808,19: 19
  808,21: 
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif

  856,5: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  808,10: x
  808,12: =
  808,14: 0
  808,16: To
  808,19: 19
  808,21: 
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif

  856,5: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  808,12: =
  808,14: 0
  808,16: To
  808,19: 19
  808,21: 
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif

  856,5: EndFor

56 NUM
  808,14: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  808,16: To
  808,19: 19
  808,21: 
       If level[y][x] <= 2 and level[y][x] <> " " Then 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif

  856,5: EndFor

83 NUM
  808,19: 19

145 CR_token2
  808,21: 


88 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  809,8: If
  809,11: level[y][x] <= 2 and level[y][x] <> " "
  809,51: Then
  809,56: 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf

  855,8: endif

86 ID Idxs
  809,11: level
  809,16: [y][x]

4 [ Expr ] Idxs
  809,16: [
  809,17: y
  809,18: ]
  809,19: [x]

76 ID
  809,17: y

245 ] Idxs
  809,18: ]
  809,19: [x]

7 [ Expr ]
  809,19: [
  809,20: x
  809,21: ]

76 ID
  809,20: x

245 ]
  809,21: ]

91 <= AdditiveExpr
  809,23: <=
  809,26: 2

131 NUM
  809,26: 2

167 AndExpr_token1 EqNeqExpr
  809,28: and
  809,32: level[y][x] <> " "

102 ID Idxs
  809,32: level
  809,37: [y][x]

4 [ Expr ] Idxs
  809,37: [
  809,38: y
  809,39: ]
  809,40: [x]

76 ID
  809,38: y

245 ] Idxs
  809,39: ]
  809,40: [x]

7 [ Expr ]
  809,40: [
  809,41: x
  809,42: ]

76 ID
  809,41: x

245 ]
  809,42: ]

134 <> CompExpr
  809,44: <>
  809,47: " "

117 STR
  809,47: " "

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  809,51: Then
  809,56: 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If level[y][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If level[y][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1
          EndIf
          If level[y-1][x] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1
          EndIf
          If level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1
          EndIf

  855,8: endif

124 CR_token2
  809,56: 


67 ID = Expr
  810,11: angle
  810,17: =
  810,19: Math.GetRandomNumber(360)

184 = Expr
  810,17: =
  810,19: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  810,19: Math
  810,23: .
  810,24: GetRandomNumber
  810,39: (
  810,40: 360
  810,43: )

5 . ID ( Exprs )
  810,23: .
  810,24: GetRandomNumber
  810,39: (
  810,40: 360
  810,43: )

260 ID ( Exprs )
  810,24: GetRandomNumber
  810,39: (
  810,40: 360
  810,43: )

24 ( Exprs )
  810,39: (
  810,40: 360
  810,43: )

26 NUM
  810,40: 360

249 )
  810,43: )

207 CR_token2
  810,44: 


68 ID = Expr
  811,11: xv
  811,14: =
  811,16: Math.Cos(angle * 0.0174) * 1200

184 = Expr
  811,14: =
  811,16: Math.Cos(angle * 0.0174) * 1200

70 ID . ID ( Exprs )
  811,16: Math
  811,20: .
  811,21: Cos
  811,24: (
  811,25: angle * 0.0174
  811,39: )

5 . ID ( Exprs )
  811,20: .
  811,21: Cos
  811,24: (
  811,25: angle * 0.0174
  811,39: )

260 ID ( Exprs )
  811,21: Cos
  811,24: (
  811,25: angle * 0.0174
  811,39: )

24 ( Exprs )
  811,24: (
  811,25: angle * 0.0174
  811,39: )

26 ID
  811,25: angle

50 * UnaryExpr
  811,31: *
  811,33: 0.0174

156 NUM
  811,33: 0.0174

249 )
  811,39: )

48 * UnaryExpr
  811,41: *
  811,43: 1200

157 NUM
  811,43: 1200

207 CR_token2
  811,47: 


68 ID = Expr
  812,11: yv
  812,14: =
  812,16: Math.Sin(angle * 0.0174) * 600

184 = Expr
  812,14: =
  812,16: Math.Sin(angle * 0.0174) * 600

70 ID . ID ( Exprs )
  812,16: Math
  812,20: .
  812,21: Sin
  812,24: (
  812,25: angle * 0.0174
  812,39: )

5 . ID ( Exprs )
  812,20: .
  812,21: Sin
  812,24: (
  812,25: angle * 0.0174
  812,39: )

260 ID ( Exprs )
  812,21: Sin
  812,24: (
  812,25: angle * 0.0174
  812,39: )

24 ( Exprs )
  812,24: (
  812,25: angle * 0.0174
  812,39: )

26 ID
  812,25: angle

50 * UnaryExpr
  812,31: *
  812,33: 0.0174

156 NUM
  812,33: 0.0174

249 )
  812,39: )

48 * UnaryExpr
  812,41: *
  812,43: 600

157 NUM
  812,43: 600

207 CR_token2
  812,48: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  813,11: If
  813,14: level[y][x-1] >= 6
  813,33: then
  813,37: 
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1

  818,11: EndIf

86 ID Idxs
  813,14: level
  813,19: [y][x-1]

4 [ Expr ] Idxs
  813,19: [
  813,20: y
  813,21: ]
  813,22: [x-1]

76 ID
  813,20: y

245 ] Idxs
  813,21: ]
  813,22: [x-1]

7 [ Expr ]
  813,22: [
  813,23: x-1
  813,26: ]

76 ID
  813,23: x

65 - MultiplicativeExpr
  813,24: -
  813,25: 1

141 NUM
  813,25: 1

245 ]
  813,26: ]

91 >= AdditiveExpr
  813,28: >=
  813,31: 6

131 NUM
  813,31: 6

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  813,33: then
  813,37: 
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1

  818,11: EndIf

124 CR_token2
  813,37: 


67 ID Idxs = Expr
  814,13: Shadow
  814,19: [shade]
  814,27: =
  814,29: Shapes.AddImage(Path + "/SW.png")

184 [ Expr ]
  814,19: [
  814,20: shade
  814,25: ]

76 ID
  814,20: shade

245 ]
  814,25: ]

263 = Expr
  814,27: =
  814,29: Shapes.AddImage(Path + "/SW.png")

55 ID . ID ( Exprs )
  814,29: Shapes
  814,35: .
  814,36: AddImage
  814,44: (
  814,45: Path + "/SW.png"
  814,61: )

5 . ID ( Exprs )
  814,35: .
  814,36: AddImage
  814,44: (
  814,45: Path + "/SW.png"
  814,61: )

260 ID ( Exprs )
  814,36: AddImage
  814,44: (
  814,45: Path + "/SW.png"
  814,61: )

24 ( Exprs )
  814,44: (
  814,45: Path + "/SW.png"
  814,61: )

26 ID
  814,45: Path

65 + MultiplicativeExpr
  814,50: +
  814,52: "/SW.png"

141 STR
  814,52: "/SW.png"

249 )
  814,61: )

207 CR_token2
  814,62: 


68 ID . ID ( Exprs )
  815,13: Shapes
  815,19: .
  815,20: Move
  815,24: (
  815,25: Shadow[shade], xv + 512, yv + 350
  815,58: )

184 . ID ( Exprs )
  815,19: .
  815,20: Move
  815,24: (
  815,25: Shadow[shade], xv + 512, yv + 350
  815,58: )

255 ID ( Exprs )
  815,20: Move
  815,24: (
  815,25: Shadow[shade], xv + 512, yv + 350
  815,58: )

221 ( Exprs )
  815,24: (
  815,25: Shadow[shade], xv + 512, yv + 350
  815,58: )

27 ID Idxs
  815,25: Shadow
  815,31: [shade]

4 [ Expr ]
  815,31: [
  815,32: shade
  815,37: ]

76 ID
  815,32: shade

245 ]
  815,37: ]

217 , MoreThanOneExpr
  815,38: ,
  815,40: xv + 512, yv + 350

54 ID
  815,40: xv

65 + MultiplicativeExpr
  815,43: +
  815,45: 512

141 NUM
  815,45: 512

217 , MoreThanOneExpr
  815,48: ,
  815,50: yv + 350

54 ID
  815,50: yv

65 + MultiplicativeExpr
  815,53: +
  815,55: 350

141 NUM
  815,55: 350

238 )
  815,58: )

207 CR_token2
  815,59: 


68 ID . ID ( Exprs )
  816,13: Shapes
  816,19: .
  816,20: Animate
  816,27: (
  816,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  816,87: )

184 . ID ( Exprs )
  816,19: .
  816,20: Animate
  816,27: (
  816,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  816,87: )

255 ID ( Exprs )
  816,20: Animate
  816,27: (
  816,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  816,87: )

221 ( Exprs )
  816,27: (
  816,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  816,87: )

27 ID Idxs
  816,28: Shadow
  816,34: [shade]

4 [ Expr ]
  816,34: [
  816,35: shade
  816,40: ]

76 ID
  816,35: shade

245 ]
  816,40: ]

217 , MoreThanOneExpr
  816,41: ,
  816,43: (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2

54 ( Expr )
  816,43: (
  816,44: x
  816,45: )

80 ID
  816,44: x

265 )
  816,45: )

50 * UnaryExpr
  816,47: *
  816,49: 50

156 NUM
  816,49: 50

65 + MultiplicativeExpr
  816,52: +
  816,54: korrx

141 ID
  816,54: korrx

217 , MoreThanOneExpr
  816,59: ,
  816,61: (y) * 40 - 0, animtime*1.2

54 ( Expr )
  816,61: (
  816,62: y
  816,63: )

80 ID
  816,62: y

265 )
  816,63: )

50 * UnaryExpr
  816,65: *
  816,67: 40

156 NUM
  816,67: 40

65 - MultiplicativeExpr
  816,70: -
  816,72: 0

141 NUM
  816,72: 0

217 , MoreThanOneExpr
  816,73: ,
  816,75: animtime*1.2

54 ID
  816,75: animtime

50 * UnaryExpr
  816,83: *
  816,84: 1.2

156 NUM
  816,84: 1.2

238 )
  816,87: )

207 CR_token2
  816,91: 


68 ID = Expr
  817,13: shade
  817,19: =
  817,21: shade + 1

184 = Expr
  817,19: =
  817,21: shade + 1

70 ID
  817,21: shade

59 + MultiplicativeExpr
  817,27: +
  817,29: 1

144 NUM
  817,29: 1

207 CR_token2
  817,30: 


122 OptionalElse_token1
  818,11: EndIf

207 CR_token2
  818,17: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  819,11: If
  819,14: level[y][x+1] >= 6
  819,33: then
  819,37: 
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1

  824,11: EndIf

86 ID Idxs
  819,14: level
  819,19: [y][x+1]

4 [ Expr ] Idxs
  819,19: [
  819,20: y
  819,21: ]
  819,22: [x+1]

76 ID
  819,20: y

245 ] Idxs
  819,21: ]
  819,22: [x+1]

7 [ Expr ]
  819,22: [
  819,23: x+1
  819,26: ]

76 ID
  819,23: x

65 + MultiplicativeExpr
  819,24: +
  819,25: 1

141 NUM
  819,25: 1

245 ]
  819,26: ]

91 >= AdditiveExpr
  819,28: >=
  819,31: 6

131 NUM
  819,31: 6

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  819,33: then
  819,37: 
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)   
            shade = shade + 1

  824,11: EndIf

124 CR_token2
  819,37: 


67 ID Idxs = Expr
  820,13: Shadow
  820,19: [shade]
  820,27: =
  820,29: Shapes.AddImage(Path + "/SE.png")

184 [ Expr ]
  820,19: [
  820,20: shade
  820,25: ]

76 ID
  820,20: shade

245 ]
  820,25: ]

263 = Expr
  820,27: =
  820,29: Shapes.AddImage(Path + "/SE.png")

55 ID . ID ( Exprs )
  820,29: Shapes
  820,35: .
  820,36: AddImage
  820,44: (
  820,45: Path + "/SE.png"
  820,61: )

5 . ID ( Exprs )
  820,35: .
  820,36: AddImage
  820,44: (
  820,45: Path + "/SE.png"
  820,61: )

260 ID ( Exprs )
  820,36: AddImage
  820,44: (
  820,45: Path + "/SE.png"
  820,61: )

24 ( Exprs )
  820,44: (
  820,45: Path + "/SE.png"
  820,61: )

26 ID
  820,45: Path

65 + MultiplicativeExpr
  820,50: +
  820,52: "/SE.png"

141 STR
  820,52: "/SE.png"

249 )
  820,61: )

207 CR_token2
  820,62: 


68 ID . ID ( Exprs )
  821,13: Shapes
  821,19: .
  821,20: Move
  821,24: (
  821,25: Shadow[shade], xv + 512, yv + 350
  821,58: )

184 . ID ( Exprs )
  821,19: .
  821,20: Move
  821,24: (
  821,25: Shadow[shade], xv + 512, yv + 350
  821,58: )

255 ID ( Exprs )
  821,20: Move
  821,24: (
  821,25: Shadow[shade], xv + 512, yv + 350
  821,58: )

221 ( Exprs )
  821,24: (
  821,25: Shadow[shade], xv + 512, yv + 350
  821,58: )

27 ID Idxs
  821,25: Shadow
  821,31: [shade]

4 [ Expr ]
  821,31: [
  821,32: shade
  821,37: ]

76 ID
  821,32: shade

245 ]
  821,37: ]

217 , MoreThanOneExpr
  821,38: ,
  821,40: xv + 512, yv + 350

54 ID
  821,40: xv

65 + MultiplicativeExpr
  821,43: +
  821,45: 512

141 NUM
  821,45: 512

217 , MoreThanOneExpr
  821,48: ,
  821,50: yv + 350

54 ID
  821,50: yv

65 + MultiplicativeExpr
  821,53: +
  821,55: 350

141 NUM
  821,55: 350

238 )
  821,58: )

207 CR_token2
  821,59: 


68 ID . ID ( Exprs )
  822,13: Shapes
  822,19: .
  822,20: Animate
  822,27: (
  822,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  822,87: )

184 . ID ( Exprs )
  822,19: .
  822,20: Animate
  822,27: (
  822,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  822,87: )

255 ID ( Exprs )
  822,20: Animate
  822,27: (
  822,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  822,87: )

221 ( Exprs )
  822,27: (
  822,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  822,87: )

27 ID Idxs
  822,28: Shadow
  822,34: [shade]

4 [ Expr ]
  822,34: [
  822,35: shade
  822,40: ]

76 ID
  822,35: shade

245 ]
  822,40: ]

217 , MoreThanOneExpr
  822,41: ,
  822,43: (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2

54 ( Expr )
  822,43: (
  822,44: x
  822,45: )

80 ID
  822,44: x

265 )
  822,45: )

50 * UnaryExpr
  822,47: *
  822,49: 50

156 NUM
  822,49: 50

65 + MultiplicativeExpr
  822,52: +
  822,54: korrx

141 ID
  822,54: korrx

217 , MoreThanOneExpr
  822,59: ,
  822,61: (y) * 40 - 0, animtime*1.2

54 ( Expr )
  822,61: (
  822,62: y
  822,63: )

80 ID
  822,62: y

265 )
  822,63: )

50 * UnaryExpr
  822,65: *
  822,67: 40

156 NUM
  822,67: 40

65 - MultiplicativeExpr
  822,70: -
  822,72: 0

141 NUM
  822,72: 0

217 , MoreThanOneExpr
  822,73: ,
  822,75: animtime*1.2

54 ID
  822,75: animtime

50 * UnaryExpr
  822,83: *
  822,84: 1.2

156 NUM
  822,84: 1.2

238 )
  822,87: )

207 CR_token2
  822,91: 


68 ID = Expr
  823,13: shade
  823,19: =
  823,21: shade + 1

184 = Expr
  823,19: =
  823,21: shade + 1

70 ID
  823,21: shade

59 + MultiplicativeExpr
  823,27: +
  823,29: 1

144 NUM
  823,29: 1

207 CR_token2
  823,30: 


122 OptionalElse_token1
  824,11: EndIf

207 CR_token2
  824,16: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  825,11: If
  825,14: level[y-1][x] >= 6
  825,33: then
  825,37: 
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1

  830,11: EndIf

86 ID Idxs
  825,14: level
  825,19: [y-1][x]

4 [ Expr ] Idxs
  825,19: [
  825,20: y-1
  825,23: ]
  825,24: [x]

76 ID
  825,20: y

65 - MultiplicativeExpr
  825,21: -
  825,22: 1

141 NUM
  825,22: 1

245 ] Idxs
  825,23: ]
  825,24: [x]

7 [ Expr ]
  825,24: [
  825,25: x
  825,26: ]

76 ID
  825,25: x

245 ]
  825,26: ]

91 >= AdditiveExpr
  825,28: >=
  825,31: 6

131 NUM
  825,31: 6

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  825,33: then
  825,37: 
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)  
            shade = shade + 1

  830,11: EndIf

124 CR_token2
  825,37: 


67 ID Idxs = Expr
  826,13: Shadow
  826,19: [shade]
  826,27: =
  826,29: Shapes.AddImage(Path + "/SN.png")

184 [ Expr ]
  826,19: [
  826,20: shade
  826,25: ]

76 ID
  826,20: shade

245 ]
  826,25: ]

263 = Expr
  826,27: =
  826,29: Shapes.AddImage(Path + "/SN.png")

55 ID . ID ( Exprs )
  826,29: Shapes
  826,35: .
  826,36: AddImage
  826,44: (
  826,45: Path + "/SN.png"
  826,61: )

5 . ID ( Exprs )
  826,35: .
  826,36: AddImage
  826,44: (
  826,45: Path + "/SN.png"
  826,61: )

260 ID ( Exprs )
  826,36: AddImage
  826,44: (
  826,45: Path + "/SN.png"
  826,61: )

24 ( Exprs )
  826,44: (
  826,45: Path + "/SN.png"
  826,61: )

26 ID
  826,45: Path

65 + MultiplicativeExpr
  826,50: +
  826,52: "/SN.png"

141 STR
  826,52: "/SN.png"

249 )
  826,61: )

207 CR_token2
  826,62: 


68 ID . ID ( Exprs )
  827,13: Shapes
  827,19: .
  827,20: Move
  827,24: (
  827,25: Shadow[shade], xv + 512, yv + 350
  827,58: )

184 . ID ( Exprs )
  827,19: .
  827,20: Move
  827,24: (
  827,25: Shadow[shade], xv + 512, yv + 350
  827,58: )

255 ID ( Exprs )
  827,20: Move
  827,24: (
  827,25: Shadow[shade], xv + 512, yv + 350
  827,58: )

221 ( Exprs )
  827,24: (
  827,25: Shadow[shade], xv + 512, yv + 350
  827,58: )

27 ID Idxs
  827,25: Shadow
  827,31: [shade]

4 [ Expr ]
  827,31: [
  827,32: shade
  827,37: ]

76 ID
  827,32: shade

245 ]
  827,37: ]

217 , MoreThanOneExpr
  827,38: ,
  827,40: xv + 512, yv + 350

54 ID
  827,40: xv

65 + MultiplicativeExpr
  827,43: +
  827,45: 512

141 NUM
  827,45: 512

217 , MoreThanOneExpr
  827,48: ,
  827,50: yv + 350

54 ID
  827,50: yv

65 + MultiplicativeExpr
  827,53: +
  827,55: 350

141 NUM
  827,55: 350

238 )
  827,58: )

207 CR_token2
  827,59: 


68 ID . ID ( Exprs )
  828,13: Shapes
  828,19: .
  828,20: Animate
  828,27: (
  828,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  828,87: )

184 . ID ( Exprs )
  828,19: .
  828,20: Animate
  828,27: (
  828,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  828,87: )

255 ID ( Exprs )
  828,20: Animate
  828,27: (
  828,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  828,87: )

221 ( Exprs )
  828,27: (
  828,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  828,87: )

27 ID Idxs
  828,28: Shadow
  828,34: [shade]

4 [ Expr ]
  828,34: [
  828,35: shade
  828,40: ]

76 ID
  828,35: shade

245 ]
  828,40: ]

217 , MoreThanOneExpr
  828,41: ,
  828,43: (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2

54 ( Expr )
  828,43: (
  828,44: x
  828,45: )

80 ID
  828,44: x

265 )
  828,45: )

50 * UnaryExpr
  828,47: *
  828,49: 50

156 NUM
  828,49: 50

65 + MultiplicativeExpr
  828,52: +
  828,54: korrx

141 ID
  828,54: korrx

217 , MoreThanOneExpr
  828,59: ,
  828,61: (y) * 40 - 0, animtime*1.2

54 ( Expr )
  828,61: (
  828,62: y
  828,63: )

80 ID
  828,62: y

265 )
  828,63: )

50 * UnaryExpr
  828,65: *
  828,67: 40

156 NUM
  828,67: 40

65 - MultiplicativeExpr
  828,70: -
  828,72: 0

141 NUM
  828,72: 0

217 , MoreThanOneExpr
  828,73: ,
  828,75: animtime*1.2

54 ID
  828,75: animtime

50 * UnaryExpr
  828,83: *
  828,84: 1.2

156 NUM
  828,84: 1.2

238 )
  828,87: )

207 CR_token2
  828,90: 


68 ID = Expr
  829,13: shade
  829,19: =
  829,21: shade + 1

184 = Expr
  829,19: =
  829,21: shade + 1

70 ID
  829,21: shade

59 + MultiplicativeExpr
  829,27: +
  829,29: 1

144 NUM
  829,29: 1

207 CR_token2
  829,30: 


122 OptionalElse_token1
  830,11: EndIf

207 CR_token2
  830,16: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  831,11: If
  831,14: level[y][x-1] <=2 and level[y-1][x] <= 2 and level[y-1][x-1] >= 6
  831,80: then
  831,84: 
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1

  836,11: EndIf

86 ID Idxs
  831,14: level
  831,19: [y][x-1]

4 [ Expr ] Idxs
  831,19: [
  831,20: y
  831,21: ]
  831,22: [x-1]

76 ID
  831,20: y

245 ] Idxs
  831,21: ]
  831,22: [x-1]

7 [ Expr ]
  831,22: [
  831,23: x-1
  831,26: ]

76 ID
  831,23: x

65 - MultiplicativeExpr
  831,24: -
  831,25: 1

141 NUM
  831,25: 1

245 ]
  831,26: ]

91 <= AdditiveExpr
  831,28: <=
  831,30: 2

131 NUM
  831,30: 2

167 AndExpr_token1 EqNeqExpr
  831,32: and
  831,36: level[y-1][x] <= 2

102 ID Idxs
  831,36: level
  831,41: [y-1][x]

4 [ Expr ] Idxs
  831,41: [
  831,42: y-1
  831,45: ]
  831,46: [x]

76 ID
  831,42: y

65 - MultiplicativeExpr
  831,43: -
  831,44: 1

141 NUM
  831,44: 1

245 ] Idxs
  831,45: ]
  831,46: [x]

7 [ Expr ]
  831,46: [
  831,47: x
  831,48: ]

76 ID
  831,47: x

245 ]
  831,48: ]

91 <= AdditiveExpr
  831,50: <=
  831,53: 2

131 NUM
  831,53: 2

167 AndExpr_token1 EqNeqExpr
  831,55: and
  831,59: level[y-1][x-1] >= 6

102 ID Idxs
  831,59: level
  831,64: [y-1][x-1]

4 [ Expr ] Idxs
  831,64: [
  831,65: y-1
  831,68: ]
  831,69: [x-1]

76 ID
  831,65: y

65 - MultiplicativeExpr
  831,66: -
  831,67: 1

141 NUM
  831,67: 1

245 ] Idxs
  831,68: ]
  831,69: [x-1]

7 [ Expr ]
  831,69: [
  831,70: x-1
  831,73: ]

76 ID
  831,70: x

65 - MultiplicativeExpr
  831,71: -
  831,72: 1

141 NUM
  831,72: 1

245 ]
  831,73: ]

91 >= AdditiveExpr
  831,75: >=
  831,78: 6

131 NUM
  831,78: 6

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  831,80: then
  831,84: 
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1

  836,11: EndIf

124 CR_token2
  831,84: 


67 ID Idxs = Expr
  832,13: Shadow
  832,19: [shade]
  832,27: =
  832,29: Shapes.AddImage(Path + "/SNW.png")

184 [ Expr ]
  832,19: [
  832,20: shade
  832,25: ]

76 ID
  832,20: shade

245 ]
  832,25: ]

263 = Expr
  832,27: =
  832,29: Shapes.AddImage(Path + "/SNW.png")

55 ID . ID ( Exprs )
  832,29: Shapes
  832,35: .
  832,36: AddImage
  832,44: (
  832,45: Path + "/SNW.png"
  832,62: )

5 . ID ( Exprs )
  832,35: .
  832,36: AddImage
  832,44: (
  832,45: Path + "/SNW.png"
  832,62: )

260 ID ( Exprs )
  832,36: AddImage
  832,44: (
  832,45: Path + "/SNW.png"
  832,62: )

24 ( Exprs )
  832,44: (
  832,45: Path + "/SNW.png"
  832,62: )

26 ID
  832,45: Path

65 + MultiplicativeExpr
  832,50: +
  832,52: "/SNW.png"

141 STR
  832,52: "/SNW.png"

249 )
  832,62: )

207 CR_token2
  832,63: 


68 ID . ID ( Exprs )
  833,13: Shapes
  833,19: .
  833,20: Move
  833,24: (
  833,25: Shadow[shade], xv + 512, yv + 350
  833,58: )

184 . ID ( Exprs )
  833,19: .
  833,20: Move
  833,24: (
  833,25: Shadow[shade], xv + 512, yv + 350
  833,58: )

255 ID ( Exprs )
  833,20: Move
  833,24: (
  833,25: Shadow[shade], xv + 512, yv + 350
  833,58: )

221 ( Exprs )
  833,24: (
  833,25: Shadow[shade], xv + 512, yv + 350
  833,58: )

27 ID Idxs
  833,25: Shadow
  833,31: [shade]

4 [ Expr ]
  833,31: [
  833,32: shade
  833,37: ]

76 ID
  833,32: shade

245 ]
  833,37: ]

217 , MoreThanOneExpr
  833,38: ,
  833,40: xv + 512, yv + 350

54 ID
  833,40: xv

65 + MultiplicativeExpr
  833,43: +
  833,45: 512

141 NUM
  833,45: 512

217 , MoreThanOneExpr
  833,48: ,
  833,50: yv + 350

54 ID
  833,50: yv

65 + MultiplicativeExpr
  833,53: +
  833,55: 350

141 NUM
  833,55: 350

238 )
  833,58: )

207 CR_token2
  833,59: 


68 ID . ID ( Exprs )
  834,13: Shapes
  834,19: .
  834,20: Animate
  834,27: (
  834,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  834,87: )

184 . ID ( Exprs )
  834,19: .
  834,20: Animate
  834,27: (
  834,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  834,87: )

255 ID ( Exprs )
  834,20: Animate
  834,27: (
  834,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  834,87: )

221 ( Exprs )
  834,27: (
  834,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  834,87: )

27 ID Idxs
  834,28: Shadow
  834,34: [shade]

4 [ Expr ]
  834,34: [
  834,35: shade
  834,40: ]

76 ID
  834,35: shade

245 ]
  834,40: ]

217 , MoreThanOneExpr
  834,41: ,
  834,43: (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2

54 ( Expr )
  834,43: (
  834,44: x
  834,45: )

80 ID
  834,44: x

265 )
  834,45: )

50 * UnaryExpr
  834,47: *
  834,49: 50

156 NUM
  834,49: 50

65 + MultiplicativeExpr
  834,52: +
  834,54: korrx

141 ID
  834,54: korrx

217 , MoreThanOneExpr
  834,59: ,
  834,61: (y) * 40 - 0, animtime*1.2

54 ( Expr )
  834,61: (
  834,62: y
  834,63: )

80 ID
  834,62: y

265 )
  834,63: )

50 * UnaryExpr
  834,65: *
  834,67: 40

156 NUM
  834,67: 40

65 - MultiplicativeExpr
  834,70: -
  834,72: 0

141 NUM
  834,72: 0

217 , MoreThanOneExpr
  834,73: ,
  834,75: animtime*1.2

54 ID
  834,75: animtime

50 * UnaryExpr
  834,83: *
  834,84: 1.2

156 NUM
  834,84: 1.2

238 )
  834,87: )

207 CR_token2
  834,92: 


68 ID = Expr
  835,13: shade
  835,19: =
  835,21: shade + 1

184 = Expr
  835,19: =
  835,21: shade + 1

70 ID
  835,21: shade

59 + MultiplicativeExpr
  835,27: +
  835,29: 1

144 NUM
  835,29: 1

207 CR_token2
  835,30: 


122 OptionalElse_token1
  836,11: EndIf

207 CR_token2
  836,16: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  837,11: If
  837,14: level[y][x+1] <=2 and level[y-1][x] <= 2 and level[y-1][x+1] >= 6
  837,80: then
  837,84: 
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1

  842,11: EndIf

86 ID Idxs
  837,14: level
  837,19: [y][x+1]

4 [ Expr ] Idxs
  837,19: [
  837,20: y
  837,21: ]
  837,22: [x+1]

76 ID
  837,20: y

245 ] Idxs
  837,21: ]
  837,22: [x+1]

7 [ Expr ]
  837,22: [
  837,23: x+1
  837,26: ]

76 ID
  837,23: x

65 + MultiplicativeExpr
  837,24: +
  837,25: 1

141 NUM
  837,25: 1

245 ]
  837,26: ]

91 <= AdditiveExpr
  837,28: <=
  837,30: 2

131 NUM
  837,30: 2

167 AndExpr_token1 EqNeqExpr
  837,32: and
  837,36: level[y-1][x] <= 2

102 ID Idxs
  837,36: level
  837,41: [y-1][x]

4 [ Expr ] Idxs
  837,41: [
  837,42: y-1
  837,45: ]
  837,46: [x]

76 ID
  837,42: y

65 - MultiplicativeExpr
  837,43: -
  837,44: 1

141 NUM
  837,44: 1

245 ] Idxs
  837,45: ]
  837,46: [x]

7 [ Expr ]
  837,46: [
  837,47: x
  837,48: ]

76 ID
  837,47: x

245 ]
  837,48: ]

91 <= AdditiveExpr
  837,50: <=
  837,53: 2

131 NUM
  837,53: 2

167 AndExpr_token1 EqNeqExpr
  837,55: and
  837,59: level[y-1][x+1] >= 6

102 ID Idxs
  837,59: level
  837,64: [y-1][x+1]

4 [ Expr ] Idxs
  837,64: [
  837,65: y-1
  837,68: ]
  837,69: [x+1]

76 ID
  837,65: y

65 - MultiplicativeExpr
  837,66: -
  837,67: 1

141 NUM
  837,67: 1

245 ] Idxs
  837,68: ]
  837,69: [x+1]

7 [ Expr ]
  837,69: [
  837,70: x+1
  837,73: ]

76 ID
  837,70: x

65 + MultiplicativeExpr
  837,71: +
  837,72: 1

141 NUM
  837,72: 1

245 ]
  837,73: ]

91 >= AdditiveExpr
  837,75: >=
  837,78: 6

131 NUM
  837,78: 6

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  837,80: then
  837,84: 
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1

  842,11: EndIf

124 CR_token2
  837,84: 


67 ID Idxs = Expr
  838,13: Shadow
  838,19: [shade]
  838,27: =
  838,29: Shapes.AddImage(Path + "/SNE.png")

184 [ Expr ]
  838,19: [
  838,20: shade
  838,25: ]

76 ID
  838,20: shade

245 ]
  838,25: ]

263 = Expr
  838,27: =
  838,29: Shapes.AddImage(Path + "/SNE.png")

55 ID . ID ( Exprs )
  838,29: Shapes
  838,35: .
  838,36: AddImage
  838,44: (
  838,45: Path + "/SNE.png"
  838,62: )

5 . ID ( Exprs )
  838,35: .
  838,36: AddImage
  838,44: (
  838,45: Path + "/SNE.png"
  838,62: )

260 ID ( Exprs )
  838,36: AddImage
  838,44: (
  838,45: Path + "/SNE.png"
  838,62: )

24 ( Exprs )
  838,44: (
  838,45: Path + "/SNE.png"
  838,62: )

26 ID
  838,45: Path

65 + MultiplicativeExpr
  838,50: +
  838,52: "/SNE.png"

141 STR
  838,52: "/SNE.png"

249 )
  838,62: )

207 CR_token2
  838,63: 


68 ID . ID ( Exprs )
  839,13: Shapes
  839,19: .
  839,20: Move
  839,24: (
  839,25: Shadow[shade], xv + 512, yv + 350
  839,58: )

184 . ID ( Exprs )
  839,19: .
  839,20: Move
  839,24: (
  839,25: Shadow[shade], xv + 512, yv + 350
  839,58: )

255 ID ( Exprs )
  839,20: Move
  839,24: (
  839,25: Shadow[shade], xv + 512, yv + 350
  839,58: )

221 ( Exprs )
  839,24: (
  839,25: Shadow[shade], xv + 512, yv + 350
  839,58: )

27 ID Idxs
  839,25: Shadow
  839,31: [shade]

4 [ Expr ]
  839,31: [
  839,32: shade
  839,37: ]

76 ID
  839,32: shade

245 ]
  839,37: ]

217 , MoreThanOneExpr
  839,38: ,
  839,40: xv + 512, yv + 350

54 ID
  839,40: xv

65 + MultiplicativeExpr
  839,43: +
  839,45: 512

141 NUM
  839,45: 512

217 , MoreThanOneExpr
  839,48: ,
  839,50: yv + 350

54 ID
  839,50: yv

65 + MultiplicativeExpr
  839,53: +
  839,55: 350

141 NUM
  839,55: 350

238 )
  839,58: )

207 CR_token2
  839,59: 


68 ID . ID ( Exprs )
  840,13: Shapes
  840,19: .
  840,20: Animate
  840,27: (
  840,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  840,87: )

184 . ID ( Exprs )
  840,19: .
  840,20: Animate
  840,27: (
  840,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  840,87: )

255 ID ( Exprs )
  840,20: Animate
  840,27: (
  840,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  840,87: )

221 ( Exprs )
  840,27: (
  840,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  840,87: )

27 ID Idxs
  840,28: Shadow
  840,34: [shade]

4 [ Expr ]
  840,34: [
  840,35: shade
  840,40: ]

76 ID
  840,35: shade

245 ]
  840,40: ]

217 , MoreThanOneExpr
  840,41: ,
  840,43: (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2

54 ( Expr )
  840,43: (
  840,44: x
  840,45: )

80 ID
  840,44: x

265 )
  840,45: )

50 * UnaryExpr
  840,47: *
  840,49: 50

156 NUM
  840,49: 50

65 + MultiplicativeExpr
  840,52: +
  840,54: korrx

141 ID
  840,54: korrx

217 , MoreThanOneExpr
  840,59: ,
  840,61: (y) * 40 - 0, animtime*1.2

54 ( Expr )
  840,61: (
  840,62: y
  840,63: )

80 ID
  840,62: y

265 )
  840,63: )

50 * UnaryExpr
  840,65: *
  840,67: 40

156 NUM
  840,67: 40

65 - MultiplicativeExpr
  840,70: -
  840,72: 0

141 NUM
  840,72: 0

217 , MoreThanOneExpr
  840,73: ,
  840,75: animtime*1.2

54 ID
  840,75: animtime

50 * UnaryExpr
  840,83: *
  840,84: 1.2

156 NUM
  840,84: 1.2

238 )
  840,87: )

207 CR_token2
  840,92: 


68 ID = Expr
  841,13: shade
  841,19: =
  841,21: shade + 1

184 = Expr
  841,19: =
  841,21: shade + 1

70 ID
  841,21: shade

59 + MultiplicativeExpr
  841,27: +
  841,29: 1

144 NUM
  841,29: 1

207 CR_token2
  841,30: 


122 OptionalElse_token1
  842,11: EndIf

207 CR_token2
  842,16: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  843,11: If
  843,14: level[y][x-1] <=2 and level[y+1][x] <= 2 and level[y+1][x-1] >= 6
  843,80: then
  843,84: 
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1

  848,11: EndIf

86 ID Idxs
  843,14: level
  843,19: [y][x-1]

4 [ Expr ] Idxs
  843,19: [
  843,20: y
  843,21: ]
  843,22: [x-1]

76 ID
  843,20: y

245 ] Idxs
  843,21: ]
  843,22: [x-1]

7 [ Expr ]
  843,22: [
  843,23: x-1
  843,26: ]

76 ID
  843,23: x

65 - MultiplicativeExpr
  843,24: -
  843,25: 1

141 NUM
  843,25: 1

245 ]
  843,26: ]

91 <= AdditiveExpr
  843,28: <=
  843,30: 2

131 NUM
  843,30: 2

167 AndExpr_token1 EqNeqExpr
  843,32: and
  843,36: level[y+1][x] <= 2

102 ID Idxs
  843,36: level
  843,41: [y+1][x]

4 [ Expr ] Idxs
  843,41: [
  843,42: y+1
  843,45: ]
  843,46: [x]

76 ID
  843,42: y

65 + MultiplicativeExpr
  843,43: +
  843,44: 1

141 NUM
  843,44: 1

245 ] Idxs
  843,45: ]
  843,46: [x]

7 [ Expr ]
  843,46: [
  843,47: x
  843,48: ]

76 ID
  843,47: x

245 ]
  843,48: ]

91 <= AdditiveExpr
  843,50: <=
  843,53: 2

131 NUM
  843,53: 2

167 AndExpr_token1 EqNeqExpr
  843,55: and
  843,59: level[y+1][x-1] >= 6

102 ID Idxs
  843,59: level
  843,64: [y+1][x-1]

4 [ Expr ] Idxs
  843,64: [
  843,65: y+1
  843,68: ]
  843,69: [x-1]

76 ID
  843,65: y

65 + MultiplicativeExpr
  843,66: +
  843,67: 1

141 NUM
  843,67: 1

245 ] Idxs
  843,68: ]
  843,69: [x-1]

7 [ Expr ]
  843,69: [
  843,70: x-1
  843,73: ]

76 ID
  843,70: x

65 - MultiplicativeExpr
  843,71: -
  843,72: 1

141 NUM
  843,72: 1

245 ]
  843,73: ]

91 >= AdditiveExpr
  843,75: >=
  843,78: 6

131 NUM
  843,78: 6

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  843,80: then
  843,84: 
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)    
            shade = shade + 1

  848,11: EndIf

124 CR_token2
  843,84: 


67 ID Idxs = Expr
  844,13: Shadow
  844,19: [shade]
  844,27: =
  844,29: Shapes.AddImage(Path + "/SSW.png")

184 [ Expr ]
  844,19: [
  844,20: shade
  844,25: ]

76 ID
  844,20: shade

245 ]
  844,25: ]

263 = Expr
  844,27: =
  844,29: Shapes.AddImage(Path + "/SSW.png")

55 ID . ID ( Exprs )
  844,29: Shapes
  844,35: .
  844,36: AddImage
  844,44: (
  844,45: Path + "/SSW.png"
  844,62: )

5 . ID ( Exprs )
  844,35: .
  844,36: AddImage
  844,44: (
  844,45: Path + "/SSW.png"
  844,62: )

260 ID ( Exprs )
  844,36: AddImage
  844,44: (
  844,45: Path + "/SSW.png"
  844,62: )

24 ( Exprs )
  844,44: (
  844,45: Path + "/SSW.png"
  844,62: )

26 ID
  844,45: Path

65 + MultiplicativeExpr
  844,50: +
  844,52: "/SSW.png"

141 STR
  844,52: "/SSW.png"

249 )
  844,62: )

207 CR_token2
  844,63: 


68 ID . ID ( Exprs )
  845,13: Shapes
  845,19: .
  845,20: Move
  845,24: (
  845,25: Shadow[shade], xv + 512, yv + 350
  845,58: )

184 . ID ( Exprs )
  845,19: .
  845,20: Move
  845,24: (
  845,25: Shadow[shade], xv + 512, yv + 350
  845,58: )

255 ID ( Exprs )
  845,20: Move
  845,24: (
  845,25: Shadow[shade], xv + 512, yv + 350
  845,58: )

221 ( Exprs )
  845,24: (
  845,25: Shadow[shade], xv + 512, yv + 350
  845,58: )

27 ID Idxs
  845,25: Shadow
  845,31: [shade]

4 [ Expr ]
  845,31: [
  845,32: shade
  845,37: ]

76 ID
  845,32: shade

245 ]
  845,37: ]

217 , MoreThanOneExpr
  845,38: ,
  845,40: xv + 512, yv + 350

54 ID
  845,40: xv

65 + MultiplicativeExpr
  845,43: +
  845,45: 512

141 NUM
  845,45: 512

217 , MoreThanOneExpr
  845,48: ,
  845,50: yv + 350

54 ID
  845,50: yv

65 + MultiplicativeExpr
  845,53: +
  845,55: 350

141 NUM
  845,55: 350

238 )
  845,58: )

207 CR_token2
  845,59: 


68 ID . ID ( Exprs )
  846,13: Shapes
  846,19: .
  846,20: Animate
  846,27: (
  846,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  846,87: )

184 . ID ( Exprs )
  846,19: .
  846,20: Animate
  846,27: (
  846,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  846,87: )

255 ID ( Exprs )
  846,20: Animate
  846,27: (
  846,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  846,87: )

221 ( Exprs )
  846,27: (
  846,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  846,87: )

27 ID Idxs
  846,28: Shadow
  846,34: [shade]

4 [ Expr ]
  846,34: [
  846,35: shade
  846,40: ]

76 ID
  846,35: shade

245 ]
  846,40: ]

217 , MoreThanOneExpr
  846,41: ,
  846,43: (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2

54 ( Expr )
  846,43: (
  846,44: x
  846,45: )

80 ID
  846,44: x

265 )
  846,45: )

50 * UnaryExpr
  846,47: *
  846,49: 50

156 NUM
  846,49: 50

65 + MultiplicativeExpr
  846,52: +
  846,54: korrx

141 ID
  846,54: korrx

217 , MoreThanOneExpr
  846,59: ,
  846,61: (y) * 40 - 0, animtime*1.2

54 ( Expr )
  846,61: (
  846,62: y
  846,63: )

80 ID
  846,62: y

265 )
  846,63: )

50 * UnaryExpr
  846,65: *
  846,67: 40

156 NUM
  846,67: 40

65 - MultiplicativeExpr
  846,70: -
  846,72: 0

141 NUM
  846,72: 0

217 , MoreThanOneExpr
  846,73: ,
  846,75: animtime*1.2

54 ID
  846,75: animtime

50 * UnaryExpr
  846,83: *
  846,84: 1.2

156 NUM
  846,84: 1.2

238 )
  846,87: )

207 CR_token2
  846,92: 


68 ID = Expr
  847,13: shade
  847,19: =
  847,21: shade + 1

184 = Expr
  847,19: =
  847,21: shade + 1

70 ID
  847,21: shade

59 + MultiplicativeExpr
  847,27: +
  847,29: 1

144 NUM
  847,29: 1

207 CR_token2
  847,30: 


122 OptionalElse_token1
  848,11: EndIf

207 CR_token2
  848,16: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  849,11: If
  849,14: level[y][x+1] <=2 and level[y+1][x] <= 2 and level[y+1][x+1] >= 6
  849,80: then
  849,84: 
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1

  854,11: EndIf

86 ID Idxs
  849,14: level
  849,19: [y][x+1]

4 [ Expr ] Idxs
  849,19: [
  849,20: y
  849,21: ]
  849,22: [x+1]

76 ID
  849,20: y

245 ] Idxs
  849,21: ]
  849,22: [x+1]

7 [ Expr ]
  849,22: [
  849,23: x+1
  849,26: ]

76 ID
  849,23: x

65 + MultiplicativeExpr
  849,24: +
  849,25: 1

141 NUM
  849,25: 1

245 ]
  849,26: ]

91 <= AdditiveExpr
  849,28: <=
  849,30: 2

131 NUM
  849,30: 2

167 AndExpr_token1 EqNeqExpr
  849,32: and
  849,36: level[y+1][x] <= 2

102 ID Idxs
  849,36: level
  849,41: [y+1][x]

4 [ Expr ] Idxs
  849,41: [
  849,42: y+1
  849,45: ]
  849,46: [x]

76 ID
  849,42: y

65 + MultiplicativeExpr
  849,43: +
  849,44: 1

141 NUM
  849,44: 1

245 ] Idxs
  849,45: ]
  849,46: [x]

7 [ Expr ]
  849,46: [
  849,47: x
  849,48: ]

76 ID
  849,47: x

245 ]
  849,48: ]

91 <= AdditiveExpr
  849,50: <=
  849,53: 2

131 NUM
  849,53: 2

167 AndExpr_token1 EqNeqExpr
  849,55: and
  849,59: level[y+1][x+1] >= 6

102 ID Idxs
  849,59: level
  849,64: [y+1][x+1]

4 [ Expr ] Idxs
  849,64: [
  849,65: y+1
  849,68: ]
  849,69: [x+1]

76 ID
  849,65: y

65 + MultiplicativeExpr
  849,66: +
  849,67: 1

141 NUM
  849,67: 1

245 ] Idxs
  849,68: ]
  849,69: [x+1]

7 [ Expr ]
  849,69: [
  849,70: x+1
  849,73: ]

76 ID
  849,70: x

65 + MultiplicativeExpr
  849,71: +
  849,72: 1

141 NUM
  849,72: 1

245 ]
  849,73: ]

91 >= AdditiveExpr
  849,75: >=
  849,78: 6

131 NUM
  849,78: 6

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  849,80: then
  849,84: 
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2)     
            shade = shade + 1

  854,11: EndIf

124 CR_token2
  849,84: 


67 ID Idxs = Expr
  850,13: Shadow
  850,19: [shade]
  850,27: =
  850,29: Shapes.AddImage(Path + "/SSE.png")

184 [ Expr ]
  850,19: [
  850,20: shade
  850,25: ]

76 ID
  850,20: shade

245 ]
  850,25: ]

263 = Expr
  850,27: =
  850,29: Shapes.AddImage(Path + "/SSE.png")

55 ID . ID ( Exprs )
  850,29: Shapes
  850,35: .
  850,36: AddImage
  850,44: (
  850,45: Path + "/SSE.png"
  850,62: )

5 . ID ( Exprs )
  850,35: .
  850,36: AddImage
  850,44: (
  850,45: Path + "/SSE.png"
  850,62: )

260 ID ( Exprs )
  850,36: AddImage
  850,44: (
  850,45: Path + "/SSE.png"
  850,62: )

24 ( Exprs )
  850,44: (
  850,45: Path + "/SSE.png"
  850,62: )

26 ID
  850,45: Path

65 + MultiplicativeExpr
  850,50: +
  850,52: "/SSE.png"

141 STR
  850,52: "/SSE.png"

249 )
  850,62: )

207 CR_token2
  850,63: 


68 ID . ID ( Exprs )
  851,13: Shapes
  851,19: .
  851,20: Move
  851,24: (
  851,25: Shadow[shade], xv + 512, yv + 350
  851,58: )

184 . ID ( Exprs )
  851,19: .
  851,20: Move
  851,24: (
  851,25: Shadow[shade], xv + 512, yv + 350
  851,58: )

255 ID ( Exprs )
  851,20: Move
  851,24: (
  851,25: Shadow[shade], xv + 512, yv + 350
  851,58: )

221 ( Exprs )
  851,24: (
  851,25: Shadow[shade], xv + 512, yv + 350
  851,58: )

27 ID Idxs
  851,25: Shadow
  851,31: [shade]

4 [ Expr ]
  851,31: [
  851,32: shade
  851,37: ]

76 ID
  851,32: shade

245 ]
  851,37: ]

217 , MoreThanOneExpr
  851,38: ,
  851,40: xv + 512, yv + 350

54 ID
  851,40: xv

65 + MultiplicativeExpr
  851,43: +
  851,45: 512

141 NUM
  851,45: 512

217 , MoreThanOneExpr
  851,48: ,
  851,50: yv + 350

54 ID
  851,50: yv

65 + MultiplicativeExpr
  851,53: +
  851,55: 350

141 NUM
  851,55: 350

238 )
  851,58: )

207 CR_token2
  851,59: 


68 ID . ID ( Exprs )
  852,13: Shapes
  852,19: .
  852,20: Animate
  852,27: (
  852,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  852,87: )

184 . ID ( Exprs )
  852,19: .
  852,20: Animate
  852,27: (
  852,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  852,87: )

255 ID ( Exprs )
  852,20: Animate
  852,27: (
  852,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  852,87: )

221 ( Exprs )
  852,27: (
  852,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2
  852,87: )

27 ID Idxs
  852,28: Shadow
  852,34: [shade]

4 [ Expr ]
  852,34: [
  852,35: shade
  852,40: ]

76 ID
  852,35: shade

245 ]
  852,40: ]

217 , MoreThanOneExpr
  852,41: ,
  852,43: (x) * 50 + korrx, (y) * 40 - 0, animtime*1.2

54 ( Expr )
  852,43: (
  852,44: x
  852,45: )

80 ID
  852,44: x

265 )
  852,45: )

50 * UnaryExpr
  852,47: *
  852,49: 50

156 NUM
  852,49: 50

65 + MultiplicativeExpr
  852,52: +
  852,54: korrx

141 ID
  852,54: korrx

217 , MoreThanOneExpr
  852,59: ,
  852,61: (y) * 40 - 0, animtime*1.2

54 ( Expr )
  852,61: (
  852,62: y
  852,63: )

80 ID
  852,62: y

265 )
  852,63: )

50 * UnaryExpr
  852,65: *
  852,67: 40

156 NUM
  852,67: 40

65 - MultiplicativeExpr
  852,70: -
  852,72: 0

141 NUM
  852,72: 0

217 , MoreThanOneExpr
  852,73: ,
  852,75: animtime*1.2

54 ID
  852,75: animtime

50 * UnaryExpr
  852,83: *
  852,84: 1.2

156 NUM
  852,84: 1.2

238 )
  852,87: )

207 CR_token2
  852,93: 


68 ID = Expr
  853,13: shade
  853,19: =
  853,21: shade + 1

184 = Expr
  853,19: =
  853,21: shade + 1

70 ID
  853,21: shade

59 + MultiplicativeExpr
  853,27: +
  853,29: 1

144 NUM
  853,29: 1

207 CR_token2
  853,30: 


122 OptionalElse_token1
  854,11: EndIf

207 CR_token2
  854,16: 


122 OptionalElse_token1
  855,8: endif

203 CR_token2
  855,13: 


177 Stmt_token6
  856,5: EndFor

203 CR_token2
  856,11: 


177 Stmt_token6
  857,3: EndFor

206 CR_token2
  857,12: 


257 Stmt_token8
  859,1: EndSub

97 Stmt_token7 ID CRStmtCRs Stmt_token8
  861,1: sub
  861,5: LoadShadowWater
  861,21: 
  shade = 0
 ky = 22
  For y = 0 To 15
     For x = 0 To 19
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   


  916,1: EndSub

244 ID CRStmtCRs Stmt_token8
  861,5: LoadShadowWater
  861,21: 
  shade = 0
 ky = 22
  For y = 0 To 15
     For x = 0 To 19
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor
  EndFor   


  916,1: EndSub

199 CR_token2
  861,21: 


105 ID = Expr
  862,3: shade
  862,9: =
  862,11: 0

184 = Expr
  862,9: =
  862,11: 0

70 NUM
  862,11: 0

206 CR_token2
  862,12: 


106 ID = Expr
  863,2: ky
  863,5: =
  863,7: 22

184 = Expr
  863,5: =
  863,7: 22

70 NUM
  863,7: 22

206 CR_token2
  863,9: 


106 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  864,3: For
  864,7: y
  864,9: =
  864,11: 0
  864,13: To
  864,16: 15
  864,18: 
     For x = 0 To 19
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor

  914,3: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  864,7: y
  864,9: =
  864,11: 0
  864,13: To
  864,16: 15
  864,18: 
     For x = 0 To 19
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor

  914,3: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  864,9: =
  864,11: 0
  864,13: To
  864,16: 15
  864,18: 
     For x = 0 To 19
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor

  914,3: EndFor

56 NUM
  864,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  864,13: To
  864,16: 15
  864,18: 
     For x = 0 To 19
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif
    EndFor

  914,3: EndFor

83 NUM
  864,16: 15

145 CR_token2
  864,18: 


88 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  865,6: For
  865,10: x
  865,12: =
  865,14: 0
  865,16: To
  865,19: 19
  865,21: 
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif

  913,5: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  865,10: x
  865,12: =
  865,14: 0
  865,16: To
  865,19: 19
  865,21: 
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif

  913,5: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  865,12: =
  865,14: 0
  865,16: To
  865,19: 19
  865,21: 
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif

  913,5: EndFor

56 NUM
  865,14: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  865,16: To
  865,19: 19
  865,21: 
       If ground[y][x] = 3 Then
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf
       endif

  913,5: EndFor

83 NUM
  865,19: 19

145 CR_token2
  865,21: 


88 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  866,8: If
  866,11: ground[y][x] = 3
  866,28: Then
  866,32: 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf

  912,8: endif

86 ID Idxs
  866,11: ground
  866,17: [y][x]

4 [ Expr ] Idxs
  866,17: [
  866,18: y
  866,19: ]
  866,20: [x]

76 ID
  866,18: y

245 ] Idxs
  866,19: ]
  866,20: [x]

7 [ Expr ]
  866,20: [
  866,21: x
  866,22: ]

76 ID
  866,21: x

245 ]
  866,22: ]

128 = CompExpr
  866,24: =
  866,26: 3

117 NUM
  866,26: 3

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  866,28: Then
  866,32: 
          angle = Math.GetRandomNumber(360)
          xv = Math.Cos(angle * 0.0174) * 1200
          yv = Math.Sin(angle * 0.0174) * 600  
          If ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf 
          If ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1
          EndIf
          If ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " " then
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1
          EndIf
          If ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0 then
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1
          EndIf

  912,8: endif

124 CR_token2
  866,32: 


67 ID = Expr
  867,11: angle
  867,17: =
  867,19: Math.GetRandomNumber(360)

184 = Expr
  867,17: =
  867,19: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  867,19: Math
  867,23: .
  867,24: GetRandomNumber
  867,39: (
  867,40: 360
  867,43: )

5 . ID ( Exprs )
  867,23: .
  867,24: GetRandomNumber
  867,39: (
  867,40: 360
  867,43: )

260 ID ( Exprs )
  867,24: GetRandomNumber
  867,39: (
  867,40: 360
  867,43: )

24 ( Exprs )
  867,39: (
  867,40: 360
  867,43: )

26 NUM
  867,40: 360

249 )
  867,43: )

207 CR_token2
  867,44: 


68 ID = Expr
  868,11: xv
  868,14: =
  868,16: Math.Cos(angle * 0.0174) * 1200

184 = Expr
  868,14: =
  868,16: Math.Cos(angle * 0.0174) * 1200

70 ID . ID ( Exprs )
  868,16: Math
  868,20: .
  868,21: Cos
  868,24: (
  868,25: angle * 0.0174
  868,39: )

5 . ID ( Exprs )
  868,20: .
  868,21: Cos
  868,24: (
  868,25: angle * 0.0174
  868,39: )

260 ID ( Exprs )
  868,21: Cos
  868,24: (
  868,25: angle * 0.0174
  868,39: )

24 ( Exprs )
  868,24: (
  868,25: angle * 0.0174
  868,39: )

26 ID
  868,25: angle

50 * UnaryExpr
  868,31: *
  868,33: 0.0174

156 NUM
  868,33: 0.0174

249 )
  868,39: )

48 * UnaryExpr
  868,41: *
  868,43: 1200

157 NUM
  868,43: 1200

207 CR_token2
  868,47: 


68 ID = Expr
  869,11: yv
  869,14: =
  869,16: Math.Sin(angle * 0.0174) * 600

184 = Expr
  869,14: =
  869,16: Math.Sin(angle * 0.0174) * 600

70 ID . ID ( Exprs )
  869,16: Math
  869,20: .
  869,21: Sin
  869,24: (
  869,25: angle * 0.0174
  869,39: )

5 . ID ( Exprs )
  869,20: .
  869,21: Sin
  869,24: (
  869,25: angle * 0.0174
  869,39: )

260 ID ( Exprs )
  869,21: Sin
  869,24: (
  869,25: angle * 0.0174
  869,39: )

24 ( Exprs )
  869,24: (
  869,25: angle * 0.0174
  869,39: )

26 ID
  869,25: angle

50 * UnaryExpr
  869,31: *
  869,33: 0.0174

156 NUM
  869,33: 0.0174

249 )
  869,39: )

48 * UnaryExpr
  869,41: *
  869,43: 600

157 NUM
  869,43: 600

207 CR_token2
  869,48: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  870,11: If
  870,14: ground[y][x-1] <> 3 and ground[y][x-1] >= 0 and ground[y][x-1] <> " "
  870,84: then
  870,88: 
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1

  875,11: EndIf

86 ID Idxs
  870,14: ground
  870,20: [y][x-1]

4 [ Expr ] Idxs
  870,20: [
  870,21: y
  870,22: ]
  870,23: [x-1]

76 ID
  870,21: y

245 ] Idxs
  870,22: ]
  870,23: [x-1]

7 [ Expr ]
  870,23: [
  870,24: x-1
  870,27: ]

76 ID
  870,24: x

65 - MultiplicativeExpr
  870,25: -
  870,26: 1

141 NUM
  870,26: 1

245 ]
  870,27: ]

128 <> CompExpr
  870,29: <>
  870,32: 3

117 NUM
  870,32: 3

167 AndExpr_token1 EqNeqExpr
  870,34: and
  870,38: ground[y][x-1] >= 0

102 ID Idxs
  870,38: ground
  870,44: [y][x-1]

4 [ Expr ] Idxs
  870,44: [
  870,45: y
  870,46: ]
  870,47: [x-1]

76 ID
  870,45: y

245 ] Idxs
  870,46: ]
  870,47: [x-1]

7 [ Expr ]
  870,47: [
  870,48: x-1
  870,51: ]

76 ID
  870,48: x

65 - MultiplicativeExpr
  870,49: -
  870,50: 1

141 NUM
  870,50: 1

245 ]
  870,51: ]

91 >= AdditiveExpr
  870,53: >=
  870,56: 0

131 NUM
  870,56: 0

167 AndExpr_token1 EqNeqExpr
  870,58: and
  870,62: ground[y][x-1] <> " "

102 ID Idxs
  870,62: ground
  870,68: [y][x-1]

4 [ Expr ] Idxs
  870,68: [
  870,69: y
  870,70: ]
  870,71: [x-1]

76 ID
  870,69: y

245 ] Idxs
  870,70: ]
  870,71: [x-1]

7 [ Expr ]
  870,71: [
  870,72: x-1
  870,75: ]

76 ID
  870,72: x

65 - MultiplicativeExpr
  870,73: -
  870,74: 1

141 NUM
  870,74: 1

245 ]
  870,75: ]

134 <> CompExpr
  870,77: <>
  870,80: " "

117 STR
  870,80: " "

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  870,84: then
  870,88: 
            Shadow[shade] = Shapes.AddImage(Path + "/SW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1

  875,11: EndIf

124 CR_token2
  870,88: 


67 ID Idxs = Expr
  871,13: Shadow
  871,19: [shade]
  871,27: =
  871,29: Shapes.AddImage(Path + "/SW.png")

184 [ Expr ]
  871,19: [
  871,20: shade
  871,25: ]

76 ID
  871,20: shade

245 ]
  871,25: ]

263 = Expr
  871,27: =
  871,29: Shapes.AddImage(Path + "/SW.png")

55 ID . ID ( Exprs )
  871,29: Shapes
  871,35: .
  871,36: AddImage
  871,44: (
  871,45: Path + "/SW.png"
  871,61: )

5 . ID ( Exprs )
  871,35: .
  871,36: AddImage
  871,44: (
  871,45: Path + "/SW.png"
  871,61: )

260 ID ( Exprs )
  871,36: AddImage
  871,44: (
  871,45: Path + "/SW.png"
  871,61: )

24 ( Exprs )
  871,44: (
  871,45: Path + "/SW.png"
  871,61: )

26 ID
  871,45: Path

65 + MultiplicativeExpr
  871,50: +
  871,52: "/SW.png"

141 STR
  871,52: "/SW.png"

249 )
  871,61: )

207 CR_token2
  871,62: 


68 ID . ID ( Exprs )
  872,13: Shapes
  872,19: .
  872,20: Move
  872,24: (
  872,25: Shadow[shade], xv + 512, yv + 350
  872,58: )

184 . ID ( Exprs )
  872,19: .
  872,20: Move
  872,24: (
  872,25: Shadow[shade], xv + 512, yv + 350
  872,58: )

255 ID ( Exprs )
  872,20: Move
  872,24: (
  872,25: Shadow[shade], xv + 512, yv + 350
  872,58: )

221 ( Exprs )
  872,24: (
  872,25: Shadow[shade], xv + 512, yv + 350
  872,58: )

27 ID Idxs
  872,25: Shadow
  872,31: [shade]

4 [ Expr ]
  872,31: [
  872,32: shade
  872,37: ]

76 ID
  872,32: shade

245 ]
  872,37: ]

217 , MoreThanOneExpr
  872,38: ,
  872,40: xv + 512, yv + 350

54 ID
  872,40: xv

65 + MultiplicativeExpr
  872,43: +
  872,45: 512

141 NUM
  872,45: 512

217 , MoreThanOneExpr
  872,48: ,
  872,50: yv + 350

54 ID
  872,50: yv

65 + MultiplicativeExpr
  872,53: +
  872,55: 350

141 NUM
  872,55: 350

238 )
  872,58: )

207 CR_token2
  872,59: 


68 ID . ID ( Exprs )
  873,13: Shapes
  873,19: .
  873,20: Animate
  873,27: (
  873,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  873,88: )

184 . ID ( Exprs )
  873,19: .
  873,20: Animate
  873,27: (
  873,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  873,88: )

255 ID ( Exprs )
  873,20: Animate
  873,27: (
  873,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  873,88: )

221 ( Exprs )
  873,27: (
  873,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  873,88: )

27 ID Idxs
  873,28: Shadow
  873,34: [shade]

4 [ Expr ]
  873,34: [
  873,35: shade
  873,40: ]

76 ID
  873,35: shade

245 ]
  873,40: ]

217 , MoreThanOneExpr
  873,41: ,
  873,43: (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2

54 ( Expr )
  873,43: (
  873,44: x
  873,45: )

80 ID
  873,44: x

265 )
  873,45: )

50 * UnaryExpr
  873,47: *
  873,49: 50

156 NUM
  873,49: 50

65 + MultiplicativeExpr
  873,52: +
  873,54: korrx

141 ID
  873,54: korrx

217 , MoreThanOneExpr
  873,59: ,
  873,61: (y) * 40 + ky, animtime*1.2

54 ( Expr )
  873,61: (
  873,62: y
  873,63: )

80 ID
  873,62: y

265 )
  873,63: )

50 * UnaryExpr
  873,65: *
  873,67: 40

156 NUM
  873,67: 40

65 + MultiplicativeExpr
  873,70: +
  873,72: ky

141 ID
  873,72: ky

217 , MoreThanOneExpr
  873,74: ,
  873,76: animtime*1.2

54 ID
  873,76: animtime

50 * UnaryExpr
  873,84: *
  873,85: 1.2

156 NUM
  873,85: 1.2

238 )
  873,88: )

207 CR_token2
  873,92: 


68 ID = Expr
  874,13: shade
  874,19: =
  874,21: shade + 1

184 = Expr
  874,19: =
  874,21: shade + 1

70 ID
  874,21: shade

59 + MultiplicativeExpr
  874,27: +
  874,29: 1

144 NUM
  874,29: 1

207 CR_token2
  874,30: 


122 OptionalElse_token1
  875,11: EndIf

207 CR_token2
  875,17: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  876,11: If
  876,14: ground[y][x+1] <> 3 and ground[y+1][x] >= 0 and ground[y][x+1] <> " "
  876,84: then
  876,88: 
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1

  881,11: EndIf

86 ID Idxs
  876,14: ground
  876,20: [y][x+1]

4 [ Expr ] Idxs
  876,20: [
  876,21: y
  876,22: ]
  876,23: [x+1]

76 ID
  876,21: y

245 ] Idxs
  876,22: ]
  876,23: [x+1]

7 [ Expr ]
  876,23: [
  876,24: x+1
  876,27: ]

76 ID
  876,24: x

65 + MultiplicativeExpr
  876,25: +
  876,26: 1

141 NUM
  876,26: 1

245 ]
  876,27: ]

128 <> CompExpr
  876,29: <>
  876,32: 3

117 NUM
  876,32: 3

167 AndExpr_token1 EqNeqExpr
  876,34: and
  876,38: ground[y+1][x] >= 0

102 ID Idxs
  876,38: ground
  876,44: [y+1][x]

4 [ Expr ] Idxs
  876,44: [
  876,45: y+1
  876,48: ]
  876,49: [x]

76 ID
  876,45: y

65 + MultiplicativeExpr
  876,46: +
  876,47: 1

141 NUM
  876,47: 1

245 ] Idxs
  876,48: ]
  876,49: [x]

7 [ Expr ]
  876,49: [
  876,50: x
  876,51: ]

76 ID
  876,50: x

245 ]
  876,51: ]

91 >= AdditiveExpr
  876,53: >=
  876,56: 0

131 NUM
  876,56: 0

167 AndExpr_token1 EqNeqExpr
  876,58: and
  876,62: ground[y][x+1] <> " "

102 ID Idxs
  876,62: ground
  876,68: [y][x+1]

4 [ Expr ] Idxs
  876,68: [
  876,69: y
  876,70: ]
  876,71: [x+1]

76 ID
  876,69: y

245 ] Idxs
  876,70: ]
  876,71: [x+1]

7 [ Expr ]
  876,71: [
  876,72: x+1
  876,75: ]

76 ID
  876,72: x

65 + MultiplicativeExpr
  876,73: +
  876,74: 1

141 NUM
  876,74: 1

245 ]
  876,75: ]

134 <> CompExpr
  876,77: <>
  876,80: " "

117 STR
  876,80: " "

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  876,84: then
  876,88: 
            Shadow[shade] = Shapes.AddImage(Path + "/SE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)   
            shade = shade + 1

  881,11: EndIf

124 CR_token2
  876,88: 


67 ID Idxs = Expr
  877,13: Shadow
  877,19: [shade]
  877,27: =
  877,29: Shapes.AddImage(Path + "/SE.png")

184 [ Expr ]
  877,19: [
  877,20: shade
  877,25: ]

76 ID
  877,20: shade

245 ]
  877,25: ]

263 = Expr
  877,27: =
  877,29: Shapes.AddImage(Path + "/SE.png")

55 ID . ID ( Exprs )
  877,29: Shapes
  877,35: .
  877,36: AddImage
  877,44: (
  877,45: Path + "/SE.png"
  877,61: )

5 . ID ( Exprs )
  877,35: .
  877,36: AddImage
  877,44: (
  877,45: Path + "/SE.png"
  877,61: )

260 ID ( Exprs )
  877,36: AddImage
  877,44: (
  877,45: Path + "/SE.png"
  877,61: )

24 ( Exprs )
  877,44: (
  877,45: Path + "/SE.png"
  877,61: )

26 ID
  877,45: Path

65 + MultiplicativeExpr
  877,50: +
  877,52: "/SE.png"

141 STR
  877,52: "/SE.png"

249 )
  877,61: )

207 CR_token2
  877,62: 


68 ID . ID ( Exprs )
  878,13: Shapes
  878,19: .
  878,20: Move
  878,24: (
  878,25: Shadow[shade], xv + 512, yv + 350
  878,58: )

184 . ID ( Exprs )
  878,19: .
  878,20: Move
  878,24: (
  878,25: Shadow[shade], xv + 512, yv + 350
  878,58: )

255 ID ( Exprs )
  878,20: Move
  878,24: (
  878,25: Shadow[shade], xv + 512, yv + 350
  878,58: )

221 ( Exprs )
  878,24: (
  878,25: Shadow[shade], xv + 512, yv + 350
  878,58: )

27 ID Idxs
  878,25: Shadow
  878,31: [shade]

4 [ Expr ]
  878,31: [
  878,32: shade
  878,37: ]

76 ID
  878,32: shade

245 ]
  878,37: ]

217 , MoreThanOneExpr
  878,38: ,
  878,40: xv + 512, yv + 350

54 ID
  878,40: xv

65 + MultiplicativeExpr
  878,43: +
  878,45: 512

141 NUM
  878,45: 512

217 , MoreThanOneExpr
  878,48: ,
  878,50: yv + 350

54 ID
  878,50: yv

65 + MultiplicativeExpr
  878,53: +
  878,55: 350

141 NUM
  878,55: 350

238 )
  878,58: )

207 CR_token2
  878,59: 


68 ID . ID ( Exprs )
  879,13: Shapes
  879,19: .
  879,20: Animate
  879,27: (
  879,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  879,88: )

184 . ID ( Exprs )
  879,19: .
  879,20: Animate
  879,27: (
  879,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  879,88: )

255 ID ( Exprs )
  879,20: Animate
  879,27: (
  879,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  879,88: )

221 ( Exprs )
  879,27: (
  879,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  879,88: )

27 ID Idxs
  879,28: Shadow
  879,34: [shade]

4 [ Expr ]
  879,34: [
  879,35: shade
  879,40: ]

76 ID
  879,35: shade

245 ]
  879,40: ]

217 , MoreThanOneExpr
  879,41: ,
  879,43: (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2

54 ( Expr )
  879,43: (
  879,44: x
  879,45: )

80 ID
  879,44: x

265 )
  879,45: )

50 * UnaryExpr
  879,47: *
  879,49: 50

156 NUM
  879,49: 50

65 + MultiplicativeExpr
  879,52: +
  879,54: korrx

141 ID
  879,54: korrx

217 , MoreThanOneExpr
  879,59: ,
  879,61: (y) * 40 + ky, animtime*1.2

54 ( Expr )
  879,61: (
  879,62: y
  879,63: )

80 ID
  879,62: y

265 )
  879,63: )

50 * UnaryExpr
  879,65: *
  879,67: 40

156 NUM
  879,67: 40

65 + MultiplicativeExpr
  879,70: +
  879,72: ky

141 ID
  879,72: ky

217 , MoreThanOneExpr
  879,74: ,
  879,76: animtime*1.2

54 ID
  879,76: animtime

50 * UnaryExpr
  879,84: *
  879,85: 1.2

156 NUM
  879,85: 1.2

238 )
  879,88: )

207 CR_token2
  879,92: 


68 ID = Expr
  880,13: shade
  880,19: =
  880,21: shade + 1

184 = Expr
  880,19: =
  880,21: shade + 1

70 ID
  880,21: shade

59 + MultiplicativeExpr
  880,27: +
  880,29: 1

144 NUM
  880,29: 1

207 CR_token2
  880,30: 


122 OptionalElse_token1
  881,11: EndIf

207 CR_token2
  881,16: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  882,11: If
  882,14: ground[y-1][x] <> 3 and ground[y-1][x] >= 0 and ground[y-1][x] <> " "
  882,84: then
  882,88: 
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1

  887,11: EndIf

86 ID Idxs
  882,14: ground
  882,20: [y-1][x]

4 [ Expr ] Idxs
  882,20: [
  882,21: y-1
  882,24: ]
  882,25: [x]

76 ID
  882,21: y

65 - MultiplicativeExpr
  882,22: -
  882,23: 1

141 NUM
  882,23: 1

245 ] Idxs
  882,24: ]
  882,25: [x]

7 [ Expr ]
  882,25: [
  882,26: x
  882,27: ]

76 ID
  882,26: x

245 ]
  882,27: ]

128 <> CompExpr
  882,29: <>
  882,32: 3

117 NUM
  882,32: 3

167 AndExpr_token1 EqNeqExpr
  882,34: and
  882,38: ground[y-1][x] >= 0

102 ID Idxs
  882,38: ground
  882,44: [y-1][x]

4 [ Expr ] Idxs
  882,44: [
  882,45: y-1
  882,48: ]
  882,49: [x]

76 ID
  882,45: y

65 - MultiplicativeExpr
  882,46: -
  882,47: 1

141 NUM
  882,47: 1

245 ] Idxs
  882,48: ]
  882,49: [x]

7 [ Expr ]
  882,49: [
  882,50: x
  882,51: ]

76 ID
  882,50: x

245 ]
  882,51: ]

91 >= AdditiveExpr
  882,53: >=
  882,56: 0

131 NUM
  882,56: 0

167 AndExpr_token1 EqNeqExpr
  882,58: and
  882,62: ground[y-1][x] <> " "

102 ID Idxs
  882,62: ground
  882,68: [y-1][x]

4 [ Expr ] Idxs
  882,68: [
  882,69: y-1
  882,72: ]
  882,73: [x]

76 ID
  882,69: y

65 - MultiplicativeExpr
  882,70: -
  882,71: 1

141 NUM
  882,71: 1

245 ] Idxs
  882,72: ]
  882,73: [x]

7 [ Expr ]
  882,73: [
  882,74: x
  882,75: ]

76 ID
  882,74: x

245 ]
  882,75: ]

134 <> CompExpr
  882,77: <>
  882,80: " "

117 STR
  882,80: " "

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  882,84: then
  882,88: 
            Shadow[shade] = Shapes.AddImage(Path + "/SN.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)  
            shade = shade + 1

  887,11: EndIf

124 CR_token2
  882,88: 


67 ID Idxs = Expr
  883,13: Shadow
  883,19: [shade]
  883,27: =
  883,29: Shapes.AddImage(Path + "/SN.png")

184 [ Expr ]
  883,19: [
  883,20: shade
  883,25: ]

76 ID
  883,20: shade

245 ]
  883,25: ]

263 = Expr
  883,27: =
  883,29: Shapes.AddImage(Path + "/SN.png")

55 ID . ID ( Exprs )
  883,29: Shapes
  883,35: .
  883,36: AddImage
  883,44: (
  883,45: Path + "/SN.png"
  883,61: )

5 . ID ( Exprs )
  883,35: .
  883,36: AddImage
  883,44: (
  883,45: Path + "/SN.png"
  883,61: )

260 ID ( Exprs )
  883,36: AddImage
  883,44: (
  883,45: Path + "/SN.png"
  883,61: )

24 ( Exprs )
  883,44: (
  883,45: Path + "/SN.png"
  883,61: )

26 ID
  883,45: Path

65 + MultiplicativeExpr
  883,50: +
  883,52: "/SN.png"

141 STR
  883,52: "/SN.png"

249 )
  883,61: )

207 CR_token2
  883,62: 


68 ID . ID ( Exprs )
  884,13: Shapes
  884,19: .
  884,20: Move
  884,24: (
  884,25: Shadow[shade], xv + 512, yv + 350
  884,58: )

184 . ID ( Exprs )
  884,19: .
  884,20: Move
  884,24: (
  884,25: Shadow[shade], xv + 512, yv + 350
  884,58: )

255 ID ( Exprs )
  884,20: Move
  884,24: (
  884,25: Shadow[shade], xv + 512, yv + 350
  884,58: )

221 ( Exprs )
  884,24: (
  884,25: Shadow[shade], xv + 512, yv + 350
  884,58: )

27 ID Idxs
  884,25: Shadow
  884,31: [shade]

4 [ Expr ]
  884,31: [
  884,32: shade
  884,37: ]

76 ID
  884,32: shade

245 ]
  884,37: ]

217 , MoreThanOneExpr
  884,38: ,
  884,40: xv + 512, yv + 350

54 ID
  884,40: xv

65 + MultiplicativeExpr
  884,43: +
  884,45: 512

141 NUM
  884,45: 512

217 , MoreThanOneExpr
  884,48: ,
  884,50: yv + 350

54 ID
  884,50: yv

65 + MultiplicativeExpr
  884,53: +
  884,55: 350

141 NUM
  884,55: 350

238 )
  884,58: )

207 CR_token2
  884,59: 


68 ID . ID ( Exprs )
  885,13: Shapes
  885,19: .
  885,20: Animate
  885,27: (
  885,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  885,88: )

184 . ID ( Exprs )
  885,19: .
  885,20: Animate
  885,27: (
  885,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  885,88: )

255 ID ( Exprs )
  885,20: Animate
  885,27: (
  885,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  885,88: )

221 ( Exprs )
  885,27: (
  885,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  885,88: )

27 ID Idxs
  885,28: Shadow
  885,34: [shade]

4 [ Expr ]
  885,34: [
  885,35: shade
  885,40: ]

76 ID
  885,35: shade

245 ]
  885,40: ]

217 , MoreThanOneExpr
  885,41: ,
  885,43: (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2

54 ( Expr )
  885,43: (
  885,44: x
  885,45: )

80 ID
  885,44: x

265 )
  885,45: )

50 * UnaryExpr
  885,47: *
  885,49: 50

156 NUM
  885,49: 50

65 + MultiplicativeExpr
  885,52: +
  885,54: korrx

141 ID
  885,54: korrx

217 , MoreThanOneExpr
  885,59: ,
  885,61: (y) * 40 + ky, animtime*1.2

54 ( Expr )
  885,61: (
  885,62: y
  885,63: )

80 ID
  885,62: y

265 )
  885,63: )

50 * UnaryExpr
  885,65: *
  885,67: 40

156 NUM
  885,67: 40

65 + MultiplicativeExpr
  885,70: +
  885,72: ky

141 ID
  885,72: ky

217 , MoreThanOneExpr
  885,74: ,
  885,76: animtime*1.2

54 ID
  885,76: animtime

50 * UnaryExpr
  885,84: *
  885,85: 1.2

156 NUM
  885,85: 1.2

238 )
  885,88: )

207 CR_token2
  885,91: 


68 ID = Expr
  886,13: shade
  886,19: =
  886,21: shade + 1

184 = Expr
  886,19: =
  886,21: shade + 1

70 ID
  886,21: shade

59 + MultiplicativeExpr
  886,27: +
  886,29: 1

144 NUM
  886,29: 1

207 CR_token2
  886,30: 


122 OptionalElse_token1
  887,11: EndIf

207 CR_token2
  887,16: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  888,11: If
  888,14: ground[y][x-1] = 3 and ground[y-1][x] = 3 and ground[y-1][x-1] <> 3 and ground[y-1][x-1] >= 0
  888,108: then
  888,112: 
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1

  893,11: EndIf

86 ID Idxs
  888,14: ground
  888,20: [y][x-1]

4 [ Expr ] Idxs
  888,20: [
  888,21: y
  888,22: ]
  888,23: [x-1]

76 ID
  888,21: y

245 ] Idxs
  888,22: ]
  888,23: [x-1]

7 [ Expr ]
  888,23: [
  888,24: x-1
  888,27: ]

76 ID
  888,24: x

65 - MultiplicativeExpr
  888,25: -
  888,26: 1

141 NUM
  888,26: 1

245 ]
  888,27: ]

128 = CompExpr
  888,29: =
  888,31: 3

117 NUM
  888,31: 3

167 AndExpr_token1 EqNeqExpr
  888,33: and
  888,37: ground[y-1][x] = 3

102 ID Idxs
  888,37: ground
  888,43: [y-1][x]

4 [ Expr ] Idxs
  888,43: [
  888,44: y-1
  888,47: ]
  888,48: [x]

76 ID
  888,44: y

65 - MultiplicativeExpr
  888,45: -
  888,46: 1

141 NUM
  888,46: 1

245 ] Idxs
  888,47: ]
  888,48: [x]

7 [ Expr ]
  888,48: [
  888,49: x
  888,50: ]

76 ID
  888,49: x

245 ]
  888,50: ]

134 = CompExpr
  888,52: =
  888,54: 3

117 NUM
  888,54: 3

167 AndExpr_token1 EqNeqExpr
  888,56: and
  888,60: ground[y-1][x-1] <> 3

102 ID Idxs
  888,60: ground
  888,66: [y-1][x-1]

4 [ Expr ] Idxs
  888,66: [
  888,67: y-1
  888,70: ]
  888,71: [x-1]

76 ID
  888,67: y

65 - MultiplicativeExpr
  888,68: -
  888,69: 1

141 NUM
  888,69: 1

245 ] Idxs
  888,70: ]
  888,71: [x-1]

7 [ Expr ]
  888,71: [
  888,72: x-1
  888,75: ]

76 ID
  888,72: x

65 - MultiplicativeExpr
  888,73: -
  888,74: 1

141 NUM
  888,74: 1

245 ]
  888,75: ]

134 <> CompExpr
  888,77: <>
  888,80: 3

117 NUM
  888,80: 3

167 AndExpr_token1 EqNeqExpr
  888,82: and
  888,86: ground[y-1][x-1] >= 0

102 ID Idxs
  888,86: ground
  888,92: [y-1][x-1]

4 [ Expr ] Idxs
  888,92: [
  888,93: y-1
  888,96: ]
  888,97: [x-1]

76 ID
  888,93: y

65 - MultiplicativeExpr
  888,94: -
  888,95: 1

141 NUM
  888,95: 1

245 ] Idxs
  888,96: ]
  888,97: [x-1]

7 [ Expr ]
  888,97: [
  888,98: x-1
  888,101: ]

76 ID
  888,98: x

65 - MultiplicativeExpr
  888,99: -
  888,100: 1

141 NUM
  888,100: 1

245 ]
  888,101: ]

91 >= AdditiveExpr
  888,103: >=
  888,106: 0

131 NUM
  888,106: 0

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  888,108: then
  888,112: 
            Shadow[shade] = Shapes.AddImage(Path + "/SNW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1

  893,11: EndIf

124 CR_token2
  888,112: 


67 ID Idxs = Expr
  889,13: Shadow
  889,19: [shade]
  889,27: =
  889,29: Shapes.AddImage(Path + "/SNW.png")

184 [ Expr ]
  889,19: [
  889,20: shade
  889,25: ]

76 ID
  889,20: shade

245 ]
  889,25: ]

263 = Expr
  889,27: =
  889,29: Shapes.AddImage(Path + "/SNW.png")

55 ID . ID ( Exprs )
  889,29: Shapes
  889,35: .
  889,36: AddImage
  889,44: (
  889,45: Path + "/SNW.png"
  889,62: )

5 . ID ( Exprs )
  889,35: .
  889,36: AddImage
  889,44: (
  889,45: Path + "/SNW.png"
  889,62: )

260 ID ( Exprs )
  889,36: AddImage
  889,44: (
  889,45: Path + "/SNW.png"
  889,62: )

24 ( Exprs )
  889,44: (
  889,45: Path + "/SNW.png"
  889,62: )

26 ID
  889,45: Path

65 + MultiplicativeExpr
  889,50: +
  889,52: "/SNW.png"

141 STR
  889,52: "/SNW.png"

249 )
  889,62: )

207 CR_token2
  889,63: 


68 ID . ID ( Exprs )
  890,13: Shapes
  890,19: .
  890,20: Move
  890,24: (
  890,25: Shadow[shade], xv + 512, yv + 350
  890,58: )

184 . ID ( Exprs )
  890,19: .
  890,20: Move
  890,24: (
  890,25: Shadow[shade], xv + 512, yv + 350
  890,58: )

255 ID ( Exprs )
  890,20: Move
  890,24: (
  890,25: Shadow[shade], xv + 512, yv + 350
  890,58: )

221 ( Exprs )
  890,24: (
  890,25: Shadow[shade], xv + 512, yv + 350
  890,58: )

27 ID Idxs
  890,25: Shadow
  890,31: [shade]

4 [ Expr ]
  890,31: [
  890,32: shade
  890,37: ]

76 ID
  890,32: shade

245 ]
  890,37: ]

217 , MoreThanOneExpr
  890,38: ,
  890,40: xv + 512, yv + 350

54 ID
  890,40: xv

65 + MultiplicativeExpr
  890,43: +
  890,45: 512

141 NUM
  890,45: 512

217 , MoreThanOneExpr
  890,48: ,
  890,50: yv + 350

54 ID
  890,50: yv

65 + MultiplicativeExpr
  890,53: +
  890,55: 350

141 NUM
  890,55: 350

238 )
  890,58: )

207 CR_token2
  890,59: 


68 ID . ID ( Exprs )
  891,13: Shapes
  891,19: .
  891,20: Animate
  891,27: (
  891,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  891,88: )

184 . ID ( Exprs )
  891,19: .
  891,20: Animate
  891,27: (
  891,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  891,88: )

255 ID ( Exprs )
  891,20: Animate
  891,27: (
  891,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  891,88: )

221 ( Exprs )
  891,27: (
  891,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  891,88: )

27 ID Idxs
  891,28: Shadow
  891,34: [shade]

4 [ Expr ]
  891,34: [
  891,35: shade
  891,40: ]

76 ID
  891,35: shade

245 ]
  891,40: ]

217 , MoreThanOneExpr
  891,41: ,
  891,43: (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2

54 ( Expr )
  891,43: (
  891,44: x
  891,45: )

80 ID
  891,44: x

265 )
  891,45: )

50 * UnaryExpr
  891,47: *
  891,49: 50

156 NUM
  891,49: 50

65 + MultiplicativeExpr
  891,52: +
  891,54: korrx

141 ID
  891,54: korrx

217 , MoreThanOneExpr
  891,59: ,
  891,61: (y) * 40 + ky, animtime*1.2

54 ( Expr )
  891,61: (
  891,62: y
  891,63: )

80 ID
  891,62: y

265 )
  891,63: )

50 * UnaryExpr
  891,65: *
  891,67: 40

156 NUM
  891,67: 40

65 + MultiplicativeExpr
  891,70: +
  891,72: ky

141 ID
  891,72: ky

217 , MoreThanOneExpr
  891,74: ,
  891,76: animtime*1.2

54 ID
  891,76: animtime

50 * UnaryExpr
  891,84: *
  891,85: 1.2

156 NUM
  891,85: 1.2

238 )
  891,88: )

207 CR_token2
  891,93: 


68 ID = Expr
  892,13: shade
  892,19: =
  892,21: shade + 1

184 = Expr
  892,19: =
  892,21: shade + 1

70 ID
  892,21: shade

59 + MultiplicativeExpr
  892,27: +
  892,29: 1

144 NUM
  892,29: 1

207 CR_token2
  892,30: 


122 OptionalElse_token1
  893,11: EndIf

207 CR_token2
  893,16: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  894,11: If
  894,14: ground[y][x+1] = 3 and ground[y-1][x] = 3 and ground[y-1][x+1] <> 3 and ground[y-1][x+1] >= 0
  894,108: then
  894,112: 
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1

  899,11: EndIf

86 ID Idxs
  894,14: ground
  894,20: [y][x+1]

4 [ Expr ] Idxs
  894,20: [
  894,21: y
  894,22: ]
  894,23: [x+1]

76 ID
  894,21: y

245 ] Idxs
  894,22: ]
  894,23: [x+1]

7 [ Expr ]
  894,23: [
  894,24: x+1
  894,27: ]

76 ID
  894,24: x

65 + MultiplicativeExpr
  894,25: +
  894,26: 1

141 NUM
  894,26: 1

245 ]
  894,27: ]

128 = CompExpr
  894,29: =
  894,31: 3

117 NUM
  894,31: 3

167 AndExpr_token1 EqNeqExpr
  894,33: and
  894,37: ground[y-1][x] = 3

102 ID Idxs
  894,37: ground
  894,43: [y-1][x]

4 [ Expr ] Idxs
  894,43: [
  894,44: y-1
  894,47: ]
  894,48: [x]

76 ID
  894,44: y

65 - MultiplicativeExpr
  894,45: -
  894,46: 1

141 NUM
  894,46: 1

245 ] Idxs
  894,47: ]
  894,48: [x]

7 [ Expr ]
  894,48: [
  894,49: x
  894,50: ]

76 ID
  894,49: x

245 ]
  894,50: ]

134 = CompExpr
  894,52: =
  894,54: 3

117 NUM
  894,54: 3

167 AndExpr_token1 EqNeqExpr
  894,56: and
  894,60: ground[y-1][x+1] <> 3

102 ID Idxs
  894,60: ground
  894,66: [y-1][x+1]

4 [ Expr ] Idxs
  894,66: [
  894,67: y-1
  894,70: ]
  894,71: [x+1]

76 ID
  894,67: y

65 - MultiplicativeExpr
  894,68: -
  894,69: 1

141 NUM
  894,69: 1

245 ] Idxs
  894,70: ]
  894,71: [x+1]

7 [ Expr ]
  894,71: [
  894,72: x+1
  894,75: ]

76 ID
  894,72: x

65 + MultiplicativeExpr
  894,73: +
  894,74: 1

141 NUM
  894,74: 1

245 ]
  894,75: ]

134 <> CompExpr
  894,77: <>
  894,80: 3

117 NUM
  894,80: 3

167 AndExpr_token1 EqNeqExpr
  894,82: and
  894,86: ground[y-1][x+1] >= 0

102 ID Idxs
  894,86: ground
  894,92: [y-1][x+1]

4 [ Expr ] Idxs
  894,92: [
  894,93: y-1
  894,96: ]
  894,97: [x+1]

76 ID
  894,93: y

65 - MultiplicativeExpr
  894,94: -
  894,95: 1

141 NUM
  894,95: 1

245 ] Idxs
  894,96: ]
  894,97: [x+1]

7 [ Expr ]
  894,97: [
  894,98: x+1
  894,101: ]

76 ID
  894,98: x

65 + MultiplicativeExpr
  894,99: +
  894,100: 1

141 NUM
  894,100: 1

245 ]
  894,101: ]

91 >= AdditiveExpr
  894,103: >=
  894,106: 0

131 NUM
  894,106: 0

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  894,108: then
  894,112: 
            Shadow[shade] = Shapes.AddImage(Path + "/SNE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1

  899,11: EndIf

124 CR_token2
  894,112: 


67 ID Idxs = Expr
  895,13: Shadow
  895,19: [shade]
  895,27: =
  895,29: Shapes.AddImage(Path + "/SNE.png")

184 [ Expr ]
  895,19: [
  895,20: shade
  895,25: ]

76 ID
  895,20: shade

245 ]
  895,25: ]

263 = Expr
  895,27: =
  895,29: Shapes.AddImage(Path + "/SNE.png")

55 ID . ID ( Exprs )
  895,29: Shapes
  895,35: .
  895,36: AddImage
  895,44: (
  895,45: Path + "/SNE.png"
  895,62: )

5 . ID ( Exprs )
  895,35: .
  895,36: AddImage
  895,44: (
  895,45: Path + "/SNE.png"
  895,62: )

260 ID ( Exprs )
  895,36: AddImage
  895,44: (
  895,45: Path + "/SNE.png"
  895,62: )

24 ( Exprs )
  895,44: (
  895,45: Path + "/SNE.png"
  895,62: )

26 ID
  895,45: Path

65 + MultiplicativeExpr
  895,50: +
  895,52: "/SNE.png"

141 STR
  895,52: "/SNE.png"

249 )
  895,62: )

207 CR_token2
  895,63: 


68 ID . ID ( Exprs )
  896,13: Shapes
  896,19: .
  896,20: Move
  896,24: (
  896,25: Shadow[shade], xv + 512, yv + 350
  896,58: )

184 . ID ( Exprs )
  896,19: .
  896,20: Move
  896,24: (
  896,25: Shadow[shade], xv + 512, yv + 350
  896,58: )

255 ID ( Exprs )
  896,20: Move
  896,24: (
  896,25: Shadow[shade], xv + 512, yv + 350
  896,58: )

221 ( Exprs )
  896,24: (
  896,25: Shadow[shade], xv + 512, yv + 350
  896,58: )

27 ID Idxs
  896,25: Shadow
  896,31: [shade]

4 [ Expr ]
  896,31: [
  896,32: shade
  896,37: ]

76 ID
  896,32: shade

245 ]
  896,37: ]

217 , MoreThanOneExpr
  896,38: ,
  896,40: xv + 512, yv + 350

54 ID
  896,40: xv

65 + MultiplicativeExpr
  896,43: +
  896,45: 512

141 NUM
  896,45: 512

217 , MoreThanOneExpr
  896,48: ,
  896,50: yv + 350

54 ID
  896,50: yv

65 + MultiplicativeExpr
  896,53: +
  896,55: 350

141 NUM
  896,55: 350

238 )
  896,58: )

207 CR_token2
  896,59: 


68 ID . ID ( Exprs )
  897,13: Shapes
  897,19: .
  897,20: Animate
  897,27: (
  897,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  897,88: )

184 . ID ( Exprs )
  897,19: .
  897,20: Animate
  897,27: (
  897,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  897,88: )

255 ID ( Exprs )
  897,20: Animate
  897,27: (
  897,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  897,88: )

221 ( Exprs )
  897,27: (
  897,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  897,88: )

27 ID Idxs
  897,28: Shadow
  897,34: [shade]

4 [ Expr ]
  897,34: [
  897,35: shade
  897,40: ]

76 ID
  897,35: shade

245 ]
  897,40: ]

217 , MoreThanOneExpr
  897,41: ,
  897,43: (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2

54 ( Expr )
  897,43: (
  897,44: x
  897,45: )

80 ID
  897,44: x

265 )
  897,45: )

50 * UnaryExpr
  897,47: *
  897,49: 50

156 NUM
  897,49: 50

65 + MultiplicativeExpr
  897,52: +
  897,54: korrx

141 ID
  897,54: korrx

217 , MoreThanOneExpr
  897,59: ,
  897,61: (y) * 40 + ky, animtime*1.2

54 ( Expr )
  897,61: (
  897,62: y
  897,63: )

80 ID
  897,62: y

265 )
  897,63: )

50 * UnaryExpr
  897,65: *
  897,67: 40

156 NUM
  897,67: 40

65 + MultiplicativeExpr
  897,70: +
  897,72: ky

141 ID
  897,72: ky

217 , MoreThanOneExpr
  897,74: ,
  897,76: animtime*1.2

54 ID
  897,76: animtime

50 * UnaryExpr
  897,84: *
  897,85: 1.2

156 NUM
  897,85: 1.2

238 )
  897,88: )

207 CR_token2
  897,93: 


68 ID = Expr
  898,13: shade
  898,19: =
  898,21: shade + 1

184 = Expr
  898,19: =
  898,21: shade + 1

70 ID
  898,21: shade

59 + MultiplicativeExpr
  898,27: +
  898,29: 1

144 NUM
  898,29: 1

207 CR_token2
  898,30: 


122 OptionalElse_token1
  899,11: EndIf

207 CR_token2
  899,16: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  900,11: If
  900,14: ground[y][x-1] = 3 and ground[y+1][x] = 3 and ground[y+1][x-1] <> 3 and ground[y+1][x-1] >= 0
  900,108: then
  900,112: 
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1

  905,11: EndIf

86 ID Idxs
  900,14: ground
  900,20: [y][x-1]

4 [ Expr ] Idxs
  900,20: [
  900,21: y
  900,22: ]
  900,23: [x-1]

76 ID
  900,21: y

245 ] Idxs
  900,22: ]
  900,23: [x-1]

7 [ Expr ]
  900,23: [
  900,24: x-1
  900,27: ]

76 ID
  900,24: x

65 - MultiplicativeExpr
  900,25: -
  900,26: 1

141 NUM
  900,26: 1

245 ]
  900,27: ]

128 = CompExpr
  900,29: =
  900,31: 3

117 NUM
  900,31: 3

167 AndExpr_token1 EqNeqExpr
  900,33: and
  900,37: ground[y+1][x] = 3

102 ID Idxs
  900,37: ground
  900,43: [y+1][x]

4 [ Expr ] Idxs
  900,43: [
  900,44: y+1
  900,47: ]
  900,48: [x]

76 ID
  900,44: y

65 + MultiplicativeExpr
  900,45: +
  900,46: 1

141 NUM
  900,46: 1

245 ] Idxs
  900,47: ]
  900,48: [x]

7 [ Expr ]
  900,48: [
  900,49: x
  900,50: ]

76 ID
  900,49: x

245 ]
  900,50: ]

134 = CompExpr
  900,52: =
  900,54: 3

117 NUM
  900,54: 3

167 AndExpr_token1 EqNeqExpr
  900,56: and
  900,60: ground[y+1][x-1] <> 3

102 ID Idxs
  900,60: ground
  900,66: [y+1][x-1]

4 [ Expr ] Idxs
  900,66: [
  900,67: y+1
  900,70: ]
  900,71: [x-1]

76 ID
  900,67: y

65 + MultiplicativeExpr
  900,68: +
  900,69: 1

141 NUM
  900,69: 1

245 ] Idxs
  900,70: ]
  900,71: [x-1]

7 [ Expr ]
  900,71: [
  900,72: x-1
  900,75: ]

76 ID
  900,72: x

65 - MultiplicativeExpr
  900,73: -
  900,74: 1

141 NUM
  900,74: 1

245 ]
  900,75: ]

134 <> CompExpr
  900,77: <>
  900,80: 3

117 NUM
  900,80: 3

167 AndExpr_token1 EqNeqExpr
  900,82: and
  900,86: ground[y+1][x-1] >= 0

102 ID Idxs
  900,86: ground
  900,92: [y+1][x-1]

4 [ Expr ] Idxs
  900,92: [
  900,93: y+1
  900,96: ]
  900,97: [x-1]

76 ID
  900,93: y

65 + MultiplicativeExpr
  900,94: +
  900,95: 1

141 NUM
  900,95: 1

245 ] Idxs
  900,96: ]
  900,97: [x-1]

7 [ Expr ]
  900,97: [
  900,98: x-1
  900,101: ]

76 ID
  900,98: x

65 - MultiplicativeExpr
  900,99: -
  900,100: 1

141 NUM
  900,100: 1

245 ]
  900,101: ]

91 >= AdditiveExpr
  900,103: >=
  900,106: 0

131 NUM
  900,106: 0

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  900,108: then
  900,112: 
            Shadow[shade] = Shapes.AddImage(Path + "/SSW.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)    
            shade = shade + 1

  905,11: EndIf

124 CR_token2
  900,112: 


67 ID Idxs = Expr
  901,13: Shadow
  901,19: [shade]
  901,27: =
  901,29: Shapes.AddImage(Path + "/SSW.png")

184 [ Expr ]
  901,19: [
  901,20: shade
  901,25: ]

76 ID
  901,20: shade

245 ]
  901,25: ]

263 = Expr
  901,27: =
  901,29: Shapes.AddImage(Path + "/SSW.png")

55 ID . ID ( Exprs )
  901,29: Shapes
  901,35: .
  901,36: AddImage
  901,44: (
  901,45: Path + "/SSW.png"
  901,62: )

5 . ID ( Exprs )
  901,35: .
  901,36: AddImage
  901,44: (
  901,45: Path + "/SSW.png"
  901,62: )

260 ID ( Exprs )
  901,36: AddImage
  901,44: (
  901,45: Path + "/SSW.png"
  901,62: )

24 ( Exprs )
  901,44: (
  901,45: Path + "/SSW.png"
  901,62: )

26 ID
  901,45: Path

65 + MultiplicativeExpr
  901,50: +
  901,52: "/SSW.png"

141 STR
  901,52: "/SSW.png"

249 )
  901,62: )

207 CR_token2
  901,63: 


68 ID . ID ( Exprs )
  902,13: Shapes
  902,19: .
  902,20: Move
  902,24: (
  902,25: Shadow[shade], xv + 512, yv + 350
  902,58: )

184 . ID ( Exprs )
  902,19: .
  902,20: Move
  902,24: (
  902,25: Shadow[shade], xv + 512, yv + 350
  902,58: )

255 ID ( Exprs )
  902,20: Move
  902,24: (
  902,25: Shadow[shade], xv + 512, yv + 350
  902,58: )

221 ( Exprs )
  902,24: (
  902,25: Shadow[shade], xv + 512, yv + 350
  902,58: )

27 ID Idxs
  902,25: Shadow
  902,31: [shade]

4 [ Expr ]
  902,31: [
  902,32: shade
  902,37: ]

76 ID
  902,32: shade

245 ]
  902,37: ]

217 , MoreThanOneExpr
  902,38: ,
  902,40: xv + 512, yv + 350

54 ID
  902,40: xv

65 + MultiplicativeExpr
  902,43: +
  902,45: 512

141 NUM
  902,45: 512

217 , MoreThanOneExpr
  902,48: ,
  902,50: yv + 350

54 ID
  902,50: yv

65 + MultiplicativeExpr
  902,53: +
  902,55: 350

141 NUM
  902,55: 350

238 )
  902,58: )

207 CR_token2
  902,59: 


68 ID . ID ( Exprs )
  903,13: Shapes
  903,19: .
  903,20: Animate
  903,27: (
  903,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  903,88: )

184 . ID ( Exprs )
  903,19: .
  903,20: Animate
  903,27: (
  903,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  903,88: )

255 ID ( Exprs )
  903,20: Animate
  903,27: (
  903,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  903,88: )

221 ( Exprs )
  903,27: (
  903,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  903,88: )

27 ID Idxs
  903,28: Shadow
  903,34: [shade]

4 [ Expr ]
  903,34: [
  903,35: shade
  903,40: ]

76 ID
  903,35: shade

245 ]
  903,40: ]

217 , MoreThanOneExpr
  903,41: ,
  903,43: (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2

54 ( Expr )
  903,43: (
  903,44: x
  903,45: )

80 ID
  903,44: x

265 )
  903,45: )

50 * UnaryExpr
  903,47: *
  903,49: 50

156 NUM
  903,49: 50

65 + MultiplicativeExpr
  903,52: +
  903,54: korrx

141 ID
  903,54: korrx

217 , MoreThanOneExpr
  903,59: ,
  903,61: (y) * 40 + ky, animtime*1.2

54 ( Expr )
  903,61: (
  903,62: y
  903,63: )

80 ID
  903,62: y

265 )
  903,63: )

50 * UnaryExpr
  903,65: *
  903,67: 40

156 NUM
  903,67: 40

65 + MultiplicativeExpr
  903,70: +
  903,72: ky

141 ID
  903,72: ky

217 , MoreThanOneExpr
  903,74: ,
  903,76: animtime*1.2

54 ID
  903,76: animtime

50 * UnaryExpr
  903,84: *
  903,85: 1.2

156 NUM
  903,85: 1.2

238 )
  903,88: )

207 CR_token2
  903,93: 


68 ID = Expr
  904,13: shade
  904,19: =
  904,21: shade + 1

184 = Expr
  904,19: =
  904,21: shade + 1

70 ID
  904,21: shade

59 + MultiplicativeExpr
  904,27: +
  904,29: 1

144 NUM
  904,29: 1

207 CR_token2
  904,30: 


122 OptionalElse_token1
  905,11: EndIf

207 CR_token2
  905,16: 


68 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  906,11: If
  906,14: ground[y][x+1] = 3 and ground[y+1][x] = 3 and ground[y+1][x+1] <> 3 and ground[y+1][x+1] >= 0
  906,108: then
  906,112: 
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1

  911,11: EndIf

86 ID Idxs
  906,14: ground
  906,20: [y][x+1]

4 [ Expr ] Idxs
  906,20: [
  906,21: y
  906,22: ]
  906,23: [x+1]

76 ID
  906,21: y

245 ] Idxs
  906,22: ]
  906,23: [x+1]

7 [ Expr ]
  906,23: [
  906,24: x+1
  906,27: ]

76 ID
  906,24: x

65 + MultiplicativeExpr
  906,25: +
  906,26: 1

141 NUM
  906,26: 1

245 ]
  906,27: ]

128 = CompExpr
  906,29: =
  906,31: 3

117 NUM
  906,31: 3

167 AndExpr_token1 EqNeqExpr
  906,33: and
  906,37: ground[y+1][x] = 3

102 ID Idxs
  906,37: ground
  906,43: [y+1][x]

4 [ Expr ] Idxs
  906,43: [
  906,44: y+1
  906,47: ]
  906,48: [x]

76 ID
  906,44: y

65 + MultiplicativeExpr
  906,45: +
  906,46: 1

141 NUM
  906,46: 1

245 ] Idxs
  906,47: ]
  906,48: [x]

7 [ Expr ]
  906,48: [
  906,49: x
  906,50: ]

76 ID
  906,49: x

245 ]
  906,50: ]

134 = CompExpr
  906,52: =
  906,54: 3

117 NUM
  906,54: 3

167 AndExpr_token1 EqNeqExpr
  906,56: and
  906,60: ground[y+1][x+1] <> 3

102 ID Idxs
  906,60: ground
  906,66: [y+1][x+1]

4 [ Expr ] Idxs
  906,66: [
  906,67: y+1
  906,70: ]
  906,71: [x+1]

76 ID
  906,67: y

65 + MultiplicativeExpr
  906,68: +
  906,69: 1

141 NUM
  906,69: 1

245 ] Idxs
  906,70: ]
  906,71: [x+1]

7 [ Expr ]
  906,71: [
  906,72: x+1
  906,75: ]

76 ID
  906,72: x

65 + MultiplicativeExpr
  906,73: +
  906,74: 1

141 NUM
  906,74: 1

245 ]
  906,75: ]

134 <> CompExpr
  906,77: <>
  906,80: 3

117 NUM
  906,80: 3

167 AndExpr_token1 EqNeqExpr
  906,82: and
  906,86: ground[y+1][x+1] >= 0

102 ID Idxs
  906,86: ground
  906,92: [y+1][x+1]

4 [ Expr ] Idxs
  906,92: [
  906,93: y+1
  906,96: ]
  906,97: [x+1]

76 ID
  906,93: y

65 + MultiplicativeExpr
  906,94: +
  906,95: 1

141 NUM
  906,95: 1

245 ] Idxs
  906,96: ]
  906,97: [x+1]

7 [ Expr ]
  906,97: [
  906,98: x+1
  906,101: ]

76 ID
  906,98: x

65 + MultiplicativeExpr
  906,99: +
  906,100: 1

141 NUM
  906,100: 1

245 ]
  906,101: ]

91 >= AdditiveExpr
  906,103: >=
  906,106: 0

131 NUM
  906,106: 0

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  906,108: then
  906,112: 
            Shadow[shade] = Shapes.AddImage(Path + "/SSE.png")
            Shapes.Move(Shadow[shade], xv + 512, yv + 350)
            Shapes.Animate(Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2)     
            shade = shade + 1

  911,11: EndIf

124 CR_token2
  906,112: 


67 ID Idxs = Expr
  907,13: Shadow
  907,19: [shade]
  907,27: =
  907,29: Shapes.AddImage(Path + "/SSE.png")

184 [ Expr ]
  907,19: [
  907,20: shade
  907,25: ]

76 ID
  907,20: shade

245 ]
  907,25: ]

263 = Expr
  907,27: =
  907,29: Shapes.AddImage(Path + "/SSE.png")

55 ID . ID ( Exprs )
  907,29: Shapes
  907,35: .
  907,36: AddImage
  907,44: (
  907,45: Path + "/SSE.png"
  907,62: )

5 . ID ( Exprs )
  907,35: .
  907,36: AddImage
  907,44: (
  907,45: Path + "/SSE.png"
  907,62: )

260 ID ( Exprs )
  907,36: AddImage
  907,44: (
  907,45: Path + "/SSE.png"
  907,62: )

24 ( Exprs )
  907,44: (
  907,45: Path + "/SSE.png"
  907,62: )

26 ID
  907,45: Path

65 + MultiplicativeExpr
  907,50: +
  907,52: "/SSE.png"

141 STR
  907,52: "/SSE.png"

249 )
  907,62: )

207 CR_token2
  907,63: 


68 ID . ID ( Exprs )
  908,13: Shapes
  908,19: .
  908,20: Move
  908,24: (
  908,25: Shadow[shade], xv + 512, yv + 350
  908,58: )

184 . ID ( Exprs )
  908,19: .
  908,20: Move
  908,24: (
  908,25: Shadow[shade], xv + 512, yv + 350
  908,58: )

255 ID ( Exprs )
  908,20: Move
  908,24: (
  908,25: Shadow[shade], xv + 512, yv + 350
  908,58: )

221 ( Exprs )
  908,24: (
  908,25: Shadow[shade], xv + 512, yv + 350
  908,58: )

27 ID Idxs
  908,25: Shadow
  908,31: [shade]

4 [ Expr ]
  908,31: [
  908,32: shade
  908,37: ]

76 ID
  908,32: shade

245 ]
  908,37: ]

217 , MoreThanOneExpr
  908,38: ,
  908,40: xv + 512, yv + 350

54 ID
  908,40: xv

65 + MultiplicativeExpr
  908,43: +
  908,45: 512

141 NUM
  908,45: 512

217 , MoreThanOneExpr
  908,48: ,
  908,50: yv + 350

54 ID
  908,50: yv

65 + MultiplicativeExpr
  908,53: +
  908,55: 350

141 NUM
  908,55: 350

238 )
  908,58: )

207 CR_token2
  908,59: 


68 ID . ID ( Exprs )
  909,13: Shapes
  909,19: .
  909,20: Animate
  909,27: (
  909,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  909,88: )

184 . ID ( Exprs )
  909,19: .
  909,20: Animate
  909,27: (
  909,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  909,88: )

255 ID ( Exprs )
  909,20: Animate
  909,27: (
  909,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  909,88: )

221 ( Exprs )
  909,27: (
  909,28: Shadow[shade], (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2
  909,88: )

27 ID Idxs
  909,28: Shadow
  909,34: [shade]

4 [ Expr ]
  909,34: [
  909,35: shade
  909,40: ]

76 ID
  909,35: shade

245 ]
  909,40: ]

217 , MoreThanOneExpr
  909,41: ,
  909,43: (x) * 50 + korrx, (y) * 40 + ky, animtime*1.2

54 ( Expr )
  909,43: (
  909,44: x
  909,45: )

80 ID
  909,44: x

265 )
  909,45: )

50 * UnaryExpr
  909,47: *
  909,49: 50

156 NUM
  909,49: 50

65 + MultiplicativeExpr
  909,52: +
  909,54: korrx

141 ID
  909,54: korrx

217 , MoreThanOneExpr
  909,59: ,
  909,61: (y) * 40 + ky, animtime*1.2

54 ( Expr )
  909,61: (
  909,62: y
  909,63: )

80 ID
  909,62: y

265 )
  909,63: )

50 * UnaryExpr
  909,65: *
  909,67: 40

156 NUM
  909,67: 40

65 + MultiplicativeExpr
  909,70: +
  909,72: ky

141 ID
  909,72: ky

217 , MoreThanOneExpr
  909,74: ,
  909,76: animtime*1.2

54 ID
  909,76: animtime

50 * UnaryExpr
  909,84: *
  909,85: 1.2

156 NUM
  909,85: 1.2

238 )
  909,88: )

207 CR_token2
  909,94: 


68 ID = Expr
  910,13: shade
  910,19: =
  910,21: shade + 1

184 = Expr
  910,19: =
  910,21: shade + 1

70 ID
  910,21: shade

59 + MultiplicativeExpr
  910,27: +
  910,29: 1

144 NUM
  910,29: 1

207 CR_token2
  910,30: 


122 OptionalElse_token1
  911,11: EndIf

207 CR_token2
  911,16: 


122 OptionalElse_token1
  912,8: endif

203 CR_token2
  912,13: 


177 Stmt_token6
  913,5: EndFor

203 CR_token2
  913,11: 


177 Stmt_token6
  914,3: EndFor

206 CR_token2
  914,12: 



257 Stmt_token8
  916,1: EndSub

97 Stmt_token7 ID CRStmtCRs Stmt_token8
  918,1: Sub
  918,5: InitStars
  918,14: 
  For i = 0 To 12
    star[i] = Shapes.AddImage(Path + "/sokocutels.png")  
    heart[i] = Shapes.AddImage(Path + "/sokocutelh.png") 
  endFor

  923,1: EndSub

244 ID CRStmtCRs Stmt_token8
  918,5: InitStars
  918,14: 
  For i = 0 To 12
    star[i] = Shapes.AddImage(Path + "/sokocutels.png")  
    heart[i] = Shapes.AddImage(Path + "/sokocutelh.png") 
  endFor

  923,1: EndSub

199 CR_token2
  918,14: 


105 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  919,3: For
  919,7: i
  919,9: =
  919,11: 0
  919,13: To
  919,16: 12
  919,18: 
    star[i] = Shapes.AddImage(Path + "/sokocutels.png")  
    heart[i] = Shapes.AddImage(Path + "/sokocutelh.png") 

  922,3: endFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  919,7: i
  919,9: =
  919,11: 0
  919,13: To
  919,16: 12
  919,18: 
    star[i] = Shapes.AddImage(Path + "/sokocutels.png")  
    heart[i] = Shapes.AddImage(Path + "/sokocutelh.png") 

  922,3: endFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  919,9: =
  919,11: 0
  919,13: To
  919,16: 12
  919,18: 
    star[i] = Shapes.AddImage(Path + "/sokocutels.png")  
    heart[i] = Shapes.AddImage(Path + "/sokocutelh.png") 

  922,3: endFor

56 NUM
  919,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  919,13: To
  919,16: 12
  919,18: 
    star[i] = Shapes.AddImage(Path + "/sokocutels.png")  
    heart[i] = Shapes.AddImage(Path + "/sokocutelh.png") 

  922,3: endFor

83 NUM
  919,16: 12

145 CR_token2
  919,18: 


88 ID Idxs = Expr
  920,5: star
  920,9: [i]
  920,13: =
  920,15: Shapes.AddImage(Path + "/sokocutels.png")

184 [ Expr ]
  920,9: [
  920,10: i
  920,11: ]

76 ID
  920,10: i

245 ]
  920,11: ]

263 = Expr
  920,13: =
  920,15: Shapes.AddImage(Path + "/sokocutels.png")

55 ID . ID ( Exprs )
  920,15: Shapes
  920,21: .
  920,22: AddImage
  920,30: (
  920,31: Path + "/sokocutels.png"
  920,55: )

5 . ID ( Exprs )
  920,21: .
  920,22: AddImage
  920,30: (
  920,31: Path + "/sokocutels.png"
  920,55: )

260 ID ( Exprs )
  920,22: AddImage
  920,30: (
  920,31: Path + "/sokocutels.png"
  920,55: )

24 ( Exprs )
  920,30: (
  920,31: Path + "/sokocutels.png"
  920,55: )

26 ID
  920,31: Path

65 + MultiplicativeExpr
  920,36: +
  920,38: "/sokocutels.png"

141 STR
  920,38: "/sokocutels.png"

249 )
  920,55: )

203 CR_token2
  920,58: 


96 ID Idxs = Expr
  921,5: heart
  921,10: [i]
  921,14: =
  921,16: Shapes.AddImage(Path + "/sokocutelh.png")

184 [ Expr ]
  921,10: [
  921,11: i
  921,12: ]

76 ID
  921,11: i

245 ]
  921,12: ]

263 = Expr
  921,14: =
  921,16: Shapes.AddImage(Path + "/sokocutelh.png")

55 ID . ID ( Exprs )
  921,16: Shapes
  921,22: .
  921,23: AddImage
  921,31: (
  921,32: Path + "/sokocutelh.png"
  921,56: )

5 . ID ( Exprs )
  921,22: .
  921,23: AddImage
  921,31: (
  921,32: Path + "/sokocutelh.png"
  921,56: )

260 ID ( Exprs )
  921,23: AddImage
  921,31: (
  921,32: Path + "/sokocutelh.png"
  921,56: )

24 ( Exprs )
  921,31: (
  921,32: Path + "/sokocutelh.png"
  921,56: )

26 ID
  921,32: Path

65 + MultiplicativeExpr
  921,37: +
  921,39: "/sokocutelh.png"

141 STR
  921,39: "/sokocutelh.png"

249 )
  921,56: )

203 CR_token2
  921,58: 


177 Stmt_token6
  922,3: endFor

206 CR_token2
  922,9: 


257 Stmt_token8
  923,1: EndSub

97 Stmt_token7 ID CRStmtCRs Stmt_token8
  926,1: Sub
  926,5: ResetStars
  926,15: 
  For i = 0 To 12
    angle = Math.GetRandomNumber(360)
    starxv[i] = Math.Cos(angle * 0.0174) * 0.50
    staryv[i] = Math.Sin(angle * 0.0174) * 0.50    
    starx[i] = 1000
    stary[i] = 1000   
    startime[i] = Math.GetRandomNumber(100)
    Shapes.Move(star[i], starx[i], stary[i])  
  endFor
  For i = 0 To 12
   angle = Math.GetRandomNumber(360)
   heartxv[i] = Math.Cos(angle * 0.0174) * 0.50
   heartyv[i] = Math.Sin(angle * 0.0174) * 0.50    
   heartx[i] = 1000
   hearty[i] = 1000   
   hearttime[i] = Math.GetRandomNumber(100)
   Shapes.Move(heart[i], heartx[i], hearty[i])  
 endFor

  945,1: EndSub

244 ID CRStmtCRs Stmt_token8
  926,5: ResetStars
  926,15: 
  For i = 0 To 12
    angle = Math.GetRandomNumber(360)
    starxv[i] = Math.Cos(angle * 0.0174) * 0.50
    staryv[i] = Math.Sin(angle * 0.0174) * 0.50    
    starx[i] = 1000
    stary[i] = 1000   
    startime[i] = Math.GetRandomNumber(100)
    Shapes.Move(star[i], starx[i], stary[i])  
  endFor
  For i = 0 To 12
   angle = Math.GetRandomNumber(360)
   heartxv[i] = Math.Cos(angle * 0.0174) * 0.50
   heartyv[i] = Math.Sin(angle * 0.0174) * 0.50    
   heartx[i] = 1000
   hearty[i] = 1000   
   hearttime[i] = Math.GetRandomNumber(100)
   Shapes.Move(heart[i], heartx[i], hearty[i])  
 endFor

  945,1: EndSub

199 CR_token2
  926,15: 


105 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  927,3: For
  927,7: i
  927,9: =
  927,11: 0
  927,13: To
  927,16: 12
  927,18: 
    angle = Math.GetRandomNumber(360)
    starxv[i] = Math.Cos(angle * 0.0174) * 0.50
    staryv[i] = Math.Sin(angle * 0.0174) * 0.50    
    starx[i] = 1000
    stary[i] = 1000   
    startime[i] = Math.GetRandomNumber(100)
    Shapes.Move(star[i], starx[i], stary[i])  

  935,3: endFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  927,7: i
  927,9: =
  927,11: 0
  927,13: To
  927,16: 12
  927,18: 
    angle = Math.GetRandomNumber(360)
    starxv[i] = Math.Cos(angle * 0.0174) * 0.50
    staryv[i] = Math.Sin(angle * 0.0174) * 0.50    
    starx[i] = 1000
    stary[i] = 1000   
    startime[i] = Math.GetRandomNumber(100)
    Shapes.Move(star[i], starx[i], stary[i])  

  935,3: endFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  927,9: =
  927,11: 0
  927,13: To
  927,16: 12
  927,18: 
    angle = Math.GetRandomNumber(360)
    starxv[i] = Math.Cos(angle * 0.0174) * 0.50
    staryv[i] = Math.Sin(angle * 0.0174) * 0.50    
    starx[i] = 1000
    stary[i] = 1000   
    startime[i] = Math.GetRandomNumber(100)
    Shapes.Move(star[i], starx[i], stary[i])  

  935,3: endFor

56 NUM
  927,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  927,13: To
  927,16: 12
  927,18: 
    angle = Math.GetRandomNumber(360)
    starxv[i] = Math.Cos(angle * 0.0174) * 0.50
    staryv[i] = Math.Sin(angle * 0.0174) * 0.50    
    starx[i] = 1000
    stary[i] = 1000   
    startime[i] = Math.GetRandomNumber(100)
    Shapes.Move(star[i], starx[i], stary[i])  

  935,3: endFor

83 NUM
  927,16: 12

145 CR_token2
  927,18: 


88 ID = Expr
  928,5: angle
  928,11: =
  928,13: Math.GetRandomNumber(360)

184 = Expr
  928,11: =
  928,13: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  928,13: Math
  928,17: .
  928,18: GetRandomNumber
  928,33: (
  928,34: 360
  928,37: )

5 . ID ( Exprs )
  928,17: .
  928,18: GetRandomNumber
  928,33: (
  928,34: 360
  928,37: )

260 ID ( Exprs )
  928,18: GetRandomNumber
  928,33: (
  928,34: 360
  928,37: )

24 ( Exprs )
  928,33: (
  928,34: 360
  928,37: )

26 NUM
  928,34: 360

249 )
  928,37: )

203 CR_token2
  928,38: 


96 ID Idxs = Expr
  929,5: starxv
  929,11: [i]
  929,15: =
  929,17: Math.Cos(angle * 0.0174) * 0.50

184 [ Expr ]
  929,11: [
  929,12: i
  929,13: ]

76 ID
  929,12: i

245 ]
  929,13: ]

263 = Expr
  929,15: =
  929,17: Math.Cos(angle * 0.0174) * 0.50

55 ID . ID ( Exprs )
  929,17: Math
  929,21: .
  929,22: Cos
  929,25: (
  929,26: angle * 0.0174
  929,40: )

5 . ID ( Exprs )
  929,21: .
  929,22: Cos
  929,25: (
  929,26: angle * 0.0174
  929,40: )

260 ID ( Exprs )
  929,22: Cos
  929,25: (
  929,26: angle * 0.0174
  929,40: )

24 ( Exprs )
  929,25: (
  929,26: angle * 0.0174
  929,40: )

26 ID
  929,26: angle

50 * UnaryExpr
  929,32: *
  929,34: 0.0174

156 NUM
  929,34: 0.0174

249 )
  929,40: )

48 * UnaryExpr
  929,42: *
  929,44: 0.50

157 NUM
  929,44: 0.50

203 CR_token2
  929,48: 


96 ID Idxs = Expr
  930,5: staryv
  930,11: [i]
  930,15: =
  930,17: Math.Sin(angle * 0.0174) * 0.50

184 [ Expr ]
  930,11: [
  930,12: i
  930,13: ]

76 ID
  930,12: i

245 ]
  930,13: ]

263 = Expr
  930,15: =
  930,17: Math.Sin(angle * 0.0174) * 0.50

55 ID . ID ( Exprs )
  930,17: Math
  930,21: .
  930,22: Sin
  930,25: (
  930,26: angle * 0.0174
  930,40: )

5 . ID ( Exprs )
  930,21: .
  930,22: Sin
  930,25: (
  930,26: angle * 0.0174
  930,40: )

260 ID ( Exprs )
  930,22: Sin
  930,25: (
  930,26: angle * 0.0174
  930,40: )

24 ( Exprs )
  930,25: (
  930,26: angle * 0.0174
  930,40: )

26 ID
  930,26: angle

50 * UnaryExpr
  930,32: *
  930,34: 0.0174

156 NUM
  930,34: 0.0174

249 )
  930,40: )

48 * UnaryExpr
  930,42: *
  930,44: 0.50

157 NUM
  930,44: 0.50

203 CR_token2
  930,52: 


96 ID Idxs = Expr
  931,5: starx
  931,10: [i]
  931,14: =
  931,16: 1000

184 [ Expr ]
  931,10: [
  931,11: i
  931,12: ]

76 ID
  931,11: i

245 ]
  931,12: ]

263 = Expr
  931,14: =
  931,16: 1000

55 NUM
  931,16: 1000

203 CR_token2
  931,20: 


96 ID Idxs = Expr
  932,5: stary
  932,10: [i]
  932,14: =
  932,16: 1000

184 [ Expr ]
  932,10: [
  932,11: i
  932,12: ]

76 ID
  932,11: i

245 ]
  932,12: ]

263 = Expr
  932,14: =
  932,16: 1000

55 NUM
  932,16: 1000

203 CR_token2
  932,23: 


96 ID Idxs = Expr
  933,5: startime
  933,13: [i]
  933,17: =
  933,19: Math.GetRandomNumber(100)

184 [ Expr ]
  933,13: [
  933,14: i
  933,15: ]

76 ID
  933,14: i

245 ]
  933,15: ]

263 = Expr
  933,17: =
  933,19: Math.GetRandomNumber(100)

55 ID . ID ( Exprs )
  933,19: Math
  933,23: .
  933,24: GetRandomNumber
  933,39: (
  933,40: 100
  933,43: )

5 . ID ( Exprs )
  933,23: .
  933,24: GetRandomNumber
  933,39: (
  933,40: 100
  933,43: )

260 ID ( Exprs )
  933,24: GetRandomNumber
  933,39: (
  933,40: 100
  933,43: )

24 ( Exprs )
  933,39: (
  933,40: 100
  933,43: )

26 NUM
  933,40: 100

249 )
  933,43: )

203 CR_token2
  933,44: 


96 ID . ID ( Exprs )
  934,5: Shapes
  934,11: .
  934,12: Move
  934,16: (
  934,17: star[i], starx[i], stary[i]
  934,44: )

184 . ID ( Exprs )
  934,11: .
  934,12: Move
  934,16: (
  934,17: star[i], starx[i], stary[i]
  934,44: )

255 ID ( Exprs )
  934,12: Move
  934,16: (
  934,17: star[i], starx[i], stary[i]
  934,44: )

221 ( Exprs )
  934,16: (
  934,17: star[i], starx[i], stary[i]
  934,44: )

27 ID Idxs
  934,17: star
  934,21: [i]

4 [ Expr ]
  934,21: [
  934,22: i
  934,23: ]

76 ID
  934,22: i

245 ]
  934,23: ]

217 , MoreThanOneExpr
  934,24: ,
  934,26: starx[i], stary[i]

54 ID Idxs
  934,26: starx
  934,31: [i]

4 [ Expr ]
  934,31: [
  934,32: i
  934,33: ]

76 ID
  934,32: i

245 ]
  934,33: ]

217 , MoreThanOneExpr
  934,34: ,
  934,36: stary[i]

54 ID Idxs
  934,36: stary
  934,41: [i]

4 [ Expr ]
  934,41: [
  934,42: i
  934,43: ]

76 ID
  934,42: i

245 ]
  934,43: ]

238 )
  934,44: )

203 CR_token2
  934,47: 


177 Stmt_token6
  935,3: endFor

206 CR_token2
  935,9: 


106 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  936,3: For
  936,7: i
  936,9: =
  936,11: 0
  936,13: To
  936,16: 12
  936,18: 
   angle = Math.GetRandomNumber(360)
   heartxv[i] = Math.Cos(angle * 0.0174) * 0.50
   heartyv[i] = Math.Sin(angle * 0.0174) * 0.50    
   heartx[i] = 1000
   hearty[i] = 1000   
   hearttime[i] = Math.GetRandomNumber(100)
   Shapes.Move(heart[i], heartx[i], hearty[i])  

  944,2: endFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  936,7: i
  936,9: =
  936,11: 0
  936,13: To
  936,16: 12
  936,18: 
   angle = Math.GetRandomNumber(360)
   heartxv[i] = Math.Cos(angle * 0.0174) * 0.50
   heartyv[i] = Math.Sin(angle * 0.0174) * 0.50    
   heartx[i] = 1000
   hearty[i] = 1000   
   hearttime[i] = Math.GetRandomNumber(100)
   Shapes.Move(heart[i], heartx[i], hearty[i])  

  944,2: endFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  936,9: =
  936,11: 0
  936,13: To
  936,16: 12
  936,18: 
   angle = Math.GetRandomNumber(360)
   heartxv[i] = Math.Cos(angle * 0.0174) * 0.50
   heartyv[i] = Math.Sin(angle * 0.0174) * 0.50    
   heartx[i] = 1000
   hearty[i] = 1000   
   hearttime[i] = Math.GetRandomNumber(100)
   Shapes.Move(heart[i], heartx[i], hearty[i])  

  944,2: endFor

56 NUM
  936,11: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  936,13: To
  936,16: 12
  936,18: 
   angle = Math.GetRandomNumber(360)
   heartxv[i] = Math.Cos(angle * 0.0174) * 0.50
   heartyv[i] = Math.Sin(angle * 0.0174) * 0.50    
   heartx[i] = 1000
   hearty[i] = 1000   
   hearttime[i] = Math.GetRandomNumber(100)
   Shapes.Move(heart[i], heartx[i], hearty[i])  

  944,2: endFor

83 NUM
  936,16: 12

145 CR_token2
  936,18: 


88 ID = Expr
  937,4: angle
  937,10: =
  937,12: Math.GetRandomNumber(360)

184 = Expr
  937,10: =
  937,12: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  937,12: Math
  937,16: .
  937,17: GetRandomNumber
  937,32: (
  937,33: 360
  937,36: )

5 . ID ( Exprs )
  937,16: .
  937,17: GetRandomNumber
  937,32: (
  937,33: 360
  937,36: )

260 ID ( Exprs )
  937,17: GetRandomNumber
  937,32: (
  937,33: 360
  937,36: )

24 ( Exprs )
  937,32: (
  937,33: 360
  937,36: )

26 NUM
  937,33: 360

249 )
  937,36: )

203 CR_token2
  937,37: 


96 ID Idxs = Expr
  938,4: heartxv
  938,11: [i]
  938,15: =
  938,17: Math.Cos(angle * 0.0174) * 0.50

184 [ Expr ]
  938,11: [
  938,12: i
  938,13: ]

76 ID
  938,12: i

245 ]
  938,13: ]

263 = Expr
  938,15: =
  938,17: Math.Cos(angle * 0.0174) * 0.50

55 ID . ID ( Exprs )
  938,17: Math
  938,21: .
  938,22: Cos
  938,25: (
  938,26: angle * 0.0174
  938,40: )

5 . ID ( Exprs )
  938,21: .
  938,22: Cos
  938,25: (
  938,26: angle * 0.0174
  938,40: )

260 ID ( Exprs )
  938,22: Cos
  938,25: (
  938,26: angle * 0.0174
  938,40: )

24 ( Exprs )
  938,25: (
  938,26: angle * 0.0174
  938,40: )

26 ID
  938,26: angle

50 * UnaryExpr
  938,32: *
  938,34: 0.0174

156 NUM
  938,34: 0.0174

249 )
  938,40: )

48 * UnaryExpr
  938,42: *
  938,44: 0.50

157 NUM
  938,44: 0.50

203 CR_token2
  938,48: 


96 ID Idxs = Expr
  939,4: heartyv
  939,11: [i]
  939,15: =
  939,17: Math.Sin(angle * 0.0174) * 0.50

184 [ Expr ]
  939,11: [
  939,12: i
  939,13: ]

76 ID
  939,12: i

245 ]
  939,13: ]

263 = Expr
  939,15: =
  939,17: Math.Sin(angle * 0.0174) * 0.50

55 ID . ID ( Exprs )
  939,17: Math
  939,21: .
  939,22: Sin
  939,25: (
  939,26: angle * 0.0174
  939,40: )

5 . ID ( Exprs )
  939,21: .
  939,22: Sin
  939,25: (
  939,26: angle * 0.0174
  939,40: )

260 ID ( Exprs )
  939,22: Sin
  939,25: (
  939,26: angle * 0.0174
  939,40: )

24 ( Exprs )
  939,25: (
  939,26: angle * 0.0174
  939,40: )

26 ID
  939,26: angle

50 * UnaryExpr
  939,32: *
  939,34: 0.0174

156 NUM
  939,34: 0.0174

249 )
  939,40: )

48 * UnaryExpr
  939,42: *
  939,44: 0.50

157 NUM
  939,44: 0.50

203 CR_token2
  939,52: 


96 ID Idxs = Expr
  940,4: heartx
  940,10: [i]
  940,14: =
  940,16: 1000

184 [ Expr ]
  940,10: [
  940,11: i
  940,12: ]

76 ID
  940,11: i

245 ]
  940,12: ]

263 = Expr
  940,14: =
  940,16: 1000

55 NUM
  940,16: 1000

203 CR_token2
  940,20: 


96 ID Idxs = Expr
  941,4: hearty
  941,10: [i]
  941,14: =
  941,16: 1000

184 [ Expr ]
  941,10: [
  941,11: i
  941,12: ]

76 ID
  941,11: i

245 ]
  941,12: ]

263 = Expr
  941,14: =
  941,16: 1000

55 NUM
  941,16: 1000

203 CR_token2
  941,23: 


96 ID Idxs = Expr
  942,4: hearttime
  942,13: [i]
  942,17: =
  942,19: Math.GetRandomNumber(100)

184 [ Expr ]
  942,13: [
  942,14: i
  942,15: ]

76 ID
  942,14: i

245 ]
  942,15: ]

263 = Expr
  942,17: =
  942,19: Math.GetRandomNumber(100)

55 ID . ID ( Exprs )
  942,19: Math
  942,23: .
  942,24: GetRandomNumber
  942,39: (
  942,40: 100
  942,43: )

5 . ID ( Exprs )
  942,23: .
  942,24: GetRandomNumber
  942,39: (
  942,40: 100
  942,43: )

260 ID ( Exprs )
  942,24: GetRandomNumber
  942,39: (
  942,40: 100
  942,43: )

24 ( Exprs )
  942,39: (
  942,40: 100
  942,43: )

26 NUM
  942,40: 100

249 )
  942,43: )

203 CR_token2
  942,44: 


96 ID . ID ( Exprs )
  943,4: Shapes
  943,10: .
  943,11: Move
  943,15: (
  943,16: heart[i], heartx[i], hearty[i]
  943,46: )

184 . ID ( Exprs )
  943,10: .
  943,11: Move
  943,15: (
  943,16: heart[i], heartx[i], hearty[i]
  943,46: )

255 ID ( Exprs )
  943,11: Move
  943,15: (
  943,16: heart[i], heartx[i], hearty[i]
  943,46: )

221 ( Exprs )
  943,15: (
  943,16: heart[i], heartx[i], hearty[i]
  943,46: )

27 ID Idxs
  943,16: heart
  943,21: [i]

4 [ Expr ]
  943,21: [
  943,22: i
  943,23: ]

76 ID
  943,22: i

245 ]
  943,23: ]

217 , MoreThanOneExpr
  943,24: ,
  943,26: heartx[i], hearty[i]

54 ID Idxs
  943,26: heartx
  943,32: [i]

4 [ Expr ]
  943,32: [
  943,33: i
  943,34: ]

76 ID
  943,33: i

245 ]
  943,34: ]

217 , MoreThanOneExpr
  943,35: ,
  943,37: hearty[i]

54 ID Idxs
  943,37: hearty
  943,43: [i]

4 [ Expr ]
  943,43: [
  943,44: i
  943,45: ]

76 ID
  943,44: i

245 ]
  943,45: ]

238 )
  943,46: )

203 CR_token2
  943,49: 


177 Stmt_token6
  944,2: endFor

206 CR_token2
  944,8: 


257 Stmt_token8
  945,1: EndSub

101 Prog
  946,1: 
' move stars and hearts
Sub MoveStars
  
      For i = 0 to 12
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      
    EndFor  
    
    
    For i = 0 to 12
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Rotate(heart[i], hearttime[i] * -10)
      Shapes.Zoom(heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32) )
      Shapes.Move(heart[i], heartx[i], hearty[i])    

97 Stmt_token7 ID CRStmtCRs Stmt_token8
  948,1: Sub
  948,5: MoveStars
  948,14: 
  
      For i = 0 to 12
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      
    EndFor  
    
    
    For i = 0 to 12
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Rotate(heart[i], hearttime[i] * -10)
      Shapes.Zoom(heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32) )
      Shapes.Move(heart[i], heartx[i], hearty[i])      
    EndFor  

  989,1: EndSub

244 ID CRStmtCRs Stmt_token8
  948,5: MoveStars
  948,14: 
  
      For i = 0 to 12
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      
    EndFor  
    
    
    For i = 0 to 12
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Rotate(heart[i], hearttime[i] * -10)
      Shapes.Zoom(heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32) )
      Shapes.Move(heart[i], heartx[i], hearty[i])      
    EndFor  

  989,1: EndSub

199 CR_token2
  948,14: 


105 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  950,7: For
  950,11: i
  950,13: =
  950,15: 0
  950,17: to
  950,20: 12
  950,22: 
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      

  967,5: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  950,11: i
  950,13: =
  950,15: 0
  950,17: to
  950,20: 12
  950,22: 
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      

  967,5: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  950,13: =
  950,15: 0
  950,17: to
  950,20: 12
  950,22: 
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      

  967,5: EndFor

56 NUM
  950,15: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  950,17: to
  950,20: 12
  950,22: 
      If startime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     
      EndIf
      startime[i] = startime[i] + 0.20
      staryv[i] = staryv[i] + 0.005
      starx[i] = starx[i] + starxv[i]
      stary[i] = stary[i] + staryv[i]
      Shapes.Rotate(star[i], startime[i] * 15)
      Shapes.Zoom(star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32) )
      Shapes.Move(star[i], starx[i], stary[i])      

  967,5: EndFor

83 NUM
  950,20: 12

145 CR_token2
  950,22: 


88 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  951,7: If
  951,10: startime[i] > 100
  951,28: then
  951,32: 
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     

  959,7: EndIf

86 ID Idxs
  951,10: startime
  951,18: [i]

4 [ Expr ]
  951,18: [
  951,19: i
  951,20: ]

76 ID
  951,19: i

245 ]
  951,20: ]

91 > AdditiveExpr
  951,22: >
  951,24: 100

131 NUM
  951,24: 100

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  951,28: then
  951,32: 
        angle = Math.GetRandomNumber(360) 
        starxv[i] = Math.Cos(angle * 0.0174) 
        staryv[i] = Math.Sin(angle * 0.0174)    
        starx[i] = 500 + 20
        stary[i] = 150
        Shapes.Move(star[i], starx[i] , stary[i])
        startime[i] = 0     

  959,7: EndIf

124 CR_token2
  951,32: 


67 ID = Expr
  952,9: angle
  952,15: =
  952,17: Math.GetRandomNumber(360)

184 = Expr
  952,15: =
  952,17: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  952,17: Math
  952,21: .
  952,22: GetRandomNumber
  952,37: (
  952,38: 360
  952,41: )

5 . ID ( Exprs )
  952,21: .
  952,22: GetRandomNumber
  952,37: (
  952,38: 360
  952,41: )

260 ID ( Exprs )
  952,22: GetRandomNumber
  952,37: (
  952,38: 360
  952,41: )

24 ( Exprs )
  952,37: (
  952,38: 360
  952,41: )

26 NUM
  952,38: 360

249 )
  952,41: )

207 CR_token2
  952,43: 


68 ID Idxs = Expr
  953,9: starxv
  953,15: [i]
  953,19: =
  953,21: Math.Cos(angle * 0.0174)

184 [ Expr ]
  953,15: [
  953,16: i
  953,17: ]

76 ID
  953,16: i

245 ]
  953,17: ]

263 = Expr
  953,19: =
  953,21: Math.Cos(angle * 0.0174)

55 ID . ID ( Exprs )
  953,21: Math
  953,25: .
  953,26: Cos
  953,29: (
  953,30: angle * 0.0174
  953,44: )

5 . ID ( Exprs )
  953,25: .
  953,26: Cos
  953,29: (
  953,30: angle * 0.0174
  953,44: )

260 ID ( Exprs )
  953,26: Cos
  953,29: (
  953,30: angle * 0.0174
  953,44: )

24 ( Exprs )
  953,29: (
  953,30: angle * 0.0174
  953,44: )

26 ID
  953,30: angle

50 * UnaryExpr
  953,36: *
  953,38: 0.0174

156 NUM
  953,38: 0.0174

249 )
  953,44: )

207 CR_token2
  953,46: 


68 ID Idxs = Expr
  954,9: staryv
  954,15: [i]
  954,19: =
  954,21: Math.Sin(angle * 0.0174)

184 [ Expr ]
  954,15: [
  954,16: i
  954,17: ]

76 ID
  954,16: i

245 ]
  954,17: ]

263 = Expr
  954,19: =
  954,21: Math.Sin(angle * 0.0174)

55 ID . ID ( Exprs )
  954,21: Math
  954,25: .
  954,26: Sin
  954,29: (
  954,30: angle * 0.0174
  954,44: )

5 . ID ( Exprs )
  954,25: .
  954,26: Sin
  954,29: (
  954,30: angle * 0.0174
  954,44: )

260 ID ( Exprs )
  954,26: Sin
  954,29: (
  954,30: angle * 0.0174
  954,44: )

24 ( Exprs )
  954,29: (
  954,30: angle * 0.0174
  954,44: )

26 ID
  954,30: angle

50 * UnaryExpr
  954,36: *
  954,38: 0.0174

156 NUM
  954,38: 0.0174

249 )
  954,44: )

207 CR_token2
  954,49: 


68 ID Idxs = Expr
  955,9: starx
  955,14: [i]
  955,18: =
  955,20: 500 + 20

184 [ Expr ]
  955,14: [
  955,15: i
  955,16: ]

76 ID
  955,15: i

245 ]
  955,16: ]

263 = Expr
  955,18: =
  955,20: 500 + 20

55 NUM
  955,20: 500

59 + MultiplicativeExpr
  955,24: +
  955,26: 20

144 NUM
  955,26: 20

207 CR_token2
  955,28: 


68 ID Idxs = Expr
  956,9: stary
  956,14: [i]
  956,18: =
  956,20: 150

184 [ Expr ]
  956,14: [
  956,15: i
  956,16: ]

76 ID
  956,15: i

245 ]
  956,16: ]

263 = Expr
  956,18: =
  956,20: 150

55 NUM
  956,20: 150

207 CR_token2
  956,23: 


68 ID . ID ( Exprs )
  957,9: Shapes
  957,15: .
  957,16: Move
  957,20: (
  957,21: star[i], starx[i] , stary[i]
  957,49: )

184 . ID ( Exprs )
  957,15: .
  957,16: Move
  957,20: (
  957,21: star[i], starx[i] , stary[i]
  957,49: )

255 ID ( Exprs )
  957,16: Move
  957,20: (
  957,21: star[i], starx[i] , stary[i]
  957,49: )

221 ( Exprs )
  957,20: (
  957,21: star[i], starx[i] , stary[i]
  957,49: )

27 ID Idxs
  957,21: star
  957,25: [i]

4 [ Expr ]
  957,25: [
  957,26: i
  957,27: ]

76 ID
  957,26: i

245 ]
  957,27: ]

217 , MoreThanOneExpr
  957,28: ,
  957,30: starx[i] , stary[i]

54 ID Idxs
  957,30: starx
  957,35: [i]

4 [ Expr ]
  957,35: [
  957,36: i
  957,37: ]

76 ID
  957,36: i

245 ]
  957,37: ]

217 , MoreThanOneExpr
  957,39: ,
  957,41: stary[i]

54 ID Idxs
  957,41: stary
  957,46: [i]

4 [ Expr ]
  957,46: [
  957,47: i
  957,48: ]

76 ID
  957,47: i

245 ]
  957,48: ]

238 )
  957,49: )

207 CR_token2
  957,50: 


68 ID Idxs = Expr
  958,9: startime
  958,17: [i]
  958,21: =
  958,23: 0

184 [ Expr ]
  958,17: [
  958,18: i
  958,19: ]

76 ID
  958,18: i

245 ]
  958,19: ]

263 = Expr
  958,21: =
  958,23: 0

55 NUM
  958,23: 0

207 CR_token2
  958,29: 


122 OptionalElse_token1
  959,7: EndIf

203 CR_token2
  959,12: 


96 ID Idxs = Expr
  960,7: startime
  960,15: [i]
  960,19: =
  960,21: startime[i] + 0.20

184 [ Expr ]
  960,15: [
  960,16: i
  960,17: ]

76 ID
  960,16: i

245 ]
  960,17: ]

263 = Expr
  960,19: =
  960,21: startime[i] + 0.20

55 ID Idxs
  960,21: startime
  960,29: [i]

5 [ Expr ]
  960,29: [
  960,30: i
  960,31: ]

81 ID
  960,30: i

233 ]
  960,31: ]

59 + MultiplicativeExpr
  960,33: +
  960,35: 0.20

144 NUM
  960,35: 0.20

203 CR_token2
  960,39: 


96 ID Idxs = Expr
  961,7: staryv
  961,13: [i]
  961,17: =
  961,19: staryv[i] + 0.005

184 [ Expr ]
  961,13: [
  961,14: i
  961,15: ]

76 ID
  961,14: i

245 ]
  961,15: ]

263 = Expr
  961,17: =
  961,19: staryv[i] + 0.005

55 ID Idxs
  961,19: staryv
  961,25: [i]

5 [ Expr ]
  961,25: [
  961,26: i
  961,27: ]

81 ID
  961,26: i

233 ]
  961,27: ]

59 + MultiplicativeExpr
  961,29: +
  961,31: 0.005

144 NUM
  961,31: 0.005

203 CR_token2
  961,36: 


96 ID Idxs = Expr
  962,7: starx
  962,12: [i]
  962,16: =
  962,18: starx[i] + starxv[i]

184 [ Expr ]
  962,12: [
  962,13: i
  962,14: ]

76 ID
  962,13: i

245 ]
  962,14: ]

263 = Expr
  962,16: =
  962,18: starx[i] + starxv[i]

55 ID Idxs
  962,18: starx
  962,23: [i]

5 [ Expr ]
  962,23: [
  962,24: i
  962,25: ]

81 ID
  962,24: i

233 ]
  962,25: ]

59 + MultiplicativeExpr
  962,27: +
  962,29: starxv[i]

144 ID Idxs
  962,29: starxv
  962,35: [i]

5 [ Expr ]
  962,35: [
  962,36: i
  962,37: ]

81 ID
  962,36: i

233 ]
  962,37: ]

203 CR_token2
  962,38: 


96 ID Idxs = Expr
  963,7: stary
  963,12: [i]
  963,16: =
  963,18: stary[i] + staryv[i]

184 [ Expr ]
  963,12: [
  963,13: i
  963,14: ]

76 ID
  963,13: i

245 ]
  963,14: ]

263 = Expr
  963,16: =
  963,18: stary[i] + staryv[i]

55 ID Idxs
  963,18: stary
  963,23: [i]

5 [ Expr ]
  963,23: [
  963,24: i
  963,25: ]

81 ID
  963,24: i

233 ]
  963,25: ]

59 + MultiplicativeExpr
  963,27: +
  963,29: staryv[i]

144 ID Idxs
  963,29: staryv
  963,35: [i]

5 [ Expr ]
  963,35: [
  963,36: i
  963,37: ]

81 ID
  963,36: i

233 ]
  963,37: ]

203 CR_token2
  963,38: 


96 ID . ID ( Exprs )
  964,7: Shapes
  964,13: .
  964,14: Rotate
  964,20: (
  964,21: star[i], startime[i] * 15
  964,46: )

184 . ID ( Exprs )
  964,13: .
  964,14: Rotate
  964,20: (
  964,21: star[i], startime[i] * 15
  964,46: )

255 ID ( Exprs )
  964,14: Rotate
  964,20: (
  964,21: star[i], startime[i] * 15
  964,46: )

221 ( Exprs )
  964,20: (
  964,21: star[i], startime[i] * 15
  964,46: )

27 ID Idxs
  964,21: star
  964,25: [i]

4 [ Expr ]
  964,25: [
  964,26: i
  964,27: ]

76 ID
  964,26: i

245 ]
  964,27: ]

217 , MoreThanOneExpr
  964,28: ,
  964,30: startime[i] * 15

54 ID Idxs
  964,30: startime
  964,38: [i]

4 [ Expr ]
  964,38: [
  964,39: i
  964,40: ]

76 ID
  964,39: i

245 ]
  964,40: ]

50 * UnaryExpr
  964,42: *
  964,44: 15

156 NUM
  964,44: 15

238 )
  964,46: )

203 CR_token2
  964,47: 


96 ID . ID ( Exprs )
  965,7: Shapes
  965,13: .
  965,14: Zoom
  965,18: (
  965,19: star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32)
  965,84: )

184 . ID ( Exprs )
  965,13: .
  965,14: Zoom
  965,18: (
  965,19: star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32)
  965,84: )

255 ID ( Exprs )
  965,14: Zoom
  965,18: (
  965,19: star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32)
  965,84: )

221 ( Exprs )
  965,18: (
  965,19: star[i], Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32)
  965,84: )

27 ID Idxs
  965,19: star
  965,23: [i]

4 [ Expr ]
  965,23: [
  965,24: i
  965,25: ]

76 ID
  965,24: i

245 ]
  965,25: ]

217 , MoreThanOneExpr
  965,26: ,
  965,28: Math.Sin(startime[i] / 32) , Math.Sin(startime[i] / 32)

54 ID . ID ( Exprs )
  965,28: Math
  965,32: .
  965,33: Sin
  965,36: (
  965,37: startime[i] / 32
  965,53: )

4 . ID ( Exprs )
  965,32: .
  965,33: Sin
  965,36: (
  965,37: startime[i] / 32
  965,53: )

248 ID ( Exprs )
  965,33: Sin
  965,36: (
  965,37: startime[i] / 32
  965,53: )

23 ( Exprs )
  965,36: (
  965,37: startime[i] / 32
  965,53: )

22 ID Idxs
  965,37: startime
  965,45: [i]

4 [ Expr ]
  965,45: [
  965,46: i
  965,47: ]

76 ID
  965,46: i

245 ]
  965,47: ]

50 / UnaryExpr
  965,49: /
  965,51: 32

156 NUM
  965,51: 32

239 )
  965,53: )

217 , MoreThanOneExpr
  965,55: ,
  965,57: Math.Sin(startime[i] / 32)

54 ID . ID ( Exprs )
  965,57: Math
  965,61: .
  965,62: Sin
  965,65: (
  965,66: startime[i] / 32
  965,82: )

4 . ID ( Exprs )
  965,61: .
  965,62: Sin
  965,65: (
  965,66: startime[i] / 32
  965,82: )

248 ID ( Exprs )
  965,62: Sin
  965,65: (
  965,66: startime[i] / 32
  965,82: )

23 ( Exprs )
  965,65: (
  965,66: startime[i] / 32
  965,82: )

22 ID Idxs
  965,66: startime
  965,74: [i]

4 [ Expr ]
  965,74: [
  965,75: i
  965,76: ]

76 ID
  965,75: i

245 ]
  965,76: ]

50 / UnaryExpr
  965,78: /
  965,80: 32

156 NUM
  965,80: 32

239 )
  965,82: )

238 )
  965,84: )

203 CR_token2
  965,85: 


96 ID . ID ( Exprs )
  966,7: Shapes
  966,13: .
  966,14: Move
  966,18: (
  966,19: star[i], starx[i], stary[i]
  966,46: )

184 . ID ( Exprs )
  966,13: .
  966,14: Move
  966,18: (
  966,19: star[i], starx[i], stary[i]
  966,46: )

255 ID ( Exprs )
  966,14: Move
  966,18: (
  966,19: star[i], starx[i], stary[i]
  966,46: )

221 ( Exprs )
  966,18: (
  966,19: star[i], starx[i], stary[i]
  966,46: )

27 ID Idxs
  966,19: star
  966,23: [i]

4 [ Expr ]
  966,23: [
  966,24: i
  966,25: ]

76 ID
  966,24: i

245 ]
  966,25: ]

217 , MoreThanOneExpr
  966,26: ,
  966,28: starx[i], stary[i]

54 ID Idxs
  966,28: starx
  966,33: [i]

4 [ Expr ]
  966,33: [
  966,34: i
  966,35: ]

76 ID
  966,34: i

245 ]
  966,35: ]

217 , MoreThanOneExpr
  966,36: ,
  966,38: stary[i]

54 ID Idxs
  966,38: stary
  966,43: [i]

4 [ Expr ]
  966,43: [
  966,44: i
  966,45: ]

76 ID
  966,44: i

245 ]
  966,45: ]

238 )
  966,46: )

203 CR_token2
  966,53: 


177 Stmt_token6
  967,5: EndFor

206 CR_token2
  967,13: 


106 Stmt_token4 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  970,5: For
  970,9: i
  970,11: =
  970,13: 0
  970,15: to
  970,18: 12
  970,20: 
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Rotate(heart[i], hearttime[i] * -10)
      Shapes.Zoom(heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32) )
      Shapes.Move(heart[i], heartx[i], hearty[i])      

  987,5: EndFor

267 ID = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  970,9: i
  970,11: =
  970,13: 0
  970,15: to
  970,18: 12
  970,20: 
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Rotate(heart[i], hearttime[i] * -10)
      Shapes.Zoom(heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32) )
      Shapes.Move(heart[i], heartx[i], hearty[i])      

  987,5: EndFor

266 = Expr Stmt_token5 Expr CRStmtCRs Stmt_token6
  970,11: =
  970,13: 0
  970,15: to
  970,18: 12
  970,20: 
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Rotate(heart[i], hearttime[i] * -10)
      Shapes.Zoom(heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32) )
      Shapes.Move(heart[i], heartx[i], hearty[i])      

  987,5: EndFor

56 NUM
  970,13: 0

264 Stmt_token5 Expr CRStmtCRs Stmt_token6
  970,15: to
  970,18: 12
  970,20: 
      If hearttime[i] > 100 then
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     
      EndIf
      hearttime[i] = hearttime[i] + 0.20
      heartyv[i] = heartyv[i] + 0.005
      heartx[i] = heartx[i] + heartxv[i]
      hearty[i] = hearty[i] + heartyv[i]
      Shapes.Rotate(heart[i], hearttime[i] * -10)
      Shapes.Zoom(heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32) )
      Shapes.Move(heart[i], heartx[i], hearty[i])      

  987,5: EndFor

83 NUM
  970,18: 12

145 CR_token2
  970,20: 


88 Stmt_token9 Expr Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  971,7: If
  971,10: hearttime[i] > 100
  971,29: then
  971,33: 
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     

  979,7: EndIf

86 ID Idxs
  971,10: hearttime
  971,19: [i]

4 [ Expr ]
  971,19: [
  971,20: i
  971,21: ]

76 ID
  971,20: i

245 ]
  971,21: ]

91 > AdditiveExpr
  971,23: >
  971,25: 100

131 NUM
  971,25: 100

254 Stmt_token10 CRStmtCRs MoreThanZeroElseIf
  971,29: then
  971,33: 
        angle = Math.GetRandomNumber(360) 
        heartxv[i] = Math.Cos(angle * 0.0174) 
        heartyv[i] = Math.Sin(angle * 0.0174)    
        heartx[i] = 500 + 20
        hearty[i] = 150
        Shapes.Move(heart[i], heartx[i] , hearty[i])
        hearttime[i] = 0     

  979,7: EndIf

124 CR_token2
  971,33: 


67 ID = Expr
  972,9: angle
  972,15: =
  972,17: Math.GetRandomNumber(360)

184 = Expr
  972,15: =
  972,17: Math.GetRandomNumber(360)

70 ID . ID ( Exprs )
  972,17: Math
  972,21: .
  972,22: GetRandomNumber
  972,37: (
  972,38: 360
  972,41: )

5 . ID ( Exprs )
  972,21: .
  972,22: GetRandomNumber
  972,37: (
  972,38: 360
  972,41: )

260 ID ( Exprs )
  972,22: GetRandomNumber
  972,37: (
  972,38: 360
  972,41: )

24 ( Exprs )
  972,37: (
  972,38: 360
  972,41: )

26 NUM
  972,38: 360

249 )
  972,41: )

207 CR_token2
  972,43: 


68 ID Idxs = Expr
  973,9: heartxv
  973,16: [i]
  973,20: =
  973,22: Math.Cos(angle * 0.0174)

184 [ Expr ]
  973,16: [
  973,17: i
  973,18: ]

76 ID
  973,17: i

245 ]
  973,18: ]

263 = Expr
  973,20: =
  973,22: Math.Cos(angle * 0.0174)

55 ID . ID ( Exprs )
  973,22: Math
  973,26: .
  973,27: Cos
  973,30: (
  973,31: angle * 0.0174
  973,45: )

5 . ID ( Exprs )
  973,26: .
  973,27: Cos
  973,30: (
  973,31: angle * 0.0174
  973,45: )

260 ID ( Exprs )
  973,27: Cos
  973,30: (
  973,31: angle * 0.0174
  973,45: )

24 ( Exprs )
  973,30: (
  973,31: angle * 0.0174
  973,45: )

26 ID
  973,31: angle

50 * UnaryExpr
  973,37: *
  973,39: 0.0174

156 NUM
  973,39: 0.0174

249 )
  973,45: )

207 CR_token2
  973,47: 


68 ID Idxs = Expr
  974,9: heartyv
  974,16: [i]
  974,20: =
  974,22: Math.Sin(angle * 0.0174)

184 [ Expr ]
  974,16: [
  974,17: i
  974,18: ]

76 ID
  974,17: i

245 ]
  974,18: ]

263 = Expr
  974,20: =
  974,22: Math.Sin(angle * 0.0174)

55 ID . ID ( Exprs )
  974,22: Math
  974,26: .
  974,27: Sin
  974,30: (
  974,31: angle * 0.0174
  974,45: )

5 . ID ( Exprs )
  974,26: .
  974,27: Sin
  974,30: (
  974,31: angle * 0.0174
  974,45: )

260 ID ( Exprs )
  974,27: Sin
  974,30: (
  974,31: angle * 0.0174
  974,45: )

24 ( Exprs )
  974,30: (
  974,31: angle * 0.0174
  974,45: )

26 ID
  974,31: angle

50 * UnaryExpr
  974,37: *
  974,39: 0.0174

156 NUM
  974,39: 0.0174

249 )
  974,45: )

207 CR_token2
  974,50: 


68 ID Idxs = Expr
  975,9: heartx
  975,15: [i]
  975,19: =
  975,21: 500 + 20

184 [ Expr ]
  975,15: [
  975,16: i
  975,17: ]

76 ID
  975,16: i

245 ]
  975,17: ]

263 = Expr
  975,19: =
  975,21: 500 + 20

55 NUM
  975,21: 500

59 + MultiplicativeExpr
  975,25: +
  975,27: 20

144 NUM
  975,27: 20

207 CR_token2
  975,29: 


68 ID Idxs = Expr
  976,9: hearty
  976,15: [i]
  976,19: =
  976,21: 150

184 [ Expr ]
  976,15: [
  976,16: i
  976,17: ]

76 ID
  976,16: i

245 ]
  976,17: ]

263 = Expr
  976,19: =
  976,21: 150

55 NUM
  976,21: 150

207 CR_token2
  976,24: 


68 ID . ID ( Exprs )
  977,9: Shapes
  977,15: .
  977,16: Move
  977,20: (
  977,21: heart[i], heartx[i] , hearty[i]
  977,52: )

184 . ID ( Exprs )
  977,15: .
  977,16: Move
  977,20: (
  977,21: heart[i], heartx[i] , hearty[i]
  977,52: )

255 ID ( Exprs )
  977,16: Move
  977,20: (
  977,21: heart[i], heartx[i] , hearty[i]
  977,52: )

221 ( Exprs )
  977,20: (
  977,21: heart[i], heartx[i] , hearty[i]
  977,52: )

27 ID Idxs
  977,21: heart
  977,26: [i]

4 [ Expr ]
  977,26: [
  977,27: i
  977,28: ]

76 ID
  977,27: i

245 ]
  977,28: ]

217 , MoreThanOneExpr
  977,29: ,
  977,31: heartx[i] , hearty[i]

54 ID Idxs
  977,31: heartx
  977,37: [i]

4 [ Expr ]
  977,37: [
  977,38: i
  977,39: ]

76 ID
  977,38: i

245 ]
  977,39: ]

217 , MoreThanOneExpr
  977,41: ,
  977,43: hearty[i]

54 ID Idxs
  977,43: hearty
  977,49: [i]

4 [ Expr ]
  977,49: [
  977,50: i
  977,51: ]

76 ID
  977,50: i

245 ]
  977,51: ]

238 )
  977,52: )

207 CR_token2
  977,53: 


68 ID Idxs = Expr
  978,9: hearttime
  978,18: [i]
  978,22: =
  978,24: 0

184 [ Expr ]
  978,18: [
  978,19: i
  978,20: ]

76 ID
  978,19: i

245 ]
  978,20: ]

263 = Expr
  978,22: =
  978,24: 0

55 NUM
  978,24: 0

207 CR_token2
  978,30: 


122 OptionalElse_token1
  979,7: EndIf

203 CR_token2
  979,12: 


96 ID Idxs = Expr
  980,7: hearttime
  980,16: [i]
  980,20: =
  980,22: hearttime[i] + 0.20

184 [ Expr ]
  980,16: [
  980,17: i
  980,18: ]

76 ID
  980,17: i

245 ]
  980,18: ]

263 = Expr
  980,20: =
  980,22: hearttime[i] + 0.20

55 ID Idxs
  980,22: hearttime
  980,31: [i]

5 [ Expr ]
  980,31: [
  980,32: i
  980,33: ]

81 ID
  980,32: i

233 ]
  980,33: ]

59 + MultiplicativeExpr
  980,35: +
  980,37: 0.20

144 NUM
  980,37: 0.20

203 CR_token2
  980,41: 


96 ID Idxs = Expr
  981,7: heartyv
  981,14: [i]
  981,18: =
  981,20: heartyv[i] + 0.005

184 [ Expr ]
  981,14: [
  981,15: i
  981,16: ]

76 ID
  981,15: i

245 ]
  981,16: ]

263 = Expr
  981,18: =
  981,20: heartyv[i] + 0.005

55 ID Idxs
  981,20: heartyv
  981,27: [i]

5 [ Expr ]
  981,27: [
  981,28: i
  981,29: ]

81 ID
  981,28: i

233 ]
  981,29: ]

59 + MultiplicativeExpr
  981,31: +
  981,33: 0.005

144 NUM
  981,33: 0.005

203 CR_token2
  981,38: 


96 ID Idxs = Expr
  982,7: heartx
  982,13: [i]
  982,17: =
  982,19: heartx[i] + heartxv[i]

184 [ Expr ]
  982,13: [
  982,14: i
  982,15: ]

76 ID
  982,14: i

245 ]
  982,15: ]

263 = Expr
  982,17: =
  982,19: heartx[i] + heartxv[i]

55 ID Idxs
  982,19: heartx
  982,25: [i]

5 [ Expr ]
  982,25: [
  982,26: i
  982,27: ]

81 ID
  982,26: i

233 ]
  982,27: ]

59 + MultiplicativeExpr
  982,29: +
  982,31: heartxv[i]

144 ID Idxs
  982,31: heartxv
  982,38: [i]

5 [ Expr ]
  982,38: [
  982,39: i
  982,40: ]

81 ID
  982,39: i

233 ]
  982,40: ]

203 CR_token2
  982,41: 


96 ID Idxs = Expr
  983,7: hearty
  983,13: [i]
  983,17: =
  983,19: hearty[i] + heartyv[i]

184 [ Expr ]
  983,13: [
  983,14: i
  983,15: ]

76 ID
  983,14: i

245 ]
  983,15: ]

263 = Expr
  983,17: =
  983,19: hearty[i] + heartyv[i]

55 ID Idxs
  983,19: hearty
  983,25: [i]

5 [ Expr ]
  983,25: [
  983,26: i
  983,27: ]

81 ID
  983,26: i

233 ]
  983,27: ]

59 + MultiplicativeExpr
  983,29: +
  983,31: heartyv[i]

144 ID Idxs
  983,31: heartyv
  983,38: [i]

5 [ Expr ]
  983,38: [
  983,39: i
  983,40: ]

81 ID
  983,39: i

233 ]
  983,40: ]

203 CR_token2
  983,41: 


96 ID . ID ( Exprs )
  984,7: Shapes
  984,13: .
  984,14: Rotate
  984,20: (
  984,21: heart[i], hearttime[i] * -10
  984,49: )

184 . ID ( Exprs )
  984,13: .
  984,14: Rotate
  984,20: (
  984,21: heart[i], hearttime[i] * -10
  984,49: )

255 ID ( Exprs )
  984,14: Rotate
  984,20: (
  984,21: heart[i], hearttime[i] * -10
  984,49: )

221 ( Exprs )
  984,20: (
  984,21: heart[i], hearttime[i] * -10
  984,49: )

27 ID Idxs
  984,21: heart
  984,26: [i]

4 [ Expr ]
  984,26: [
  984,27: i
  984,28: ]

76 ID
  984,27: i

245 ]
  984,28: ]

217 , MoreThanOneExpr
  984,29: ,
  984,31: hearttime[i] * -10

54 ID Idxs
  984,31: hearttime
  984,40: [i]

4 [ Expr ]
  984,40: [
  984,41: i
  984,42: ]

76 ID
  984,41: i

245 ]
  984,42: ]

50 * UnaryExpr
  984,44: *
  984,46: -10

156 - Primary
  984,46: -
  984,47: 10

197 NUM
  984,47: 10

238 )
  984,49: )

203 CR_token2
  984,50: 


96 ID . ID ( Exprs )
  985,7: Shapes
  985,13: .
  985,14: Zoom
  985,18: (
  985,19: heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32)
  985,87: )

184 . ID ( Exprs )
  985,13: .
  985,14: Zoom
  985,18: (
  985,19: heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32)
  985,87: )

255 ID ( Exprs )
  985,14: Zoom
  985,18: (
  985,19: heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32)
  985,87: )

221 ( Exprs )
  985,18: (
  985,19: heart[i], Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32)
  985,87: )

27 ID Idxs
  985,19: heart
  985,24: [i]

4 [ Expr ]
  985,24: [
  985,25: i
  985,26: ]

76 ID
  985,25: i

245 ]
  985,26: ]

217 , MoreThanOneExpr
  985,27: ,
  985,29: Math.Sin(hearttime[i] / 32) , Math.Sin(hearttime[i] / 32)

54 ID . ID ( Exprs )
  985,29: Math
  985,33: .
  985,34: Sin
  985,37: (
  985,38: hearttime[i] / 32
  985,55: )

4 . ID ( Exprs )
  985,33: .
  985,34: Sin
  985,37: (
  985,38: hearttime[i] / 32
  985,55: )

248 ID ( Exprs )
  985,34: Sin
  985,37: (
  985,38: hearttime[i] / 32
  985,55: )

23 ( Exprs )
  985,37: (
  985,38: hearttime[i] / 32
  985,55: )

22 ID Idxs
  985,38: hearttime
  985,47: [i]

4 [ Expr ]
  985,47: [
  985,48: i
  985,49: ]

76 ID
  985,48: i

245 ]
  985,49: ]

50 / UnaryExpr
  985,51: /
  985,53: 32

156 NUM
  985,53: 32

239 )
  985,55: )

217 , MoreThanOneExpr
  985,57: ,
  985,59: Math.Sin(hearttime[i] / 32)

54 ID . ID ( Exprs )
  985,59: Math
  985,63: .
  985,64: Sin
  985,67: (
  985,68: hearttime[i] / 32
  985,85: )

4 . ID ( Exprs )
  985,63: .
  985,64: Sin
  985,67: (
  985,68: hearttime[i] / 32
  985,85: )

248 ID ( Exprs )
  985,64: Sin
  985,67: (
  985,68: hearttime[i] / 32
  985,85: )

23 ( Exprs )
  985,67: (
  985,68: hearttime[i] / 32
  985,85: )

22 ID Idxs
  985,68: hearttime
  985,77: [i]

4 [ Expr ]
  985,77: [
  985,78: i
  985,79: ]

76 ID
  985,78: i

245 ]
  985,79: ]

50 / UnaryExpr
  985,81: /
  985,83: 32

156 NUM
  985,83: 32

239 )
  985,85: )

238 )
  985,87: )

203 CR_token2
  985,88: 


96 ID . ID ( Exprs )
  986,7: Shapes
  986,13: .
  986,14: Move
  986,18: (
  986,19: heart[i], heartx[i], hearty[i]
  986,49: )

184 . ID ( Exprs )
  986,13: .
  986,14: Move
  986,18: (
  986,19: heart[i], heartx[i], hearty[i]
  986,49: )

255 ID ( Exprs )
  986,14: Move
  986,18: (
  986,19: heart[i], heartx[i], hearty[i]
  986,49: )

221 ( Exprs )
  986,18: (
  986,19: heart[i], heartx[i], hearty[i]
  986,49: )

27 ID Idxs
  986,19: heart
  986,24: [i]

4 [ Expr ]
  986,24: [
  986,25: i
  986,26: ]

76 ID
  986,25: i

245 ]
  986,26: ]

217 , MoreThanOneExpr
  986,27: ,
  986,29: heartx[i], hearty[i]

54 ID Idxs
  986,29: heartx
  986,35: [i]

4 [ Expr ]
  986,35: [
  986,36: i
  986,37: ]

76 ID
  986,36: i

245 ]
  986,37: ]

217 , MoreThanOneExpr
  986,38: ,
  986,40: hearty[i]

54 ID Idxs
  986,40: hearty
  986,46: [i]

4 [ Expr ]
  986,46: [
  986,47: i
  986,48: ]

76 ID
  986,47: i

245 ]
  986,48: ]

238 )
  986,49: )

203 CR_token2
  986,56: 


177 Stmt_token6
  987,5: EndFor

206 CR_token2
  987,13: 


257 Stmt_token8
  989,1: EndSub

97 Stmt_token7 ID CRStmtCRs Stmt_token8
  992,1: Sub
  992,5: InitLevels
  992,15: 
  
block[0][0] = "                    "
block[0][1] = "                    "
block[0][2] = "                    "
block[0][3] = "     66666          "
block[0][4] = "     60006          "
block[0][5] = "     62006          "
block[0][6] = "   66600266         "
block[0][7] = "   60020206         "
block[0][8] = " 6660606606AA555555 "
block[0][9] = " 600060660666700115 "
block[0][10]= " 60200200000X000115 "
block[0][11]= " 666660666066700115 "
block[0][12]= "     60000066555555 "
block[0][13]= "     6666666        "
block[0][14]= "                    "
block[0][15]= "                    "

block[1][0] = "                    "
block[1][1] = "                    "
block[1][2] = "                    "
block[1][3] = "       6666666      "
block[1][4] = "  76666600000667    "
block[1][5] = "  61111602002006    "
block[1][6] = "  61100626666006    "
block[1][7] = "  6110000X066006    "
block[1][8] = "  61100606002076    "
block[1][9] = "  76666606620206    "
block[1][10]= "    602002020206    "
block[1][11]= "    600007000006    "
block[1][12]= "    766666666667    "
block[1][13]= "                    "
block[1][14]= "                    "
block[1][15]= "                    "

block[2][0] = "                    "
block[2][1] = "                    "
block[2][2] = "                    "
block[2][3] = "         76666667   "
block[2][4] = "         600000X6   "
block[2][5] = "         60262066   "
block[2][6] = "         6020026    "
block[2][7] = "         6720206    "
block[2][8] = " 7666666 602060667  "
block[2][9] = " 61111066602002006  "
block[2][10]= " 61110000020020006  "
block[2][11]= " 61111066666666667  "
block[2][12]= " 7666666            "
block[2][13]= "                    "
block[2][14]= "                    "
block[2][15]= "                    "

block[3][0] = "                    "
block[3][1] = "                    "
block[3][2] = "6666663             "
block[3][3] = "611166366666  66666 "
block[3][4] = "611116360006  60006 "
block[3][5] = "6111163607066660706 "
block[3][6] = "600X063600200000006 "
block[3][7] = "6606663700602260666 "
block[3][8] = "5AAAA73A220060006   "
block[3][9] = "5ACAABBB002666206   "
block[3][10]= "5AA5AA3A700060006   "
block[3][11]= "5555553A666060726   "
block[3][12]= "AAAAAA3AAA6022006   "
block[3][13]= "33333333336000006   "
block[3][14]= "          6666666   "
block[3][15]= "                    "

block[4][0] = "                    "
block[4][1] = "                    "
block[4][2] = "          66666     "
block[4][3] = "    666666600067    "
block[4][4] = "   66070X6602206    "
block[4][5] = "   6000020000006    "
block[4][6] = "   6002006660006    "
block[4][7] = "   6660666662666    "
block[4][8] = "   602006660116     "
block[4][9] = "   602020201116     "
block[4][10]= "   600006661116     "
block[4][11]= "   602206 61116     "
block[4][12]= "   600666 76667     "
block[4][13]= "   7667             "
block[4][14]= "                    "
block[4][15]= "                    "

block[5][0] = "                    "
block[5][1] = "           4444444  "
block[5][2] = "           4AA1114  "
block[5][3] = "       66667AA1114  "
block[5][4] = "       60000AA1A14  "
block[5][5] = "       60067AA1114  "
block[5][6] = "       66066AA1114  "
block[5][7] = "      666066444444  "
block[5][8] = "      60222066AAAA  "
block[5][9] = "  6666600202066666  "
block[5][10]= " 66000720200070006  "
block[5][11]= " 6X020020000200206  "
block[5][12]= " 66666602202066666  "
block[5][13]= "      60000006      "
block[5][14]= "      66666666      "
block[5][15]= "                    "

block[6][0] = "                    "
block[6][1] = "     7777777777     "
block[6][2] = "     7110070007     "
block[6][3] = "     7110000007     "
block[6][4] = "     711007007777   "
block[6][5] = "    77777770070077  "
block[6][6] = "    70000000000007  "
block[6][7] = "    70070077007007  "
block[6][8] = "  7777077007777077  "
block[6][9] = "  7002007777707007  "
block[6][10]= "  7070200200702007  "
block[6][11]= "  70X2002000700077  "
block[6][12]= "  777707707777777   "
block[6][13]= "     700007         "
block[6][14]= "     777777         "
block[6][15]= "                    "

block[7][0] = "                    "
block[7][1] = "                    "
block[7][2] = "                    "
block[7][3] = "          4444      "
block[7][4] = "    4444444AY4      "
block[7][5] = "    4AAAAACAA4      "
block[7][6] = "    4AAAC77AC4      "
block[7][7] = "    44C71117A4      "
block[7][8] = "     4AC111AA4      "
block[7][9] = "     4A71A17A44     "
block[7][10]= "     4AAA7A7CA4     "
block[7][11]= "     4CAACAAAA4     "
block[7][12]= "     4AA4444444     "
block[7][13]= "     4444           "
block[7][14]= "                    "
block[7][15]= "                    "

block[8][0] = "                    "
block[8][1] = "                    "
block[8][2] = "          4444      "
block[8][3] = "  444444444AA77     "
block[8][4] = " 74AACAAAAAACA75557 "
block[8][5] = " 4ABB77B77BBA771115 "
block[8][6] = " 4A7DDBDBDD7C771115 "
block[8][7] = " 4A7BBBBZBB7AAA1115 "
block[8][8] = " 4ABD7B777DDAAA1115 "
block[8][9] = " 4ACAACCAACA7711115 "
block[8][10]= " 744CAAAAAAA7755557 "
block[8][11]= "   4AA4444444       "
block[8][12]= "   4444             "
block[8][13]= "                    "
block[8][14]= "                    "
block[8][15]= "                    "

block[9][0] = " AAAAA A   A AAAA   "
block[9][1] = "   A   A   A A      "
block[9][2] = "   A   AAAAA AAA    "
block[9][3] = "   A   A   A A      "
block[9][4] = "   A   A   A AAAA   "
block[9][5] = "                    "
block[9][6] = "  AAAA A   A AAA    "
block[9][7] = "  A    AA  A A  A   "
block[9][8] = "  AAA  A A A A  A   "
block[9][9]=  "  A    A  AA A  A   "
block[9][10]= "  AAAA A   A AAA    "
block[9][11]= "                    "
block[9][12]= "                    "
block[9][13]= " 4444444444444444   "
block[9][14]= " 40X0020000000104   "
block[9][15]= " 4444444444444444   "


  1164,1: EndSub

244 ID CRStmtCRs Stmt_token8
  992,5: InitLevels
  992,15: 
  
block[0][0] = "                    "
block[0][1] = "                    "
block[0][2] = "                    "
block[0][3] = "     66666          "
block[0][4] = "     60006          "
block[0][5] = "     62006          "
block[0][6] = "   66600266         "
block[0][7] = "   60020206         "
block[0][8] = " 6660606606AA555555 "
block[0][9] = " 600060660666700115 "
block[0][10]= " 60200200000X000115 "
block[0][11]= " 666660666066700115 "
block[0][12]= "     60000066555555 "
block[0][13]= "     6666666        "
block[0][14]= "                    "
block[0][15]= "                    "

block[1][0] = "                    "
block[1][1] = "                    "
block[1][2] = "                    "
block[1][3] = "       6666666      "
block[1][4] = "  76666600000667    "
block[1][5] = "  61111602002006    "
block[1][6] = "  61100626666006    "
block[1][7] = "  6110000X066006    "
block[1][8] = "  61100606002076    "
block[1][9] = "  76666606620206    "
block[1][10]= "    602002020206    "
block[1][11]= "    600007000006    "
block[1][12]= "    766666666667    "
block[1][13]= "                    "
block[1][14]= "                    "
block[1][15]= "                    "

block[2][0] = "                    "
block[2][1] = "                    "
block[2][2] = "                    "
block[2][3] = "         76666667   "
block[2][4] = "         600000X6   "
block[2][5] = "         60262066   "
block[2][6] = "         6020026    "
block[2][7] = "         6720206    "
block[2][8] = " 7666666 602060667  "
block[2][9] = " 61111066602002006  "
block[2][10]= " 61110000020020006  "
block[2][11]= " 61111066666666667  "
block[2][12]= " 7666666            "
block[2][13]= "                    "
block[2][14]= "                    "
block[2][15]= "                    "

block[3][0] = "                    "
block[3][1] = "                    "
block[3][2] = "6666663             "
block[3][3] = "611166366666  66666 "
block[3][4] = "611116360006  60006 "
block[3][5] = "6111163607066660706 "
block[3][6] = "600X063600200000006 "
block[3][7] = "6606663700602260666 "
block[3][8] = "5AAAA73A220060006   "
block[3][9] = "5ACAABBB002666206   "
block[3][10]= "5AA5AA3A700060006   "
block[3][11]= "5555553A666060726   "
block[3][12]= "AAAAAA3AAA6022006   "
block[3][13]= "33333333336000006   "
block[3][14]= "          6666666   "
block[3][15]= "                    "

block[4][0] = "                    "
block[4][1] = "                    "
block[4][2] = "          66666     "
block[4][3] = "    666666600067    "
block[4][4] = "   66070X6602206    "
block[4][5] = "   6000020000006    "
block[4][6] = "   6002006660006    "
block[4][7] = "   6660666662666    "
block[4][8] = "   602006660116     "
block[4][9] = "   602020201116     "
block[4][10]= "   600006661116     "
block[4][11]= "   602206 61116     "
block[4][12]= "   600666 76667     "
block[4][13]= "   7667             "
block[4][14]= "                    "
block[4][15]= "                    "

block[5][0] = "                    "
block[5][1] = "           4444444  "
block[5][2] = "           4AA1114  "
block[5][3] = "       66667AA1114  "
block[5][4] = "       60000AA1A14  "
block[5][5] = "       60067AA1114  "
block[5][6] = "       66066AA1114  "
block[5][7] = "      666066444444  "
block[5][8] = "      60222066AAAA  "
block[5][9] = "  6666600202066666  "
block[5][10]= " 66000720200070006  "
block[5][11]= " 6X020020000200206  "
block[5][12]= " 66666602202066666  "
block[5][13]= "      60000006      "
block[5][14]= "      66666666      "
block[5][15]= "                    "

block[6][0] = "                    "
block[6][1] = "     7777777777     "
block[6][2] = "     7110070007     "
block[6][3] = "     7110000007     "
block[6][4] = "     711007007777   "
block[6][5] = "    77777770070077  "
block[6][6] = "    70000000000007  "
block[6][7] = "    70070077007007  "
block[6][8] = "  7777077007777077  "
block[6][9] = "  7002007777707007  "
block[6][10]= "  7070200200702007  "
block[6][11]= "  70X2002000700077  "
block[6][12]= "  777707707777777   "
block[6][13]= "     700007         "
block[6][14]= "     777777         "
block[6][15]= "                    "

block[7][0] = "                    "
block[7][1] = "                    "
block[7][2] = "                    "
block[7][3] = "          4444      "
block[7][4] = "    4444444AY4      "
block[7][5] = "    4AAAAACAA4      "
block[7][6] = "    4AAAC77AC4      "
block[7][7] = "    44C71117A4      "
block[7][8] = "     4AC111AA4      "
block[7][9] = "     4A71A17A44     "
block[7][10]= "     4AAA7A7CA4     "
block[7][11]= "     4CAACAAAA4     "
block[7][12]= "     4AA4444444     "
block[7][13]= "     4444           "
block[7][14]= "                    "
block[7][15]= "                    "

block[8][0] = "                    "
block[8][1] = "                    "
block[8][2] = "          4444      "
block[8][3] = "  444444444AA77     "
block[8][4] = " 74AACAAAAAACA75557 "
block[8][5] = " 4ABB77B77BBA771115 "
block[8][6] = " 4A7DDBDBDD7C771115 "
block[8][7] = " 4A7BBBBZBB7AAA1115 "
block[8][8] = " 4ABD7B777DDAAA1115 "
block[8][9] = " 4ACAACCAACA7711115 "
block[8][10]= " 744CAAAAAAA7755557 "
block[8][11]= "   4AA4444444       "
block[8][12]= "   4444             "
block[8][13]= "                    "
block[8][14]= "                    "
block[8][15]= "                    "

block[9][0] = " AAAAA A   A AAAA   "
block[9][1] = "   A   A   A A      "
block[9][2] = "   A   AAAAA AAA    "
block[9][3] = "   A   A   A A      "
block[9][4] = "   A   A   A AAAA   "
block[9][5] = "                    "
block[9][6] = "  AAAA A   A AAA    "
block[9][7] = "  A    AA  A A  A   "
block[9][8] = "  AAA  A A A A  A   "
block[9][9]=  "  A    A  AA A  A   "
block[9][10]= "  AAAA A   A AAA    "
block[9][11]= "                    "
block[9][12]= "                    "
block[9][13]= " 4444444444444444   "
block[9][14]= " 40X0020000000104   "
block[9][15]= " 4444444444444444   "


  1164,1: EndSub

199 CR_token2
  992,15: 


105 ID Idxs = Expr
  994,1: block
  994,6: [0][0]
  994,13: =
  994,15: "                    "

184 [ Expr ] Idxs
  994,6: [
  994,7: 0
  994,8: ]
  994,9: [0]

76 NUM
  994,7: 0

245 ] Idxs
  994,8: ]
  994,9: [0]

7 [ Expr ]
  994,9: [
  994,10: 0
  994,11: ]

76 NUM
  994,10: 0

245 ]
  994,11: ]

263 = Expr
  994,13: =
  994,15: "                    "

55 STR
  994,15: "                    "

206 CR_token2
  994,37: 


106 ID Idxs = Expr
  995,1: block
  995,6: [0][1]
  995,13: =
  995,15: "                    "

184 [ Expr ] Idxs
  995,6: [
  995,7: 0
  995,8: ]
  995,9: [1]

76 NUM
  995,7: 0

245 ] Idxs
  995,8: ]
  995,9: [1]

7 [ Expr ]
  995,9: [
  995,10: 1
  995,11: ]

76 NUM
  995,10: 1

245 ]
  995,11: ]

263 = Expr
  995,13: =
  995,15: "                    "

55 STR
  995,15: "                    "

206 CR_token2
  995,37: 


106 ID Idxs = Expr
  996,1: block
  996,6: [0][2]
  996,13: =
  996,15: "                    "

184 [ Expr ] Idxs
  996,6: [
  996,7: 0
  996,8: ]
  996,9: [2]

76 NUM
  996,7: 0

245 ] Idxs
  996,8: ]
  996,9: [2]

7 [ Expr ]
  996,9: [
  996,10: 2
  996,11: ]

76 NUM
  996,10: 2

245 ]
  996,11: ]

263 = Expr
  996,13: =
  996,15: "                    "

55 STR
  996,15: "                    "

206 CR_token2
  996,37: 


106 ID Idxs = Expr
  997,1: block
  997,6: [0][3]
  997,13: =
  997,15: "     66666          "

184 [ Expr ] Idxs
  997,6: [
  997,7: 0
  997,8: ]
  997,9: [3]

76 NUM
  997,7: 0

245 ] Idxs
  997,8: ]
  997,9: [3]

7 [ Expr ]
  997,9: [
  997,10: 3
  997,11: ]

76 NUM
  997,10: 3

245 ]
  997,11: ]

263 = Expr
  997,13: =
  997,15: "     66666          "

55 STR
  997,15: "     66666          "

206 CR_token2
  997,37: 


106 ID Idxs = Expr
  998,1: block
  998,6: [0][4]
  998,13: =
  998,15: "     60006          "

184 [ Expr ] Idxs
  998,6: [
  998,7: 0
  998,8: ]
  998,9: [4]

76 NUM
  998,7: 0

245 ] Idxs
  998,8: ]
  998,9: [4]

7 [ Expr ]
  998,9: [
  998,10: 4
  998,11: ]

76 NUM
  998,10: 4

245 ]
  998,11: ]

263 = Expr
  998,13: =
  998,15: "     60006          "

55 STR
  998,15: "     60006          "

206 CR_token2
  998,37: 


106 ID Idxs = Expr
  999,1: block
  999,6: [0][5]
  999,13: =
  999,15: "     62006          "

184 [ Expr ] Idxs
  999,6: [
  999,7: 0
  999,8: ]
  999,9: [5]

76 NUM
  999,7: 0

245 ] Idxs
  999,8: ]
  999,9: [5]

7 [ Expr ]
  999,9: [
  999,10: 5
  999,11: ]

76 NUM
  999,10: 5

245 ]
  999,11: ]

263 = Expr
  999,13: =
  999,15: "     62006          "

55 STR
  999,15: "     62006          "

206 CR_token2
  999,37: 


106 ID Idxs = Expr
  1000,1: block
  1000,6: [0][6]
  1000,13: =
  1000,15: "   66600266         "

184 [ Expr ] Idxs
  1000,6: [
  1000,7: 0
  1000,8: ]
  1000,9: [6]

76 NUM
  1000,7: 0

245 ] Idxs
  1000,8: ]
  1000,9: [6]

7 [ Expr ]
  1000,9: [
  1000,10: 6
  1000,11: ]

76 NUM
  1000,10: 6

245 ]
  1000,11: ]

263 = Expr
  1000,13: =
  1000,15: "   66600266         "

55 STR
  1000,15: "   66600266         "

206 CR_token2
  1000,37: 


106 ID Idxs = Expr
  1001,1: block
  1001,6: [0][7]
  1001,13: =
  1001,15: "   60020206         "

184 [ Expr ] Idxs
  1001,6: [
  1001,7: 0
  1001,8: ]
  1001,9: [7]

76 NUM
  1001,7: 0

245 ] Idxs
  1001,8: ]
  1001,9: [7]

7 [ Expr ]
  1001,9: [
  1001,10: 7
  1001,11: ]

76 NUM
  1001,10: 7

245 ]
  1001,11: ]

263 = Expr
  1001,13: =
  1001,15: "   60020206         "

55 STR
  1001,15: "   60020206         "

206 CR_token2
  1001,37: 


106 ID Idxs = Expr
  1002,1: block
  1002,6: [0][8]
  1002,13: =
  1002,15: " 6660606606AA555555 "

184 [ Expr ] Idxs
  1002,6: [
  1002,7: 0
  1002,8: ]
  1002,9: [8]

76 NUM
  1002,7: 0

245 ] Idxs
  1002,8: ]
  1002,9: [8]

7 [ Expr ]
  1002,9: [
  1002,10: 8
  1002,11: ]

76 NUM
  1002,10: 8

245 ]
  1002,11: ]

263 = Expr
  1002,13: =
  1002,15: " 6660606606AA555555 "

55 STR
  1002,15: " 6660606606AA555555 "

206 CR_token2
  1002,37: 


106 ID Idxs = Expr
  1003,1: block
  1003,6: [0][9]
  1003,13: =
  1003,15: " 600060660666700115 "

184 [ Expr ] Idxs
  1003,6: [
  1003,7: 0
  1003,8: ]
  1003,9: [9]

76 NUM
  1003,7: 0

245 ] Idxs
  1003,8: ]
  1003,9: [9]

7 [ Expr ]
  1003,9: [
  1003,10: 9
  1003,11: ]

76 NUM
  1003,10: 9

245 ]
  1003,11: ]

263 = Expr
  1003,13: =
  1003,15: " 600060660666700115 "

55 STR
  1003,15: " 600060660666700115 "

206 CR_token2
  1003,37: 


106 ID Idxs = Expr
  1004,1: block
  1004,6: [0][10]
  1004,13: =
  1004,15: " 60200200000X000115 "

184 [ Expr ] Idxs
  1004,6: [
  1004,7: 0
  1004,8: ]
  1004,9: [10]

76 NUM
  1004,7: 0

245 ] Idxs
  1004,8: ]
  1004,9: [10]

7 [ Expr ]
  1004,9: [
  1004,10: 10
  1004,12: ]

76 NUM
  1004,10: 10

245 ]
  1004,12: ]

263 = Expr
  1004,13: =
  1004,15: " 60200200000X000115 "

55 STR
  1004,15: " 60200200000X000115 "

206 CR_token2
  1004,37: 


106 ID Idxs = Expr
  1005,1: block
  1005,6: [0][11]
  1005,13: =
  1005,15: " 666660666066700115 "

184 [ Expr ] Idxs
  1005,6: [
  1005,7: 0
  1005,8: ]
  1005,9: [11]

76 NUM
  1005,7: 0

245 ] Idxs
  1005,8: ]
  1005,9: [11]

7 [ Expr ]
  1005,9: [
  1005,10: 11
  1005,12: ]

76 NUM
  1005,10: 11

245 ]
  1005,12: ]

263 = Expr
  1005,13: =
  1005,15: " 666660666066700115 "

55 STR
  1005,15: " 666660666066700115 "

206 CR_token2
  1005,37: 


106 ID Idxs = Expr
  1006,1: block
  1006,6: [0][12]
  1006,13: =
  1006,15: "     60000066555555 "

184 [ Expr ] Idxs
  1006,6: [
  1006,7: 0
  1006,8: ]
  1006,9: [12]

76 NUM
  1006,7: 0

245 ] Idxs
  1006,8: ]
  1006,9: [12]

7 [ Expr ]
  1006,9: [
  1006,10: 12
  1006,12: ]

76 NUM
  1006,10: 12

245 ]
  1006,12: ]

263 = Expr
  1006,13: =
  1006,15: "     60000066555555 "

55 STR
  1006,15: "     60000066555555 "

206 CR_token2
  1006,37: 


106 ID Idxs = Expr
  1007,1: block
  1007,6: [0][13]
  1007,13: =
  1007,15: "     6666666        "

184 [ Expr ] Idxs
  1007,6: [
  1007,7: 0
  1007,8: ]
  1007,9: [13]

76 NUM
  1007,7: 0

245 ] Idxs
  1007,8: ]
  1007,9: [13]

7 [ Expr ]
  1007,9: [
  1007,10: 13
  1007,12: ]

76 NUM
  1007,10: 13

245 ]
  1007,12: ]

263 = Expr
  1007,13: =
  1007,15: "     6666666        "

55 STR
  1007,15: "     6666666        "

206 CR_token2
  1007,37: 


106 ID Idxs = Expr
  1008,1: block
  1008,6: [0][14]
  1008,13: =
  1008,15: "                    "

184 [ Expr ] Idxs
  1008,6: [
  1008,7: 0
  1008,8: ]
  1008,9: [14]

76 NUM
  1008,7: 0

245 ] Idxs
  1008,8: ]
  1008,9: [14]

7 [ Expr ]
  1008,9: [
  1008,10: 14
  1008,12: ]

76 NUM
  1008,10: 14

245 ]
  1008,12: ]

263 = Expr
  1008,13: =
  1008,15: "                    "

55 STR
  1008,15: "                    "

206 CR_token2
  1008,37: 


106 ID Idxs = Expr
  1009,1: block
  1009,6: [0][15]
  1009,13: =
  1009,15: "                    "

184 [ Expr ] Idxs
  1009,6: [
  1009,7: 0
  1009,8: ]
  1009,9: [15]

76 NUM
  1009,7: 0

245 ] Idxs
  1009,8: ]
  1009,9: [15]

7 [ Expr ]
  1009,9: [
  1009,10: 15
  1009,12: ]

76 NUM
  1009,10: 15

245 ]
  1009,12: ]

263 = Expr
  1009,13: =
  1009,15: "                    "

55 STR
  1009,15: "                    "

206 CR_token2
  1009,37: 



106 ID Idxs = Expr
  1011,1: block
  1011,6: [1][0]
  1011,13: =
  1011,15: "                    "

184 [ Expr ] Idxs
  1011,6: [
  1011,7: 1
  1011,8: ]
  1011,9: [0]

76 NUM
  1011,7: 1

245 ] Idxs
  1011,8: ]
  1011,9: [0]

7 [ Expr ]
  1011,9: [
  1011,10: 0
  1011,11: ]

76 NUM
  1011,10: 0

245 ]
  1011,11: ]

263 = Expr
  1011,13: =
  1011,15: "                    "

55 STR
  1011,15: "                    "

206 CR_token2
  1011,37: 


106 ID Idxs = Expr
  1012,1: block
  1012,6: [1][1]
  1012,13: =
  1012,15: "                    "

184 [ Expr ] Idxs
  1012,6: [
  1012,7: 1
  1012,8: ]
  1012,9: [1]

76 NUM
  1012,7: 1

245 ] Idxs
  1012,8: ]
  1012,9: [1]

7 [ Expr ]
  1012,9: [
  1012,10: 1
  1012,11: ]

76 NUM
  1012,10: 1

245 ]
  1012,11: ]

263 = Expr
  1012,13: =
  1012,15: "                    "

55 STR
  1012,15: "                    "

206 CR_token2
  1012,37: 


106 ID Idxs = Expr
  1013,1: block
  1013,6: [1][2]
  1013,13: =
  1013,15: "                    "

184 [ Expr ] Idxs
  1013,6: [
  1013,7: 1
  1013,8: ]
  1013,9: [2]

76 NUM
  1013,7: 1

245 ] Idxs
  1013,8: ]
  1013,9: [2]

7 [ Expr ]
  1013,9: [
  1013,10: 2
  1013,11: ]

76 NUM
  1013,10: 2

245 ]
  1013,11: ]

263 = Expr
  1013,13: =
  1013,15: "                    "

55 STR
  1013,15: "                    "

206 CR_token2
  1013,37: 


106 ID Idxs = Expr
  1014,1: block
  1014,6: [1][3]
  1014,13: =
  1014,15: "       6666666      "

184 [ Expr ] Idxs
  1014,6: [
  1014,7: 1
  1014,8: ]
  1014,9: [3]

76 NUM
  1014,7: 1

245 ] Idxs
  1014,8: ]
  1014,9: [3]

7 [ Expr ]
  1014,9: [
  1014,10: 3
  1014,11: ]

76 NUM
  1014,10: 3

245 ]
  1014,11: ]

263 = Expr
  1014,13: =
  1014,15: "       6666666      "

55 STR
  1014,15: "       6666666      "

206 CR_token2
  1014,37: 


106 ID Idxs = Expr
  1015,1: block
  1015,6: [1][4]
  1015,13: =
  1015,15: "  76666600000667    "

184 [ Expr ] Idxs
  1015,6: [
  1015,7: 1
  1015,8: ]
  1015,9: [4]

76 NUM
  1015,7: 1

245 ] Idxs
  1015,8: ]
  1015,9: [4]

7 [ Expr ]
  1015,9: [
  1015,10: 4
  1015,11: ]

76 NUM
  1015,10: 4

245 ]
  1015,11: ]

263 = Expr
  1015,13: =
  1015,15: "  76666600000667    "

55 STR
  1015,15: "  76666600000667    "

206 CR_token2
  1015,37: 


106 ID Idxs = Expr
  1016,1: block
  1016,6: [1][5]
  1016,13: =
  1016,15: "  61111602002006    "

184 [ Expr ] Idxs
  1016,6: [
  1016,7: 1
  1016,8: ]
  1016,9: [5]

76 NUM
  1016,7: 1

245 ] Idxs
  1016,8: ]
  1016,9: [5]

7 [ Expr ]
  1016,9: [
  1016,10: 5
  1016,11: ]

76 NUM
  1016,10: 5

245 ]
  1016,11: ]

263 = Expr
  1016,13: =
  1016,15: "  61111602002006    "

55 STR
  1016,15: "  61111602002006    "

206 CR_token2
  1016,37: 


106 ID Idxs = Expr
  1017,1: block
  1017,6: [1][6]
  1017,13: =
  1017,15: "  61100626666006    "

184 [ Expr ] Idxs
  1017,6: [
  1017,7: 1
  1017,8: ]
  1017,9: [6]

76 NUM
  1017,7: 1

245 ] Idxs
  1017,8: ]
  1017,9: [6]

7 [ Expr ]
  1017,9: [
  1017,10: 6
  1017,11: ]

76 NUM
  1017,10: 6

245 ]
  1017,11: ]

263 = Expr
  1017,13: =
  1017,15: "  61100626666006    "

55 STR
  1017,15: "  61100626666006    "

206 CR_token2
  1017,37: 


106 ID Idxs = Expr
  1018,1: block
  1018,6: [1][7]
  1018,13: =
  1018,15: "  6110000X066006    "

184 [ Expr ] Idxs
  1018,6: [
  1018,7: 1
  1018,8: ]
  1018,9: [7]

76 NUM
  1018,7: 1

245 ] Idxs
  1018,8: ]
  1018,9: [7]

7 [ Expr ]
  1018,9: [
  1018,10: 7
  1018,11: ]

76 NUM
  1018,10: 7

245 ]
  1018,11: ]

263 = Expr
  1018,13: =
  1018,15: "  6110000X066006    "

55 STR
  1018,15: "  6110000X066006    "

206 CR_token2
  1018,37: 


106 ID Idxs = Expr
  1019,1: block
  1019,6: [1][8]
  1019,13: =
  1019,15: "  61100606002076    "

184 [ Expr ] Idxs
  1019,6: [
  1019,7: 1
  1019,8: ]
  1019,9: [8]

76 NUM
  1019,7: 1

245 ] Idxs
  1019,8: ]
  1019,9: [8]

7 [ Expr ]
  1019,9: [
  1019,10: 8
  1019,11: ]

76 NUM
  1019,10: 8

245 ]
  1019,11: ]

263 = Expr
  1019,13: =
  1019,15: "  61100606002076    "

55 STR
  1019,15: "  61100606002076    "

206 CR_token2
  1019,37: 


106 ID Idxs = Expr
  1020,1: block
  1020,6: [1][9]
  1020,13: =
  1020,15: "  76666606620206    "

184 [ Expr ] Idxs
  1020,6: [
  1020,7: 1
  1020,8: ]
  1020,9: [9]

76 NUM
  1020,7: 1

245 ] Idxs
  1020,8: ]
  1020,9: [9]

7 [ Expr ]
  1020,9: [
  1020,10: 9
  1020,11: ]

76 NUM
  1020,10: 9

245 ]
  1020,11: ]

263 = Expr
  1020,13: =
  1020,15: "  76666606620206    "

55 STR
  1020,15: "  76666606620206    "

206 CR_token2
  1020,37: 


106 ID Idxs = Expr
  1021,1: block
  1021,6: [1][10]
  1021,13: =
  1021,15: "    602002020206    "

184 [ Expr ] Idxs
  1021,6: [
  1021,7: 1
  1021,8: ]
  1021,9: [10]

76 NUM
  1021,7: 1

245 ] Idxs
  1021,8: ]
  1021,9: [10]

7 [ Expr ]
  1021,9: [
  1021,10: 10
  1021,12: ]

76 NUM
  1021,10: 10

245 ]
  1021,12: ]

263 = Expr
  1021,13: =
  1021,15: "    602002020206    "

55 STR
  1021,15: "    602002020206    "

206 CR_token2
  1021,37: 


106 ID Idxs = Expr
  1022,1: block
  1022,6: [1][11]
  1022,13: =
  1022,15: "    600007000006    "

184 [ Expr ] Idxs
  1022,6: [
  1022,7: 1
  1022,8: ]
  1022,9: [11]

76 NUM
  1022,7: 1

245 ] Idxs
  1022,8: ]
  1022,9: [11]

7 [ Expr ]
  1022,9: [
  1022,10: 11
  1022,12: ]

76 NUM
  1022,10: 11

245 ]
  1022,12: ]

263 = Expr
  1022,13: =
  1022,15: "    600007000006    "

55 STR
  1022,15: "    600007000006    "

206 CR_token2
  1022,37: 


106 ID Idxs = Expr
  1023,1: block
  1023,6: [1][12]
  1023,13: =
  1023,15: "    766666666667    "

184 [ Expr ] Idxs
  1023,6: [
  1023,7: 1
  1023,8: ]
  1023,9: [12]

76 NUM
  1023,7: 1

245 ] Idxs
  1023,8: ]
  1023,9: [12]

7 [ Expr ]
  1023,9: [
  1023,10: 12
  1023,12: ]

76 NUM
  1023,10: 12

245 ]
  1023,12: ]

263 = Expr
  1023,13: =
  1023,15: "    766666666667    "

55 STR
  1023,15: "    766666666667    "

206 CR_token2
  1023,37: 


106 ID Idxs = Expr
  1024,1: block
  1024,6: [1][13]
  1024,13: =
  1024,15: "                    "

184 [ Expr ] Idxs
  1024,6: [
  1024,7: 1
  1024,8: ]
  1024,9: [13]

76 NUM
  1024,7: 1

245 ] Idxs
  1024,8: ]
  1024,9: [13]

7 [ Expr ]
  1024,9: [
  1024,10: 13
  1024,12: ]

76 NUM
  1024,10: 13

245 ]
  1024,12: ]

263 = Expr
  1024,13: =
  1024,15: "                    "

55 STR
  1024,15: "                    "

206 CR_token2
  1024,37: 


106 ID Idxs = Expr
  1025,1: block
  1025,6: [1][14]
  1025,13: =
  1025,15: "                    "

184 [ Expr ] Idxs
  1025,6: [
  1025,7: 1
  1025,8: ]
  1025,9: [14]

76 NUM
  1025,7: 1

245 ] Idxs
  1025,8: ]
  1025,9: [14]

7 [ Expr ]
  1025,9: [
  1025,10: 14
  1025,12: ]

76 NUM
  1025,10: 14

245 ]
  1025,12: ]

263 = Expr
  1025,13: =
  1025,15: "                    "

55 STR
  1025,15: "                    "

206 CR_token2
  1025,37: 


106 ID Idxs = Expr
  1026,1: block
  1026,6: [1][15]
  1026,13: =
  1026,15: "                    "

184 [ Expr ] Idxs
  1026,6: [
  1026,7: 1
  1026,8: ]
  1026,9: [15]

76 NUM
  1026,7: 1

245 ] Idxs
  1026,8: ]
  1026,9: [15]

7 [ Expr ]
  1026,9: [
  1026,10: 15
  1026,12: ]

76 NUM
  1026,10: 15

245 ]
  1026,12: ]

263 = Expr
  1026,13: =
  1026,15: "                    "

55 STR
  1026,15: "                    "

206 CR_token2
  1026,37: 



106 ID Idxs = Expr
  1028,1: block
  1028,6: [2][0]
  1028,13: =
  1028,15: "                    "

184 [ Expr ] Idxs
  1028,6: [
  1028,7: 2
  1028,8: ]
  1028,9: [0]

76 NUM
  1028,7: 2

245 ] Idxs
  1028,8: ]
  1028,9: [0]

7 [ Expr ]
  1028,9: [
  1028,10: 0
  1028,11: ]

76 NUM
  1028,10: 0

245 ]
  1028,11: ]

263 = Expr
  1028,13: =
  1028,15: "                    "

55 STR
  1028,15: "                    "

206 CR_token2
  1028,37: 


106 ID Idxs = Expr
  1029,1: block
  1029,6: [2][1]
  1029,13: =
  1029,15: "                    "

184 [ Expr ] Idxs
  1029,6: [
  1029,7: 2
  1029,8: ]
  1029,9: [1]

76 NUM
  1029,7: 2

245 ] Idxs
  1029,8: ]
  1029,9: [1]

7 [ Expr ]
  1029,9: [
  1029,10: 1
  1029,11: ]

76 NUM
  1029,10: 1

245 ]
  1029,11: ]

263 = Expr
  1029,13: =
  1029,15: "                    "

55 STR
  1029,15: "                    "

206 CR_token2
  1029,37: 


106 ID Idxs = Expr
  1030,1: block
  1030,6: [2][2]
  1030,13: =
  1030,15: "                    "

184 [ Expr ] Idxs
  1030,6: [
  1030,7: 2
  1030,8: ]
  1030,9: [2]

76 NUM
  1030,7: 2

245 ] Idxs
  1030,8: ]
  1030,9: [2]

7 [ Expr ]
  1030,9: [
  1030,10: 2
  1030,11: ]

76 NUM
  1030,10: 2

245 ]
  1030,11: ]

263 = Expr
  1030,13: =
  1030,15: "                    "

55 STR
  1030,15: "                    "

206 CR_token2
  1030,37: 


106 ID Idxs = Expr
  1031,1: block
  1031,6: [2][3]
  1031,13: =
  1031,15: "         76666667   "

184 [ Expr ] Idxs
  1031,6: [
  1031,7: 2
  1031,8: ]
  1031,9: [3]

76 NUM
  1031,7: 2

245 ] Idxs
  1031,8: ]
  1031,9: [3]

7 [ Expr ]
  1031,9: [
  1031,10: 3
  1031,11: ]

76 NUM
  1031,10: 3

245 ]
  1031,11: ]

263 = Expr
  1031,13: =
  1031,15: "         76666667   "

55 STR
  1031,15: "         76666667   "

206 CR_token2
  1031,37: 


106 ID Idxs = Expr
  1032,1: block
  1032,6: [2][4]
  1032,13: =
  1032,15: "         600000X6   "

184 [ Expr ] Idxs
  1032,6: [
  1032,7: 2
  1032,8: ]
  1032,9: [4]

76 NUM
  1032,7: 2

245 ] Idxs
  1032,8: ]
  1032,9: [4]

7 [ Expr ]
  1032,9: [
  1032,10: 4
  1032,11: ]

76 NUM
  1032,10: 4

245 ]
  1032,11: ]

263 = Expr
  1032,13: =
  1032,15: "         600000X6   "

55 STR
  1032,15: "         600000X6   "

206 CR_token2
  1032,37: 


106 ID Idxs = Expr
  1033,1: block
  1033,6: [2][5]
  1033,13: =
  1033,15: "         60262066   "

184 [ Expr ] Idxs
  1033,6: [
  1033,7: 2
  1033,8: ]
  1033,9: [5]

76 NUM
  1033,7: 2

245 ] Idxs
  1033,8: ]
  1033,9: [5]

7 [ Expr ]
  1033,9: [
  1033,10: 5
  1033,11: ]

76 NUM
  1033,10: 5

245 ]
  1033,11: ]

263 = Expr
  1033,13: =
  1033,15: "         60262066   "

55 STR
  1033,15: "         60262066   "

206 CR_token2
  1033,37: 


106 ID Idxs = Expr
  1034,1: block
  1034,6: [2][6]
  1034,13: =
  1034,15: "         6020026    "

184 [ Expr ] Idxs
  1034,6: [
  1034,7: 2
  1034,8: ]
  1034,9: [6]

76 NUM
  1034,7: 2

245 ] Idxs
  1034,8: ]
  1034,9: [6]

7 [ Expr ]
  1034,9: [
  1034,10: 6
  1034,11: ]

76 NUM
  1034,10: 6

245 ]
  1034,11: ]

263 = Expr
  1034,13: =
  1034,15: "         6020026    "

55 STR
  1034,15: "         6020026    "

206 CR_token2
  1034,37: 


106 ID Idxs = Expr
  1035,1: block
  1035,6: [2][7]
  1035,13: =
  1035,15: "         6720206    "

184 [ Expr ] Idxs
  1035,6: [
  1035,7: 2
  1035,8: ]
  1035,9: [7]

76 NUM
  1035,7: 2

245 ] Idxs
  1035,8: ]
  1035,9: [7]

7 [ Expr ]
  1035,9: [
  1035,10: 7
  1035,11: ]

76 NUM
  1035,10: 7

245 ]
  1035,11: ]

263 = Expr
  1035,13: =
  1035,15: "         6720206    "

55 STR
  1035,15: "         6720206    "

206 CR_token2
  1035,37: 


106 ID Idxs = Expr
  1036,1: block
  1036,6: [2][8]
  1036,13: =
  1036,15: " 7666666 602060667  "

184 [ Expr ] Idxs
  1036,6: [
  1036,7: 2
  1036,8: ]
  1036,9: [8]

76 NUM
  1036,7: 2

245 ] Idxs
  1036,8: ]
  1036,9: [8]

7 [ Expr ]
  1036,9: [
  1036,10: 8
  1036,11: ]

76 NUM
  1036,10: 8

245 ]
  1036,11: ]

263 = Expr
  1036,13: =
  1036,15: " 7666666 602060667  "

55 STR
  1036,15: " 7666666 602060667  "

206 CR_token2
  1036,37: 


106 ID Idxs = Expr
  1037,1: block
  1037,6: [2][9]
  1037,13: =
  1037,15: " 61111066602002006  "

184 [ Expr ] Idxs
  1037,6: [
  1037,7: 2
  1037,8: ]
  1037,9: [9]

76 NUM
  1037,7: 2

245 ] Idxs
  1037,8: ]
  1037,9: [9]

7 [ Expr ]
  1037,9: [
  1037,10: 9
  1037,11: ]

76 NUM
  1037,10: 9

245 ]
  1037,11: ]

263 = Expr
  1037,13: =
  1037,15: " 61111066602002006  "

55 STR
  1037,15: " 61111066602002006  "

206 CR_token2
  1037,37: 


106 ID Idxs = Expr
  1038,1: block
  1038,6: [2][10]
  1038,13: =
  1038,15: " 61110000020020006  "

184 [ Expr ] Idxs
  1038,6: [
  1038,7: 2
  1038,8: ]
  1038,9: [10]

76 NUM
  1038,7: 2

245 ] Idxs
  1038,8: ]
  1038,9: [10]

7 [ Expr ]
  1038,9: [
  1038,10: 10
  1038,12: ]

76 NUM
  1038,10: 10

245 ]
  1038,12: ]

263 = Expr
  1038,13: =
  1038,15: " 61110000020020006  "

55 STR
  1038,15: " 61110000020020006  "

206 CR_token2
  1038,37: 


106 ID Idxs = Expr
  1039,1: block
  1039,6: [2][11]
  1039,13: =
  1039,15: " 61111066666666667  "

184 [ Expr ] Idxs
  1039,6: [
  1039,7: 2
  1039,8: ]
  1039,9: [11]

76 NUM
  1039,7: 2

245 ] Idxs
  1039,8: ]
  1039,9: [11]

7 [ Expr ]
  1039,9: [
  1039,10: 11
  1039,12: ]

76 NUM
  1039,10: 11

245 ]
  1039,12: ]

263 = Expr
  1039,13: =
  1039,15: " 61111066666666667  "

55 STR
  1039,15: " 61111066666666667  "

206 CR_token2
  1039,37: 


106 ID Idxs = Expr
  1040,1: block
  1040,6: [2][12]
  1040,13: =
  1040,15: " 7666666            "

184 [ Expr ] Idxs
  1040,6: [
  1040,7: 2
  1040,8: ]
  1040,9: [12]

76 NUM
  1040,7: 2

245 ] Idxs
  1040,8: ]
  1040,9: [12]

7 [ Expr ]
  1040,9: [
  1040,10: 12
  1040,12: ]

76 NUM
  1040,10: 12

245 ]
  1040,12: ]

263 = Expr
  1040,13: =
  1040,15: " 7666666            "

55 STR
  1040,15: " 7666666            "

206 CR_token2
  1040,37: 


106 ID Idxs = Expr
  1041,1: block
  1041,6: [2][13]
  1041,13: =
  1041,15: "                    "

184 [ Expr ] Idxs
  1041,6: [
  1041,7: 2
  1041,8: ]
  1041,9: [13]

76 NUM
  1041,7: 2

245 ] Idxs
  1041,8: ]
  1041,9: [13]

7 [ Expr ]
  1041,9: [
  1041,10: 13
  1041,12: ]

76 NUM
  1041,10: 13

245 ]
  1041,12: ]

263 = Expr
  1041,13: =
  1041,15: "                    "

55 STR
  1041,15: "                    "

206 CR_token2
  1041,37: 


106 ID Idxs = Expr
  1042,1: block
  1042,6: [2][14]
  1042,13: =
  1042,15: "                    "

184 [ Expr ] Idxs
  1042,6: [
  1042,7: 2
  1042,8: ]
  1042,9: [14]

76 NUM
  1042,7: 2

245 ] Idxs
  1042,8: ]
  1042,9: [14]

7 [ Expr ]
  1042,9: [
  1042,10: 14
  1042,12: ]

76 NUM
  1042,10: 14

245 ]
  1042,12: ]

263 = Expr
  1042,13: =
  1042,15: "                    "

55 STR
  1042,15: "                    "

206 CR_token2
  1042,37: 


106 ID Idxs = Expr
  1043,1: block
  1043,6: [2][15]
  1043,13: =
  1043,15: "                    "

184 [ Expr ] Idxs
  1043,6: [
  1043,7: 2
  1043,8: ]
  1043,9: [15]

76 NUM
  1043,7: 2

245 ] Idxs
  1043,8: ]
  1043,9: [15]

7 [ Expr ]
  1043,9: [
  1043,10: 15
  1043,12: ]

76 NUM
  1043,10: 15

245 ]
  1043,12: ]

263 = Expr
  1043,13: =
  1043,15: "                    "

55 STR
  1043,15: "                    "

206 CR_token2
  1043,37: 



106 ID Idxs = Expr
  1045,1: block
  1045,6: [3][0]
  1045,13: =
  1045,15: "                    "

184 [ Expr ] Idxs
  1045,6: [
  1045,7: 3
  1045,8: ]
  1045,9: [0]

76 NUM
  1045,7: 3

245 ] Idxs
  1045,8: ]
  1045,9: [0]

7 [ Expr ]
  1045,9: [
  1045,10: 0
  1045,11: ]

76 NUM
  1045,10: 0

245 ]
  1045,11: ]

263 = Expr
  1045,13: =
  1045,15: "                    "

55 STR
  1045,15: "                    "

206 CR_token2
  1045,37: 


106 ID Idxs = Expr
  1046,1: block
  1046,6: [3][1]
  1046,13: =
  1046,15: "                    "

184 [ Expr ] Idxs
  1046,6: [
  1046,7: 3
  1046,8: ]
  1046,9: [1]

76 NUM
  1046,7: 3

245 ] Idxs
  1046,8: ]
  1046,9: [1]

7 [ Expr ]
  1046,9: [
  1046,10: 1
  1046,11: ]

76 NUM
  1046,10: 1

245 ]
  1046,11: ]

263 = Expr
  1046,13: =
  1046,15: "                    "

55 STR
  1046,15: "                    "

206 CR_token2
  1046,37: 


106 ID Idxs = Expr
  1047,1: block
  1047,6: [3][2]
  1047,13: =
  1047,15: "6666663             "

184 [ Expr ] Idxs
  1047,6: [
  1047,7: 3
  1047,8: ]
  1047,9: [2]

76 NUM
  1047,7: 3

245 ] Idxs
  1047,8: ]
  1047,9: [2]

7 [ Expr ]
  1047,9: [
  1047,10: 2
  1047,11: ]

76 NUM
  1047,10: 2

245 ]
  1047,11: ]

263 = Expr
  1047,13: =
  1047,15: "6666663             "

55 STR
  1047,15: "6666663             "

206 CR_token2
  1047,37: 


106 ID Idxs = Expr
  1048,1: block
  1048,6: [3][3]
  1048,13: =
  1048,15: "611166366666  66666 "

184 [ Expr ] Idxs
  1048,6: [
  1048,7: 3
  1048,8: ]
  1048,9: [3]

76 NUM
  1048,7: 3

245 ] Idxs
  1048,8: ]
  1048,9: [3]

7 [ Expr ]
  1048,9: [
  1048,10: 3
  1048,11: ]

76 NUM
  1048,10: 3

245 ]
  1048,11: ]

263 = Expr
  1048,13: =
  1048,15: "611166366666  66666 "

55 STR
  1048,15: "611166366666  66666 "

206 CR_token2
  1048,37: 


106 ID Idxs = Expr
  1049,1: block
  1049,6: [3][4]
  1049,13: =
  1049,15: "611116360006  60006 "

184 [ Expr ] Idxs
  1049,6: [
  1049,7: 3
  1049,8: ]
  1049,9: [4]

76 NUM
  1049,7: 3

245 ] Idxs
  1049,8: ]
  1049,9: [4]

7 [ Expr ]
  1049,9: [
  1049,10: 4
  1049,11: ]

76 NUM
  1049,10: 4

245 ]
  1049,11: ]

263 = Expr
  1049,13: =
  1049,15: "611116360006  60006 "

55 STR
  1049,15: "611116360006  60006 "

206 CR_token2
  1049,37: 


106 ID Idxs = Expr
  1050,1: block
  1050,6: [3][5]
  1050,13: =
  1050,15: "6111163607066660706 "

184 [ Expr ] Idxs
  1050,6: [
  1050,7: 3
  1050,8: ]
  1050,9: [5]

76 NUM
  1050,7: 3

245 ] Idxs
  1050,8: ]
  1050,9: [5]

7 [ Expr ]
  1050,9: [
  1050,10: 5
  1050,11: ]

76 NUM
  1050,10: 5

245 ]
  1050,11: ]

263 = Expr
  1050,13: =
  1050,15: "6111163607066660706 "

55 STR
  1050,15: "6111163607066660706 "

206 CR_token2
  1050,37: 


106 ID Idxs = Expr
  1051,1: block
  1051,6: [3][6]
  1051,13: =
  1051,15: "600X063600200000006 "

184 [ Expr ] Idxs
  1051,6: [
  1051,7: 3
  1051,8: ]
  1051,9: [6]

76 NUM
  1051,7: 3

245 ] Idxs
  1051,8: ]
  1051,9: [6]

7 [ Expr ]
  1051,9: [
  1051,10: 6
  1051,11: ]

76 NUM
  1051,10: 6

245 ]
  1051,11: ]

263 = Expr
  1051,13: =
  1051,15: "600X063600200000006 "

55 STR
  1051,15: "600X063600200000006 "

206 CR_token2
  1051,37: 


106 ID Idxs = Expr
  1052,1: block
  1052,6: [3][7]
  1052,13: =
  1052,15: "6606663700602260666 "

184 [ Expr ] Idxs
  1052,6: [
  1052,7: 3
  1052,8: ]
  1052,9: [7]

76 NUM
  1052,7: 3

245 ] Idxs
  1052,8: ]
  1052,9: [7]

7 [ Expr ]
  1052,9: [
  1052,10: 7
  1052,11: ]

76 NUM
  1052,10: 7

245 ]
  1052,11: ]

263 = Expr
  1052,13: =
  1052,15: "6606663700602260666 "

55 STR
  1052,15: "6606663700602260666 "

206 CR_token2
  1052,37: 


106 ID Idxs = Expr
  1053,1: block
  1053,6: [3][8]
  1053,13: =
  1053,15: "5AAAA73A220060006   "

184 [ Expr ] Idxs
  1053,6: [
  1053,7: 3
  1053,8: ]
  1053,9: [8]

76 NUM
  1053,7: 3

245 ] Idxs
  1053,8: ]
  1053,9: [8]

7 [ Expr ]
  1053,9: [
  1053,10: 8
  1053,11: ]

76 NUM
  1053,10: 8

245 ]
  1053,11: ]

263 = Expr
  1053,13: =
  1053,15: "5AAAA73A220060006   "

55 STR
  1053,15: "5AAAA73A220060006   "

206 CR_token2
  1053,37: 


106 ID Idxs = Expr
  1054,1: block
  1054,6: [3][9]
  1054,13: =
  1054,15: "5ACAABBB002666206   "

184 [ Expr ] Idxs
  1054,6: [
  1054,7: 3
  1054,8: ]
  1054,9: [9]

76 NUM
  1054,7: 3

245 ] Idxs
  1054,8: ]
  1054,9: [9]

7 [ Expr ]
  1054,9: [
  1054,10: 9
  1054,11: ]

76 NUM
  1054,10: 9

245 ]
  1054,11: ]

263 = Expr
  1054,13: =
  1054,15: "5ACAABBB002666206   "

55 STR
  1054,15: "5ACAABBB002666206   "

206 CR_token2
  1054,37: 


106 ID Idxs = Expr
  1055,1: block
  1055,6: [3][10]
  1055,13: =
  1055,15: "5AA5AA3A700060006   "

184 [ Expr ] Idxs
  1055,6: [
  1055,7: 3
  1055,8: ]
  1055,9: [10]

76 NUM
  1055,7: 3

245 ] Idxs
  1055,8: ]
  1055,9: [10]

7 [ Expr ]
  1055,9: [
  1055,10: 10
  1055,12: ]

76 NUM
  1055,10: 10

245 ]
  1055,12: ]

263 = Expr
  1055,13: =
  1055,15: "5AA5AA3A700060006   "

55 STR
  1055,15: "5AA5AA3A700060006   "

206 CR_token2
  1055,37: 


106 ID Idxs = Expr
  1056,1: block
  1056,6: [3][11]
  1056,13: =
  1056,15: "5555553A666060726   "

184 [ Expr ] Idxs
  1056,6: [
  1056,7: 3
  1056,8: ]
  1056,9: [11]

76 NUM
  1056,7: 3

245 ] Idxs
  1056,8: ]
  1056,9: [11]

7 [ Expr ]
  1056,9: [
  1056,10: 11
  1056,12: ]

76 NUM
  1056,10: 11

245 ]
  1056,12: ]

263 = Expr
  1056,13: =
  1056,15: "5555553A666060726   "

55 STR
  1056,15: "5555553A666060726   "

206 CR_token2
  1056,37: 


106 ID Idxs = Expr
  1057,1: block
  1057,6: [3][12]
  1057,13: =
  1057,15: "AAAAAA3AAA6022006   "

184 [ Expr ] Idxs
  1057,6: [
  1057,7: 3
  1057,8: ]
  1057,9: [12]

76 NUM
  1057,7: 3

245 ] Idxs
  1057,8: ]
  1057,9: [12]

7 [ Expr ]
  1057,9: [
  1057,10: 12
  1057,12: ]

76 NUM
  1057,10: 12

245 ]
  1057,12: ]

263 = Expr
  1057,13: =
  1057,15: "AAAAAA3AAA6022006   "

55 STR
  1057,15: "AAAAAA3AAA6022006   "

206 CR_token2
  1057,37: 


106 ID Idxs = Expr
  1058,1: block
  1058,6: [3][13]
  1058,13: =
  1058,15: "33333333336000006   "

184 [ Expr ] Idxs
  1058,6: [
  1058,7: 3
  1058,8: ]
  1058,9: [13]

76 NUM
  1058,7: 3

245 ] Idxs
  1058,8: ]
  1058,9: [13]

7 [ Expr ]
  1058,9: [
  1058,10: 13
  1058,12: ]

76 NUM
  1058,10: 13

245 ]
  1058,12: ]

263 = Expr
  1058,13: =
  1058,15: "33333333336000006   "

55 STR
  1058,15: "33333333336000006   "

206 CR_token2
  1058,37: 


106 ID Idxs = Expr
  1059,1: block
  1059,6: [3][14]
  1059,13: =
  1059,15: "          6666666   "

184 [ Expr ] Idxs
  1059,6: [
  1059,7: 3
  1059,8: ]
  1059,9: [14]

76 NUM
  1059,7: 3

245 ] Idxs
  1059,8: ]
  1059,9: [14]

7 [ Expr ]
  1059,9: [
  1059,10: 14
  1059,12: ]

76 NUM
  1059,10: 14

245 ]
  1059,12: ]

263 = Expr
  1059,13: =
  1059,15: "          6666666   "

55 STR
  1059,15: "          6666666   "

206 CR_token2
  1059,37: 


106 ID Idxs = Expr
  1060,1: block
  1060,6: [3][15]
  1060,13: =
  1060,15: "                    "

184 [ Expr ] Idxs
  1060,6: [
  1060,7: 3
  1060,8: ]
  1060,9: [15]

76 NUM
  1060,7: 3

245 ] Idxs
  1060,8: ]
  1060,9: [15]

7 [ Expr ]
  1060,9: [
  1060,10: 15
  1060,12: ]

76 NUM
  1060,10: 15

245 ]
  1060,12: ]

263 = Expr
  1060,13: =
  1060,15: "                    "

55 STR
  1060,15: "                    "

206 CR_token2
  1060,37: 



106 ID Idxs = Expr
  1062,1: block
  1062,6: [4][0]
  1062,13: =
  1062,15: "                    "

184 [ Expr ] Idxs
  1062,6: [
  1062,7: 4
  1062,8: ]
  1062,9: [0]

76 NUM
  1062,7: 4

245 ] Idxs
  1062,8: ]
  1062,9: [0]

7 [ Expr ]
  1062,9: [
  1062,10: 0
  1062,11: ]

76 NUM
  1062,10: 0

245 ]
  1062,11: ]

263 = Expr
  1062,13: =
  1062,15: "                    "

55 STR
  1062,15: "                    "

206 CR_token2
  1062,37: 


106 ID Idxs = Expr
  1063,1: block
  1063,6: [4][1]
  1063,13: =
  1063,15: "                    "

184 [ Expr ] Idxs
  1063,6: [
  1063,7: 4
  1063,8: ]
  1063,9: [1]

76 NUM
  1063,7: 4

245 ] Idxs
  1063,8: ]
  1063,9: [1]

7 [ Expr ]
  1063,9: [
  1063,10: 1
  1063,11: ]

76 NUM
  1063,10: 1

245 ]
  1063,11: ]

263 = Expr
  1063,13: =
  1063,15: "                    "

55 STR
  1063,15: "                    "

206 CR_token2
  1063,37: 


106 ID Idxs = Expr
  1064,1: block
  1064,6: [4][2]
  1064,13: =
  1064,15: "          66666     "

184 [ Expr ] Idxs
  1064,6: [
  1064,7: 4
  1064,8: ]
  1064,9: [2]

76 NUM
  1064,7: 4

245 ] Idxs
  1064,8: ]
  1064,9: [2]

7 [ Expr ]
  1064,9: [
  1064,10: 2
  1064,11: ]

76 NUM
  1064,10: 2

245 ]
  1064,11: ]

263 = Expr
  1064,13: =
  1064,15: "          66666     "

55 STR
  1064,15: "          66666     "

206 CR_token2
  1064,37: 


106 ID Idxs = Expr
  1065,1: block
  1065,6: [4][3]
  1065,13: =
  1065,15: "    666666600067    "

184 [ Expr ] Idxs
  1065,6: [
  1065,7: 4
  1065,8: ]
  1065,9: [3]

76 NUM
  1065,7: 4

245 ] Idxs
  1065,8: ]
  1065,9: [3]

7 [ Expr ]
  1065,9: [
  1065,10: 3
  1065,11: ]

76 NUM
  1065,10: 3

245 ]
  1065,11: ]

263 = Expr
  1065,13: =
  1065,15: "    666666600067    "

55 STR
  1065,15: "    666666600067    "

206 CR_token2
  1065,37: 


106 ID Idxs = Expr
  1066,1: block
  1066,6: [4][4]
  1066,13: =
  1066,15: "   66070X6602206    "

184 [ Expr ] Idxs
  1066,6: [
  1066,7: 4
  1066,8: ]
  1066,9: [4]

76 NUM
  1066,7: 4

245 ] Idxs
  1066,8: ]
  1066,9: [4]

7 [ Expr ]
  1066,9: [
  1066,10: 4
  1066,11: ]

76 NUM
  1066,10: 4

245 ]
  1066,11: ]

263 = Expr
  1066,13: =
  1066,15: "   66070X6602206    "

55 STR
  1066,15: "   66070X6602206    "

206 CR_token2
  1066,37: 


106 ID Idxs = Expr
  1067,1: block
  1067,6: [4][5]
  1067,13: =
  1067,15: "   6000020000006    "

184 [ Expr ] Idxs
  1067,6: [
  1067,7: 4
  1067,8: ]
  1067,9: [5]

76 NUM
  1067,7: 4

245 ] Idxs
  1067,8: ]
  1067,9: [5]

7 [ Expr ]
  1067,9: [
  1067,10: 5
  1067,11: ]

76 NUM
  1067,10: 5

245 ]
  1067,11: ]

263 = Expr
  1067,13: =
  1067,15: "   6000020000006    "

55 STR
  1067,15: "   6000020000006    "

206 CR_token2
  1067,37: 


106 ID Idxs = Expr
  1068,1: block
  1068,6: [4][6]
  1068,13: =
  1068,15: "   6002006660006    "

184 [ Expr ] Idxs
  1068,6: [
  1068,7: 4
  1068,8: ]
  1068,9: [6]

76 NUM
  1068,7: 4

245 ] Idxs
  1068,8: ]
  1068,9: [6]

7 [ Expr ]
  1068,9: [
  1068,10: 6
  1068,11: ]

76 NUM
  1068,10: 6

245 ]
  1068,11: ]

263 = Expr
  1068,13: =
  1068,15: "   6002006660006    "

55 STR
  1068,15: "   6002006660006    "

206 CR_token2
  1068,37: 


106 ID Idxs = Expr
  1069,1: block
  1069,6: [4][7]
  1069,13: =
  1069,15: "   6660666662666    "

184 [ Expr ] Idxs
  1069,6: [
  1069,7: 4
  1069,8: ]
  1069,9: [7]

76 NUM
  1069,7: 4

245 ] Idxs
  1069,8: ]
  1069,9: [7]

7 [ Expr ]
  1069,9: [
  1069,10: 7
  1069,11: ]

76 NUM
  1069,10: 7

245 ]
  1069,11: ]

263 = Expr
  1069,13: =
  1069,15: "   6660666662666    "

55 STR
  1069,15: "   6660666662666    "

206 CR_token2
  1069,37: 


106 ID Idxs = Expr
  1070,1: block
  1070,6: [4][8]
  1070,13: =
  1070,15: "   602006660116     "

184 [ Expr ] Idxs
  1070,6: [
  1070,7: 4
  1070,8: ]
  1070,9: [8]

76 NUM
  1070,7: 4

245 ] Idxs
  1070,8: ]
  1070,9: [8]

7 [ Expr ]
  1070,9: [
  1070,10: 8
  1070,11: ]

76 NUM
  1070,10: 8

245 ]
  1070,11: ]

263 = Expr
  1070,13: =
  1070,15: "   602006660116     "

55 STR
  1070,15: "   602006660116     "

206 CR_token2
  1070,37: 


106 ID Idxs = Expr
  1071,1: block
  1071,6: [4][9]
  1071,13: =
  1071,15: "   602020201116     "

184 [ Expr ] Idxs
  1071,6: [
  1071,7: 4
  1071,8: ]
  1071,9: [9]

76 NUM
  1071,7: 4

245 ] Idxs
  1071,8: ]
  1071,9: [9]

7 [ Expr ]
  1071,9: [
  1071,10: 9
  1071,11: ]

76 NUM
  1071,10: 9

245 ]
  1071,11: ]

263 = Expr
  1071,13: =
  1071,15: "   602020201116     "

55 STR
  1071,15: "   602020201116     "

206 CR_token2
  1071,37: 


106 ID Idxs = Expr
  1072,1: block
  1072,6: [4][10]
  1072,13: =
  1072,15: "   600006661116     "

184 [ Expr ] Idxs
  1072,6: [
  1072,7: 4
  1072,8: ]
  1072,9: [10]

76 NUM
  1072,7: 4

245 ] Idxs
  1072,8: ]
  1072,9: [10]

7 [ Expr ]
  1072,9: [
  1072,10: 10
  1072,12: ]

76 NUM
  1072,10: 10

245 ]
  1072,12: ]

263 = Expr
  1072,13: =
  1072,15: "   600006661116     "

55 STR
  1072,15: "   600006661116     "

206 CR_token2
  1072,37: 


106 ID Idxs = Expr
  1073,1: block
  1073,6: [4][11]
  1073,13: =
  1073,15: "   602206 61116     "

184 [ Expr ] Idxs
  1073,6: [
  1073,7: 4
  1073,8: ]
  1073,9: [11]

76 NUM
  1073,7: 4

245 ] Idxs
  1073,8: ]
  1073,9: [11]

7 [ Expr ]
  1073,9: [
  1073,10: 11
  1073,12: ]

76 NUM
  1073,10: 11

245 ]
  1073,12: ]

263 = Expr
  1073,13: =
  1073,15: "   602206 61116     "

55 STR
  1073,15: "   602206 61116     "

206 CR_token2
  1073,37: 


106 ID Idxs = Expr
  1074,1: block
  1074,6: [4][12]
  1074,13: =
  1074,15: "   600666 76667     "

184 [ Expr ] Idxs
  1074,6: [
  1074,7: 4
  1074,8: ]
  1074,9: [12]

76 NUM
  1074,7: 4

245 ] Idxs
  1074,8: ]
  1074,9: [12]

7 [ Expr ]
  1074,9: [
  1074,10: 12
  1074,12: ]

76 NUM
  1074,10: 12

245 ]
  1074,12: ]

263 = Expr
  1074,13: =
  1074,15: "   600666 76667     "

55 STR
  1074,15: "   600666 76667     "

206 CR_token2
  1074,37: 


106 ID Idxs = Expr
  1075,1: block
  1075,6: [4][13]
  1075,13: =
  1075,15: "   7667             "

184 [ Expr ] Idxs
  1075,6: [
  1075,7: 4
  1075,8: ]
  1075,9: [13]

76 NUM
  1075,7: 4

245 ] Idxs
  1075,8: ]
  1075,9: [13]

7 [ Expr ]
  1075,9: [
  1075,10: 13
  1075,12: ]

76 NUM
  1075,10: 13

245 ]
  1075,12: ]

263 = Expr
  1075,13: =
  1075,15: "   7667             "

55 STR
  1075,15: "   7667             "

206 CR_token2
  1075,37: 


106 ID Idxs = Expr
  1076,1: block
  1076,6: [4][14]
  1076,13: =
  1076,15: "                    "

184 [ Expr ] Idxs
  1076,6: [
  1076,7: 4
  1076,8: ]
  1076,9: [14]

76 NUM
  1076,7: 4

245 ] Idxs
  1076,8: ]
  1076,9: [14]

7 [ Expr ]
  1076,9: [
  1076,10: 14
  1076,12: ]

76 NUM
  1076,10: 14

245 ]
  1076,12: ]

263 = Expr
  1076,13: =
  1076,15: "                    "

55 STR
  1076,15: "                    "

206 CR_token2
  1076,37: 


106 ID Idxs = Expr
  1077,1: block
  1077,6: [4][15]
  1077,13: =
  1077,15: "                    "

184 [ Expr ] Idxs
  1077,6: [
  1077,7: 4
  1077,8: ]
  1077,9: [15]

76 NUM
  1077,7: 4

245 ] Idxs
  1077,8: ]
  1077,9: [15]

7 [ Expr ]
  1077,9: [
  1077,10: 15
  1077,12: ]

76 NUM
  1077,10: 15

245 ]
  1077,12: ]

263 = Expr
  1077,13: =
  1077,15: "                    "

55 STR
  1077,15: "                    "

206 CR_token2
  1077,37: 



106 ID Idxs = Expr
  1079,1: block
  1079,6: [5][0]
  1079,13: =
  1079,15: "                    "

184 [ Expr ] Idxs
  1079,6: [
  1079,7: 5
  1079,8: ]
  1079,9: [0]

76 NUM
  1079,7: 5

245 ] Idxs
  1079,8: ]
  1079,9: [0]

7 [ Expr ]
  1079,9: [
  1079,10: 0
  1079,11: ]

76 NUM
  1079,10: 0

245 ]
  1079,11: ]

263 = Expr
  1079,13: =
  1079,15: "                    "

55 STR
  1079,15: "                    "

206 CR_token2
  1079,37: 


106 ID Idxs = Expr
  1080,1: block
  1080,6: [5][1]
  1080,13: =
  1080,15: "           4444444  "

184 [ Expr ] Idxs
  1080,6: [
  1080,7: 5
  1080,8: ]
  1080,9: [1]

76 NUM
  1080,7: 5

245 ] Idxs
  1080,8: ]
  1080,9: [1]

7 [ Expr ]
  1080,9: [
  1080,10: 1
  1080,11: ]

76 NUM
  1080,10: 1

245 ]
  1080,11: ]

263 = Expr
  1080,13: =
  1080,15: "           4444444  "

55 STR
  1080,15: "           4444444  "

206 CR_token2
  1080,37: 


106 ID Idxs = Expr
  1081,1: block
  1081,6: [5][2]
  1081,13: =
  1081,15: "           4AA1114  "

184 [ Expr ] Idxs
  1081,6: [
  1081,7: 5
  1081,8: ]
  1081,9: [2]

76 NUM
  1081,7: 5

245 ] Idxs
  1081,8: ]
  1081,9: [2]

7 [ Expr ]
  1081,9: [
  1081,10: 2
  1081,11: ]

76 NUM
  1081,10: 2

245 ]
  1081,11: ]

263 = Expr
  1081,13: =
  1081,15: "           4AA1114  "

55 STR
  1081,15: "           4AA1114  "

206 CR_token2
  1081,37: 


106 ID Idxs = Expr
  1082,1: block
  1082,6: [5][3]
  1082,13: =
  1082,15: "       66667AA1114  "

184 [ Expr ] Idxs
  1082,6: [
  1082,7: 5
  1082,8: ]
  1082,9: [3]

76 NUM
  1082,7: 5

245 ] Idxs
  1082,8: ]
  1082,9: [3]

7 [ Expr ]
  1082,9: [
  1082,10: 3
  1082,11: ]

76 NUM
  1082,10: 3

245 ]
  1082,11: ]

263 = Expr
  1082,13: =
  1082,15: "       66667AA1114  "

55 STR
  1082,15: "       66667AA1114  "

206 CR_token2
  1082,37: 


106 ID Idxs = Expr
  1083,1: block
  1083,6: [5][4]
  1083,13: =
  1083,15: "       60000AA1A14  "

184 [ Expr ] Idxs
  1083,6: [
  1083,7: 5
  1083,8: ]
  1083,9: [4]

76 NUM
  1083,7: 5

245 ] Idxs
  1083,8: ]
  1083,9: [4]

7 [ Expr ]
  1083,9: [
  1083,10: 4
  1083,11: ]

76 NUM
  1083,10: 4

245 ]
  1083,11: ]

263 = Expr
  1083,13: =
  1083,15: "       60000AA1A14  "

55 STR
  1083,15: "       60000AA1A14  "

206 CR_token2
  1083,37: 


106 ID Idxs = Expr
  1084,1: block
  1084,6: [5][5]
  1084,13: =
  1084,15: "       60067AA1114  "

184 [ Expr ] Idxs
  1084,6: [
  1084,7: 5
  1084,8: ]
  1084,9: [5]

76 NUM
  1084,7: 5

245 ] Idxs
  1084,8: ]
  1084,9: [5]

7 [ Expr ]
  1084,9: [
  1084,10: 5
  1084,11: ]

76 NUM
  1084,10: 5

245 ]
  1084,11: ]

263 = Expr
  1084,13: =
  1084,15: "       60067AA1114  "

55 STR
  1084,15: "       60067AA1114  "

206 CR_token2
  1084,37: 


106 ID Idxs = Expr
  1085,1: block
  1085,6: [5][6]
  1085,13: =
  1085,15: "       66066AA1114  "

184 [ Expr ] Idxs
  1085,6: [
  1085,7: 5
  1085,8: ]
  1085,9: [6]

76 NUM
  1085,7: 5

245 ] Idxs
  1085,8: ]
  1085,9: [6]

7 [ Expr ]
  1085,9: [
  1085,10: 6
  1085,11: ]

76 NUM
  1085,10: 6

245 ]
  1085,11: ]

263 = Expr
  1085,13: =
  1085,15: "       66066AA1114  "

55 STR
  1085,15: "       66066AA1114  "

206 CR_token2
  1085,37: 


106 ID Idxs = Expr
  1086,1: block
  1086,6: [5][7]
  1086,13: =
  1086,15: "      666066444444  "

184 [ Expr ] Idxs
  1086,6: [
  1086,7: 5
  1086,8: ]
  1086,9: [7]

76 NUM
  1086,7: 5

245 ] Idxs
  1086,8: ]
  1086,9: [7]

7 [ Expr ]
  1086,9: [
  1086,10: 7
  1086,11: ]

76 NUM
  1086,10: 7

245 ]
  1086,11: ]

263 = Expr
  1086,13: =
  1086,15: "      666066444444  "

55 STR
  1086,15: "      666066444444  "

206 CR_token2
  1086,37: 


106 ID Idxs = Expr
  1087,1: block
  1087,6: [5][8]
  1087,13: =
  1087,15: "      60222066AAAA  "

184 [ Expr ] Idxs
  1087,6: [
  1087,7: 5
  1087,8: ]
  1087,9: [8]

76 NUM
  1087,7: 5

245 ] Idxs
  1087,8: ]
  1087,9: [8]

7 [ Expr ]
  1087,9: [
  1087,10: 8
  1087,11: ]

76 NUM
  1087,10: 8

245 ]
  1087,11: ]

263 = Expr
  1087,13: =
  1087,15: "      60222066AAAA  "

55 STR
  1087,15: "      60222066AAAA  "

206 CR_token2
  1087,37: 


106 ID Idxs = Expr
  1088,1: block
  1088,6: [5][9]
  1088,13: =
  1088,15: "  6666600202066666  "

184 [ Expr ] Idxs
  1088,6: [
  1088,7: 5
  1088,8: ]
  1088,9: [9]

76 NUM
  1088,7: 5

245 ] Idxs
  1088,8: ]
  1088,9: [9]

7 [ Expr ]
  1088,9: [
  1088,10: 9
  1088,11: ]

76 NUM
  1088,10: 9

245 ]
  1088,11: ]

263 = Expr
  1088,13: =
  1088,15: "  6666600202066666  "

55 STR
  1088,15: "  6666600202066666  "

206 CR_token2
  1088,37: 


106 ID Idxs = Expr
  1089,1: block
  1089,6: [5][10]
  1089,13: =
  1089,15: " 66000720200070006  "

184 [ Expr ] Idxs
  1089,6: [
  1089,7: 5
  1089,8: ]
  1089,9: [10]

76 NUM
  1089,7: 5

245 ] Idxs
  1089,8: ]
  1089,9: [10]

7 [ Expr ]
  1089,9: [
  1089,10: 10
  1089,12: ]

76 NUM
  1089,10: 10

245 ]
  1089,12: ]

263 = Expr
  1089,13: =
  1089,15: " 66000720200070006  "

55 STR
  1089,15: " 66000720200070006  "

206 CR_token2
  1089,37: 


106 ID Idxs = Expr
  1090,1: block
  1090,6: [5][11]
  1090,13: =
  1090,15: " 6X020020000200206  "

184 [ Expr ] Idxs
  1090,6: [
  1090,7: 5
  1090,8: ]
  1090,9: [11]

76 NUM
  1090,7: 5

245 ] Idxs
  1090,8: ]
  1090,9: [11]

7 [ Expr ]
  1090,9: [
  1090,10: 11
  1090,12: ]

76 NUM
  1090,10: 11

245 ]
  1090,12: ]

263 = Expr
  1090,13: =
  1090,15: " 6X020020000200206  "

55 STR
  1090,15: " 6X020020000200206  "

206 CR_token2
  1090,37: 


106 ID Idxs = Expr
  1091,1: block
  1091,6: [5][12]
  1091,13: =
  1091,15: " 66666602202066666  "

184 [ Expr ] Idxs
  1091,6: [
  1091,7: 5
  1091,8: ]
  1091,9: [12]

76 NUM
  1091,7: 5

245 ] Idxs
  1091,8: ]
  1091,9: [12]

7 [ Expr ]
  1091,9: [
  1091,10: 12
  1091,12: ]

76 NUM
  1091,10: 12

245 ]
  1091,12: ]

263 = Expr
  1091,13: =
  1091,15: " 66666602202066666  "

55 STR
  1091,15: " 66666602202066666  "

206 CR_token2
  1091,37: 


106 ID Idxs = Expr
  1092,1: block
  1092,6: [5][13]
  1092,13: =
  1092,15: "      60000006      "

184 [ Expr ] Idxs
  1092,6: [
  1092,7: 5
  1092,8: ]
  1092,9: [13]

76 NUM
  1092,7: 5

245 ] Idxs
  1092,8: ]
  1092,9: [13]

7 [ Expr ]
  1092,9: [
  1092,10: 13
  1092,12: ]

76 NUM
  1092,10: 13

245 ]
  1092,12: ]

263 = Expr
  1092,13: =
  1092,15: "      60000006      "

55 STR
  1092,15: "      60000006      "

206 CR_token2
  1092,37: 


106 ID Idxs = Expr
  1093,1: block
  1093,6: [5][14]
  1093,13: =
  1093,15: "      66666666      "

184 [ Expr ] Idxs
  1093,6: [
  1093,7: 5
  1093,8: ]
  1093,9: [14]

76 NUM
  1093,7: 5

245 ] Idxs
  1093,8: ]
  1093,9: [14]

7 [ Expr ]
  1093,9: [
  1093,10: 14
  1093,12: ]

76 NUM
  1093,10: 14

245 ]
  1093,12: ]

263 = Expr
  1093,13: =
  1093,15: "      66666666      "

55 STR
  1093,15: "      66666666      "

206 CR_token2
  1093,37: 


106 ID Idxs = Expr
  1094,1: block
  1094,6: [5][15]
  1094,13: =
  1094,15: "                    "

184 [ Expr ] Idxs
  1094,6: [
  1094,7: 5
  1094,8: ]
  1094,9: [15]

76 NUM
  1094,7: 5

245 ] Idxs
  1094,8: ]
  1094,9: [15]

7 [ Expr ]
  1094,9: [
  1094,10: 15
  1094,12: ]

76 NUM
  1094,10: 15

245 ]
  1094,12: ]

263 = Expr
  1094,13: =
  1094,15: "                    "

55 STR
  1094,15: "                    "

206 CR_token2
  1094,37: 



106 ID Idxs = Expr
  1096,1: block
  1096,6: [6][0]
  1096,13: =
  1096,15: "                    "

184 [ Expr ] Idxs
  1096,6: [
  1096,7: 6
  1096,8: ]
  1096,9: [0]

76 NUM
  1096,7: 6

245 ] Idxs
  1096,8: ]
  1096,9: [0]

7 [ Expr ]
  1096,9: [
  1096,10: 0
  1096,11: ]

76 NUM
  1096,10: 0

245 ]
  1096,11: ]

263 = Expr
  1096,13: =
  1096,15: "                    "

55 STR
  1096,15: "                    "

206 CR_token2
  1096,37: 


106 ID Idxs = Expr
  1097,1: block
  1097,6: [6][1]
  1097,13: =
  1097,15: "     7777777777     "

184 [ Expr ] Idxs
  1097,6: [
  1097,7: 6
  1097,8: ]
  1097,9: [1]

76 NUM
  1097,7: 6

245 ] Idxs
  1097,8: ]
  1097,9: [1]

7 [ Expr ]
  1097,9: [
  1097,10: 1
  1097,11: ]

76 NUM
  1097,10: 1

245 ]
  1097,11: ]

263 = Expr
  1097,13: =
  1097,15: "     7777777777     "

55 STR
  1097,15: "     7777777777     "

206 CR_token2
  1097,37: 


106 ID Idxs = Expr
  1098,1: block
  1098,6: [6][2]
  1098,13: =
  1098,15: "     7110070007     "

184 [ Expr ] Idxs
  1098,6: [
  1098,7: 6
  1098,8: ]
  1098,9: [2]

76 NUM
  1098,7: 6

245 ] Idxs
  1098,8: ]
  1098,9: [2]

7 [ Expr ]
  1098,9: [
  1098,10: 2
  1098,11: ]

76 NUM
  1098,10: 2

245 ]
  1098,11: ]

263 = Expr
  1098,13: =
  1098,15: "     7110070007     "

55 STR
  1098,15: "     7110070007     "

206 CR_token2
  1098,37: 


106 ID Idxs = Expr
  1099,1: block
  1099,6: [6][3]
  1099,13: =
  1099,15: "     7110000007     "

184 [ Expr ] Idxs
  1099,6: [
  1099,7: 6
  1099,8: ]
  1099,9: [3]

76 NUM
  1099,7: 6

245 ] Idxs
  1099,8: ]
  1099,9: [3]

7 [ Expr ]
  1099,9: [
  1099,10: 3
  1099,11: ]

76 NUM
  1099,10: 3

245 ]
  1099,11: ]

263 = Expr
  1099,13: =
  1099,15: "     7110000007     "

55 STR
  1099,15: "     7110000007     "

206 CR_token2
  1099,37: 


106 ID Idxs = Expr
  1100,1: block
  1100,6: [6][4]
  1100,13: =
  1100,15: "     711007007777   "

184 [ Expr ] Idxs
  1100,6: [
  1100,7: 6
  1100,8: ]
  1100,9: [4]

76 NUM
  1100,7: 6

245 ] Idxs
  1100,8: ]
  1100,9: [4]

7 [ Expr ]
  1100,9: [
  1100,10: 4
  1100,11: ]

76 NUM
  1100,10: 4

245 ]
  1100,11: ]

263 = Expr
  1100,13: =
  1100,15: "     711007007777   "

55 STR
  1100,15: "     711007007777   "

206 CR_token2
  1100,37: 


106 ID Idxs = Expr
  1101,1: block
  1101,6: [6][5]
  1101,13: =
  1101,15: "    77777770070077  "

184 [ Expr ] Idxs
  1101,6: [
  1101,7: 6
  1101,8: ]
  1101,9: [5]

76 NUM
  1101,7: 6

245 ] Idxs
  1101,8: ]
  1101,9: [5]

7 [ Expr ]
  1101,9: [
  1101,10: 5
  1101,11: ]

76 NUM
  1101,10: 5

245 ]
  1101,11: ]

263 = Expr
  1101,13: =
  1101,15: "    77777770070077  "

55 STR
  1101,15: "    77777770070077  "

206 CR_token2
  1101,37: 


106 ID Idxs = Expr
  1102,1: block
  1102,6: [6][6]
  1102,13: =
  1102,15: "    70000000000007  "

184 [ Expr ] Idxs
  1102,6: [
  1102,7: 6
  1102,8: ]
  1102,9: [6]

76 NUM
  1102,7: 6

245 ] Idxs
  1102,8: ]
  1102,9: [6]

7 [ Expr ]
  1102,9: [
  1102,10: 6
  1102,11: ]

76 NUM
  1102,10: 6

245 ]
  1102,11: ]

263 = Expr
  1102,13: =
  1102,15: "    70000000000007  "

55 STR
  1102,15: "    70000000000007  "

206 CR_token2
  1102,37: 


106 ID Idxs = Expr
  1103,1: block
  1103,6: [6][7]
  1103,13: =
  1103,15: "    70070077007007  "

184 [ Expr ] Idxs
  1103,6: [
  1103,7: 6
  1103,8: ]
  1103,9: [7]

76 NUM
  1103,7: 6

245 ] Idxs
  1103,8: ]
  1103,9: [7]

7 [ Expr ]
  1103,9: [
  1103,10: 7
  1103,11: ]

76 NUM
  1103,10: 7

245 ]
  1103,11: ]

263 = Expr
  1103,13: =
  1103,15: "    70070077007007  "

55 STR
  1103,15: "    70070077007007  "

206 CR_token2
  1103,37: 


106 ID Idxs = Expr
  1104,1: block
  1104,6: [6][8]
  1104,13: =
  1104,15: "  7777077007777077  "

184 [ Expr ] Idxs
  1104,6: [
  1104,7: 6
  1104,8: ]
  1104,9: [8]

76 NUM
  1104,7: 6

245 ] Idxs
  1104,8: ]
  1104,9: [8]

7 [ Expr ]
  1104,9: [
  1104,10: 8
  1104,11: ]

76 NUM
  1104,10: 8

245 ]
  1104,11: ]

263 = Expr
  1104,13: =
  1104,15: "  7777077007777077  "

55 STR
  1104,15: "  7777077007777077  "

206 CR_token2
  1104,37: 


106 ID Idxs = Expr
  1105,1: block
  1105,6: [6][9]
  1105,13: =
  1105,15: "  7002007777707007  "

184 [ Expr ] Idxs
  1105,6: [
  1105,7: 6
  1105,8: ]
  1105,9: [9]

76 NUM
  1105,7: 6

245 ] Idxs
  1105,8: ]
  1105,9: [9]

7 [ Expr ]
  1105,9: [
  1105,10: 9
  1105,11: ]

76 NUM
  1105,10: 9

245 ]
  1105,11: ]

263 = Expr
  1105,13: =
  1105,15: "  7002007777707007  "

55 STR
  1105,15: "  7002007777707007  "

206 CR_token2
  1105,37: 


106 ID Idxs = Expr
  1106,1: block
  1106,6: [6][10]
  1106,13: =
  1106,15: "  7070200200702007  "

184 [ Expr ] Idxs
  1106,6: [
  1106,7: 6
  1106,8: ]
  1106,9: [10]

76 NUM
  1106,7: 6

245 ] Idxs
  1106,8: ]
  1106,9: [10]

7 [ Expr ]
  1106,9: [
  1106,10: 10
  1106,12: ]

76 NUM
  1106,10: 10

245 ]
  1106,12: ]

263 = Expr
  1106,13: =
  1106,15: "  7070200200702007  "

55 STR
  1106,15: "  7070200200702007  "

206 CR_token2
  1106,37: 


106 ID Idxs = Expr
  1107,1: block
  1107,6: [6][11]
  1107,13: =
  1107,15: "  70X2002000700077  "

184 [ Expr ] Idxs
  1107,6: [
  1107,7: 6
  1107,8: ]
  1107,9: [11]

76 NUM
  1107,7: 6

245 ] Idxs
  1107,8: ]
  1107,9: [11]

7 [ Expr ]
  1107,9: [
  1107,10: 11
  1107,12: ]

76 NUM
  1107,10: 11

245 ]
  1107,12: ]

263 = Expr
  1107,13: =
  1107,15: "  70X2002000700077  "

55 STR
  1107,15: "  70X2002000700077  "

206 CR_token2
  1107,37: 


106 ID Idxs = Expr
  1108,1: block
  1108,6: [6][12]
  1108,13: =
  1108,15: "  777707707777777   "

184 [ Expr ] Idxs
  1108,6: [
  1108,7: 6
  1108,8: ]
  1108,9: [12]

76 NUM
  1108,7: 6

245 ] Idxs
  1108,8: ]
  1108,9: [12]

7 [ Expr ]
  1108,9: [
  1108,10: 12
  1108,12: ]

76 NUM
  1108,10: 12

245 ]
  1108,12: ]

263 = Expr
  1108,13: =
  1108,15: "  777707707777777   "

55 STR
  1108,15: "  777707707777777   "

206 CR_token2
  1108,37: 


106 ID Idxs = Expr
  1109,1: block
  1109,6: [6][13]
  1109,13: =
  1109,15: "     700007         "

184 [ Expr ] Idxs
  1109,6: [
  1109,7: 6
  1109,8: ]
  1109,9: [13]

76 NUM
  1109,7: 6

245 ] Idxs
  1109,8: ]
  1109,9: [13]

7 [ Expr ]
  1109,9: [
  1109,10: 13
  1109,12: ]

76 NUM
  1109,10: 13

245 ]
  1109,12: ]

263 = Expr
  1109,13: =
  1109,15: "     700007         "

55 STR
  1109,15: "     700007         "

206 CR_token2
  1109,37: 


106 ID Idxs = Expr
  1110,1: block
  1110,6: [6][14]
  1110,13: =
  1110,15: "     777777         "

184 [ Expr ] Idxs
  1110,6: [
  1110,7: 6
  1110,8: ]
  1110,9: [14]

76 NUM
  1110,7: 6

245 ] Idxs
  1110,8: ]
  1110,9: [14]

7 [ Expr ]
  1110,9: [
  1110,10: 14
  1110,12: ]

76 NUM
  1110,10: 14

245 ]
  1110,12: ]

263 = Expr
  1110,13: =
  1110,15: "     777777         "

55 STR
  1110,15: "     777777         "

206 CR_token2
  1110,37: 


106 ID Idxs = Expr
  1111,1: block
  1111,6: [6][15]
  1111,13: =
  1111,15: "                    "

184 [ Expr ] Idxs
  1111,6: [
  1111,7: 6
  1111,8: ]
  1111,9: [15]

76 NUM
  1111,7: 6

245 ] Idxs
  1111,8: ]
  1111,9: [15]

7 [ Expr ]
  1111,9: [
  1111,10: 15
  1111,12: ]

76 NUM
  1111,10: 15

245 ]
  1111,12: ]

263 = Expr
  1111,13: =
  1111,15: "                    "

55 STR
  1111,15: "                    "

206 CR_token2
  1111,37: 



106 ID Idxs = Expr
  1113,1: block
  1113,6: [7][0]
  1113,13: =
  1113,15: "                    "

184 [ Expr ] Idxs
  1113,6: [
  1113,7: 7
  1113,8: ]
  1113,9: [0]

76 NUM
  1113,7: 7

245 ] Idxs
  1113,8: ]
  1113,9: [0]

7 [ Expr ]
  1113,9: [
  1113,10: 0
  1113,11: ]

76 NUM
  1113,10: 0

245 ]
  1113,11: ]

263 = Expr
  1113,13: =
  1113,15: "                    "

55 STR
  1113,15: "                    "

206 CR_token2
  1113,37: 


106 ID Idxs = Expr
  1114,1: block
  1114,6: [7][1]
  1114,13: =
  1114,15: "                    "

184 [ Expr ] Idxs
  1114,6: [
  1114,7: 7
  1114,8: ]
  1114,9: [1]

76 NUM
  1114,7: 7

245 ] Idxs
  1114,8: ]
  1114,9: [1]

7 [ Expr ]
  1114,9: [
  1114,10: 1
  1114,11: ]

76 NUM
  1114,10: 1

245 ]
  1114,11: ]

263 = Expr
  1114,13: =
  1114,15: "                    "

55 STR
  1114,15: "                    "

206 CR_token2
  1114,37: 


106 ID Idxs = Expr
  1115,1: block
  1115,6: [7][2]
  1115,13: =
  1115,15: "                    "

184 [ Expr ] Idxs
  1115,6: [
  1115,7: 7
  1115,8: ]
  1115,9: [2]

76 NUM
  1115,7: 7

245 ] Idxs
  1115,8: ]
  1115,9: [2]

7 [ Expr ]
  1115,9: [
  1115,10: 2
  1115,11: ]

76 NUM
  1115,10: 2

245 ]
  1115,11: ]

263 = Expr
  1115,13: =
  1115,15: "                    "

55 STR
  1115,15: "                    "

206 CR_token2
  1115,37: 


106 ID Idxs = Expr
  1116,1: block
  1116,6: [7][3]
  1116,13: =
  1116,15: "          4444      "

184 [ Expr ] Idxs
  1116,6: [
  1116,7: 7
  1116,8: ]
  1116,9: [3]

76 NUM
  1116,7: 7

245 ] Idxs
  1116,8: ]
  1116,9: [3]

7 [ Expr ]
  1116,9: [
  1116,10: 3
  1116,11: ]

76 NUM
  1116,10: 3

245 ]
  1116,11: ]

263 = Expr
  1116,13: =
  1116,15: "          4444      "

55 STR
  1116,15: "          4444      "

206 CR_token2
  1116,37: 


106 ID Idxs = Expr
  1117,1: block
  1117,6: [7][4]
  1117,13: =
  1117,15: "    4444444AY4      "

184 [ Expr ] Idxs
  1117,6: [
  1117,7: 7
  1117,8: ]
  1117,9: [4]

76 NUM
  1117,7: 7

245 ] Idxs
  1117,8: ]
  1117,9: [4]

7 [ Expr ]
  1117,9: [
  1117,10: 4
  1117,11: ]

76 NUM
  1117,10: 4

245 ]
  1117,11: ]

263 = Expr
  1117,13: =
  1117,15: "    4444444AY4      "

55 STR
  1117,15: "    4444444AY4      "

206 CR_token2
  1117,37: 


106 ID Idxs = Expr
  1118,1: block
  1118,6: [7][5]
  1118,13: =
  1118,15: "    4AAAAACAA4      "

184 [ Expr ] Idxs
  1118,6: [
  1118,7: 7
  1118,8: ]
  1118,9: [5]

76 NUM
  1118,7: 7

245 ] Idxs
  1118,8: ]
  1118,9: [5]

7 [ Expr ]
  1118,9: [
  1118,10: 5
  1118,11: ]

76 NUM
  1118,10: 5

245 ]
  1118,11: ]

263 = Expr
  1118,13: =
  1118,15: "    4AAAAACAA4      "

55 STR
  1118,15: "    4AAAAACAA4      "

206 CR_token2
  1118,37: 


106 ID Idxs = Expr
  1119,1: block
  1119,6: [7][6]
  1119,13: =
  1119,15: "    4AAAC77AC4      "

184 [ Expr ] Idxs
  1119,6: [
  1119,7: 7
  1119,8: ]
  1119,9: [6]

76 NUM
  1119,7: 7

245 ] Idxs
  1119,8: ]
  1119,9: [6]

7 [ Expr ]
  1119,9: [
  1119,10: 6
  1119,11: ]

76 NUM
  1119,10: 6

245 ]
  1119,11: ]

263 = Expr
  1119,13: =
  1119,15: "    4AAAC77AC4      "

55 STR
  1119,15: "    4AAAC77AC4      "

206 CR_token2
  1119,37: 


106 ID Idxs = Expr
  1120,1: block
  1120,6: [7][7]
  1120,13: =
  1120,15: "    44C71117A4      "

184 [ Expr ] Idxs
  1120,6: [
  1120,7: 7
  1120,8: ]
  1120,9: [7]

76 NUM
  1120,7: 7

245 ] Idxs
  1120,8: ]
  1120,9: [7]

7 [ Expr ]
  1120,9: [
  1120,10: 7
  1120,11: ]

76 NUM
  1120,10: 7

245 ]
  1120,11: ]

263 = Expr
  1120,13: =
  1120,15: "    44C71117A4      "

55 STR
  1120,15: "    44C71117A4      "

206 CR_token2
  1120,37: 


106 ID Idxs = Expr
  1121,1: block
  1121,6: [7][8]
  1121,13: =
  1121,15: "     4AC111AA4      "

184 [ Expr ] Idxs
  1121,6: [
  1121,7: 7
  1121,8: ]
  1121,9: [8]

76 NUM
  1121,7: 7

245 ] Idxs
  1121,8: ]
  1121,9: [8]

7 [ Expr ]
  1121,9: [
  1121,10: 8
  1121,11: ]

76 NUM
  1121,10: 8

245 ]
  1121,11: ]

263 = Expr
  1121,13: =
  1121,15: "     4AC111AA4      "

55 STR
  1121,15: "     4AC111AA4      "

206 CR_token2
  1121,37: 


106 ID Idxs = Expr
  1122,1: block
  1122,6: [7][9]
  1122,13: =
  1122,15: "     4A71A17A44     "

184 [ Expr ] Idxs
  1122,6: [
  1122,7: 7
  1122,8: ]
  1122,9: [9]

76 NUM
  1122,7: 7

245 ] Idxs
  1122,8: ]
  1122,9: [9]

7 [ Expr ]
  1122,9: [
  1122,10: 9
  1122,11: ]

76 NUM
  1122,10: 9

245 ]
  1122,11: ]

263 = Expr
  1122,13: =
  1122,15: "     4A71A17A44     "

55 STR
  1122,15: "     4A71A17A44     "

206 CR_token2
  1122,37: 


106 ID Idxs = Expr
  1123,1: block
  1123,6: [7][10]
  1123,13: =
  1123,15: "     4AAA7A7CA4     "

184 [ Expr ] Idxs
  1123,6: [
  1123,7: 7
  1123,8: ]
  1123,9: [10]

76 NUM
  1123,7: 7

245 ] Idxs
  1123,8: ]
  1123,9: [10]

7 [ Expr ]
  1123,9: [
  1123,10: 10
  1123,12: ]

76 NUM
  1123,10: 10

245 ]
  1123,12: ]

263 = Expr
  1123,13: =
  1123,15: "     4AAA7A7CA4     "

55 STR
  1123,15: "     4AAA7A7CA4     "

206 CR_token2
  1123,37: 


106 ID Idxs = Expr
  1124,1: block
  1124,6: [7][11]
  1124,13: =
  1124,15: "     4CAACAAAA4     "

184 [ Expr ] Idxs
  1124,6: [
  1124,7: 7
  1124,8: ]
  1124,9: [11]

76 NUM
  1124,7: 7

245 ] Idxs
  1124,8: ]
  1124,9: [11]

7 [ Expr ]
  1124,9: [
  1124,10: 11
  1124,12: ]

76 NUM
  1124,10: 11

245 ]
  1124,12: ]

263 = Expr
  1124,13: =
  1124,15: "     4CAACAAAA4     "

55 STR
  1124,15: "     4CAACAAAA4     "

206 CR_token2
  1124,37: 


106 ID Idxs = Expr
  1125,1: block
  1125,6: [7][12]
  1125,13: =
  1125,15: "     4AA4444444     "

184 [ Expr ] Idxs
  1125,6: [
  1125,7: 7
  1125,8: ]
  1125,9: [12]

76 NUM
  1125,7: 7

245 ] Idxs
  1125,8: ]
  1125,9: [12]

7 [ Expr ]
  1125,9: [
  1125,10: 12
  1125,12: ]

76 NUM
  1125,10: 12

245 ]
  1125,12: ]

263 = Expr
  1125,13: =
  1125,15: "     4AA4444444     "

55 STR
  1125,15: "     4AA4444444     "

206 CR_token2
  1125,37: 


106 ID Idxs = Expr
  1126,1: block
  1126,6: [7][13]
  1126,13: =
  1126,15: "     4444           "

184 [ Expr ] Idxs
  1126,6: [
  1126,7: 7
  1126,8: ]
  1126,9: [13]

76 NUM
  1126,7: 7

245 ] Idxs
  1126,8: ]
  1126,9: [13]

7 [ Expr ]
  1126,9: [
  1126,10: 13
  1126,12: ]

76 NUM
  1126,10: 13

245 ]
  1126,12: ]

263 = Expr
  1126,13: =
  1126,15: "     4444           "

55 STR
  1126,15: "     4444           "

206 CR_token2
  1126,37: 


106 ID Idxs = Expr
  1127,1: block
  1127,6: [7][14]
  1127,13: =
  1127,15: "                    "

184 [ Expr ] Idxs
  1127,6: [
  1127,7: 7
  1127,8: ]
  1127,9: [14]

76 NUM
  1127,7: 7

245 ] Idxs
  1127,8: ]
  1127,9: [14]

7 [ Expr ]
  1127,9: [
  1127,10: 14
  1127,12: ]

76 NUM
  1127,10: 14

245 ]
  1127,12: ]

263 = Expr
  1127,13: =
  1127,15: "                    "

55 STR
  1127,15: "                    "

206 CR_token2
  1127,37: 


106 ID Idxs = Expr
  1128,1: block
  1128,6: [7][15]
  1128,13: =
  1128,15: "                    "

184 [ Expr ] Idxs
  1128,6: [
  1128,7: 7
  1128,8: ]
  1128,9: [15]

76 NUM
  1128,7: 7

245 ] Idxs
  1128,8: ]
  1128,9: [15]

7 [ Expr ]
  1128,9: [
  1128,10: 15
  1128,12: ]

76 NUM
  1128,10: 15

245 ]
  1128,12: ]

263 = Expr
  1128,13: =
  1128,15: "                    "

55 STR
  1128,15: "                    "

206 CR_token2
  1128,37: 



106 ID Idxs = Expr
  1130,1: block
  1130,6: [8][0]
  1130,13: =
  1130,15: "                    "

184 [ Expr ] Idxs
  1130,6: [
  1130,7: 8
  1130,8: ]
  1130,9: [0]

76 NUM
  1130,7: 8

245 ] Idxs
  1130,8: ]
  1130,9: [0]

7 [ Expr ]
  1130,9: [
  1130,10: 0
  1130,11: ]

76 NUM
  1130,10: 0

245 ]
  1130,11: ]

263 = Expr
  1130,13: =
  1130,15: "                    "

55 STR
  1130,15: "                    "

206 CR_token2
  1130,37: 


106 ID Idxs = Expr
  1131,1: block
  1131,6: [8][1]
  1131,13: =
  1131,15: "                    "

184 [ Expr ] Idxs
  1131,6: [
  1131,7: 8
  1131,8: ]
  1131,9: [1]

76 NUM
  1131,7: 8

245 ] Idxs
  1131,8: ]
  1131,9: [1]

7 [ Expr ]
  1131,9: [
  1131,10: 1
  1131,11: ]

76 NUM
  1131,10: 1

245 ]
  1131,11: ]

263 = Expr
  1131,13: =
  1131,15: "                    "

55 STR
  1131,15: "                    "

206 CR_token2
  1131,37: 


106 ID Idxs = Expr
  1132,1: block
  1132,6: [8][2]
  1132,13: =
  1132,15: "          4444      "

184 [ Expr ] Idxs
  1132,6: [
  1132,7: 8
  1132,8: ]
  1132,9: [2]

76 NUM
  1132,7: 8

245 ] Idxs
  1132,8: ]
  1132,9: [2]

7 [ Expr ]
  1132,9: [
  1132,10: 2
  1132,11: ]

76 NUM
  1132,10: 2

245 ]
  1132,11: ]

263 = Expr
  1132,13: =
  1132,15: "          4444      "

55 STR
  1132,15: "          4444      "

206 CR_token2
  1132,37: 


106 ID Idxs = Expr
  1133,1: block
  1133,6: [8][3]
  1133,13: =
  1133,15: "  444444444AA77     "

184 [ Expr ] Idxs
  1133,6: [
  1133,7: 8
  1133,8: ]
  1133,9: [3]

76 NUM
  1133,7: 8

245 ] Idxs
  1133,8: ]
  1133,9: [3]

7 [ Expr ]
  1133,9: [
  1133,10: 3
  1133,11: ]

76 NUM
  1133,10: 3

245 ]
  1133,11: ]

263 = Expr
  1133,13: =
  1133,15: "  444444444AA77     "

55 STR
  1133,15: "  444444444AA77     "

206 CR_token2
  1133,37: 


106 ID Idxs = Expr
  1134,1: block
  1134,6: [8][4]
  1134,13: =
  1134,15: " 74AACAAAAAACA75557 "

184 [ Expr ] Idxs
  1134,6: [
  1134,7: 8
  1134,8: ]
  1134,9: [4]

76 NUM
  1134,7: 8

245 ] Idxs
  1134,8: ]
  1134,9: [4]

7 [ Expr ]
  1134,9: [
  1134,10: 4
  1134,11: ]

76 NUM
  1134,10: 4

245 ]
  1134,11: ]

263 = Expr
  1134,13: =
  1134,15: " 74AACAAAAAACA75557 "

55 STR
  1134,15: " 74AACAAAAAACA75557 "

206 CR_token2
  1134,37: 


106 ID Idxs = Expr
  1135,1: block
  1135,6: [8][5]
  1135,13: =
  1135,15: " 4ABB77B77BBA771115 "

184 [ Expr ] Idxs
  1135,6: [
  1135,7: 8
  1135,8: ]
  1135,9: [5]

76 NUM
  1135,7: 8

245 ] Idxs
  1135,8: ]
  1135,9: [5]

7 [ Expr ]
  1135,9: [
  1135,10: 5
  1135,11: ]

76 NUM
  1135,10: 5

245 ]
  1135,11: ]

263 = Expr
  1135,13: =
  1135,15: " 4ABB77B77BBA771115 "

55 STR
  1135,15: " 4ABB77B77BBA771115 "

206 CR_token2
  1135,37: 


106 ID Idxs = Expr
  1136,1: block
  1136,6: [8][6]
  1136,13: =
  1136,15: " 4A7DDBDBDD7C771115 "

184 [ Expr ] Idxs
  1136,6: [
  1136,7: 8
  1136,8: ]
  1136,9: [6]

76 NUM
  1136,7: 8

245 ] Idxs
  1136,8: ]
  1136,9: [6]

7 [ Expr ]
  1136,9: [
  1136,10: 6
  1136,11: ]

76 NUM
  1136,10: 6

245 ]
  1136,11: ]

263 = Expr
  1136,13: =
  1136,15: " 4A7DDBDBDD7C771115 "

55 STR
  1136,15: " 4A7DDBDBDD7C771115 "

206 CR_token2
  1136,37: 


106 ID Idxs = Expr
  1137,1: block
  1137,6: [8][7]
  1137,13: =
  1137,15: " 4A7BBBBZBB7AAA1115 "

184 [ Expr ] Idxs
  1137,6: [
  1137,7: 8
  1137,8: ]
  1137,9: [7]

76 NUM
  1137,7: 8

245 ] Idxs
  1137,8: ]
  1137,9: [7]

7 [ Expr ]
  1137,9: [
  1137,10: 7
  1137,11: ]

76 NUM
  1137,10: 7

245 ]
  1137,11: ]

263 = Expr
  1137,13: =
  1137,15: " 4A7BBBBZBB7AAA1115 "

55 STR
  1137,15: " 4A7BBBBZBB7AAA1115 "

206 CR_token2
  1137,37: 


106 ID Idxs = Expr
  1138,1: block
  1138,6: [8][8]
  1138,13: =
  1138,15: " 4ABD7B777DDAAA1115 "

184 [ Expr ] Idxs
  1138,6: [
  1138,7: 8
  1138,8: ]
  1138,9: [8]

76 NUM
  1138,7: 8

245 ] Idxs
  1138,8: ]
  1138,9: [8]

7 [ Expr ]
  1138,9: [
  1138,10: 8
  1138,11: ]

76 NUM
  1138,10: 8

245 ]
  1138,11: ]

263 = Expr
  1138,13: =
  1138,15: " 4ABD7B777DDAAA1115 "

55 STR
  1138,15: " 4ABD7B777DDAAA1115 "

206 CR_token2
  1138,37: 


106 ID Idxs = Expr
  1139,1: block
  1139,6: [8][9]
  1139,13: =
  1139,15: " 4ACAACCAACA7711115 "

184 [ Expr ] Idxs
  1139,6: [
  1139,7: 8
  1139,8: ]
  1139,9: [9]

76 NUM
  1139,7: 8

245 ] Idxs
  1139,8: ]
  1139,9: [9]

7 [ Expr ]
  1139,9: [
  1139,10: 9
  1139,11: ]

76 NUM
  1139,10: 9

245 ]
  1139,11: ]

263 = Expr
  1139,13: =
  1139,15: " 4ACAACCAACA7711115 "

55 STR
  1139,15: " 4ACAACCAACA7711115 "

206 CR_token2
  1139,37: 


106 ID Idxs = Expr
  1140,1: block
  1140,6: [8][10]
  1140,13: =
  1140,15: " 744CAAAAAAA7755557 "

184 [ Expr ] Idxs
  1140,6: [
  1140,7: 8
  1140,8: ]
  1140,9: [10]

76 NUM
  1140,7: 8

245 ] Idxs
  1140,8: ]
  1140,9: [10]

7 [ Expr ]
  1140,9: [
  1140,10: 10
  1140,12: ]

76 NUM
  1140,10: 10

245 ]
  1140,12: ]

263 = Expr
  1140,13: =
  1140,15: " 744CAAAAAAA7755557 "

55 STR
  1140,15: " 744CAAAAAAA7755557 "

206 CR_token2
  1140,37: 


106 ID Idxs = Expr
  1141,1: block
  1141,6: [8][11]
  1141,13: =
  1141,15: "   4AA4444444       "

184 [ Expr ] Idxs
  1141,6: [
  1141,7: 8
  1141,8: ]
  1141,9: [11]

76 NUM
  1141,7: 8

245 ] Idxs
  1141,8: ]
  1141,9: [11]

7 [ Expr ]
  1141,9: [
  1141,10: 11
  1141,12: ]

76 NUM
  1141,10: 11

245 ]
  1141,12: ]

263 = Expr
  1141,13: =
  1141,15: "   4AA4444444       "

55 STR
  1141,15: "   4AA4444444       "

206 CR_token2
  1141,37: 


106 ID Idxs = Expr
  1142,1: block
  1142,6: [8][12]
  1142,13: =
  1142,15: "   4444             "

184 [ Expr ] Idxs
  1142,6: [
  1142,7: 8
  1142,8: ]
  1142,9: [12]

76 NUM
  1142,7: 8

245 ] Idxs
  1142,8: ]
  1142,9: [12]

7 [ Expr ]
  1142,9: [
  1142,10: 12
  1142,12: ]

76 NUM
  1142,10: 12

245 ]
  1142,12: ]

263 = Expr
  1142,13: =
  1142,15: "   4444             "

55 STR
  1142,15: "   4444             "

206 CR_token2
  1142,37: 


106 ID Idxs = Expr
  1143,1: block
  1143,6: [8][13]
  1143,13: =
  1143,15: "                    "

184 [ Expr ] Idxs
  1143,6: [
  1143,7: 8
  1143,8: ]
  1143,9: [13]

76 NUM
  1143,7: 8

245 ] Idxs
  1143,8: ]
  1143,9: [13]

7 [ Expr ]
  1143,9: [
  1143,10: 13
  1143,12: ]

76 NUM
  1143,10: 13

245 ]
  1143,12: ]

263 = Expr
  1143,13: =
  1143,15: "                    "

55 STR
  1143,15: "                    "

206 CR_token2
  1143,37: 


106 ID Idxs = Expr
  1144,1: block
  1144,6: [8][14]
  1144,13: =
  1144,15: "                    "

184 [ Expr ] Idxs
  1144,6: [
  1144,7: 8
  1144,8: ]
  1144,9: [14]

76 NUM
  1144,7: 8

245 ] Idxs
  1144,8: ]
  1144,9: [14]

7 [ Expr ]
  1144,9: [
  1144,10: 14
  1144,12: ]

76 NUM
  1144,10: 14

245 ]
  1144,12: ]

263 = Expr
  1144,13: =
  1144,15: "                    "

55 STR
  1144,15: "                    "

206 CR_token2
  1144,37: 


106 ID Idxs = Expr
  1145,1: block
  1145,6: [8][15]
  1145,13: =
  1145,15: "                    "

184 [ Expr ] Idxs
  1145,6: [
  1145,7: 8
  1145,8: ]
  1145,9: [15]

76 NUM
  1145,7: 8

245 ] Idxs
  1145,8: ]
  1145,9: [15]

7 [ Expr ]
  1145,9: [
  1145,10: 15
  1145,12: ]

76 NUM
  1145,10: 15

245 ]
  1145,12: ]

263 = Expr
  1145,13: =
  1145,15: "                    "

55 STR
  1145,15: "                    "

206 CR_token2
  1145,37: 



106 ID Idxs = Expr
  1147,1: block
  1147,6: [9][0]
  1147,13: =
  1147,15: " AAAAA A   A AAAA   "

184 [ Expr ] Idxs
  1147,6: [
  1147,7: 9
  1147,8: ]
  1147,9: [0]

76 NUM
  1147,7: 9

245 ] Idxs
  1147,8: ]
  1147,9: [0]

7 [ Expr ]
  1147,9: [
  1147,10: 0
  1147,11: ]

76 NUM
  1147,10: 0

245 ]
  1147,11: ]

263 = Expr
  1147,13: =
  1147,15: " AAAAA A   A AAAA   "

55 STR
  1147,15: " AAAAA A   A AAAA   "

206 CR_token2
  1147,37: 


106 ID Idxs = Expr
  1148,1: block
  1148,6: [9][1]
  1148,13: =
  1148,15: "   A   A   A A      "

184 [ Expr ] Idxs
  1148,6: [
  1148,7: 9
  1148,8: ]
  1148,9: [1]

76 NUM
  1148,7: 9

245 ] Idxs
  1148,8: ]
  1148,9: [1]

7 [ Expr ]
  1148,9: [
  1148,10: 1
  1148,11: ]

76 NUM
  1148,10: 1

245 ]
  1148,11: ]

263 = Expr
  1148,13: =
  1148,15: "   A   A   A A      "

55 STR
  1148,15: "   A   A   A A      "

206 CR_token2
  1148,37: 


106 ID Idxs = Expr
  1149,1: block
  1149,6: [9][2]
  1149,13: =
  1149,15: "   A   AAAAA AAA    "

184 [ Expr ] Idxs
  1149,6: [
  1149,7: 9
  1149,8: ]
  1149,9: [2]

76 NUM
  1149,7: 9

245 ] Idxs
  1149,8: ]
  1149,9: [2]

7 [ Expr ]
  1149,9: [
  1149,10: 2
  1149,11: ]

76 NUM
  1149,10: 2

245 ]
  1149,11: ]

263 = Expr
  1149,13: =
  1149,15: "   A   AAAAA AAA    "

55 STR
  1149,15: "   A   AAAAA AAA    "

206 CR_token2
  1149,37: 


106 ID Idxs = Expr
  1150,1: block
  1150,6: [9][3]
  1150,13: =
  1150,15: "   A   A   A A      "

184 [ Expr ] Idxs
  1150,6: [
  1150,7: 9
  1150,8: ]
  1150,9: [3]

76 NUM
  1150,7: 9

245 ] Idxs
  1150,8: ]
  1150,9: [3]

7 [ Expr ]
  1150,9: [
  1150,10: 3
  1150,11: ]

76 NUM
  1150,10: 3

245 ]
  1150,11: ]

263 = Expr
  1150,13: =
  1150,15: "   A   A   A A      "

55 STR
  1150,15: "   A   A   A A      "

206 CR_token2
  1150,37: 


106 ID Idxs = Expr
  1151,1: block
  1151,6: [9][4]
  1151,13: =
  1151,15: "   A   A   A AAAA   "

184 [ Expr ] Idxs
  1151,6: [
  1151,7: 9
  1151,8: ]
  1151,9: [4]

76 NUM
  1151,7: 9

245 ] Idxs
  1151,8: ]
  1151,9: [4]

7 [ Expr ]
  1151,9: [
  1151,10: 4
  1151,11: ]

76 NUM
  1151,10: 4

245 ]
  1151,11: ]

263 = Expr
  1151,13: =
  1151,15: "   A   A   A AAAA   "

55 STR
  1151,15: "   A   A   A AAAA   "

206 CR_token2
  1151,37: 


106 ID Idxs = Expr
  1152,1: block
  1152,6: [9][5]
  1152,13: =
  1152,15: "                    "

184 [ Expr ] Idxs
  1152,6: [
  1152,7: 9
  1152,8: ]
  1152,9: [5]

76 NUM
  1152,7: 9

245 ] Idxs
  1152,8: ]
  1152,9: [5]

7 [ Expr ]
  1152,9: [
  1152,10: 5
  1152,11: ]

76 NUM
  1152,10: 5

245 ]
  1152,11: ]

263 = Expr
  1152,13: =
  1152,15: "                    "

55 STR
  1152,15: "                    "

206 CR_token2
  1152,37: 


106 ID Idxs = Expr
  1153,1: block
  1153,6: [9][6]
  1153,13: =
  1153,15: "  AAAA A   A AAA    "

184 [ Expr ] Idxs
  1153,6: [
  1153,7: 9
  1153,8: ]
  1153,9: [6]

76 NUM
  1153,7: 9

245 ] Idxs
  1153,8: ]
  1153,9: [6]

7 [ Expr ]
  1153,9: [
  1153,10: 6
  1153,11: ]

76 NUM
  1153,10: 6

245 ]
  1153,11: ]

263 = Expr
  1153,13: =
  1153,15: "  AAAA A   A AAA    "

55 STR
  1153,15: "  AAAA A   A AAA    "

206 CR_token2
  1153,37: 


106 ID Idxs = Expr
  1154,1: block
  1154,6: [9][7]
  1154,13: =
  1154,15: "  A    AA  A A  A   "

184 [ Expr ] Idxs
  1154,6: [
  1154,7: 9
  1154,8: ]
  1154,9: [7]

76 NUM
  1154,7: 9

245 ] Idxs
  1154,8: ]
  1154,9: [7]

7 [ Expr ]
  1154,9: [
  1154,10: 7
  1154,11: ]

76 NUM
  1154,10: 7

245 ]
  1154,11: ]

263 = Expr
  1154,13: =
  1154,15: "  A    AA  A A  A   "

55 STR
  1154,15: "  A    AA  A A  A   "

206 CR_token2
  1154,37: 


106 ID Idxs = Expr
  1155,1: block
  1155,6: [9][8]
  1155,13: =
  1155,15: "  AAA  A A A A  A   "

184 [ Expr ] Idxs
  1155,6: [
  1155,7: 9
  1155,8: ]
  1155,9: [8]

76 NUM
  1155,7: 9

245 ] Idxs
  1155,8: ]
  1155,9: [8]

7 [ Expr ]
  1155,9: [
  1155,10: 8
  1155,11: ]

76 NUM
  1155,10: 8

245 ]
  1155,11: ]

263 = Expr
  1155,13: =
  1155,15: "  AAA  A A A A  A   "

55 STR
  1155,15: "  AAA  A A A A  A   "

206 CR_token2
  1155,37: 


106 ID Idxs = Expr
  1156,1: block
  1156,6: [9][9]
  1156,12: =
  1156,15: "  A    A  AA A  A   "

184 [ Expr ] Idxs
  1156,6: [
  1156,7: 9
  1156,8: ]
  1156,9: [9]

76 NUM
  1156,7: 9

245 ] Idxs
  1156,8: ]
  1156,9: [9]

7 [ Expr ]
  1156,9: [
  1156,10: 9
  1156,11: ]

76 NUM
  1156,10: 9

245 ]
  1156,11: ]

263 = Expr
  1156,12: =
  1156,15: "  A    A  AA A  A   "

55 STR
  1156,15: "  A    A  AA A  A   "

206 CR_token2
  1156,37: 


106 ID Idxs = Expr
  1157,1: block
  1157,6: [9][10]
  1157,13: =
  1157,15: "  AAAA A   A AAA    "

184 [ Expr ] Idxs
  1157,6: [
  1157,7: 9
  1157,8: ]
  1157,9: [10]

76 NUM
  1157,7: 9

245 ] Idxs
  1157,8: ]
  1157,9: [10]

7 [ Expr ]
  1157,9: [
  1157,10: 10
  1157,12: ]

76 NUM
  1157,10: 10

245 ]
  1157,12: ]

263 = Expr
  1157,13: =
  1157,15: "  AAAA A   A AAA    "

55 STR
  1157,15: "  AAAA A   A AAA    "

206 CR_token2
  1157,37: 


106 ID Idxs = Expr
  1158,1: block
  1158,6: [9][11]
  1158,13: =
  1158,15: "                    "

184 [ Expr ] Idxs
  1158,6: [
  1158,7: 9
  1158,8: ]
  1158,9: [11]

76 NUM
  1158,7: 9

245 ] Idxs
  1158,8: ]
  1158,9: [11]

7 [ Expr ]
  1158,9: [
  1158,10: 11
  1158,12: ]

76 NUM
  1158,10: 11

245 ]
  1158,12: ]

263 = Expr
  1158,13: =
  1158,15: "                    "

55 STR
  1158,15: "                    "

206 CR_token2
  1158,37: 


106 ID Idxs = Expr
  1159,1: block
  1159,6: [9][12]
  1159,13: =
  1159,15: "                    "

184 [ Expr ] Idxs
  1159,6: [
  1159,7: 9
  1159,8: ]
  1159,9: [12]

76 NUM
  1159,7: 9

245 ] Idxs
  1159,8: ]
  1159,9: [12]

7 [ Expr ]
  1159,9: [
  1159,10: 12
  1159,12: ]

76 NUM
  1159,10: 12

245 ]
  1159,12: ]

263 = Expr
  1159,13: =
  1159,15: "                    "

55 STR
  1159,15: "                    "

206 CR_token2
  1159,37: 


106 ID Idxs = Expr
  1160,1: block
  1160,6: [9][13]
  1160,13: =
  1160,15: " 4444444444444444   "

184 [ Expr ] Idxs
  1160,6: [
  1160,7: 9
  1160,8: ]
  1160,9: [13]

76 NUM
  1160,7: 9

245 ] Idxs
  1160,8: ]
  1160,9: [13]

7 [ Expr ]
  1160,9: [
  1160,10: 13
  1160,12: ]

76 NUM
  1160,10: 13

245 ]
  1160,12: ]

263 = Expr
  1160,13: =
  1160,15: " 4444444444444444   "

55 STR
  1160,15: " 4444444444444444   "

206 CR_token2
  1160,37: 


106 ID Idxs = Expr
  1161,1: block
  1161,6: [9][14]
  1161,13: =
  1161,15: " 40X0020000000104   "

184 [ Expr ] Idxs
  1161,6: [
  1161,7: 9
  1161,8: ]
  1161,9: [14]

76 NUM
  1161,7: 9

245 ] Idxs
  1161,8: ]
  1161,9: [14]

7 [ Expr ]
  1161,9: [
  1161,10: 14
  1161,12: ]

76 NUM
  1161,10: 14

245 ]
  1161,12: ]

263 = Expr
  1161,13: =
  1161,15: " 40X0020000000104   "

55 STR
  1161,15: " 40X0020000000104   "

206 CR_token2
  1161,37: 


106 ID Idxs = Expr
  1162,1: block
  1162,6: [9][15]
  1162,13: =
  1162,15: " 4444444444444444   "

184 [ Expr ] Idxs
  1162,6: [
  1162,7: 9
  1162,8: ]
  1162,9: [15]

76 NUM
  1162,7: 9

245 ] Idxs
  1162,8: ]
  1162,9: [15]

7 [ Expr ]
  1162,9: [
  1162,10: 15
  1162,12: ]

76 NUM
  1162,10: 15

245 ]
  1162,12: ]

263 = Expr
  1162,13: =
  1162,15: " 4444444444444444   "

55 STR
  1162,15: " 4444444444444444   "

206 CR_token2
  1162,37: 



257 Stmt_token8
  1164,1: EndSub

